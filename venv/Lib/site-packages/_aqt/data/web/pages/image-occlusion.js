"use strict";var anki=(()=>{var ky=Object.create;var Lo=Object.defineProperty;var Ty=Object.getOwnPropertyDescriptor;var Cy=Object.getOwnPropertyNames;var Sy=Object.getPrototypeOf,Ey=Object.prototype.hasOwnProperty;var Oy=(t,e,n)=>e in t?Lo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Ay=(t,e)=>()=>(t&&(e=t(t=0)),e);var ct=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),rd=(t,e)=>{for(var n in e)Lo(t,n,{get:e[n],enumerable:!0})},od=(t,e,n,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Cy(e))!Ey.call(t,r)&&r!==n&&Lo(t,r,{get:()=>e[r],enumerable:!(o=Ty(e,r))||o.enumerable});return t};var pt=(t,e,n)=>(n=t!=null?ky(Sy(t)):{},od(e||!t||!t.__esModule?Lo(n,"default",{value:t,enumerable:!0}):n,t)),id=t=>od(Lo({},"__esModule",{value:!0}),t);var tt=(t,e,n)=>(Oy(t,typeof e!="symbol"?e+"":e,n),n);var gf={};rd(gf,{default:()=>c0});function Di(t){"@babel/helpers - typeof";return Di=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Di(t)}function t0(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ff(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o0(o.key),o)}}function n0(t,e,n){return e&&ff(t.prototype,e),n&&ff(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function r0(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var o=n.call(t,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function o0(t){var e=r0(t,"string");return typeof e=="symbol"?e:String(e)}function Kt(t,e){var n=hf(t,e,"get");return i0(t,n)}function zo(t,e,n){var o=hf(t,e,"set");return a0(t,o,n),n}function hf(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function i0(t,e){return e.get?e.get.call(t):e.value}function a0(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function s0(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ho(t,e,n){s0(t,e),e.set(t,n)}function l0(t){var e=Object.prototype.hasOwnProperty.call(t,"type")&&t.type;if(!e)return"cardinal";if(e==="cardinal"||e==="ordinal")return e;throw new RangeError("Not a valid plural type: "+JSON.stringify(e))}function mf(t){switch(Di(t)){case"number":return t;case"bigint":throw new TypeError("Cannot convert a BigInt value to a number");default:return Number(t)}}function c0(t,e,n,o){var r=function(p){do{if(e(p))return p;p=p.replace(/-?[^-]*$/,"")}while(p);return null},i=function(p){for(var m=pf(p),h=0;h<m.length;++h){var b=r(m[h]);if(b)return b}var x=new t().resolvedOptions().locale;return r(x)},a=new WeakMap,s=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap,d=function(){function f(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};t0(this,f),Ho(this,a,{writable:!0,value:void 0}),Ho(this,s,{writable:!0,value:void 0}),Ho(this,c,{writable:!0,value:void 0}),Ho(this,l,{writable:!0,value:void 0}),Ho(this,u,{writable:!0,value:void 0}),zo(this,a,i(p)),zo(this,c,e(Kt(this,a))),zo(this,s,o(Kt(this,a))),zo(this,l,l0(m)),zo(this,u,new t("en",m))}return n0(f,[{key:"resolvedOptions",value:function(){var m=Kt(this,u).resolvedOptions(),h=m.minimumIntegerDigits,b=m.minimumFractionDigits,x=m.maximumFractionDigits,T=m.minimumSignificantDigits,B=m.maximumSignificantDigits,A=m.roundingPriority,S={locale:Kt(this,a),type:Kt(this,l),minimumIntegerDigits:h,minimumFractionDigits:b,maximumFractionDigits:x};return typeof T=="number"&&(S.minimumSignificantDigits=T,S.maximumSignificantDigits=B),S.pluralCategories=n(Kt(this,a),Kt(this,l)==="ordinal").slice(0),S.roundingPriority=A||"auto",S}},{key:"select",value:function(m){if(!(this instanceof f))throw new TypeError("select() called on incompatible ".concat(this));if(typeof m!="number"&&(m=Number(m)),!isFinite(m))return"other";var h=Kt(this,u).format(Math.abs(m));return Kt(this,c).call(this,h,Kt(this,l)==="ordinal")}},{key:"selectRange",value:function(m,h){if(!(this instanceof f))throw new TypeError("selectRange() called on incompatible ".concat(this));if(m===void 0)throw new TypeError("start is undefined");if(h===void 0)throw new TypeError("end is undefined");var b=mf(m),x=mf(h);if(!isFinite(b))throw new RangeError("start must be finite");if(!isFinite(x))throw new RangeError("end must be finite");return Kt(this,s).call(this,this.select(b),this.select(x))}}],[{key:"supportedLocalesOf",value:function(m){return pf(m).filter(r)}}]),f}();return typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(d.prototype,Symbol.toStringTag,{value:"Intl.PluralRules",writable:!1,configurable:!0}),Object.defineProperty(d,"prototype",{writable:!1}),d}var pf,bf=Ay(()=>{pf=function(e){if(!e)return[];Array.isArray(e)||(e=[e]);for(var n={},o=0;o<e.length;++o){var r,i=e[o];if(i&&Di(i)==="object"&&(i=String(i)),typeof i!="string"){var a="Locales should be strings, ".concat(JSON.stringify(i)," isn't.");throw new TypeError(a)}var s=i.split("-");if(!s.every(function(d){return/[a-z0-9]+/i.test(d)})){var c=JSON.stringify(i),l="The locale ".concat(c," is not a structurally valid BCP 47 language tag.");throw new RangeError(l)}var u=s[0].toLowerCase();s[0]=(r={in:"id",iw:"he",ji:"yi"}[u])!==null&&r!==void 0?r:u,n[s.join("-")]=!0}return Object.keys(n)}});var _f=ct((o5,wf)=>{"use strict";var u0=(bf(),id(gf));function d0(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}function Ss(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(o){if(o!=="default"&&!(o in t)){var r=Object.getOwnPropertyDescriptor(n,o);Object.defineProperty(t,o,r.get?r:{enumerable:!0,get:function(){return n[o]}})}})}),Object.freeze(t)}var f0=d0(u0),Es=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Os(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var As={exports:{}};(function(t,e){var n=function(l,u){return u?"other":l==1?"one":"other"},o=function(l,u){return u?"other":l==0||l==1?"one":"other"},r=function(l,u){return u?"other":l>=0&&l<=1?"one":"other"},i=function(l,u){var d=String(l).split("."),f=!d[1];return u?"other":l==1&&f?"one":"other"},a=function(l,u){return"other"},s=function(l,u){return u?"other":l==1?"one":l==2?"two":"other"};(function(c,l){Object.defineProperty(l,"__esModule",{value:!0}),t.exports=l})(Es,{af:n,ak:o,am:r,an:n,ar:function(l,u){var d=String(l).split("."),f=Number(d[0])==l,p=f&&d[0].slice(-2);return u?"other":l==0?"zero":l==1?"one":l==2?"two":p>=3&&p<=10?"few":p>=11&&p<=99?"many":"other"},ars:function(l,u){var d=String(l).split("."),f=Number(d[0])==l,p=f&&d[0].slice(-2);return u?"other":l==0?"zero":l==1?"one":l==2?"two":p>=3&&p<=10?"few":p>=11&&p<=99?"many":"other"},as:function(l,u){return u?l==1||l==5||l==7||l==8||l==9||l==10?"one":l==2||l==3?"two":l==4?"few":l==6?"many":"other":l>=0&&l<=1?"one":"other"},asa:n,ast:i,az:function(l,u){var d=String(l).split("."),f=d[0],p=f.slice(-1),m=f.slice(-2),h=f.slice(-3);return u?p==1||p==2||p==5||p==7||p==8||m==20||m==50||m==70||m==80?"one":p==3||p==4||h==100||h==200||h==300||h==400||h==500||h==600||h==700||h==800||h==900?"few":f==0||p==6||m==40||m==60||m==90?"many":"other":l==1?"one":"other"},bal:function(l,u){return l==1?"one":"other"},be:function(l,u){var d=String(l).split("."),f=Number(d[0])==l,p=f&&d[0].slice(-1),m=f&&d[0].slice(-2);return u?(p==2||p==3)&&m!=12&&m!=13?"few":"other":p==1&&m!=11?"one":p>=2&&p<=4&&(m<12||m>14)?"few":f&&p==0||p>=5&&p<=9||m>=11&&m<=14?"many":"other"},bem:n,bez:n,bg:n,bho:o,bm:a,bn:function(l,u){return u?l==1||l==5||l==7||l==8||l==9||l==10?"one":l==2||l==3?"two":l==4?"few":l==6?"many":"other":l>=0&&l<=1?"one":"other"},bo:a,br:function(l,u){var d=String(l).split("."),f=Number(d[0])==l,p=f&&d[0].slice(-1),m=f&&d[0].slice(-2),h=f&&d[0].slice(-6);return u?"other":p==1&&m!=11&&m!=71&&m!=91?"one":p==2&&m!=12&&m!=72&&m!=92?"two":(p==3||p==4||p==9)&&(m<10||m>19)&&(m<70||m>79)&&(m<90||m>99)?"few":l!=0&&f&&h==0?"many":"other"},brx:n,bs:function(l,u){var d=String(l).split("."),f=d[0],p=d[1]||"",m=!d[1],h=f.slice(-1),b=f.slice(-2),x=p.slice(-1),T=p.slice(-2);return u?"other":m&&h==1&&b!=11||x==1&&T!=11?"one":m&&h>=2&&h<=4&&(b<12||b>14)||x>=2&&x<=4&&(T<12||T>14)?"few":"other"},ca:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=f.slice(-6);return u?l==1||l==3?"one":l==2?"two":l==4?"few":"other":l==1&&p?"one":f!=0&&m==0&&p?"many":"other"},ce:n,ceb:function(l,u){var d=String(l).split("."),f=d[0],p=d[1]||"",m=!d[1],h=f.slice(-1),b=p.slice(-1);return u?"other":m&&(f==1||f==2||f==3)||m&&h!=4&&h!=6&&h!=9||!m&&b!=4&&b!=6&&b!=9?"one":"other"},cgg:n,chr:n,ckb:n,cs:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1];return u?"other":l==1&&p?"one":f>=2&&f<=4&&p?"few":p?"other":"many"},cy:function(l,u){return u?l==0||l==7||l==8||l==9?"zero":l==1?"one":l==2?"two":l==3||l==4?"few":l==5||l==6?"many":"other":l==0?"zero":l==1?"one":l==2?"two":l==3?"few":l==6?"many":"other"},da:function(l,u){var d=String(l).split("."),f=d[0],p=Number(d[0])==l;return u?"other":l==1||!p&&(f==0||f==1)?"one":"other"},de:i,doi:r,dsb:function(l,u){var d=String(l).split("."),f=d[0],p=d[1]||"",m=!d[1],h=f.slice(-2),b=p.slice(-2);return u?"other":m&&h==1||b==1?"one":m&&h==2||b==2?"two":m&&(h==3||h==4)||b==3||b==4?"few":"other"},dv:n,dz:a,ee:n,el:n,en:function(l,u){var d=String(l).split("."),f=!d[1],p=Number(d[0])==l,m=p&&d[0].slice(-1),h=p&&d[0].slice(-2);return u?m==1&&h!=11?"one":m==2&&h!=12?"two":m==3&&h!=13?"few":"other":l==1&&f?"one":"other"},eo:n,es:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=f.slice(-6);return u?"other":l==1?"one":f!=0&&m==0&&p?"many":"other"},et:i,eu:n,fa:r,ff:function(l,u){return u?"other":l>=0&&l<2?"one":"other"},fi:i,fil:function(l,u){var d=String(l).split("."),f=d[0],p=d[1]||"",m=!d[1],h=f.slice(-1),b=p.slice(-1);return u?l==1?"one":"other":m&&(f==1||f==2||f==3)||m&&h!=4&&h!=6&&h!=9||!m&&b!=4&&b!=6&&b!=9?"one":"other"},fo:n,fr:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=f.slice(-6);return u?l==1?"one":"other":l>=0&&l<2?"one":f!=0&&m==0&&p?"many":"other"},fur:n,fy:i,ga:function(l,u){var d=String(l).split("."),f=Number(d[0])==l;return u?l==1?"one":"other":l==1?"one":l==2?"two":f&&l>=3&&l<=6?"few":f&&l>=7&&l<=10?"many":"other"},gd:function(l,u){var d=String(l).split("."),f=Number(d[0])==l;return u?l==1||l==11?"one":l==2||l==12?"two":l==3||l==13?"few":"other":l==1||l==11?"one":l==2||l==12?"two":f&&l>=3&&l<=10||f&&l>=13&&l<=19?"few":"other"},gl:i,gsw:n,gu:function(l,u){return u?l==1?"one":l==2||l==3?"two":l==4?"few":l==6?"many":"other":l>=0&&l<=1?"one":"other"},guw:o,gv:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=f.slice(-1),h=f.slice(-2);return u?"other":p&&m==1?"one":p&&m==2?"two":p&&(h==0||h==20||h==40||h==60||h==80)?"few":p?"other":"many"},ha:n,haw:n,he:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1];return u?"other":f==1&&p||f==0&&!p?"one":f==2&&p?"two":"other"},hi:function(l,u){return u?l==1?"one":l==2||l==3?"two":l==4?"few":l==6?"many":"other":l>=0&&l<=1?"one":"other"},hnj:a,hr:function(l,u){var d=String(l).split("."),f=d[0],p=d[1]||"",m=!d[1],h=f.slice(-1),b=f.slice(-2),x=p.slice(-1),T=p.slice(-2);return u?"other":m&&h==1&&b!=11||x==1&&T!=11?"one":m&&h>=2&&h<=4&&(b<12||b>14)||x>=2&&x<=4&&(T<12||T>14)?"few":"other"},hsb:function(l,u){var d=String(l).split("."),f=d[0],p=d[1]||"",m=!d[1],h=f.slice(-2),b=p.slice(-2);return u?"other":m&&h==1||b==1?"one":m&&h==2||b==2?"two":m&&(h==3||h==4)||b==3||b==4?"few":"other"},hu:function(l,u){return u?l==1||l==5?"one":"other":l==1?"one":"other"},hy:function(l,u){return u?l==1?"one":"other":l>=0&&l<2?"one":"other"},ia:i,id:a,ig:a,ii:a,io:i,is:function(l,u){var d=String(l).split("."),f=d[0],p=(d[1]||"").replace(/0+$/,""),m=Number(d[0])==l,h=f.slice(-1),b=f.slice(-2);return u?"other":m&&h==1&&b!=11||p%10==1&&p%100!=11?"one":"other"},it:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=f.slice(-6);return u?l==11||l==8||l==80||l==800?"many":"other":l==1&&p?"one":f!=0&&m==0&&p?"many":"other"},iu:s,ja:a,jbo:a,jgo:n,jmc:n,jv:a,jw:a,ka:function(l,u){var d=String(l).split("."),f=d[0],p=f.slice(-2);return u?f==1?"one":f==0||p>=2&&p<=20||p==40||p==60||p==80?"many":"other":l==1?"one":"other"},kab:function(l,u){return u?"other":l>=0&&l<2?"one":"other"},kaj:n,kcg:n,kde:a,kea:a,kk:function(l,u){var d=String(l).split("."),f=Number(d[0])==l,p=f&&d[0].slice(-1);return u?p==6||p==9||f&&p==0&&l!=0?"many":"other":l==1?"one":"other"},kkj:n,kl:n,km:a,kn:r,ko:a,ks:n,ksb:n,ksh:function(l,u){return u?"other":l==0?"zero":l==1?"one":"other"},ku:n,kw:function(l,u){var d=String(l).split("."),f=Number(d[0])==l,p=f&&d[0].slice(-2),m=f&&d[0].slice(-3),h=f&&d[0].slice(-5),b=f&&d[0].slice(-6);return u?f&&l>=1&&l<=4||p>=1&&p<=4||p>=21&&p<=24||p>=41&&p<=44||p>=61&&p<=64||p>=81&&p<=84?"one":l==5||p==5?"many":"other":l==0?"zero":l==1?"one":p==2||p==22||p==42||p==62||p==82||f&&m==0&&(h>=1e3&&h<=2e4||h==4e4||h==6e4||h==8e4)||l!=0&&b==1e5?"two":p==3||p==23||p==43||p==63||p==83?"few":l!=1&&(p==1||p==21||p==41||p==61||p==81)?"many":"other"},ky:n,lag:function(l,u){var d=String(l).split("."),f=d[0];return u?"other":l==0?"zero":(f==0||f==1)&&l!=0?"one":"other"},lb:n,lg:n,lij:function(l,u){var d=String(l).split("."),f=!d[1],p=Number(d[0])==l;return u?l==11||l==8||p&&l>=80&&l<=89||p&&l>=800&&l<=899?"many":"other":l==1&&f?"one":"other"},lkt:a,ln:o,lo:function(l,u){return u&&l==1?"one":"other"},lt:function(l,u){var d=String(l).split("."),f=d[1]||"",p=Number(d[0])==l,m=p&&d[0].slice(-1),h=p&&d[0].slice(-2);return u?"other":m==1&&(h<11||h>19)?"one":m>=2&&m<=9&&(h<11||h>19)?"few":f!=0?"many":"other"},lv:function(l,u){var d=String(l).split("."),f=d[1]||"",p=f.length,m=Number(d[0])==l,h=m&&d[0].slice(-1),b=m&&d[0].slice(-2),x=f.slice(-2),T=f.slice(-1);return u?"other":m&&h==0||b>=11&&b<=19||p==2&&x>=11&&x<=19?"zero":h==1&&b!=11||p==2&&T==1&&x!=11||p!=2&&T==1?"one":"other"},mas:n,mg:o,mgo:n,mk:function(l,u){var d=String(l).split("."),f=d[0],p=d[1]||"",m=!d[1],h=f.slice(-1),b=f.slice(-2),x=p.slice(-1),T=p.slice(-2);return u?h==1&&b!=11?"one":h==2&&b!=12?"two":(h==7||h==8)&&b!=17&&b!=18?"many":"other":m&&h==1&&b!=11||x==1&&T!=11?"one":"other"},ml:n,mn:n,mo:function(l,u){var d=String(l).split("."),f=!d[1],p=Number(d[0])==l,m=p&&d[0].slice(-2);return u?l==1?"one":"other":l==1&&f?"one":!f||l==0||l!=1&&m>=1&&m<=19?"few":"other"},mr:function(l,u){return u?l==1?"one":l==2||l==3?"two":l==4?"few":"other":l==1?"one":"other"},ms:function(l,u){return u&&l==1?"one":"other"},mt:function(l,u){var d=String(l).split("."),f=Number(d[0])==l,p=f&&d[0].slice(-2);return u?"other":l==1?"one":l==2?"two":l==0||p>=3&&p<=10?"few":p>=11&&p<=19?"many":"other"},my:a,nah:n,naq:s,nb:n,nd:n,ne:function(l,u){var d=String(l).split("."),f=Number(d[0])==l;return u?f&&l>=1&&l<=4?"one":"other":l==1?"one":"other"},nl:i,nn:n,nnh:n,no:n,nqo:a,nr:n,nso:o,ny:n,nyn:n,om:n,or:function(l,u){var d=String(l).split("."),f=Number(d[0])==l;return u?l==1||l==5||f&&l>=7&&l<=9?"one":l==2||l==3?"two":l==4?"few":l==6?"many":"other":l==1?"one":"other"},os:n,osa:a,pa:o,pap:n,pcm:r,pl:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=f.slice(-1),h=f.slice(-2);return u?"other":l==1&&p?"one":p&&m>=2&&m<=4&&(h<12||h>14)?"few":p&&f!=1&&(m==0||m==1)||p&&m>=5&&m<=9||p&&h>=12&&h<=14?"many":"other"},prg:function(l,u){var d=String(l).split("."),f=d[1]||"",p=f.length,m=Number(d[0])==l,h=m&&d[0].slice(-1),b=m&&d[0].slice(-2),x=f.slice(-2),T=f.slice(-1);return u?"other":m&&h==0||b>=11&&b<=19||p==2&&x>=11&&x<=19?"zero":h==1&&b!=11||p==2&&T==1&&x!=11||p!=2&&T==1?"one":"other"},ps:n,pt:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=f.slice(-6);return u?"other":f==0||f==1?"one":f!=0&&m==0&&p?"many":"other"},pt_PT:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=f.slice(-6);return u?"other":l==1&&p?"one":f!=0&&m==0&&p?"many":"other"},rm:n,ro:function(l,u){var d=String(l).split("."),f=!d[1],p=Number(d[0])==l,m=p&&d[0].slice(-2);return u?l==1?"one":"other":l==1&&f?"one":!f||l==0||l!=1&&m>=1&&m<=19?"few":"other"},rof:n,ru:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=f.slice(-1),h=f.slice(-2);return u?"other":p&&m==1&&h!=11?"one":p&&m>=2&&m<=4&&(h<12||h>14)?"few":p&&m==0||p&&m>=5&&m<=9||p&&h>=11&&h<=14?"many":"other"},rwk:n,sah:a,saq:n,sat:s,sc:function(l,u){var d=String(l).split("."),f=!d[1];return u?l==11||l==8||l==80||l==800?"many":"other":l==1&&f?"one":"other"},scn:function(l,u){var d=String(l).split("."),f=!d[1];return u?l==11||l==8||l==80||l==800?"many":"other":l==1&&f?"one":"other"},sd:n,sdh:n,se:s,seh:n,ses:a,sg:a,sh:function(l,u){var d=String(l).split("."),f=d[0],p=d[1]||"",m=!d[1],h=f.slice(-1),b=f.slice(-2),x=p.slice(-1),T=p.slice(-2);return u?"other":m&&h==1&&b!=11||x==1&&T!=11?"one":m&&h>=2&&h<=4&&(b<12||b>14)||x>=2&&x<=4&&(T<12||T>14)?"few":"other"},shi:function(l,u){var d=String(l).split("."),f=Number(d[0])==l;return u?"other":l>=0&&l<=1?"one":f&&l>=2&&l<=10?"few":"other"},si:function(l,u){var d=String(l).split("."),f=d[0],p=d[1]||"";return u?"other":l==0||l==1||f==0&&p==1?"one":"other"},sk:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1];return u?"other":l==1&&p?"one":f>=2&&f<=4&&p?"few":p?"other":"many"},sl:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=f.slice(-2);return u?"other":p&&m==1?"one":p&&m==2?"two":p&&(m==3||m==4)||!p?"few":"other"},sma:s,smi:s,smj:s,smn:s,sms:s,sn:n,so:n,sq:function(l,u){var d=String(l).split("."),f=Number(d[0])==l,p=f&&d[0].slice(-1),m=f&&d[0].slice(-2);return u?l==1?"one":p==4&&m!=14?"many":"other":l==1?"one":"other"},sr:function(l,u){var d=String(l).split("."),f=d[0],p=d[1]||"",m=!d[1],h=f.slice(-1),b=f.slice(-2),x=p.slice(-1),T=p.slice(-2);return u?"other":m&&h==1&&b!=11||x==1&&T!=11?"one":m&&h>=2&&h<=4&&(b<12||b>14)||x>=2&&x<=4&&(T<12||T>14)?"few":"other"},ss:n,ssy:n,st:n,su:a,sv:function(l,u){var d=String(l).split("."),f=!d[1],p=Number(d[0])==l,m=p&&d[0].slice(-1),h=p&&d[0].slice(-2);return u?(m==1||m==2)&&h!=11&&h!=12?"one":"other":l==1&&f?"one":"other"},sw:i,syr:n,ta:n,te:n,teo:n,th:a,ti:o,tig:n,tk:function(l,u){var d=String(l).split("."),f=Number(d[0])==l,p=f&&d[0].slice(-1);return u?p==6||p==9||l==10?"few":"other":l==1?"one":"other"},tl:function(l,u){var d=String(l).split("."),f=d[0],p=d[1]||"",m=!d[1],h=f.slice(-1),b=p.slice(-1);return u?l==1?"one":"other":m&&(f==1||f==2||f==3)||m&&h!=4&&h!=6&&h!=9||!m&&b!=4&&b!=6&&b!=9?"one":"other"},tn:n,to:a,tpi:a,tr:n,ts:n,tzm:function(l,u){var d=String(l).split("."),f=Number(d[0])==l;return u?"other":l==0||l==1||f&&l>=11&&l<=99?"one":"other"},ug:n,uk:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=Number(d[0])==l,h=m&&d[0].slice(-1),b=m&&d[0].slice(-2),x=f.slice(-1),T=f.slice(-2);return u?h==3&&b!=13?"few":"other":p&&x==1&&T!=11?"one":p&&x>=2&&x<=4&&(T<12||T>14)?"few":p&&x==0||p&&x>=5&&x<=9||p&&T>=11&&T<=14?"many":"other"},und:a,ur:i,uz:n,ve:n,vec:function(l,u){var d=String(l).split("."),f=d[0],p=!d[1],m=f.slice(-6);return u?l==11||l==8||l==80||l==800?"many":"other":l==1&&p?"one":f!=0&&m==0&&p?"many":"other"},vi:function(l,u){return u&&l==1?"one":"other"},vo:n,vun:n,wa:o,wae:n,wo:a,xh:n,xog:n,yi:i,yo:a,yue:a,zh:a,zu:r})})(As);var xf=Os(As.exports),p0=Ss({__proto__:null,default:xf},[As.exports]),Ns={exports:{}};(function(t,e){var n="zero",o="one",r="two",i="few",a="many",s="other",c={cardinal:[o,s],ordinal:[s]},l={cardinal:[o,s],ordinal:[o,s]},u={cardinal:[s],ordinal:[s]},d={cardinal:[o,r,s],ordinal:[s]};(function(f,p){Object.defineProperty(p,"__esModule",{value:!0}),t.exports=p})(Es,{af:c,ak:c,am:c,an:c,ar:{cardinal:[n,o,r,i,a,s],ordinal:[s]},ars:{cardinal:[n,o,r,i,a,s],ordinal:[s]},as:{cardinal:[o,s],ordinal:[o,r,i,a,s]},asa:c,ast:c,az:{cardinal:[o,s],ordinal:[o,i,a,s]},bal:l,be:{cardinal:[o,i,a,s],ordinal:[i,s]},bem:c,bez:c,bg:c,bho:c,bm:u,bn:{cardinal:[o,s],ordinal:[o,r,i,a,s]},bo:u,br:{cardinal:[o,r,i,a,s],ordinal:[s]},brx:c,bs:{cardinal:[o,i,s],ordinal:[s]},ca:{cardinal:[o,a,s],ordinal:[o,r,i,s]},ce:c,ceb:c,cgg:c,chr:c,ckb:c,cs:{cardinal:[o,i,a,s],ordinal:[s]},cy:{cardinal:[n,o,r,i,a,s],ordinal:[n,o,r,i,a,s]},da:c,de:c,doi:c,dsb:{cardinal:[o,r,i,s],ordinal:[s]},dv:c,dz:u,ee:c,el:c,en:{cardinal:[o,s],ordinal:[o,r,i,s]},eo:c,es:{cardinal:[o,a,s],ordinal:[s]},et:c,eu:c,fa:c,ff:c,fi:c,fil:l,fo:c,fr:{cardinal:[o,a,s],ordinal:[o,s]},fur:c,fy:c,ga:{cardinal:[o,r,i,a,s],ordinal:[o,s]},gd:{cardinal:[o,r,i,s],ordinal:[o,r,i,s]},gl:c,gsw:c,gu:{cardinal:[o,s],ordinal:[o,r,i,a,s]},guw:c,gv:{cardinal:[o,r,i,a,s],ordinal:[s]},ha:c,haw:c,he:d,hi:{cardinal:[o,s],ordinal:[o,r,i,a,s]},hnj:u,hr:{cardinal:[o,i,s],ordinal:[s]},hsb:{cardinal:[o,r,i,s],ordinal:[s]},hu:l,hy:l,ia:c,id:u,ig:u,ii:u,io:c,is:c,it:{cardinal:[o,a,s],ordinal:[a,s]},iu:d,ja:u,jbo:u,jgo:c,jmc:c,jv:u,jw:u,ka:{cardinal:[o,s],ordinal:[o,a,s]},kab:c,kaj:c,kcg:c,kde:u,kea:u,kk:{cardinal:[o,s],ordinal:[a,s]},kkj:c,kl:c,km:u,kn:c,ko:u,ks:c,ksb:c,ksh:{cardinal:[n,o,s],ordinal:[s]},ku:c,kw:{cardinal:[n,o,r,i,a,s],ordinal:[o,a,s]},ky:c,lag:{cardinal:[n,o,s],ordinal:[s]},lb:c,lg:c,lij:{cardinal:[o,s],ordinal:[a,s]},lkt:u,ln:c,lo:{cardinal:[s],ordinal:[o,s]},lt:{cardinal:[o,i,a,s],ordinal:[s]},lv:{cardinal:[n,o,s],ordinal:[s]},mas:c,mg:c,mgo:c,mk:{cardinal:[o,s],ordinal:[o,r,a,s]},ml:c,mn:c,mo:{cardinal:[o,i,s],ordinal:[o,s]},mr:{cardinal:[o,s],ordinal:[o,r,i,s]},ms:{cardinal:[s],ordinal:[o,s]},mt:{cardinal:[o,r,i,a,s],ordinal:[s]},my:u,nah:c,naq:d,nb:c,nd:c,ne:l,nl:c,nn:c,nnh:c,no:c,nqo:u,nr:c,nso:c,ny:c,nyn:c,om:c,or:{cardinal:[o,s],ordinal:[o,r,i,a,s]},os:c,osa:u,pa:c,pap:c,pcm:c,pl:{cardinal:[o,i,a,s],ordinal:[s]},prg:{cardinal:[n,o,s],ordinal:[s]},ps:c,pt:{cardinal:[o,a,s],ordinal:[s]},pt_PT:{cardinal:[o,a,s],ordinal:[s]},rm:c,ro:{cardinal:[o,i,s],ordinal:[o,s]},rof:c,ru:{cardinal:[o,i,a,s],ordinal:[s]},rwk:c,sah:u,saq:c,sat:d,sc:{cardinal:[o,s],ordinal:[a,s]},scn:{cardinal:[o,s],ordinal:[a,s]},sd:c,sdh:c,se:d,seh:c,ses:u,sg:u,sh:{cardinal:[o,i,s],ordinal:[s]},shi:{cardinal:[o,i,s],ordinal:[s]},si:c,sk:{cardinal:[o,i,a,s],ordinal:[s]},sl:{cardinal:[o,r,i,s],ordinal:[s]},sma:d,smi:d,smj:d,smn:d,sms:d,sn:c,so:c,sq:{cardinal:[o,s],ordinal:[o,a,s]},sr:{cardinal:[o,i,s],ordinal:[s]},ss:c,ssy:c,st:c,su:u,sv:l,sw:c,syr:c,ta:c,te:c,teo:c,th:u,ti:c,tig:c,tk:{cardinal:[o,s],ordinal:[i,s]},tl:l,tn:c,to:u,tpi:u,tr:c,ts:c,tzm:c,ug:c,uk:{cardinal:[o,i,a,s],ordinal:[i,s]},und:u,ur:c,uz:c,ve:c,vec:{cardinal:[o,a,s],ordinal:[a,s]},vi:{cardinal:[s],ordinal:[o,s]},vo:c,vun:c,wa:c,wae:c,wo:u,xh:c,xog:c,yi:c,yo:u,yue:u,zh:u,zu:c})})(Ns);var vf=Os(Ns.exports),m0=Ss({__proto__:null,default:vf},[Ns.exports]),Rs={exports:{}};(function(t,e){var n=function(a,s){return"other"},o=function(a,s){return a==="other"&&s==="one"?"one":"other"},r=function(a,s){return s||"other"};(function(i,a){Object.defineProperty(a,"__esModule",{value:!0}),t.exports=a})(Es,{af:n,ak:o,am:r,an:n,ar:function(a,s){return s==="few"?"few":s==="many"?"many":a==="zero"&&s==="one"||a==="zero"&&s==="two"?"zero":"other"},as:r,az:r,be:r,bg:n,bn:r,bs:r,ca:n,cs:r,cy:r,da:r,de:r,el:r,en:n,es:n,et:n,eu:n,fa:o,fi:n,fil:r,fr:r,ga:r,gl:r,gsw:r,gu:r,he:n,hi:r,hr:r,hu:r,hy:r,ia:n,id:n,io:n,is:r,it:r,ja:n,ka:function(a,s){return a||"other"},kk:r,km:n,kn:r,ko:n,ky:r,lij:r,lo:n,lt:r,lv:function(a,s){return s==="one"?"one":"other"},mk:n,ml:r,mn:r,mr:r,ms:n,my:n,nb:n,ne:r,nl:r,no:n,or:o,pa:r,pcm:n,pl:r,ps:r,pt:r,ro:function(a,s){return s==="few"||s==="one"?"few":"other"},ru:r,sc:r,scn:r,sd:o,si:function(a,s){return a==="one"&&s==="one"?"one":"other"},sk:r,sl:function(a,s){return s==="few"||s==="one"?"few":s==="two"?"two":"other"},sq:r,sr:r,sv:n,sw:r,ta:r,te:r,th:n,tk:r,tr:r,ug:r,uk:r,ur:n,uz:r,vi:n,yue:n,zh:n,zu:r})})(Rs);var yf=Os(Rs.exports),h0=Ss({__proto__:null,default:yf},[Rs.exports]),g0=xf||p0,b0=vf||m0,x0=yf||h0,Is=function(e){return e==="pt-PT"?"pt_PT":e},v0=function(e){return g0[Is(e)]},y0=function(e,n){return b0[Is(e)][n?"ordinal":"cardinal"]},w0=function(e){return x0[Is(e)]},_0=f0.default(Intl.NumberFormat,v0,y0,w0);wf.exports=_0});var Cf=ct(Tf=>{"use strict";var k0=_f();function T0(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var Jn=T0(k0);typeof Intl>"u"?(typeof global<"u"?global.Intl={PluralRules:Jn.default}:typeof window<"u"?window.Intl={PluralRules:Jn.default}:Tf.Intl={PluralRules:Jn.default},Jn.default.polyfill=!0):!Intl.PluralRules||!Intl.PluralRules.prototype.selectRange?(Intl.PluralRules=Jn.default,Jn.default.polyfill=!0):(Ds=["en","es","ru","zh"],kf=Intl.PluralRules.supportedLocalesOf(Ds),kf.length<Ds.length&&(Intl.PluralRules=Jn.default,Jn.default.polyfill=!0));var Ds,kf});var Of=ct(Zn=>{"use strict";var Sf=Zn&&Zn.__awaiter||function(t,e,n,o){function r(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(u){try{l(o.next(u))}catch(d){a(d)}}function c(u){try{l(o.throw(u))}catch(d){a(d)}}function l(u){u.done?i(u.value):r(u.value).then(s,c)}l((o=o.apply(t,e||[])).next())})},Ef=Zn&&Zn.__generator||function(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},o,r,i,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(l){return function(u){return c([l,u])}}function c(l){if(o)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(n=0)),n;)try{if(o=1,r&&(i=l[0]&2?r.return:l[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,l[1])).done)return i;switch(r=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,r=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){n.label=l[1];break}if(l[0]===6&&n.label<i[1]){n.label=i[1],i=l;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(l);break}i[2]&&n.ops.pop(),n.trys.pop();continue}l=e.call(t,n)}catch(u){l=[6,u],r=0}finally{o=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(Zn,"__esModule",{value:!0});Zn.postProto=void 0;function C0(t,e,n,o){var r=o.alertOnError,i=r===void 0?!0:r;return Sf(this,void 0,void 0,function(){var a,s,c,l;return Ef(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),a=e.toBinary(),s="/_anki/".concat(t),[4,S0(s,a)];case 1:return c=u.sent(),[2,n.fromBinary(c)];case 2:throw l=u.sent(),i&&!(l instanceof Error&&l.message==="500: Interrupted")&&alert(l),l;case 3:return[2]}})})}Zn.postProto=C0;function S0(t,e){return Sf(this,void 0,void 0,function(){var n,o,r,i,a;return Ef(this,function(s){switch(s.label){case 0:return[4,fetch(t,{method:"POST",headers:{"Content-Type":"application/binary"},body:e})];case 1:if(n=s.sent(),n.ok)return[3,6];o="something went wrong",s.label=2;case 2:return s.trys.push([2,4,,5]),[4,n.text()];case 3:return o=s.sent(),[3,5];case 4:return r=s.sent(),[3,5];case 5:throw new Error("".concat(n.status,": ").concat(o));case 6:return[4,n.blob()];case 7:return i=s.sent(),[4,new Response(i).arrayBuffer()];case 8:return a=s.sent(),[2,new Uint8Array(a)]}})})}});var jp=ct(()=>{});var zp=ct(()=>{});var Hp=ct(()=>{});var Ct=ct(ae=>{var g=g||{version:"5.3.0"};typeof ae<"u"?ae.fabric=g:typeof define=="function"&&define.amd&&define([],function(){return g});typeof document<"u"&&typeof window<"u"?(document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?g.document=document:g.document=document.implementation.createHTMLDocument(""),g.window=window):(Vp=jp(),tl=new Vp.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window,g.document=tl.document,g.jsdomImplForWrapper=zp().implForWrapper,g.nodeCanvas=Hp().Canvas,g.window=tl,DOMParser=g.window.DOMParser);var Vp,tl;g.isTouchSupported="ontouchstart"in g.window||"ontouchstart"in g.document||g.window&&g.window.navigator&&g.window.navigator.maxTouchPoints>0;g.isLikelyNode=typeof Buffer<"u"&&typeof window>"u";g.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];g.DPI=96;g.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)";g.commaWsp="(?:\\s+,?\\s*|,\\s*)";g.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig;g.reNonWord=/[ \n\.,;!\?\-]/;g.fontPaths={};g.iMatrix=[1,0,0,1,0,0];g.svgNS="http://www.w3.org/2000/svg";g.perfLimitSizeTotal=2097152;g.maxCacheSideLimit=4096;g.minCacheSideLimit=256;g.charWidthsCache={};g.textureSize=2048;g.disableStyleCopyPaste=!1;g.enableGLFiltering=!0;g.devicePixelRatio=g.window.devicePixelRatio||g.window.webkitDevicePixelRatio||g.window.mozDevicePixelRatio||1;g.browserShadowBlurConstant=1;g.arcToSegmentsCache={};g.boundsOfCurveCache={};g.cachesBoundsOfCurve=!0;g.forceGLPutImageData=!1;g.initFilterBackend=function(){if(g.enableGLFiltering&&g.isWebglSupported&&g.isWebglSupported(g.textureSize))return console.log("max texture size: "+g.maxTextureSize),new g.WebglFilterBackend({tileSize:g.textureSize});if(g.Canvas2dFilterBackend)return new g.Canvas2dFilterBackend};typeof document<"u"&&typeof window<"u"&&(window.fabric=g);(function(){function t(a,s){if(this.__eventListeners[a]){var c=this.__eventListeners[a];s?c[c.indexOf(s)]=!1:g.util.array.fill(c,!1)}}function e(a,s){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var c in a)this.on(c,a[c]);else this.__eventListeners[a]||(this.__eventListeners[a]=[]),this.__eventListeners[a].push(s);return this}function n(a,s){var c=function(){s.apply(this,arguments),this.off(a,c)}.bind(this);this.on(a,c)}function o(a,s){if(arguments.length===1)for(var c in a)n.call(this,c,a[c]);else n.call(this,a,s);return this}function r(a,s){if(!this.__eventListeners)return this;if(arguments.length===0)for(a in this.__eventListeners)t.call(this,a);else if(arguments.length===1&&typeof arguments[0]=="object")for(var c in a)t.call(this,c,a[c]);else t.call(this,a,s);return this}function i(a,s){if(!this.__eventListeners)return this;var c=this.__eventListeners[a];if(!c)return this;for(var l=0,u=c.length;l<u;l++)c[l]&&c[l].call(this,s||{});return this.__eventListeners[a]=c.filter(function(d){return d!==!1}),this}g.Observable={fire:i,on:e,once:o,off:r}})();g.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var t=0,e=arguments.length;t<e;t++)this._onObjectAdded(arguments[t]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(t,e,n){var o=this._objects;return n?o[e]=t:o.splice(e,0,t),this._onObjectAdded&&this._onObjectAdded(t),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var t=this._objects,e,n=!1,o=0,r=arguments.length;o<r;o++)e=t.indexOf(arguments[o]),e!==-1&&(n=!0,t.splice(e,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[o]));return this.renderOnAddRemove&&n&&this.requestRenderAll(),this},forEachObject:function(t,e){for(var n=this.getObjects(),o=0,r=n.length;o<r;o++)t.call(e,n[o],o,n);return this},getObjects:function(t){return typeof t>"u"?this._objects.concat():this._objects.filter(function(e){return e.type===t})},item:function(t){return this._objects[t]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(t,e){return this._objects.indexOf(t)>-1?!0:e?this._objects.some(function(n){return typeof n.contains=="function"&&n.contains(t,!0)}):!1},complexity:function(){return this._objects.reduce(function(t,e){return t+=e.complexity?e.complexity():0,t},0)}};g.CommonMethods={_setOptions:function(t){for(var e in t)this.set(e,t[e])},_initGradient:function(t,e){t&&t.colorStops&&!(t instanceof g.Gradient)&&this.set(e,new g.Gradient(t))},_initPattern:function(t,e,n){t&&t.source&&!(t instanceof g.Pattern)?this.set(e,new g.Pattern(t,n)):n&&n()},_setObject:function(t){for(var e in t)this._set(e,t[e])},set:function(t,e){return typeof t=="object"?this._setObject(t):this._set(t,e),this},_set:function(t,e){this[t]=e},toggle:function(t){var e=this.get(t);return typeof e=="boolean"&&this.set(t,!e),this},get:function(t){return this[t]}};(function(t){var e=Math.sqrt,n=Math.atan2,o=Math.pow,r=Math.PI/180,i=Math.PI/2;g.util={cos:function(a){if(a===0)return 1;a<0&&(a=-a);var s=a/i;switch(s){case 1:case 3:return 0;case 2:return-1}return Math.cos(a)},sin:function(a){if(a===0)return 0;var s=a/i,c=1;switch(a<0&&(c=-1),s){case 1:return c;case 2:return 0;case 3:return-c}return Math.sin(a)},removeFromArray:function(a,s){var c=a.indexOf(s);return c!==-1&&a.splice(c,1),a},getRandomInt:function(a,s){return Math.floor(Math.random()*(s-a+1))+a},degreesToRadians:function(a){return a*r},radiansToDegrees:function(a){return a/r},rotatePoint:function(a,s,c){var l=new g.Point(a.x-s.x,a.y-s.y),u=g.util.rotateVector(l,c);return new g.Point(u.x,u.y).addEquals(s)},rotateVector:function(a,s){var c=g.util.sin(s),l=g.util.cos(s),u=a.x*l-a.y*c,d=a.x*c+a.y*l;return{x:u,y:d}},createVector:function(a,s){return new g.Point(s.x-a.x,s.y-a.y)},calcAngleBetweenVectors:function(a,s){return Math.acos((a.x*s.x+a.y*s.y)/(Math.hypot(a.x,a.y)*Math.hypot(s.x,s.y)))},getHatVector:function(a){return new g.Point(a.x,a.y).multiply(1/Math.hypot(a.x,a.y))},getBisector:function(a,s,c){var l=g.util.createVector(a,s),u=g.util.createVector(a,c),d=g.util.calcAngleBetweenVectors(l,u),f=g.util.calcAngleBetweenVectors(g.util.rotateVector(l,d),u),p=d*(f===0?1:-1)/2;return{vector:g.util.getHatVector(g.util.rotateVector(l,p)),angle:d}},projectStrokeOnPoints:function(a,s,c){var l=[],u=s.strokeWidth/2,d=s.strokeUniform?new g.Point(1/s.scaleX,1/s.scaleY):new g.Point(1,1),f=function(p){var m=u/Math.hypot(p.x,p.y);return new g.Point(p.x*m*d.x,p.y*m*d.y)};return a.length<=1||a.forEach(function(p,m){var h=new g.Point(p.x,p.y),b,x;m===0?(x=a[m+1],b=c?f(g.util.createVector(x,h)).addEquals(h):a[a.length-1]):m===a.length-1?(b=a[m-1],x=c?f(g.util.createVector(b,h)).addEquals(h):a[0]):(b=a[m-1],x=a[m+1]);var T=g.util.getBisector(h,b,x),B=T.vector,A=T.angle,S,H;if(s.strokeLineJoin==="miter"&&(S=-u/Math.sin(A/2),H=new g.Point(B.x*S*d.x,B.y*S*d.y),Math.hypot(H.x,H.y)/u<=s.strokeMiterLimit)){l.push(h.add(H)),l.push(h.subtract(H));return}S=-u*Math.SQRT2,H=new g.Point(B.x*S*d.x,B.y*S*d.y),l.push(h.add(H)),l.push(h.subtract(H))}),l},transformPoint:function(a,s,c){return c?new g.Point(s[0]*a.x+s[2]*a.y,s[1]*a.x+s[3]*a.y):new g.Point(s[0]*a.x+s[2]*a.y+s[4],s[1]*a.x+s[3]*a.y+s[5])},makeBoundingBoxFromPoints:function(a,s){if(s)for(var c=0;c<a.length;c++)a[c]=g.util.transformPoint(a[c],s);var l=[a[0].x,a[1].x,a[2].x,a[3].x],u=g.util.array.min(l),d=g.util.array.max(l),f=d-u,p=[a[0].y,a[1].y,a[2].y,a[3].y],m=g.util.array.min(p),h=g.util.array.max(p),b=h-m;return{left:u,top:m,width:f,height:b}},invertTransform:function(a){var s=1/(a[0]*a[3]-a[1]*a[2]),c=[s*a[3],-s*a[1],-s*a[2],s*a[0]],l=g.util.transformPoint({x:a[4],y:a[5]},c,!0);return c[4]=-l.x,c[5]=-l.y,c},toFixed:function(a,s){return parseFloat(Number(a).toFixed(s))},parseUnit:function(a,s){var c=/\D{0,2}$/.exec(a),l=parseFloat(a);switch(s||(s=g.Text.DEFAULT_SVG_FONT_SIZE),c[0]){case"mm":return l*g.DPI/25.4;case"cm":return l*g.DPI/2.54;case"in":return l*g.DPI;case"pt":return l*g.DPI/72;case"pc":return l*g.DPI/72*12;case"em":return l*s;default:return l}},falseFunction:function(){return!1},getKlass:function(a,s){return a=g.util.string.camelize(a.charAt(0).toUpperCase()+a.slice(1)),g.util.resolveNamespace(s)[a]},getSvgAttributes:function(a){var s=["instantiated_by_use","style","id","class"];switch(a){case"linearGradient":s=s.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":s=s.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":s=s.concat(["offset","stop-color","stop-opacity"]);break}return s},resolveNamespace:function(a){if(!a)return g;var s=a.split("."),c=s.length,l,u=t||g.window;for(l=0;l<c;++l)u=u[s[l]];return u},loadImage:function(a,s,c,l){if(!a){s&&s.call(c,a);return}var u=g.util.createImage(),d=function(){s&&s.call(c,u,!1),u=u.onload=u.onerror=null};u.onload=d,u.onerror=function(){g.log("Error loading "+u.src),s&&s.call(c,null,!0),u=u.onload=u.onerror=null},a.indexOf("data")!==0&&l!==void 0&&l!==null&&(u.crossOrigin=l),a.substring(0,14)==="data:image/svg"&&(u.onload=null,g.util.loadImageInDom(u,d)),u.src=a},loadImageInDom:function(a,s){var c=g.document.createElement("div");c.style.width=c.style.height="1px",c.style.left=c.style.top="-100%",c.style.position="absolute",c.appendChild(a),g.document.querySelector("body").appendChild(c),a.onload=function(){s(),c.parentNode.removeChild(c),c=null}},enlivenObjects:function(a,s,c,l){a=a||[];var u=[],d=0,f=a.length;function p(){++d===f&&s&&s(u.filter(function(m){return m}))}if(!f){s&&s(u);return}a.forEach(function(m,h){if(!m||!m.type){p();return}var b=g.util.getKlass(m.type,c);b.fromObject(m,function(x,T){T||(u[h]=x),l&&l(m,x,T),p()})})},enlivenObjectEnlivables:function(a,s,c){var l=g.Object.ENLIVEN_PROPS.filter(function(u){return!!a[u]});g.util.enlivenObjects(l.map(function(u){return a[u]}),function(u){var d={};l.forEach(function(f,p){d[f]=u[p],s&&(s[f]=u[p])}),c&&c(d)})},enlivenPatterns:function(a,s){a=a||[];function c(){++u===d&&s&&s(l)}var l=[],u=0,d=a.length;if(!d){s&&s(l);return}a.forEach(function(f,p){f&&f.source?new g.Pattern(f,function(m){l[p]=m,c()}):(l[p]=f,c())})},groupSVGElements:function(a,s,c){var l;return a&&a.length===1?(typeof c<"u"&&(a[0].sourcePath=c),a[0]):(s&&(s.width&&s.height?s.centerPoint={x:s.width/2,y:s.height/2}:(delete s.width,delete s.height)),l=new g.Group(a,s),typeof c<"u"&&(l.sourcePath=c),l)},populateWithProperties:function(a,s,c){if(c&&Array.isArray(c))for(var l=0,u=c.length;l<u;l++)c[l]in a&&(s[c[l]]=a[c[l]])},createCanvasElement:function(){return g.document.createElement("canvas")},copyCanvasElement:function(a){var s=g.util.createCanvasElement();return s.width=a.width,s.height=a.height,s.getContext("2d").drawImage(a,0,0),s},toDataURL:function(a,s,c){return a.toDataURL("image/"+s,c)},createImage:function(){return g.document.createElement("img")},multiplyTransformMatrices:function(a,s,c){return[a[0]*s[0]+a[2]*s[1],a[1]*s[0]+a[3]*s[1],a[0]*s[2]+a[2]*s[3],a[1]*s[2]+a[3]*s[3],c?0:a[0]*s[4]+a[2]*s[5]+a[4],c?0:a[1]*s[4]+a[3]*s[5]+a[5]]},qrDecompose:function(a){var s=n(a[1],a[0]),c=o(a[0],2)+o(a[1],2),l=e(c),u=(a[0]*a[3]-a[2]*a[1])/l,d=n(a[0]*a[2]+a[1]*a[3],c);return{angle:s/r,scaleX:l,scaleY:u,skewX:d/r,skewY:0,translateX:a[4],translateY:a[5]}},calcRotateMatrix:function(a){if(!a.angle)return g.iMatrix.concat();var s=g.util.degreesToRadians(a.angle),c=g.util.cos(s),l=g.util.sin(s);return[c,l,-l,c,0,0]},calcDimensionsMatrix:function(a){var s=typeof a.scaleX>"u"?1:a.scaleX,c=typeof a.scaleY>"u"?1:a.scaleY,l=[a.flipX?-s:s,0,0,a.flipY?-c:c,0,0],u=g.util.multiplyTransformMatrices,d=g.util.degreesToRadians;return a.skewX&&(l=u(l,[1,0,Math.tan(d(a.skewX)),1],!0)),a.skewY&&(l=u(l,[1,Math.tan(d(a.skewY)),0,1],!0)),l},composeMatrix:function(a){var s=[1,0,0,1,a.translateX||0,a.translateY||0],c=g.util.multiplyTransformMatrices;return a.angle&&(s=c(s,g.util.calcRotateMatrix(a))),(a.scaleX!==1||a.scaleY!==1||a.skewX||a.skewY||a.flipX||a.flipY)&&(s=c(s,g.util.calcDimensionsMatrix(a))),s},resetObjectTransform:function(a){a.scaleX=1,a.scaleY=1,a.skewX=0,a.skewY=0,a.flipX=!1,a.flipY=!1,a.rotate(0)},saveObjectTransform:function(a){return{scaleX:a.scaleX,scaleY:a.scaleY,skewX:a.skewX,skewY:a.skewY,angle:a.angle,left:a.left,flipX:a.flipX,flipY:a.flipY,top:a.top}},isTransparent:function(a,s,c,l){l>0&&(s>l?s-=l:s=0,c>l?c-=l:c=0);var u=!0,d,f,p=a.getImageData(s,c,l*2||1,l*2||1),m=p.data.length;for(d=3;d<m&&(f=p.data[d],u=f<=0,u!==!1);d+=4);return p=null,u},parsePreserveAspectRatioAttribute:function(a){var s="meet",c="Mid",l="Mid",u=a.split(" "),d;return u&&u.length&&(s=u.pop(),s!=="meet"&&s!=="slice"?(d=s,s="meet"):u.length&&(d=u.pop())),c=d!=="none"?d.slice(1,4):"none",l=d!=="none"?d.slice(5,8):"none",{meetOrSlice:s,alignX:c,alignY:l}},clearFabricFontCache:function(a){a=(a||"").toLowerCase(),a?g.charWidthsCache[a]&&delete g.charWidthsCache[a]:g.charWidthsCache={}},limitDimsByArea:function(a,s){var c=Math.sqrt(s*a),l=Math.floor(s/c);return{x:Math.floor(c),y:l}},capValue:function(a,s,c){return Math.max(a,Math.min(s,c))},findScaleToFit:function(a,s){return Math.min(s.width/a.width,s.height/a.height)},findScaleToCover:function(a,s){return Math.max(s.width/a.width,s.height/a.height)},matrixToSVG:function(a){return"matrix("+a.map(function(s){return g.util.toFixed(s,g.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(a,s){var c=g.util.invertTransform(s),l=g.util.multiplyTransformMatrices(c,a.calcOwnMatrix());g.util.applyTransformToObject(a,l)},addTransformToObject:function(a,s){g.util.applyTransformToObject(a,g.util.multiplyTransformMatrices(s,a.calcOwnMatrix()))},applyTransformToObject:function(a,s){var c=g.util.qrDecompose(s),l=new g.Point(c.translateX,c.translateY);a.flipX=!1,a.flipY=!1,a.set("scaleX",c.scaleX),a.set("scaleY",c.scaleY),a.skewX=c.skewX,a.skewY=c.skewY,a.angle=c.angle,a.setPositionByOrigin(l,"center","center")},sizeAfterTransform:function(a,s,c){var l=a/2,u=s/2,d=[{x:-l,y:-u},{x:l,y:-u},{x:-l,y:u},{x:l,y:u}],f=g.util.calcDimensionsMatrix(c),p=g.util.makeBoundingBoxFromPoints(d,f);return{x:p.width,y:p.height}},mergeClipPaths:function(a,s){var c=a,l=s;c.inverted&&!l.inverted&&(c=s,l=a),g.util.applyTransformToObject(l,g.util.multiplyTransformMatrices(g.util.invertTransform(c.calcTransformMatrix()),l.calcTransformMatrix()));var u=c.inverted&&l.inverted;return u&&(c.inverted=l.inverted=!1),new g.Group([c],{clipPath:l,inverted:u})},hasStyleChanged:function(a,s,c){return c=c||!1,a.fill!==s.fill||a.stroke!==s.stroke||a.strokeWidth!==s.strokeWidth||a.fontSize!==s.fontSize||a.fontFamily!==s.fontFamily||a.fontWeight!==s.fontWeight||a.fontStyle!==s.fontStyle||a.textBackgroundColor!==s.textBackgroundColor||a.deltaY!==s.deltaY||c&&(a.overline!==s.overline||a.underline!==s.underline||a.linethrough!==s.linethrough)},stylesToArray:function(c,s){for(var c=g.util.object.clone(c,!0),l=s.split(`
`),u=-1,d={},f=[],p=0;p<l.length;p++){if(!c[p]){u+=l[p].length;continue}for(var m=0;m<l[p].length;m++){u++;var h=c[p][m];if(h&&Object.keys(h).length>0){var b=g.util.hasStyleChanged(d,h,!0);b?f.push({start:u,end:u+1,style:h}):f[f.length-1].end++}d=h||{}}}return f},stylesFromArray:function(a,s){if(!Array.isArray(a))return a;for(var c=s.split(`
`),l=-1,u=0,d={},f=0;f<c.length;f++)for(var p=0;p<c[f].length;p++)l++,a[u]&&a[u].start<=l&&l<a[u].end&&(d[f]=d[f]||{},d[f][p]=Object.assign({},a[u].style),l===a[u].end-1&&u++);return d}}})(ae);(function(){var t=Array.prototype.join,e={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},n={m:"l",M:"L"};function o(v,k,R,N,W,C,w,D,_,F,G){var $=g.util.cos(v),X=g.util.sin(v),U=g.util.cos(k),P=g.util.sin(k),V=R*W*U-N*C*P+w,K=N*W*U+R*C*P+D,te=F+_*(-R*W*X-N*C*$),L=G+_*(-N*W*X+R*C*$),re=V+_*(R*W*P+N*C*U),ce=K+_*(N*W*P-R*C*U);return["C",te,L,re,ce,V,K]}function r(v,k,R,N,W,C,w){var D=Math.PI,_=w*D/180,F=g.util.sin(_),G=g.util.cos(_),$=0,X=0;R=Math.abs(R),N=Math.abs(N);var U=-G*v*.5-F*k*.5,P=-G*k*.5+F*v*.5,V=R*R,K=N*N,te=P*P,L=U*U,re=V*K-V*te-K*L,ce=0;if(re<0){var Te=Math.sqrt(1-re/(V*K));R*=Te,N*=Te}else ce=(W===C?-1:1)*Math.sqrt(re/(V*te+K*L));var ve=ce*R*P/N,ie=-ce*N*U/R,ge=G*ve-F*ie+v*.5,Ee=F*ve+G*ie+k*.5,Ne=i(1,0,(U-ve)/R,(P-ie)/N),Pe=i((U-ve)/R,(P-ie)/N,(-U-ve)/R,(-P-ie)/N);C===0&&Pe>0?Pe-=2*D:C===1&&Pe<0&&(Pe+=2*D);for(var Se=Math.ceil(Math.abs(Pe/D*2)),et=[],Ye=Pe/Se,St=8/3*Math.sin(Ye/4)*Math.sin(Ye/4)/Math.sin(Ye/2),Ft=Ne+Ye,ht=0;ht<Se;ht++)et[ht]=o(Ne,Ft,G,F,R,N,ge,Ee,St,$,X),$=et[ht][5],X=et[ht][6],Ne=Ft,Ft+=Ye;return et}function i(v,k,R,N){var W=Math.atan2(k,v),C=Math.atan2(N,R);return C>=W?C-W:2*Math.PI-(W-C)}function a(v,k,R,N,W,C,w,D){var _;if(g.cachesBoundsOfCurve&&(_=t.call(arguments),g.boundsOfCurveCache[_]))return g.boundsOfCurveCache[_];var F=Math.sqrt,G=Math.min,$=Math.max,X=Math.abs,U=[],P=[[],[]],V,K,te,L,re,ce,Te,ve;K=6*v-12*R+6*W,V=-3*v+9*R-9*W+3*w,te=3*R-3*v;for(var ie=0;ie<2;++ie){if(ie>0&&(K=6*k-12*N+6*C,V=-3*k+9*N-9*C+3*D,te=3*N-3*k),X(V)<1e-12){if(X(K)<1e-12)continue;L=-te/K,0<L&&L<1&&U.push(L);continue}Te=K*K-4*te*V,!(Te<0)&&(ve=F(Te),re=(-K+ve)/(2*V),0<re&&re<1&&U.push(re),ce=(-K-ve)/(2*V),0<ce&&ce<1&&U.push(ce))}for(var ge,Ee,Ne=U.length,Pe=Ne,Se;Ne--;)L=U[Ne],Se=1-L,ge=Se*Se*Se*v+3*Se*Se*L*R+3*Se*L*L*W+L*L*L*w,P[0][Ne]=ge,Ee=Se*Se*Se*k+3*Se*Se*L*N+3*Se*L*L*C+L*L*L*D,P[1][Ne]=Ee;P[0][Pe]=v,P[1][Pe]=k,P[0][Pe+1]=w,P[1][Pe+1]=D;var et=[{x:G.apply(null,P[0]),y:G.apply(null,P[1])},{x:$.apply(null,P[0]),y:$.apply(null,P[1])}];return g.cachesBoundsOfCurve&&(g.boundsOfCurveCache[_]=et),et}function s(v,k,R){for(var N=R[1],W=R[2],C=R[3],w=R[4],D=R[5],_=R[6],F=R[7],G=r(_-v,F-k,N,W,w,D,C),$=0,X=G.length;$<X;$++)G[$][1]+=v,G[$][2]+=k,G[$][3]+=v,G[$][4]+=k,G[$][5]+=v,G[$][6]+=k;return G}function c(v){var k=0,R=0,N=v.length,W=0,C=0,w,D,_,F=[],G,$,X;for(D=0;D<N;++D){switch(_=!1,w=v[D].slice(0),w[0]){case"l":w[0]="L",w[1]+=k,w[2]+=R;case"L":k=w[1],R=w[2];break;case"h":w[1]+=k;case"H":w[0]="L",w[2]=R,k=w[1];break;case"v":w[1]+=R;case"V":w[0]="L",R=w[1],w[1]=k,w[2]=R;break;case"m":w[0]="M",w[1]+=k,w[2]+=R;case"M":k=w[1],R=w[2],W=w[1],C=w[2];break;case"c":w[0]="C",w[1]+=k,w[2]+=R,w[3]+=k,w[4]+=R,w[5]+=k,w[6]+=R;case"C":$=w[3],X=w[4],k=w[5],R=w[6];break;case"s":w[0]="S",w[1]+=k,w[2]+=R,w[3]+=k,w[4]+=R;case"S":G==="C"?($=2*k-$,X=2*R-X):($=k,X=R),k=w[3],R=w[4],w[0]="C",w[5]=w[3],w[6]=w[4],w[3]=w[1],w[4]=w[2],w[1]=$,w[2]=X,$=w[3],X=w[4];break;case"q":w[0]="Q",w[1]+=k,w[2]+=R,w[3]+=k,w[4]+=R;case"Q":$=w[1],X=w[2],k=w[3],R=w[4];break;case"t":w[0]="T",w[1]+=k,w[2]+=R;case"T":G==="Q"?($=2*k-$,X=2*R-X):($=k,X=R),w[0]="Q",k=w[1],R=w[2],w[1]=$,w[2]=X,w[3]=k,w[4]=R;break;case"a":w[0]="A",w[6]+=k,w[7]+=R;case"A":_=!0,F=F.concat(s(k,R,w)),k=w[6],R=w[7];break;case"z":case"Z":k=W,R=C;break;default:}_||F.push(w),G=w[0]}return F}function l(v,k,R,N){return Math.sqrt((R-v)*(R-v)+(N-k)*(N-k))}function u(v){return v*v*v}function d(v){return 3*v*v*(1-v)}function f(v){return 3*v*(1-v)*(1-v)}function p(v){return(1-v)*(1-v)*(1-v)}function m(v,k,R,N,W,C,w,D){return function(_){var F=u(_),G=d(_),$=f(_),X=p(_);return{x:w*F+W*G+R*$+v*X,y:D*F+C*G+N*$+k*X}}}function h(v,k,R,N,W,C,w,D){return function(_){var F=1-_,G=3*F*F*(R-v)+6*F*_*(W-R)+3*_*_*(w-W),$=3*F*F*(N-k)+6*F*_*(C-N)+3*_*_*(D-C);return Math.atan2($,G)}}function b(v){return v*v}function x(v){return 2*v*(1-v)}function T(v){return(1-v)*(1-v)}function B(v,k,R,N,W,C){return function(w){var D=b(w),_=x(w),F=T(w);return{x:W*D+R*_+v*F,y:C*D+N*_+k*F}}}function A(v,k,R,N,W,C){return function(w){var D=1-w,_=2*D*(R-v)+2*w*(W-R),F=2*D*(N-k)+2*w*(C-N);return Math.atan2(F,_)}}function S(v,k,R){var N={x:k,y:R},W,C=0,w;for(w=1;w<=100;w+=1)W=v(w/100),C+=l(N.x,N.y,W.x,W.y),N=W;return C}function H(v,k){for(var R=0,N=0,W=v.iterator,C={x:v.x,y:v.y},w,D,_=.01,F=v.angleFinder,G;N<k&&_>1e-4;)w=W(R),G=R,D=l(C.x,C.y,w.x,w.y),D+N>k?(R-=_,_/=2):(C=w,R+=_,N+=D);return w.angle=F(G),w}function j(v){for(var k=0,R=v.length,N,W=0,C=0,w=0,D=0,_=[],F,G,$,X=0;X<R;X++){switch(N=v[X],G={x:W,y:C,command:N[0]},N[0]){case"M":G.length=0,w=W=N[1],D=C=N[2];break;case"L":G.length=l(W,C,N[1],N[2]),W=N[1],C=N[2];break;case"C":F=m(W,C,N[1],N[2],N[3],N[4],N[5],N[6]),$=h(W,C,N[1],N[2],N[3],N[4],N[5],N[6]),G.iterator=F,G.angleFinder=$,G.length=S(F,W,C),W=N[5],C=N[6];break;case"Q":F=B(W,C,N[1],N[2],N[3],N[4]),$=A(W,C,N[1],N[2],N[3],N[4]),G.iterator=F,G.angleFinder=$,G.length=S(F,W,C),W=N[3],C=N[4];break;case"Z":case"z":G.destX=w,G.destY=D,G.length=l(W,C,w,D),W=w,C=D;break}k+=G.length,_.push(G)}return _.push({length:k,x:W,y:C}),_}function M(v,k,R){R||(R=j(v));for(var N=0;k-R[N].length>0&&N<R.length-2;)k-=R[N].length,N++;var W=R[N],C=k/W.length,w=W.command,D=v[N],_;switch(w){case"M":return{x:W.x,y:W.y,angle:0};case"Z":case"z":return _=new g.Point(W.x,W.y).lerp(new g.Point(W.destX,W.destY),C),_.angle=Math.atan2(W.destY-W.y,W.destX-W.x),_;case"L":return _=new g.Point(W.x,W.y).lerp(new g.Point(D[1],D[2]),C),_.angle=Math.atan2(D[2]-W.y,D[1]-W.x),_;case"C":return H(W,k);case"Q":return H(W,k)}}function I(v){var k=[],R=[],N,W,C=g.rePathCommand,w="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",D="("+w+")"+g.commaWsp,_="([01])"+g.commaWsp+"?",F=D+"?"+D+"?"+D+_+_+D+"?("+w+")",G=new RegExp(F,"g"),$,X,U;if(!v||!v.match)return k;U=v.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var P=0,V,K=U.length;P<K;P++){N=U[P],X=N.slice(1).trim(),R.length=0;var te=N.charAt(0);if(V=[te],te.toLowerCase()==="a")for(var L;L=G.exec(X);)for(var re=1;re<L.length;re++)R.push(L[re]);else for(;$=C.exec(X);)R.push($[0]);for(var re=0,ce=R.length;re<ce;re++)W=parseFloat(R[re]),isNaN(W)||V.push(W);var Te=e[te.toLowerCase()],ve=n[te]||te;if(V.length-1>Te)for(var ie=1,ge=V.length;ie<ge;ie+=Te)k.push([te].concat(V.slice(ie,ie+Te))),te=ve;else k.push(V)}return k}function O(v,k){var R=[],N,W=new g.Point(v[0].x,v[0].y),C=new g.Point(v[1].x,v[1].y),w=v.length,D=1,_=0,F=w>2;for(k=k||0,F&&(D=v[2].x<C.x?-1:v[2].x===C.x?0:1,_=v[2].y<C.y?-1:v[2].y===C.y?0:1),R.push(["M",W.x-D*k,W.y-_*k]),N=1;N<w;N++){if(!W.eq(C)){var G=W.midPointFrom(C);R.push(["Q",W.x,W.y,G.x,G.y])}W=v[N],N+1<v.length&&(C=v[N+1])}return F&&(D=W.x>v[N-2].x?1:W.x===v[N-2].x?0:-1,_=W.y>v[N-2].y?1:W.y===v[N-2].y?0:-1),R.push(["L",W.x+D*k,W.y+_*k]),R}function Q(v,k,R){return R&&(k=g.util.multiplyTransformMatrices(k,[1,0,0,1,-R.x,-R.y])),v.map(function(N){for(var W=N.slice(0),C={},w=1;w<N.length-1;w+=2)C.x=N[w],C.y=N[w+1],C=g.util.transformPoint(C,k),W[w]=C.x,W[w+1]=C.y;return W})}g.util.joinPath=function(v){return v.map(function(k){return k.join(" ")}).join(" ")},g.util.parsePath=I,g.util.makePathSimpler=c,g.util.getSmoothPathFromPoints=O,g.util.getPathSegmentsInfo=j,g.util.getBoundsOfCurve=a,g.util.getPointOnPath=M,g.util.transformPath=Q})();(function(){var t=Array.prototype.slice;function e(a,s){for(var c=t.call(arguments,2),l=[],u=0,d=a.length;u<d;u++)l[u]=c.length?a[u][s].apply(a[u],c):a[u][s].call(a[u]);return l}function n(a,s){return i(a,s,function(c,l){return c>=l})}function o(a,s){return i(a,s,function(c,l){return c<l})}function r(a,s){for(var c=a.length;c--;)a[c]=s;return a}function i(a,s,c){if(!(!a||a.length===0)){var l=a.length-1,u=s?a[l][s]:a[l];if(s)for(;l--;)c(a[l][s],u)&&(u=a[l][s]);else for(;l--;)c(a[l],u)&&(u=a[l]);return u}}g.util.array={fill:r,invoke:e,min:o,max:n}})();(function(){function t(n,o,r){if(r)if(!g.isLikelyNode&&o instanceof Element)n=o;else if(o instanceof Array){n=[];for(var i=0,a=o.length;i<a;i++)n[i]=t({},o[i],r)}else if(o&&typeof o=="object")for(var s in o)s==="canvas"||s==="group"?n[s]=null:o.hasOwnProperty(s)&&(n[s]=t({},o[s],r));else n=o;else for(var s in o)n[s]=o[s];return n}function e(n,o){return t({},n,o)}g.util.object={extend:t,clone:e},g.util.object.extend(g.util,g.Observable)})();(function(){function t(i){return i.replace(/-+(.)?/g,function(a,s){return s?s.toUpperCase():""})}function e(i,a){return i.charAt(0).toUpperCase()+(a?i.slice(1):i.slice(1).toLowerCase())}function n(i){return i.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function o(i){var a=0,s,c=[];for(a=0,s;a<i.length;a++)(s=r(i,a))!==!1&&c.push(s);return c}function r(i,a){var s=i.charCodeAt(a);if(isNaN(s))return"";if(s<55296||s>57343)return i.charAt(a);if(55296<=s&&s<=56319){if(i.length<=a+1)throw"High surrogate without following low surrogate";var c=i.charCodeAt(a+1);if(56320>c||c>57343)throw"High surrogate without following low surrogate";return i.charAt(a)+i.charAt(a+1)}if(a===0)throw"Low surrogate without preceding high surrogate";var l=i.charCodeAt(a-1);if(55296>l||l>56319)throw"Low surrogate without preceding high surrogate";return!1}g.util.string={camelize:t,capitalize:e,escapeXml:n,graphemeSplit:o}})();(function(){var t=Array.prototype.slice,e=function(){},n=function(){for(var s in{toString:1})if(s==="toString")return!1;return!0}(),o=function(s,c,l){for(var u in c)u in s.prototype&&typeof s.prototype[u]=="function"&&(c[u]+"").indexOf("callSuper")>-1?s.prototype[u]=function(d){return function(){var f=this.constructor.superclass;this.constructor.superclass=l;var p=c[d].apply(this,arguments);if(this.constructor.superclass=f,d!=="initialize")return p}}(u):s.prototype[u]=c[u],n&&(c.toString!==Object.prototype.toString&&(s.prototype.toString=c.toString),c.valueOf!==Object.prototype.valueOf&&(s.prototype.valueOf=c.valueOf))};function r(){}function i(s){for(var c=null,l=this;l.constructor.superclass;){var u=l.constructor.superclass.prototype[s];if(l[s]!==u){c=u;break}l=l.constructor.superclass.prototype}return c?arguments.length>1?c.apply(this,t.call(arguments,1)):c.call(this):console.log("tried to callSuper "+s+", method not found in prototype chain",this)}function a(){var s=null,c=t.call(arguments,0);typeof c[0]=="function"&&(s=c.shift());function l(){this.initialize.apply(this,arguments)}l.superclass=s,l.subclasses=[],s&&(r.prototype=s.prototype,l.prototype=new r,s.subclasses.push(l));for(var u=0,d=c.length;u<d;u++)o(l,c[u],s);return l.prototype.initialize||(l.prototype.initialize=e),l.prototype.constructor=l,l.prototype.callSuper=i,l}g.util.createClass=a})();(function(){var t=!!g.document.createElement("div").attachEvent,e=["touchstart","touchmove","touchend"];g.util.addListener=function(o,r,i,a){o&&o.addEventListener(r,i,t?!1:a)},g.util.removeListener=function(o,r,i,a){o&&o.removeEventListener(r,i,t?!1:a)};function n(o){var r=o.changedTouches;return r&&r[0]?r[0]:o}g.util.getPointer=function(o){var r=o.target,i=g.util.getScrollLeftTop(r),a=n(o);return{x:a.clientX+i.left,y:a.clientY+i.top}},g.util.isTouchEvent=function(o){return e.indexOf(o.type)>-1||o.pointerType==="touch"}})();(function(){function t(a,s){var c=a.style;if(!c)return a;if(typeof s=="string")return a.style.cssText+=";"+s,s.indexOf("opacity")>-1?i(a,s.match(/opacity:\s*(\d?\.?\d*)/)[1]):a;for(var l in s)if(l==="opacity")i(a,s[l]);else{var u=l==="float"||l==="cssFloat"?typeof c.styleFloat>"u"?"cssFloat":"styleFloat":l;c.setProperty(u,s[l])}return a}var e=g.document.createElement("div"),n=typeof e.style.opacity=="string",o=typeof e.style.filter=="string",r=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,i=function(a){return a};n?i=function(a,s){return a.style.opacity=s,a}:o&&(i=function(a,s){var c=a.style;return a.currentStyle&&!a.currentStyle.hasLayout&&(c.zoom=1),r.test(c.filter)?(s=s>=.9999?"":"alpha(opacity="+s*100+")",c.filter=c.filter.replace(r,s)):c.filter+=" alpha(opacity="+s*100+")",a}),g.util.setStyle=t})();(function(){var t=Array.prototype.slice;function e(p){return typeof p=="string"?g.document.getElementById(p):p}var n,o=function(p){return t.call(p,0)};try{n=o(g.document.childNodes)instanceof Array}catch{}n||(o=function(p){for(var m=new Array(p.length),h=p.length;h--;)m[h]=p[h];return m});function r(p,m){var h=g.document.createElement(p);for(var b in m)b==="class"?h.className=m[b]:b==="for"?h.htmlFor=m[b]:h.setAttribute(b,m[b]);return h}function i(p,m){p&&(" "+p.className+" ").indexOf(" "+m+" ")===-1&&(p.className+=(p.className?" ":"")+m)}function a(p,m,h){return typeof m=="string"&&(m=r(m,h)),p.parentNode&&p.parentNode.replaceChild(m,p),m.appendChild(p),m}function s(p){for(var m=0,h=0,b=g.document.documentElement,x=g.document.body||{scrollLeft:0,scrollTop:0};p&&(p.parentNode||p.host)&&(p=p.parentNode||p.host,p===g.document?(m=x.scrollLeft||b.scrollLeft||0,h=x.scrollTop||b.scrollTop||0):(m+=p.scrollLeft||0,h+=p.scrollTop||0),!(p.nodeType===1&&p.style.position==="fixed")););return{left:m,top:h}}function c(p){var m,h=p&&p.ownerDocument,b={left:0,top:0},x={left:0,top:0},T,B={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!h)return x;for(var A in B)x[B[A]]+=parseInt(l(p,A),10)||0;return m=h.documentElement,typeof p.getBoundingClientRect<"u"&&(b=p.getBoundingClientRect()),T=s(p),{left:b.left+T.left-(m.clientLeft||0)+x.left,top:b.top+T.top-(m.clientTop||0)+x.top}}var l;g.document.defaultView&&g.document.defaultView.getComputedStyle?l=function(p,m){var h=g.document.defaultView.getComputedStyle(p,null);return h?h[m]:void 0}:l=function(p,m){var h=p.style[m];return!h&&p.currentStyle&&(h=p.currentStyle[m]),h},function(){var p=g.document.documentElement.style,m="userSelect"in p?"userSelect":"MozUserSelect"in p?"MozUserSelect":"WebkitUserSelect"in p?"WebkitUserSelect":"KhtmlUserSelect"in p?"KhtmlUserSelect":"";function h(x){return typeof x.onselectstart<"u"&&(x.onselectstart=g.util.falseFunction),m?x.style[m]="none":typeof x.unselectable=="string"&&(x.unselectable="on"),x}function b(x){return typeof x.onselectstart<"u"&&(x.onselectstart=null),m?x.style[m]="":typeof x.unselectable=="string"&&(x.unselectable=""),x}g.util.makeElementUnselectable=h,g.util.makeElementSelectable=b}();function u(p){var m=g.jsdomImplForWrapper(p);return m._canvas||m._image}function d(p){if(g.isLikelyNode){var m=g.jsdomImplForWrapper(p);m&&(m._image=null,m._canvas=null,m._currentSrc=null,m._attributes=null,m._classList=null)}}function f(p,m){p.imageSmoothingEnabled=p.imageSmoothingEnabled||p.webkitImageSmoothingEnabled||p.mozImageSmoothingEnabled||p.msImageSmoothingEnabled||p.oImageSmoothingEnabled,p.imageSmoothingEnabled=m}g.util.setImageSmoothing=f,g.util.getById=e,g.util.toArray=o,g.util.addClass=i,g.util.makeElement=r,g.util.wrapElement=a,g.util.getScrollLeftTop=s,g.util.getElementOffset=c,g.util.getNodeCanvas=u,g.util.cleanUpJsdomNode=d})();(function(){function t(o,r){return o+(/\?/.test(o)?"&":"?")+r}function e(){}function n(o,r){r||(r={});var i=r.method?r.method.toUpperCase():"GET",a=r.onComplete||function(){},s=new g.window.XMLHttpRequest,c=r.body||r.parameters;return s.onreadystatechange=function(){s.readyState===4&&(a(s),s.onreadystatechange=e)},i==="GET"&&(c=null,typeof r.parameters=="string"&&(o=t(o,r.parameters))),s.open(i,o,!0),(i==="POST"||i==="PUT")&&s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(c),s}g.util.request=n})();g.log=console.log;g.warn=console.warn;(function(){var t=g.util.object.extend,e=g.util.object.clone,n=[];g.util.object.extend(n,{cancelAll:function(){var u=this.splice(0);return u.forEach(function(d){d.cancel()}),u},cancelByCanvas:function(u){if(!u)return[];var d=this.filter(function(f){return typeof f.target=="object"&&f.target.canvas===u});return d.forEach(function(f){f.cancel()}),d},cancelByTarget:function(u){var d=this.findAnimationsByTarget(u);return d.forEach(function(f){f.cancel()}),d},findAnimationIndex:function(u){return this.indexOf(this.findAnimation(u))},findAnimation:function(u){return this.find(function(d){return d.cancel===u})},findAnimationsByTarget:function(u){return u?this.filter(function(d){return d.target===u}):[]}});function o(){return!1}function r(u,d,f,p){return-f*Math.cos(u/p*(Math.PI/2))+f+d}function i(u){u||(u={});var d=!1,f,p=function(){var m=g.runningAnimations.indexOf(f);return m>-1&&g.runningAnimations.splice(m,1)[0]};return f=t(e(u),{cancel:function(){return d=!0,p()},currentValue:"startValue"in u?u.startValue:0,completionRate:0,durationRate:0}),g.runningAnimations.push(f),c(function(m){var h=m||+new Date,b=u.duration||500,x=h+b,T,B=u.onChange||o,A=u.abort||o,S=u.onComplete||o,H=u.easing||r,j="startValue"in u?u.startValue.length>0:!1,M="startValue"in u?u.startValue:0,I="endValue"in u?u.endValue:100,O=u.byValue||(j?M.map(function(Q,v){return I[v]-M[v]}):I-M);u.onStart&&u.onStart(),function Q(v){T=v||+new Date;var k=T>x?b:T-h,R=k/b,N=j?M.map(function(C,w){return H(k,M[w],O[w],b)}):H(k,M,O,b),W=Math.abs(j?(N[0]-M[0])/O[0]:(N-M)/O);if(f.currentValue=j?N.slice():N,f.completionRate=W,f.durationRate=R,!d){if(A(N,W,R)){p();return}if(T>x){f.currentValue=j?I.slice():I,f.completionRate=1,f.durationRate=1,B(j?I.slice():I,1,1),S(I,1,1),p();return}else B(N,W,R),c(Q)}}(h)}),f.cancel}var a=g.window.requestAnimationFrame||g.window.webkitRequestAnimationFrame||g.window.mozRequestAnimationFrame||g.window.oRequestAnimationFrame||g.window.msRequestAnimationFrame||function(u){return g.window.setTimeout(u,1e3/60)},s=g.window.cancelAnimationFrame||g.window.clearTimeout;function c(){return a.apply(g.window,arguments)}function l(){return s.apply(g.window,arguments)}g.util.animate=i,g.util.requestAnimFrame=c,g.util.cancelAnimFrame=l,g.runningAnimations=n})();(function(){function t(n,o,r){var i="rgba("+parseInt(n[0]+r*(o[0]-n[0]),10)+","+parseInt(n[1]+r*(o[1]-n[1]),10)+","+parseInt(n[2]+r*(o[2]-n[2]),10);return i+=","+(n&&o?parseFloat(n[3]+r*(o[3]-n[3])):1),i+=")",i}function e(n,o,r,i){var a=new g.Color(n).getSource(),s=new g.Color(o).getSource(),c=i.onComplete,l=i.onChange;return i=i||{},g.util.animate(g.util.object.extend(i,{duration:r||500,startValue:a,endValue:s,byValue:s,easing:function(u,d,f,p){var m=i.colorEasing?i.colorEasing(u,p):1-Math.cos(u/p*(Math.PI/2));return t(d,f,m)},onComplete:function(u,d,f){if(c)return c(t(s,s,0),d,f)},onChange:function(u,d,f){if(l){if(Array.isArray(u))return l(t(u,u,0),d,f);l(u,d,f)}}}))}g.util.animateColor=e})();(function(){function t(v,k,R,N){return v<Math.abs(k)?(v=k,N=R/4):k===0&&v===0?N=R/(2*Math.PI)*Math.asin(1):N=R/(2*Math.PI)*Math.asin(k/v),{a:v,c:k,p:R,s:N}}function e(v,k,R){return v.a*Math.pow(2,10*(k-=1))*Math.sin((k*R-v.s)*(2*Math.PI)/v.p)}function n(v,k,R,N){return R*((v=v/N-1)*v*v+1)+k}function o(v,k,R,N){return v/=N/2,v<1?R/2*v*v*v+k:R/2*((v-=2)*v*v+2)+k}function r(v,k,R,N){return R*(v/=N)*v*v*v+k}function i(v,k,R,N){return-R*((v=v/N-1)*v*v*v-1)+k}function a(v,k,R,N){return v/=N/2,v<1?R/2*v*v*v*v+k:-R/2*((v-=2)*v*v*v-2)+k}function s(v,k,R,N){return R*(v/=N)*v*v*v*v+k}function c(v,k,R,N){return R*((v=v/N-1)*v*v*v*v+1)+k}function l(v,k,R,N){return v/=N/2,v<1?R/2*v*v*v*v*v+k:R/2*((v-=2)*v*v*v*v+2)+k}function u(v,k,R,N){return-R*Math.cos(v/N*(Math.PI/2))+R+k}function d(v,k,R,N){return R*Math.sin(v/N*(Math.PI/2))+k}function f(v,k,R,N){return-R/2*(Math.cos(Math.PI*v/N)-1)+k}function p(v,k,R,N){return v===0?k:R*Math.pow(2,10*(v/N-1))+k}function m(v,k,R,N){return v===N?k+R:R*(-Math.pow(2,-10*v/N)+1)+k}function h(v,k,R,N){return v===0?k:v===N?k+R:(v/=N/2,v<1?R/2*Math.pow(2,10*(v-1))+k:R/2*(-Math.pow(2,-10*--v)+2)+k)}function b(v,k,R,N){return-R*(Math.sqrt(1-(v/=N)*v)-1)+k}function x(v,k,R,N){return R*Math.sqrt(1-(v=v/N-1)*v)+k}function T(v,k,R,N){return v/=N/2,v<1?-R/2*(Math.sqrt(1-v*v)-1)+k:R/2*(Math.sqrt(1-(v-=2)*v)+1)+k}function B(v,k,R,N){var W=1.70158,C=0,w=R;if(v===0)return k;if(v/=N,v===1)return k+R;C||(C=N*.3);var D=t(w,R,C,W);return-e(D,v,N)+k}function A(v,k,R,N){var W=1.70158,C=0,w=R;if(v===0)return k;if(v/=N,v===1)return k+R;C||(C=N*.3);var D=t(w,R,C,W);return D.a*Math.pow(2,-10*v)*Math.sin((v*N-D.s)*(2*Math.PI)/D.p)+D.c+k}function S(v,k,R,N){var W=1.70158,C=0,w=R;if(v===0)return k;if(v/=N/2,v===2)return k+R;C||(C=N*(.3*1.5));var D=t(w,R,C,W);return v<1?-.5*e(D,v,N)+k:D.a*Math.pow(2,-10*(v-=1))*Math.sin((v*N-D.s)*(2*Math.PI)/D.p)*.5+D.c+k}function H(v,k,R,N,W){return W===void 0&&(W=1.70158),R*(v/=N)*v*((W+1)*v-W)+k}function j(v,k,R,N,W){return W===void 0&&(W=1.70158),R*((v=v/N-1)*v*((W+1)*v+W)+1)+k}function M(v,k,R,N,W){return W===void 0&&(W=1.70158),v/=N/2,v<1?R/2*(v*v*(((W*=1.525)+1)*v-W))+k:R/2*((v-=2)*v*(((W*=1.525)+1)*v+W)+2)+k}function I(v,k,R,N){return R-O(N-v,0,R,N)+k}function O(v,k,R,N){return(v/=N)<1/2.75?R*(7.5625*v*v)+k:v<2/2.75?R*(7.5625*(v-=1.5/2.75)*v+.75)+k:v<2.5/2.75?R*(7.5625*(v-=2.25/2.75)*v+.9375)+k:R*(7.5625*(v-=2.625/2.75)*v+.984375)+k}function Q(v,k,R,N){return v<N/2?I(v*2,0,R,N)*.5+k:O(v*2-N,0,R,N)*.5+R*.5+k}g.util.ease={easeInQuad:function(v,k,R,N){return R*(v/=N)*v+k},easeOutQuad:function(v,k,R,N){return-R*(v/=N)*(v-2)+k},easeInOutQuad:function(v,k,R,N){return v/=N/2,v<1?R/2*v*v+k:-R/2*(--v*(v-2)-1)+k},easeInCubic:function(v,k,R,N){return R*(v/=N)*v*v+k},easeOutCubic:n,easeInOutCubic:o,easeInQuart:r,easeOutQuart:i,easeInOutQuart:a,easeInQuint:s,easeOutQuint:c,easeInOutQuint:l,easeInSine:u,easeOutSine:d,easeInOutSine:f,easeInExpo:p,easeOutExpo:m,easeInOutExpo:h,easeInCirc:b,easeOutCirc:x,easeInOutCirc:T,easeInElastic:B,easeOutElastic:A,easeInOutElastic:S,easeInBack:H,easeOutBack:j,easeInOutBack:M,easeInBounce:I,easeOutBounce:O,easeInOutBounce:Q}})();(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,o=e.util.object.clone,r=e.util.toFixed,i=e.util.parseUnit,a=e.util.multiplyTransformMatrices,s=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],c=["symbol","image","marker","pattern","view","svg"],l=["pattern","defs","symbol","metadata","clipPath","mask","desc"],u=["symbol","g","a","svg","clipPath","defs"],d={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},f={stroke:"strokeOpacity",fill:"fillOpacity"},p="font-size",m="clip-path";e.svgValidTagNamesRegEx=x(s),e.svgViewBoxElementsRegEx=x(c),e.svgInvalidAncestorsRegEx=x(l),e.svgValidParentsRegEx=x(u),e.cssRules={},e.gradientDefs={},e.clipPaths={};function h(C){return C in d?d[C]:C}function b(C,w,D,_){var F=Array.isArray(w),G;if((C==="fill"||C==="stroke")&&w==="none")w="";else{if(C==="strokeUniform")return w==="non-scaling-stroke";if(C==="strokeDashArray")w==="none"?w=null:w=w.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(C==="transformMatrix")D&&D.transformMatrix?w=a(D.transformMatrix,e.parseTransformAttribute(w)):w=e.parseTransformAttribute(w);else if(C==="visible")w=w!=="none"&&w!=="hidden",D&&D.visible===!1&&(w=!1);else if(C==="opacity")w=parseFloat(w),D&&typeof D.opacity<"u"&&(w*=D.opacity);else if(C==="textAnchor")w=w==="start"?"left":w==="end"?"right":"center";else if(C==="charSpacing")G=i(w,_)/_*1e3;else if(C==="paintFirst"){var $=w.indexOf("fill"),X=w.indexOf("stroke"),w="fill";($>-1&&X>-1&&X<$||$===-1&&X>-1)&&(w="stroke")}else{if(C==="href"||C==="xlink:href"||C==="font")return w;if(C==="imageSmoothing")return w==="optimizeQuality";G=F?w.map(i):i(w,_)}}return!F&&isNaN(G)?w:G}function x(C){return new RegExp("^("+C.join("|")+")\\b","i")}function T(C){for(var w in f)if(!(typeof C[f[w]]>"u"||C[w]==="")){if(typeof C[w]>"u"){if(!e.Object.prototype[w])continue;C[w]=e.Object.prototype[w]}if(C[w].indexOf("url(")!==0){var D=new e.Color(C[w]);C[w]=D.setAlpha(r(D.getAlpha()*C[f[w]],2)).toRgba()}}return C}function B(C,w){var D,_=[],F,G,$;for(G=0,$=w.length;G<$;G++)D=w[G],F=C.getElementsByTagName(D),_=_.concat(Array.prototype.slice.call(F));return _}e.parseTransformAttribute=function(){function C(ie,ge){var Ee=e.util.cos(ge[0]),Ne=e.util.sin(ge[0]),Pe=0,Se=0;ge.length===3&&(Pe=ge[1],Se=ge[2]),ie[0]=Ee,ie[1]=Ne,ie[2]=-Ne,ie[3]=Ee,ie[4]=Pe-(Ee*Pe-Ne*Se),ie[5]=Se-(Ne*Pe+Ee*Se)}function w(ie,ge){var Ee=ge[0],Ne=ge.length===2?ge[1]:ge[0];ie[0]=Ee,ie[3]=Ne}function D(ie,ge,Ee){ie[Ee]=Math.tan(e.util.degreesToRadians(ge[0]))}function _(ie,ge){ie[4]=ge[0],ge.length===2&&(ie[5]=ge[1])}var F=e.iMatrix,G=e.reNum,$=e.commaWsp,X="(?:(skewX)\\s*\\(\\s*("+G+")\\s*\\))",U="(?:(skewY)\\s*\\(\\s*("+G+")\\s*\\))",P="(?:(rotate)\\s*\\(\\s*("+G+")(?:"+$+"("+G+")"+$+"("+G+"))?\\s*\\))",V="(?:(scale)\\s*\\(\\s*("+G+")(?:"+$+"("+G+"))?\\s*\\))",K="(?:(translate)\\s*\\(\\s*("+G+")(?:"+$+"("+G+"))?\\s*\\))",te="(?:(matrix)\\s*\\(\\s*("+G+")"+$+"("+G+")"+$+"("+G+")"+$+"("+G+")"+$+"("+G+")"+$+"("+G+")\\s*\\))",L="(?:"+te+"|"+K+"|"+V+"|"+P+"|"+X+"|"+U+")",re="(?:"+L+"(?:"+$+"*"+L+")*)",ce="^\\s*(?:"+re+"?)\\s*$",Te=new RegExp(ce),ve=new RegExp(L,"g");return function(ie){var ge=F.concat(),Ee=[];if(!ie||ie&&!Te.test(ie))return ge;ie.replace(ve,function(Pe){var Se=new RegExp(L).exec(Pe).filter(function(St){return!!St}),et=Se[1],Ye=Se.slice(2).map(parseFloat);switch(et){case"translate":_(ge,Ye);break;case"rotate":Ye[0]=e.util.degreesToRadians(Ye[0]),C(ge,Ye);break;case"scale":w(ge,Ye);break;case"skewX":D(ge,Ye,2);break;case"skewY":D(ge,Ye,1);break;case"matrix":ge=Ye;break}Ee.push(ge.concat()),ge=F.concat()});for(var Ne=Ee[0];Ee.length>1;)Ee.shift(),Ne=e.util.multiplyTransformMatrices(Ne,Ee[0]);return Ne}}();function A(C,w){var D,_;C.replace(/;\s*$/,"").split(";").forEach(function(F){var G=F.split(":");D=G[0].trim().toLowerCase(),_=G[1].trim(),w[D]=_})}function S(C,w){var D,_;for(var F in C)typeof C[F]>"u"||(D=F.toLowerCase(),_=C[F],w[D]=_)}function H(C,w){var D={};for(var _ in e.cssRules[w])if(j(C,_.split(" ")))for(var F in e.cssRules[w][_])D[F]=e.cssRules[w][_][F];return D}function j(C,w){var D,_=!0;return D=I(C,w.pop()),D&&w.length&&(_=M(C,w)),D&&_&&w.length===0}function M(C,w){for(var D,_=!0;C.parentNode&&C.parentNode.nodeType===1&&w.length;)_&&(D=w.pop()),C=C.parentNode,_=I(C,D);return w.length===0}function I(C,w){var D=C.nodeName,_=C.getAttribute("class"),F=C.getAttribute("id"),G,$;if(G=new RegExp("^"+D,"i"),w=w.replace(G,""),F&&w.length&&(G=new RegExp("#"+F+"(?![a-zA-Z\\-]+)","i"),w=w.replace(G,"")),_&&w.length)for(_=_.split(" "),$=_.length;$--;)G=new RegExp("\\."+_[$]+"(?![a-zA-Z\\-]+)","i"),w=w.replace(G,"");return w.length===0}function O(C,w){var D;if(C.getElementById&&(D=C.getElementById(w)),D)return D;var _,F,G,$=C.getElementsByTagName("*");for(F=0,G=$.length;F<G;F++)if(_=$[F],w===_.getAttribute("id"))return _}function Q(C){for(var w=B(C,["use","svg:use"]),D=0;w.length&&D<w.length;){var _=w[D],F=_.getAttribute("xlink:href")||_.getAttribute("href");if(F===null)return;var G=F.slice(1),$=_.getAttribute("x")||0,X=_.getAttribute("y")||0,U=O(C,G).cloneNode(!0),P=(U.getAttribute("transform")||"")+" translate("+$+", "+X+")",V,K=w.length,te,L,re,ce,Te=e.svgNS;if(k(U),/^svg$/i.test(U.nodeName)){var ve=U.ownerDocument.createElementNS(Te,"g");for(L=0,re=U.attributes,ce=re.length;L<ce;L++)te=re.item(L),ve.setAttributeNS(Te,te.nodeName,te.nodeValue);for(;U.firstChild;)ve.appendChild(U.firstChild);U=ve}for(L=0,re=_.attributes,ce=re.length;L<ce;L++)te=re.item(L),!(te.nodeName==="x"||te.nodeName==="y"||te.nodeName==="xlink:href"||te.nodeName==="href")&&(te.nodeName==="transform"?P=te.nodeValue+" "+P:U.setAttribute(te.nodeName,te.nodeValue));U.setAttribute("transform",P),U.setAttribute("instantiated_by_use","1"),U.removeAttribute("id"),V=_.parentNode,V.replaceChild(U,_),w.length===K&&D++}}var v=new RegExp("^\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*,?\\s*("+e.reNum+"+)\\s*$");function k(C){if(!e.svgViewBoxElementsRegEx.test(C.nodeName))return{};var w=C.getAttribute("viewBox"),D=1,_=1,F=0,G=0,$,X,U,P,V=C.getAttribute("width"),K=C.getAttribute("height"),te=C.getAttribute("x")||0,L=C.getAttribute("y")||0,re=C.getAttribute("preserveAspectRatio")||"",ce=!w||!(w=w.match(v)),Te=!V||!K||V==="100%"||K==="100%",ve=ce&&Te,ie={},ge="",Ee=0,Ne=0;if(ie.width=0,ie.height=0,ie.toBeParsed=ve,ce&&(te||L)&&C.parentNode&&C.parentNode.nodeName!=="#document"&&(ge=" translate("+i(te)+" "+i(L)+") ",U=(C.getAttribute("transform")||"")+ge,C.setAttribute("transform",U),C.removeAttribute("x"),C.removeAttribute("y")),ve)return ie;if(ce)return ie.width=i(V),ie.height=i(K),ie;if(F=-parseFloat(w[1]),G=-parseFloat(w[2]),$=parseFloat(w[3]),X=parseFloat(w[4]),ie.minX=F,ie.minY=G,ie.viewBoxWidth=$,ie.viewBoxHeight=X,Te?(ie.width=$,ie.height=X):(ie.width=i(V),ie.height=i(K),D=ie.width/$,_=ie.height/X),re=e.util.parsePreserveAspectRatioAttribute(re),re.alignX!=="none"&&(re.meetOrSlice==="meet"&&(_=D=D>_?_:D),re.meetOrSlice==="slice"&&(_=D=D>_?D:_),Ee=ie.width-$*D,Ne=ie.height-X*D,re.alignX==="Mid"&&(Ee/=2),re.alignY==="Mid"&&(Ne/=2),re.alignX==="Min"&&(Ee=0),re.alignY==="Min"&&(Ne=0)),D===1&&_===1&&F===0&&G===0&&te===0&&L===0)return ie;if((te||L)&&C.parentNode.nodeName!=="#document"&&(ge=" translate("+i(te)+" "+i(L)+") "),U=ge+" matrix("+D+" 0 0 "+_+" "+(F*D+Ee)+" "+(G*_+Ne)+") ",C.nodeName==="svg"){for(P=C.ownerDocument.createElementNS(e.svgNS,"g");C.firstChild;)P.appendChild(C.firstChild);C.appendChild(P)}else P=C,P.removeAttribute("x"),P.removeAttribute("y"),U=P.getAttribute("transform")+U;return P.setAttribute("transform",U),ie}function R(C,w){for(;C&&(C=C.parentNode);)if(C.nodeName&&w.test(C.nodeName.replace("svg:",""))&&!C.getAttribute("instantiated_by_use"))return!0;return!1}e.parseSVGDocument=function(C,w,D,_){if(C){Q(C);var F=e.Object.__uid++,G,$,X=k(C),U=e.util.toArray(C.getElementsByTagName("*"));if(X.crossOrigin=_&&_.crossOrigin,X.svgUid=F,U.length===0&&e.isLikelyNode){U=C.selectNodes('//*[name(.)!="svg"]');var P=[];for(G=0,$=U.length;G<$;G++)P[G]=U[G];U=P}var V=U.filter(function(te){return k(te),e.svgValidTagNamesRegEx.test(te.nodeName.replace("svg:",""))&&!R(te,e.svgInvalidAncestorsRegEx)});if(!V||V&&!V.length){w&&w([],{});return}var K={};U.filter(function(te){return te.nodeName.replace("svg:","")==="clipPath"}).forEach(function(te){var L=te.getAttribute("id");K[L]=e.util.toArray(te.getElementsByTagName("*")).filter(function(re){return e.svgValidTagNamesRegEx.test(re.nodeName.replace("svg:",""))})}),e.gradientDefs[F]=e.getGradientDefs(C),e.cssRules[F]=e.getCSSRules(C),e.clipPaths[F]=K,e.parseElements(V,function(te,L){w&&(w(te,X,L,U),delete e.gradientDefs[F],delete e.cssRules[F],delete e.clipPaths[F])},o(X),D,_)}};function N(C,w){var D=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],_="xlink:href",F=w.getAttribute(_).slice(1),G=O(C,F);if(G&&G.getAttribute(_)&&N(C,G),D.forEach(function(X){G&&!w.hasAttribute(X)&&G.hasAttribute(X)&&w.setAttribute(X,G.getAttribute(X))}),!w.children.length)for(var $=G.cloneNode(!0);$.firstChild;)w.appendChild($.firstChild);w.removeAttribute(_)}var W=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+e.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+e.reNum+"))?\\s+(.*)");n(e,{parseFontDeclaration:function(C,w){var D=C.match(W);if(D){var _=D[1],F=D[3],G=D[4],$=D[5],X=D[6];_&&(w.fontStyle=_),F&&(w.fontWeight=isNaN(parseFloat(F))?F:parseFloat(F)),G&&(w.fontSize=i(G)),X&&(w.fontFamily=X),$&&(w.lineHeight=$==="normal"?1:$)}},getGradientDefs:function(C){var w=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],D=B(C,w),_,F=0,G={};for(F=D.length;F--;)_=D[F],_.getAttribute("xlink:href")&&N(C,_),G[_.getAttribute("id")]=_;return G},parseAttributes:function(C,w,D){if(C){var _,F={},G,$;typeof D>"u"&&(D=C.getAttribute("svgUid")),C.parentNode&&e.svgValidParentsRegEx.test(C.parentNode.nodeName)&&(F=e.parseAttributes(C.parentNode,w,D));var X=w.reduce(function(re,ce){return _=C.getAttribute(ce),_&&(re[ce]=_),re},{}),U=n(H(C,D),e.parseStyleAttribute(C));X=n(X,U),U[m]&&C.setAttribute(m,U[m]),G=$=F.fontSize||e.Text.DEFAULT_SVG_FONT_SIZE,X[p]&&(X[p]=G=i(X[p],$));var P,V,K={};for(var te in X)P=h(te),V=b(P,X[te],F,G),K[P]=V;K&&K.font&&e.parseFontDeclaration(K.font,K);var L=n(F,K);return e.svgValidParentsRegEx.test(C.nodeName)?L:T(L)}},parseElements:function(C,w,D,_,F){new e.ElementsParser(C,w,D,_,F).parse()},parseStyleAttribute:function(C){var w={},D=C.getAttribute("style");return D&&(typeof D=="string"?A(D,w):S(D,w)),w},parsePointsAttribute:function(C){if(!C)return null;C=C.replace(/,/g," ").trim(),C=C.split(/\s+/);var w=[],D,_;for(D=0,_=C.length;D<_;D+=2)w.push({x:parseFloat(C[D]),y:parseFloat(C[D+1])});return w},getCSSRules:function(C){var w=C.getElementsByTagName("style"),D,_,F={},G;for(D=0,_=w.length;D<_;D++){var $=w[D].textContent;$=$.replace(/\/\*[\s\S]*?\*\//g,""),$.trim()!==""&&(G=$.split("}"),G=G.filter(function(X){return X.trim()}),G.forEach(function(X){var U=X.split("{"),P={},V=U[1].trim(),K=V.split(";").filter(function(ce){return ce.trim()});for(D=0,_=K.length;D<_;D++){var te=K[D].split(":"),L=te[0].trim(),re=te[1].trim();P[L]=re}X=U[0].trim(),X.split(",").forEach(function(ce){ce=ce.replace(/^svg/i,"").trim(),ce!==""&&(F[ce]?e.util.object.extend(F[ce],P):F[ce]=e.util.object.clone(P))})}))}return F},loadSVGFromURL:function(C,w,D,_){C=C.replace(/^\n\s*/,"").trim(),new e.util.request(C,{method:"get",onComplete:F});function F(G){var $=G.responseXML;if(!$||!$.documentElement)return w&&w(null),!1;e.parseSVGDocument($.documentElement,function(X,U,P,V){w&&w(X,U,P,V)},D,_)}},loadSVGFromString:function(C,w,D,_){var F=new e.window.DOMParser,G=F.parseFromString(C.trim(),"text/xml");e.parseSVGDocument(G.documentElement,function($,X,U,P){w($,X,U,P)},D,_)}})})(ae);g.ElementsParser=function(t,e,n,o,r,i){this.elements=t,this.callback=e,this.options=n,this.reviver=o,this.svgUid=n&&n.svgUid||0,this.parsingOptions=r,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=i};(function(t){t.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},t.createObjects=function(){var e=this;this.elements.forEach(function(n,o){n.setAttribute("svgUid",e.svgUid),e.createObject(n,o)})},t.findTag=function(e){return g[g.util.string.capitalize(e.tagName.replace("svg:",""))]},t.createObject=function(e,n){var o=this.findTag(e);if(o&&o.fromElement)try{o.fromElement(e,this.createCallback(n,e),this.options)}catch(r){g.log(r)}else this.checkIfDone()},t.createCallback=function(e,n){var o=this;return function(r){var i;o.resolveGradient(r,n,"fill"),o.resolveGradient(r,n,"stroke"),r instanceof g.Image&&r._originalElement&&(i=r.parsePreserveAspectRatioAttribute(n)),r._removeTransformMatrix(i),o.resolveClipPath(r,n),o.reviver&&o.reviver(n,r),o.instances[e]=r,o.checkIfDone()}},t.extractPropertyDefinition=function(e,n,o){var r=e[n],i=this.regexUrl;if(i.test(r)){i.lastIndex=0;var a=i.exec(r)[1];return i.lastIndex=0,g[o][this.svgUid][a]}},t.resolveGradient=function(e,n,o){var r=this.extractPropertyDefinition(e,o,"gradientDefs");if(r){var i=n.getAttribute(o+"-opacity"),a=g.Gradient.fromElement(r,e,i,this.options);e.set(o,a)}},t.createClipPathCallback=function(e,n){return function(o){o._removeTransformMatrix(),o.fillRule=o.clipRule,n.push(o)}},t.resolveClipPath=function(e,n){var o=this.extractPropertyDefinition(e,"clipPath","clipPaths"),r,i,a,s,c,l;if(o){s=[],a=g.util.invertTransform(e.calcTransformMatrix());for(var u=o[0].parentNode,d=n;d.parentNode&&d.getAttribute("clip-path")!==e.clipPath;)d=d.parentNode;d.parentNode.appendChild(u);for(var f=0;f<o.length;f++)r=o[f],i=this.findTag(r),i.fromElement(r,this.createClipPathCallback(e,s),this.options);s.length===1?o=s[0]:o=new g.Group(s),c=g.util.multiplyTransformMatrices(a,o.calcTransformMatrix()),o.clipPath&&this.resolveClipPath(o,d);var l=g.util.qrDecompose(c);o.flipX=!1,o.flipY=!1,o.set("scaleX",l.scaleX),o.set("scaleY",l.scaleY),o.angle=l.angle,o.skewX=l.skewX,o.skewY=0,o.setPositionByOrigin({x:l.translateX,y:l.translateY},"center","center"),e.clipPath=o}else delete e.clipPath},t.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(e){return e!=null}),this.callback(this.instances,this.elements))}})(g.ElementsParser.prototype);(function(t){"use strict";var e=t.fabric||(t.fabric={});if(e.Point){e.warn("fabric.Point is already defined");return}e.Point=n;function n(o,r){this.x=o,this.y=r}n.prototype={type:"point",constructor:n,add:function(o){return new n(this.x+o.x,this.y+o.y)},addEquals:function(o){return this.x+=o.x,this.y+=o.y,this},scalarAdd:function(o){return new n(this.x+o,this.y+o)},scalarAddEquals:function(o){return this.x+=o,this.y+=o,this},subtract:function(o){return new n(this.x-o.x,this.y-o.y)},subtractEquals:function(o){return this.x-=o.x,this.y-=o.y,this},scalarSubtract:function(o){return new n(this.x-o,this.y-o)},scalarSubtractEquals:function(o){return this.x-=o,this.y-=o,this},multiply:function(o){return new n(this.x*o,this.y*o)},multiplyEquals:function(o){return this.x*=o,this.y*=o,this},divide:function(o){return new n(this.x/o,this.y/o)},divideEquals:function(o){return this.x/=o,this.y/=o,this},eq:function(o){return this.x===o.x&&this.y===o.y},lt:function(o){return this.x<o.x&&this.y<o.y},lte:function(o){return this.x<=o.x&&this.y<=o.y},gt:function(o){return this.x>o.x&&this.y>o.y},gte:function(o){return this.x>=o.x&&this.y>=o.y},lerp:function(o,r){return typeof r>"u"&&(r=.5),r=Math.max(Math.min(1,r),0),new n(this.x+(o.x-this.x)*r,this.y+(o.y-this.y)*r)},distanceFrom:function(o){var r=this.x-o.x,i=this.y-o.y;return Math.sqrt(r*r+i*i)},midPointFrom:function(o){return this.lerp(o)},min:function(o){return new n(Math.min(this.x,o.x),Math.min(this.y,o.y))},max:function(o){return new n(Math.max(this.x,o.x),Math.max(this.y,o.y))},toString:function(){return this.x+","+this.y},setXY:function(o,r){return this.x=o,this.y=r,this},setX:function(o){return this.x=o,this},setY:function(o){return this.y=o,this},setFromPoint:function(o){return this.x=o.x,this.y=o.y,this},swap:function(o){var r=this.x,i=this.y;this.x=o.x,this.y=o.y,o.x=r,o.y=i},clone:function(){return new n(this.x,this.y)}}})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={});if(e.Intersection){e.warn("fabric.Intersection is already defined");return}function n(o){this.status=o,this.points=[]}e.Intersection=n,e.Intersection.prototype={constructor:n,appendPoint:function(o){return this.points.push(o),this},appendPoints:function(o){return this.points=this.points.concat(o),this}},e.Intersection.intersectLineLine=function(o,r,i,a){var s,c=(a.x-i.x)*(o.y-i.y)-(a.y-i.y)*(o.x-i.x),l=(r.x-o.x)*(o.y-i.y)-(r.y-o.y)*(o.x-i.x),u=(a.y-i.y)*(r.x-o.x)-(a.x-i.x)*(r.y-o.y);if(u!==0){var d=c/u,f=l/u;0<=d&&d<=1&&0<=f&&f<=1?(s=new n("Intersection"),s.appendPoint(new e.Point(o.x+d*(r.x-o.x),o.y+d*(r.y-o.y)))):s=new n}else c===0||l===0?s=new n("Coincident"):s=new n("Parallel");return s},e.Intersection.intersectLinePolygon=function(o,r,i){var a=new n,s=i.length,c,l,u,d;for(d=0;d<s;d++)c=i[d],l=i[(d+1)%s],u=n.intersectLineLine(o,r,c,l),a.appendPoints(u.points);return a.points.length>0&&(a.status="Intersection"),a},e.Intersection.intersectPolygonPolygon=function(o,r){var i=new n,a=o.length,s;for(s=0;s<a;s++){var c=o[s],l=o[(s+1)%a],u=n.intersectLinePolygon(c,l,r);i.appendPoints(u.points)}return i.points.length>0&&(i.status="Intersection"),i},e.Intersection.intersectPolygonRectangle=function(o,r,i){var a=r.min(i),s=r.max(i),c=new e.Point(s.x,a.y),l=new e.Point(a.x,s.y),u=n.intersectLinePolygon(a,c,o),d=n.intersectLinePolygon(c,s,o),f=n.intersectLinePolygon(s,l,o),p=n.intersectLinePolygon(l,a,o),m=new n;return m.appendPoints(u.points),m.appendPoints(d.points),m.appendPoints(f.points),m.appendPoints(p.points),m.points.length>0&&(m.status="Intersection"),m}})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={});if(e.Color){e.warn("fabric.Color is already defined.");return}function n(r){r?this._tryParsingColor(r):this.setSource([0,0,0,1])}e.Color=n,e.Color.prototype={_tryParsingColor:function(r){var i;r in n.colorNameMap&&(r=n.colorNameMap[r]),r==="transparent"&&(i=[255,255,255,0]),i||(i=n.sourceFromHex(r)),i||(i=n.sourceFromRgb(r)),i||(i=n.sourceFromHsl(r)),i||(i=[0,0,0,1]),i&&this.setSource(i)},_rgbToHsl:function(r,i,a){r/=255,i/=255,a/=255;var s,c,l,u=e.util.array.max([r,i,a]),d=e.util.array.min([r,i,a]);if(l=(u+d)/2,u===d)s=c=0;else{var f=u-d;switch(c=l>.5?f/(2-u-d):f/(u+d),u){case r:s=(i-a)/f+(i<a?6:0);break;case i:s=(a-r)/f+2;break;case a:s=(r-i)/f+4;break}s/=6}return[Math.round(s*360),Math.round(c*100),Math.round(l*100)]},getSource:function(){return this._source},setSource:function(r){this._source=r},toRgb:function(){var r=this.getSource();return"rgb("+r[0]+","+r[1]+","+r[2]+")"},toRgba:function(){var r=this.getSource();return"rgba("+r[0]+","+r[1]+","+r[2]+","+r[3]+")"},toHsl:function(){var r=this.getSource(),i=this._rgbToHsl(r[0],r[1],r[2]);return"hsl("+i[0]+","+i[1]+"%,"+i[2]+"%)"},toHsla:function(){var r=this.getSource(),i=this._rgbToHsl(r[0],r[1],r[2]);return"hsla("+i[0]+","+i[1]+"%,"+i[2]+"%,"+r[3]+")"},toHex:function(){var r=this.getSource(),i,a,s;return i=r[0].toString(16),i=i.length===1?"0"+i:i,a=r[1].toString(16),a=a.length===1?"0"+a:a,s=r[2].toString(16),s=s.length===1?"0"+s:s,i.toUpperCase()+a.toUpperCase()+s.toUpperCase()},toHexa:function(){var r=this.getSource(),i;return i=Math.round(r[3]*255),i=i.toString(16),i=i.length===1?"0"+i:i,this.toHex()+i.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(r){var i=this.getSource();return i[3]=r,this.setSource(i),this},toGrayscale:function(){var r=this.getSource(),i=parseInt((r[0]*.3+r[1]*.59+r[2]*.11).toFixed(0),10),a=r[3];return this.setSource([i,i,i,a]),this},toBlackWhite:function(r){var i=this.getSource(),a=(i[0]*.3+i[1]*.59+i[2]*.11).toFixed(0),s=i[3];return r=r||127,a=Number(a)<Number(r)?0:255,this.setSource([a,a,a,s]),this},overlayWith:function(r){r instanceof n||(r=new n(r));var i=[],a=this.getAlpha(),s=.5,c=this.getSource(),l=r.getSource(),u;for(u=0;u<3;u++)i.push(Math.round(c[u]*(1-s)+l[u]*s));return i[3]=a,this.setSource(i),this}},e.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,e.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,e.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,e.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function o(r,i,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?r+(i-r)*6*a:a<1/2?i:a<2/3?r+(i-r)*(2/3-a)*6:r}e.Color.fromRgb=function(r){return n.fromSource(n.sourceFromRgb(r))},e.Color.sourceFromRgb=function(r){var i=r.match(n.reRGBa);if(i){var a=parseInt(i[1],10)/(/%$/.test(i[1])?100:1)*(/%$/.test(i[1])?255:1),s=parseInt(i[2],10)/(/%$/.test(i[2])?100:1)*(/%$/.test(i[2])?255:1),c=parseInt(i[3],10)/(/%$/.test(i[3])?100:1)*(/%$/.test(i[3])?255:1);return[parseInt(a,10),parseInt(s,10),parseInt(c,10),i[4]?parseFloat(i[4]):1]}},e.Color.fromRgba=n.fromRgb,e.Color.fromHsl=function(r){return n.fromSource(n.sourceFromHsl(r))},e.Color.sourceFromHsl=function(r){var i=r.match(n.reHSLa);if(i){var a=(parseFloat(i[1])%360+360)%360/360,s=parseFloat(i[2])/(/%$/.test(i[2])?100:1),c=parseFloat(i[3])/(/%$/.test(i[3])?100:1),l,u,d;if(s===0)l=u=d=c;else{var f=c<=.5?c*(s+1):c+s-c*s,p=c*2-f;l=o(p,f,a+1/3),u=o(p,f,a),d=o(p,f,a-1/3)}return[Math.round(l*255),Math.round(u*255),Math.round(d*255),i[4]?parseFloat(i[4]):1]}},e.Color.fromHsla=n.fromHsl,e.Color.fromHex=function(r){return n.fromSource(n.sourceFromHex(r))},e.Color.sourceFromHex=function(r){if(r.match(n.reHex)){var i=r.slice(r.indexOf("#")+1),a=i.length===3||i.length===4,s=i.length===8||i.length===4,c=a?i.charAt(0)+i.charAt(0):i.substring(0,2),l=a?i.charAt(1)+i.charAt(1):i.substring(2,4),u=a?i.charAt(2)+i.charAt(2):i.substring(4,6),d=s?a?i.charAt(3)+i.charAt(3):i.substring(6,8):"FF";return[parseInt(c,16),parseInt(l,16),parseInt(u,16),parseFloat((parseInt(d,16)/255).toFixed(2))]}},e.Color.fromSource=function(r){var i=new n;return i.setSource(r),i}})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=["e","se","s","sw","w","nw","n","ne","e"],o=["ns","nesw","ew","nwse"],r={},i="left",a="top",s="right",c="bottom",l="center",u={top:c,bottom:a,left:s,right:i,center:l},d=e.util.radiansToDegrees,f=Math.sign||function(P){return(P>0)-(P<0)||+P};function p(P,V){var K=P.angle+d(Math.atan2(V.y,V.x))+360;return Math.round(K%360/45)}function m(P,V){var K=V.transform.target,te=K.canvas,L=e.util.object.clone(V);L.target=K,te&&te.fire("object:"+P,L),K.fire(P,V)}function h(P,V){var K=V.canvas,te=K.uniScaleKey,L=P[te];return K.uniformScaling&&!L||!K.uniformScaling&&L}function b(P){return P.originX===l&&P.originY===l}function x(P,V,K){var te=P.lockScalingX,L=P.lockScalingY;return!!(te&&L||!V&&(te||L)&&K||te&&V==="x"||L&&V==="y")}function T(P,V,K){var te="not-allowed",L=h(P,K),re="";if(V.x!==0&&V.y===0?re="x":V.x===0&&V.y!==0&&(re="y"),x(K,re,L))return te;var ce=p(K,V);return n[ce]+"-resize"}function B(P,V,K){var te="not-allowed";if(V.x!==0&&K.lockSkewingY||V.y!==0&&K.lockSkewingX)return te;var L=p(K,V)%4;return o[L]+"-resize"}function A(P,V,K){return P[K.canvas.altActionKey]?r.skewCursorStyleHandler(P,V,K):r.scaleCursorStyleHandler(P,V,K)}function S(P,V,K){var te=P[K.canvas.altActionKey];if(V.x===0)return te?"skewX":"scaleY";if(V.y===0)return te?"skewY":"scaleX"}function H(P,V,K){return K.lockRotation?"not-allowed":V.cursorStyle}function j(P,V,K,te){return{e:P,transform:V,pointer:{x:K,y:te}}}function M(P){return function(V,K,te,L){var re=K.target,ce=re.getCenterPoint(),Te=re.translateToOriginPoint(ce,K.originX,K.originY),ve=P(V,K,te,L);return re.setPositionByOrigin(Te,K.originX,K.originY),ve}}function I(P,V){return function(K,te,L,re){var ce=V(K,te,L,re);return ce&&m(P,j(K,te,L,re)),ce}}function O(P,V,K,te,L){var re=P.target,ce=re.controls[P.corner],Te=re.canvas.getZoom(),ve=re.padding/Te,ie=re.toLocalPoint(new e.Point(te,L),V,K);return ie.x>=ve&&(ie.x-=ve),ie.x<=-ve&&(ie.x+=ve),ie.y>=ve&&(ie.y-=ve),ie.y<=ve&&(ie.y+=ve),ie.x-=ce.offsetX,ie.y-=ce.offsetY,ie}function Q(P){return P.flipX!==P.flipY}function v(P,V,K,te,L){if(P[V]!==0){var re=P._getTransformedDimensions()[te],ce=L/re*P[K];P.set(K,ce)}}function k(P,V,K,te){var L=V.target,re=L._getTransformedDimensions(0,L.skewY),ce=O(V,V.originX,V.originY,K,te),Te=Math.abs(ce.x*2)-re.x,ve=L.skewX,ie;Te<2?ie=0:(ie=d(Math.atan2(Te/L.scaleX,re.y/L.scaleY)),V.originX===i&&V.originY===c&&(ie=-ie),V.originX===s&&V.originY===a&&(ie=-ie),Q(L)&&(ie=-ie));var ge=ve!==ie;if(ge){var Ee=L._getTransformedDimensions().y;L.set("skewX",ie),v(L,"skewY","scaleY","y",Ee)}return ge}function R(P,V,K,te){var L=V.target,re=L._getTransformedDimensions(L.skewX,0),ce=O(V,V.originX,V.originY,K,te),Te=Math.abs(ce.y*2)-re.y,ve=L.skewY,ie;Te<2?ie=0:(ie=d(Math.atan2(Te/L.scaleY,re.x/L.scaleX)),V.originX===i&&V.originY===c&&(ie=-ie),V.originX===s&&V.originY===a&&(ie=-ie),Q(L)&&(ie=-ie));var ge=ve!==ie;if(ge){var Ee=L._getTransformedDimensions().x;L.set("skewY",ie),v(L,"skewX","scaleX","x",Ee)}return ge}function N(P,V,K,te){var L=V.target,re=L.skewX,ce,Te=V.originY;if(L.lockSkewingX)return!1;if(re===0){var ve=O(V,l,l,K,te);ve.x>0?ce=i:ce=s}else re>0&&(ce=Te===a?i:s),re<0&&(ce=Te===a?s:i),Q(L)&&(ce=ce===i?s:i);V.originX=ce;var ie=I("skewing",M(k));return ie(P,V,K,te)}function W(P,V,K,te){var L=V.target,re=L.skewY,ce,Te=V.originX;if(L.lockSkewingY)return!1;if(re===0){var ve=O(V,l,l,K,te);ve.y>0?ce=a:ce=c}else re>0&&(ce=Te===i?a:c),re<0&&(ce=Te===i?c:a),Q(L)&&(ce=ce===a?c:a);V.originY=ce;var ie=I("skewing",M(R));return ie(P,V,K,te)}function C(P,V,K,te){var L=V,re=L.target,ce=re.translateToOriginPoint(re.getCenterPoint(),L.originX,L.originY);if(re.lockRotation)return!1;var Te=Math.atan2(L.ey-ce.y,L.ex-ce.x),ve=Math.atan2(te-ce.y,K-ce.x),ie=d(ve-Te+L.theta),ge=!0;if(re.snapAngle>0){var Ee=re.snapAngle,Ne=re.snapThreshold||Ee,Pe=Math.ceil(ie/Ee)*Ee,Se=Math.floor(ie/Ee)*Ee;Math.abs(ie-Se)<Ne?ie=Se:Math.abs(ie-Pe)<Ne&&(ie=Pe)}return ie<0&&(ie=360+ie),ie%=360,ge=re.angle!==ie,re.angle=ie,ge}function w(P,V,K,te,L){L=L||{};var re=V.target,ce=re.lockScalingX,Te=re.lockScalingY,ve=L.by,ie,ge,Ee,Ne,Pe=h(P,re),Se=x(re,ve,Pe),et,Ye,St=V.gestureScale;if(Se)return!1;if(St)ge=V.scaleX*St,Ee=V.scaleY*St;else{if(ie=O(V,V.originX,V.originY,K,te),et=ve!=="y"?f(ie.x):1,Ye=ve!=="x"?f(ie.y):1,V.signX||(V.signX=et),V.signY||(V.signY=Ye),re.lockScalingFlip&&(V.signX!==et||V.signY!==Ye))return!1;if(Ne=re._getTransformedDimensions(),Pe&&!ve){var Ft=Math.abs(ie.x)+Math.abs(ie.y),ht=V.original,En=Math.abs(Ne.x*ht.scaleX/re.scaleX)+Math.abs(Ne.y*ht.scaleY/re.scaleY),ln=Ft/En;ge=ht.scaleX*ln,Ee=ht.scaleY*ln}else ge=Math.abs(ie.x*re.scaleX/Ne.x),Ee=Math.abs(ie.y*re.scaleY/Ne.y);b(V)&&(ge*=2,Ee*=2),V.signX!==et&&ve!=="y"&&(V.originX=u[V.originX],ge*=-1,V.signX=et),V.signY!==Ye&&ve!=="x"&&(V.originY=u[V.originY],Ee*=-1,V.signY=Ye)}var On=re.scaleX,Ur=re.scaleY;return ve?(ve==="x"&&re.set("scaleX",ge),ve==="y"&&re.set("scaleY",Ee)):(!ce&&re.set("scaleX",ge),!Te&&re.set("scaleY",Ee)),On!==re.scaleX||Ur!==re.scaleY}function D(P,V,K,te){return w(P,V,K,te)}function _(P,V,K,te){return w(P,V,K,te,{by:"x"})}function F(P,V,K,te){return w(P,V,K,te,{by:"y"})}function G(P,V,K,te){return P[V.target.canvas.altActionKey]?r.skewHandlerX(P,V,K,te):r.scalingY(P,V,K,te)}function $(P,V,K,te){return P[V.target.canvas.altActionKey]?r.skewHandlerY(P,V,K,te):r.scalingX(P,V,K,te)}function X(P,V,K,te){var L=V.target,re=O(V,V.originX,V.originY,K,te),ce=L.strokeWidth/(L.strokeUniform?L.scaleX:1),Te=b(V)?2:1,ve=L.width,ie=Math.abs(re.x*Te/L.scaleX)-ce;return L.set("width",Math.max(ie,0)),ve!==ie}function U(P,V,K,te){var L=V.target,re=K-V.offsetX,ce=te-V.offsetY,Te=!L.get("lockMovementX")&&L.left!==re,ve=!L.get("lockMovementY")&&L.top!==ce;return Te&&L.set("left",re),ve&&L.set("top",ce),(Te||ve)&&m("moving",j(P,V,K,te)),Te||ve}r.scaleCursorStyleHandler=T,r.skewCursorStyleHandler=B,r.scaleSkewCursorStyleHandler=A,r.rotationWithSnapping=I("rotating",M(C)),r.scalingEqually=I("scaling",M(D)),r.scalingX=I("scaling",M(_)),r.scalingY=I("scaling",M(F)),r.scalingYOrSkewingX=G,r.scalingXOrSkewingY=$,r.changeWidth=I("resizing",M(X)),r.skewHandlerX=N,r.skewHandlerY=W,r.dragHandler=U,r.scaleOrSkewActionName=S,r.rotationStyleHandler=H,r.fireEvent=m,r.wrapWithFixedAnchor=M,r.wrapWithFireEvent=I,r.getLocalPoint=O,e.controlsUtils=r})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.degreesToRadians,o=e.controlsUtils;function r(a,s,c,l,u){l=l||{};var d=this.sizeX||l.cornerSize||u.cornerSize,f=this.sizeY||l.cornerSize||u.cornerSize,p=typeof l.transparentCorners<"u"?l.transparentCorners:u.transparentCorners,m=p?"stroke":"fill",h=!p&&(l.cornerStrokeColor||u.cornerStrokeColor),b=s,x=c,T;a.save(),a.fillStyle=l.cornerColor||u.cornerColor,a.strokeStyle=l.cornerStrokeColor||u.cornerStrokeColor,d>f?(T=d,a.scale(1,f/d),x=c*d/f):f>d?(T=f,a.scale(d/f,1),b=s*f/d):T=d,a.lineWidth=1,a.beginPath(),a.arc(b,x,T/2,0,2*Math.PI,!1),a[m](),h&&a.stroke(),a.restore()}function i(a,s,c,l,u){l=l||{};var d=this.sizeX||l.cornerSize||u.cornerSize,f=this.sizeY||l.cornerSize||u.cornerSize,p=typeof l.transparentCorners<"u"?l.transparentCorners:u.transparentCorners,m=p?"stroke":"fill",h=!p&&(l.cornerStrokeColor||u.cornerStrokeColor),b=d/2,x=f/2;a.save(),a.fillStyle=l.cornerColor||u.cornerColor,a.strokeStyle=l.cornerStrokeColor||u.cornerStrokeColor,a.lineWidth=1,a.translate(s,c),a.rotate(n(u.angle)),a[m+"Rect"](-b,-x,d,f),h&&a.strokeRect(-b,-x,d,f),a.restore()}o.renderCircleControl=r,o.renderSquareControl=i})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={});function n(o){for(var r in o)this[r]=o[r]}e.Control=n,e.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(o,r){return r.cursorStyle},getActionName:function(o,r){return r.actionName},getVisibility:function(o,r){var i=o._controlsVisibility;return i&&typeof i[r]<"u"?i[r]:this.visible},setVisibility:function(o){this.visible=o},positionHandler:function(o,r){var i=e.util.transformPoint({x:this.x*o.x+this.offsetX,y:this.y*o.y+this.offsetY},r);return i},calcCornerCoords:function(o,r,i,a,s){var c,l,u,d,f=s?this.touchSizeX:this.sizeX,p=s?this.touchSizeY:this.sizeY;if(f&&p&&f!==p){var m=Math.atan2(p,f),h=Math.sqrt(f*f+p*p)/2,b=m-e.util.degreesToRadians(o),x=Math.PI/2-m-e.util.degreesToRadians(o);c=h*e.util.cos(b),l=h*e.util.sin(b),u=h*e.util.cos(x),d=h*e.util.sin(x)}else{var T=f&&p?f:r;h=T*.7071067812;var b=e.util.degreesToRadians(45-o);c=u=h*e.util.cos(b),l=d=h*e.util.sin(b)}return{tl:{x:i-d,y:a-u},tr:{x:i+c,y:a-l},bl:{x:i-c,y:a+l},br:{x:i+d,y:a+u}}},render:function(o,r,i,a,s){switch(a=a||{},a.cornerStyle||s.cornerStyle){case"circle":e.controlsUtils.renderCircleControl.call(this,o,r,i,a,s);break;default:e.controlsUtils.renderSquareControl.call(this,o,r,i,a,s)}}}})(ae);(function(){function t(i,a){var s=i.getAttribute("style"),c=i.getAttribute("offset")||0,l,u,d,f;if(c=parseFloat(c)/(/%$/.test(c)?100:1),c=c<0?0:c>1?1:c,s){var p=s.split(/\s*;\s*/);for(p[p.length-1]===""&&p.pop(),f=p.length;f--;){var m=p[f].split(/\s*:\s*/),h=m[0].trim(),b=m[1].trim();h==="stop-color"?l=b:h==="stop-opacity"&&(d=b)}}return l||(l=i.getAttribute("stop-color")||"rgb(0,0,0)"),d||(d=i.getAttribute("stop-opacity")),l=new g.Color(l),u=l.getAlpha(),d=isNaN(parseFloat(d))?1:parseFloat(d),d*=u*a,{offset:c,color:l.toRgb(),opacity:d}}function e(i){return{x1:i.getAttribute("x1")||0,y1:i.getAttribute("y1")||0,x2:i.getAttribute("x2")||"100%",y2:i.getAttribute("y2")||0}}function n(i){return{x1:i.getAttribute("fx")||i.getAttribute("cx")||"50%",y1:i.getAttribute("fy")||i.getAttribute("cy")||"50%",r1:0,x2:i.getAttribute("cx")||"50%",y2:i.getAttribute("cy")||"50%",r2:i.getAttribute("r")||"50%"}}var o=g.util.object.clone;g.Gradient=g.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(i){i||(i={}),i.coords||(i.coords={});var a,s=this;Object.keys(i).forEach(function(c){s[c]=i[c]}),this.id?this.id+="_"+g.Object.__uid++:this.id=g.Object.__uid++,a={x1:i.coords.x1||0,y1:i.coords.y1||0,x2:i.coords.x2||0,y2:i.coords.y2||0},this.type==="radial"&&(a.r1=i.coords.r1||0,a.r2=i.coords.r2||0),this.coords=a,this.colorStops=i.colorStops.slice()},addColorStop:function(i){for(var a in i){var s=new g.Color(i[a]);this.colorStops.push({offset:parseFloat(a),color:s.toRgb(),opacity:s.getAlpha()})}return this},toObject:function(i){var a={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return g.util.populateWithProperties(this,a,i),a},toSVG:function(i,u){var s=o(this.coords,!0),c,l,u=u||{},d,f,p=o(this.colorStops,!0),m=s.r1>s.r2,h=this.gradientTransform?this.gradientTransform.concat():g.iMatrix.concat(),b=-this.offsetX,x=-this.offsetY,T=!!u.additionalTransform,B=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(p.sort(function(M,I){return M.offset-I.offset}),B==="objectBoundingBox"?(b/=i.width,x/=i.height):(b+=i.width/2,x+=i.height/2),i.type==="path"&&this.gradientUnits!=="percentage"&&(b-=i.pathOffset.x,x-=i.pathOffset.y),h[4]-=b,h[5]-=x,f='id="SVGID_'+this.id+'" gradientUnits="'+B+'"',f+=' gradientTransform="'+(T?u.additionalTransform+" ":"")+g.util.matrixToSVG(h)+'" ',this.type==="linear"?d=["<linearGradient ",f,' x1="',s.x1,'" y1="',s.y1,'" x2="',s.x2,'" y2="',s.y2,`">
`]:this.type==="radial"&&(d=["<radialGradient ",f,' cx="',m?s.x1:s.x2,'" cy="',m?s.y1:s.y2,'" r="',m?s.r1:s.r2,'" fx="',m?s.x2:s.x1,'" fy="',m?s.y2:s.y1,`">
`]),this.type==="radial"){if(m)for(p=p.concat(),p.reverse(),c=0,l=p.length;c<l;c++)p[c].offset=1-p[c].offset;var A=Math.min(s.r1,s.r2);if(A>0){var S=Math.max(s.r1,s.r2),H=A/S;for(c=0,l=p.length;c<l;c++)p[c].offset+=H*(1-p[c].offset)}}for(c=0,l=p.length;c<l;c++){var j=p[c];d.push("<stop ",'offset="',j.offset*100+"%",'" style="stop-color:',j.color,typeof j.opacity<"u"?";stop-opacity: "+j.opacity:";",`"/>
`)}return d.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),d.join("")},toLive:function(i){var a,s=g.util.object.clone(this.coords),c,l;if(this.type){for(this.type==="linear"?a=i.createLinearGradient(s.x1,s.y1,s.x2,s.y2):this.type==="radial"&&(a=i.createRadialGradient(s.x1,s.y1,s.r1,s.x2,s.y2,s.r2)),c=0,l=this.colorStops.length;c<l;c++){var u=this.colorStops[c].color,d=this.colorStops[c].opacity,f=this.colorStops[c].offset;typeof d<"u"&&(u=new g.Color(u).setAlpha(d).toRgba()),a.addColorStop(f,u)}return a}}}),g.util.object.extend(g.Gradient,{fromElement:function(i,a,s,c){var l=parseFloat(s)/(/%$/.test(s)?100:1);l=l<0?0:l>1?1:l,isNaN(l)&&(l=1);var u=i.getElementsByTagName("stop"),d,f=i.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",p=i.getAttribute("gradientTransform")||"",m=[],h,b,x=0,T=0,B;for(i.nodeName==="linearGradient"||i.nodeName==="LINEARGRADIENT"?(d="linear",h=e(i)):(d="radial",h=n(i)),b=u.length;b--;)m.push(t(u[b],l));B=g.parseTransformAttribute(p),r(a,h,c,f),f==="pixels"&&(x=-a.left,T=-a.top);var A=new g.Gradient({id:i.getAttribute("id"),type:d,coords:h,colorStops:m,gradientUnits:f,gradientTransform:B,offsetX:x,offsetY:T});return A}});function r(i,a,s,c){var l,u;Object.keys(a).forEach(function(d){l=a[d],l==="Infinity"?u=1:l==="-Infinity"?u=0:(u=parseFloat(a[d],10),typeof l=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(l)&&(u*=.01,c==="pixels"&&((d==="x1"||d==="x2"||d==="r2")&&(u*=s.viewBoxWidth||s.width),(d==="y1"||d==="y2")&&(u*=s.viewBoxHeight||s.height)))),a[d]=u})}})();(function(){"use strict";var t=g.util.toFixed;g.Pattern=g.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(e,n){if(e||(e={}),this.id=g.Object.__uid++,this.setOptions(e),!e.source||e.source&&typeof e.source!="string"){n&&n(this);return}else{var o=this;this.source=g.util.createImage(),g.util.loadImage(e.source,function(r,i){o.source=r,n&&n(o,i)},null,this.crossOrigin)}},toObject:function(e){var n=g.Object.NUM_FRACTION_DIGITS,o,r;return typeof this.source.src=="string"?o=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(o=this.source.toDataURL()),r={type:"pattern",source:o,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:t(this.offsetX,n),offsetY:t(this.offsetY,n),patternTransform:this.patternTransform?this.patternTransform.concat():null},g.util.populateWithProperties(this,r,e),r},toSVG:function(e){var n=typeof this.source=="function"?this.source():this.source,o=n.width/e.width,r=n.height/e.height,i=this.offsetX/e.width,a=this.offsetY/e.height,s="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&(r=1,a&&(r+=Math.abs(a))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(o=1,i&&(o+=Math.abs(i))),n.src?s=n.src:n.toDataURL&&(s=n.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+i+'" y="'+a+'" width="'+o+'" height="'+r+`">
<image x="0" y="0" width="`+n.width+'" height="'+n.height+'" xlink:href="'+s+`"></image>
</pattern>
`},setOptions:function(e){for(var n in e)this[n]=e[n]},toLive:function(e){var n=this.source;return!n||typeof n.src<"u"&&(!n.complete||n.naturalWidth===0||n.naturalHeight===0)?"":e.createPattern(n,this.repeat)}})})();(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.toFixed;if(e.Shadow){e.warn("fabric.Shadow is already defined.");return}e.Shadow=e.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(o){typeof o=="string"&&(o=this._parseShadow(o));for(var r in o)this[r]=o[r];this.id=e.Object.__uid++},_parseShadow:function(o){var r=o.trim(),i=e.Shadow.reOffsetsAndBlur.exec(r)||[],a=r.replace(e.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:a.trim(),offsetX:parseFloat(i[1],10)||0,offsetY:parseFloat(i[2],10)||0,blur:parseFloat(i[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(o){var r=40,i=40,a=e.Object.NUM_FRACTION_DIGITS,s=e.util.rotateVector({x:this.offsetX,y:this.offsetY},e.util.degreesToRadians(-o.angle)),c=20,l=new e.Color(this.color);return o.width&&o.height&&(r=n((Math.abs(s.x)+this.blur)/o.width,a)*100+c,i=n((Math.abs(s.y)+this.blur)/o.height,a)*100+c),o.flipX&&(s.x*=-1),o.flipY&&(s.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+i+'%" height="'+(100+2*i)+'%" x="-'+r+'%" width="'+(100+2*r)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+n(this.blur?this.blur/2:0,a)+`"></feGaussianBlur>
	<feOffset dx="`+n(s.x,a)+'" dy="'+n(s.y,a)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+l.toRgb()+'" flood-opacity="'+l.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var o={},r=e.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(i){this[i]!==r[i]&&(o[i]=this[i])},this),o}}),e.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/})(ae);(function(){"use strict";if(g.StaticCanvas){g.warn("fabric.StaticCanvas is already defined.");return}var t=g.util.object.extend,e=g.util.getElementOffset,n=g.util.removeFromArray,o=g.util.toFixed,r=g.util.transformPoint,i=g.util.invertTransform,a=g.util.getNodeCanvas,s=g.util.createCanvasElement,c=new Error("Could not initialize `canvas` element");g.StaticCanvas=g.util.createClass(g.CommonMethods,{initialize:function(l,u){u||(u={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(l,u)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:g.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(l,u){var d=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(l),this._initOptions(u),this.interactive||this._initRetinaScaling(),u.overlayImage&&this.setOverlayImage(u.overlayImage,d),u.backgroundImage&&this.setBackgroundImage(u.backgroundImage,d),u.backgroundColor&&this.setBackgroundColor(u.backgroundColor,d),u.overlayColor&&this.setOverlayColor(u.overlayColor,d),this.calcOffset()},_isRetinaScaling:function(){return g.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,g.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var l=g.devicePixelRatio;this.__initRetinaScaling(l,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(l,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(l,u,d){u.setAttribute("width",this.width*l),u.setAttribute("height",this.height*l),d.scale(l,l)},calcOffset:function(){return this._offset=e(this.lowerCanvasEl),this},setOverlayImage:function(l,u,d){return this.__setBgOverlayImage("overlayImage",l,u,d)},setBackgroundImage:function(l,u,d){return this.__setBgOverlayImage("backgroundImage",l,u,d)},setOverlayColor:function(l,u){return this.__setBgOverlayColor("overlayColor",l,u)},setBackgroundColor:function(l,u){return this.__setBgOverlayColor("backgroundColor",l,u)},__setBgOverlayImage:function(l,u,d,f){return typeof u=="string"?g.util.loadImage(u,function(p,m){if(p){var h=new g.Image(p,f);this[l]=h,h.canvas=this}d&&d(p,m)},this,f&&f.crossOrigin):(f&&u.setOptions(f),this[l]=u,u&&(u.canvas=this),d&&d(u,!1)),this},__setBgOverlayColor:function(l,u,d){return this[l]=u,this._initGradient(u,l),this._initPattern(u,l,d),this},_createCanvasElement:function(){var l=s();if(!l||(l.style||(l.style={}),typeof l.getContext>"u"))throw c;return l},_initOptions:function(l){var u=this.lowerCanvasEl;this._setOptions(l),this.width=this.width||parseInt(u.width,10)||0,this.height=this.height||parseInt(u.height,10)||0,this.lowerCanvasEl.style&&(u.width=this.width,u.height=this.height,u.style.width=this.width+"px",u.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(l){l&&l.getContext?this.lowerCanvasEl=l:this.lowerCanvasEl=g.util.getById(l)||this._createCanvasElement(),g.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(l,u){return this.setDimensions({width:l},u)},setHeight:function(l,u){return this.setDimensions({height:l},u)},setDimensions:function(l,u){var d;u=u||{};for(var f in l)d=l[f],u.cssOnly||(this._setBackstoreDimension(f,l[f]),d+="px",this.hasLostContext=!0),u.backstoreOnly||this._setCssDimension(f,d);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),u.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(l,u){return this.lowerCanvasEl[l]=u,this.upperCanvasEl&&(this.upperCanvasEl[l]=u),this.cacheCanvasEl&&(this.cacheCanvasEl[l]=u),this[l]=u,this},_setCssDimension:function(l,u){return this.lowerCanvasEl.style[l]=u,this.upperCanvasEl&&(this.upperCanvasEl.style[l]=u),this.wrapperEl&&(this.wrapperEl.style[l]=u),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(l){var u=this._activeObject,d=this.backgroundImage,f=this.overlayImage,p,m,h;for(this.viewportTransform=l,m=0,h=this._objects.length;m<h;m++)p=this._objects[m],p.group||p.setCoords(!0);return u&&u.setCoords(),d&&d.setCoords(!0),f&&f.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(l,u){var d=l,f=this.viewportTransform.slice(0);l=r(l,i(this.viewportTransform)),f[0]=u,f[3]=u;var p=r(l,f);return f[4]+=d.x-p.x,f[5]+=d.y-p.y,this.setViewportTransform(f)},setZoom:function(l){return this.zoomToPoint(new g.Point(0,0),l),this},absolutePan:function(l){var u=this.viewportTransform.slice(0);return u[4]=-l.x,u[5]=-l.y,this.setViewportTransform(u)},relativePan:function(l){return this.absolutePan(new g.Point(-l.x-this.viewportTransform[4],-l.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(l){this.stateful&&l.setupState(),l._set("canvas",this),l.setCoords(),this.fire("object:added",{target:l}),l.fire("added")},_onObjectRemoved:function(l){this.fire("object:removed",{target:l}),l.fire("removed"),delete l.canvas},clearContext:function(l){return l.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var l=this.contextContainer;return this.renderCanvas(l,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=g.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var l={},u=this.width,d=this.height,f=i(this.viewportTransform);return l.tl=r({x:0,y:0},f),l.br=r({x:u,y:d},f),l.tr=new g.Point(l.br.x,l.tl.y),l.bl=new g.Point(l.tl.x,l.br.y),this.vptCoords=l,l},cancelRequestedRender:function(){this.isRendering&&(g.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(l,u){var d=this.viewportTransform,f=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(l),g.util.setImageSmoothing(l,this.imageSmoothingEnabled),this.fire("before:render",{ctx:l}),this._renderBackground(l),l.save(),l.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._renderObjects(l,u),l.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(l),f&&(f.canvas=this,f.shouldCache(),f._transformDone=!0,f.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(l)),this._renderOverlay(l),this.controlsAboveOverlay&&this.interactive&&this.drawControls(l),this.fire("after:render",{ctx:l})},drawClipPathOnCanvas:function(l){var u=this.viewportTransform,d=this.clipPath;l.save(),l.transform(u[0],u[1],u[2],u[3],u[4],u[5]),l.globalCompositeOperation="destination-in",d.transform(l),l.scale(1/d.zoomX,1/d.zoomY),l.drawImage(d._cacheCanvas,-d.cacheTranslationX,-d.cacheTranslationY),l.restore()},_renderObjects:function(l,u){var d,f;for(d=0,f=u.length;d<f;++d)u[d]&&u[d].render(l)},_renderBackgroundOrOverlay:function(l,u){var d=this[u+"Color"],f=this[u+"Image"],p=this.viewportTransform,m=this[u+"Vpt"];if(!(!d&&!f)){if(d){l.save(),l.beginPath(),l.moveTo(0,0),l.lineTo(this.width,0),l.lineTo(this.width,this.height),l.lineTo(0,this.height),l.closePath(),l.fillStyle=d.toLive?d.toLive(l,this):d,m&&l.transform(p[0],p[1],p[2],p[3],p[4],p[5]),l.transform(1,0,0,1,d.offsetX||0,d.offsetY||0);var h=d.gradientTransform||d.patternTransform;h&&l.transform(h[0],h[1],h[2],h[3],h[4],h[5]),l.fill(),l.restore()}f&&(l.save(),m&&l.transform(p[0],p[1],p[2],p[3],p[4],p[5]),f.render(l),l.restore())}},_renderBackground:function(l){this._renderBackgroundOrOverlay(l,"background")},_renderOverlay:function(l){this._renderBackgroundOrOverlay(l,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new g.Point(this.width/2,this.height/2)},centerObjectH:function(l){return this._centerObject(l,new g.Point(this.getCenterPoint().x,l.getCenterPoint().y))},centerObjectV:function(l){return this._centerObject(l,new g.Point(l.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(l){var u=this.getCenterPoint();return this._centerObject(l,u)},viewportCenterObject:function(l){var u=this.getVpCenter();return this._centerObject(l,u)},viewportCenterObjectH:function(l){var u=this.getVpCenter();return this._centerObject(l,new g.Point(u.x,l.getCenterPoint().y)),this},viewportCenterObjectV:function(l){var u=this.getVpCenter();return this._centerObject(l,new g.Point(l.getCenterPoint().x,u.y))},getVpCenter:function(){var l=this.getCenterPoint(),u=i(this.viewportTransform);return r(l,u)},_centerObject:function(l,u){return l.setPositionByOrigin(u,"center","center"),l.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(l){return this.toDatalessObject(l)},toObject:function(l){return this._toObjectMethod("toObject",l)},toDatalessObject:function(l){return this._toObjectMethod("toDatalessObject",l)},_toObjectMethod:function(l,u){var d=this.clipPath,f={version:g.version,objects:this._toObjects(l,u)};return d&&!d.excludeFromExport&&(f.clipPath=this._toObject(this.clipPath,l,u)),t(f,this.__serializeBgOverlay(l,u)),g.util.populateWithProperties(this,f,u),f},_toObjects:function(l,u){return this._objects.filter(function(d){return!d.excludeFromExport}).map(function(d){return this._toObject(d,l,u)},this)},_toObject:function(l,u,d){var f;this.includeDefaultValues||(f=l.includeDefaultValues,l.includeDefaultValues=!1);var p=l[u](d);return this.includeDefaultValues||(l.includeDefaultValues=f),p},__serializeBgOverlay:function(l,u){var d={},f=this.backgroundImage,p=this.overlayImage,m=this.backgroundColor,h=this.overlayColor;return m&&m.toObject?m.excludeFromExport||(d.background=m.toObject(u)):m&&(d.background=m),h&&h.toObject?h.excludeFromExport||(d.overlay=h.toObject(u)):h&&(d.overlay=h),f&&!f.excludeFromExport&&(d.backgroundImage=this._toObject(f,l,u)),p&&!p.excludeFromExport&&(d.overlayImage=this._toObject(p,l,u)),d},svgViewportTransformation:!0,toSVG:function(l,u){l||(l={}),l.reviver=u;var d=[];return this._setSVGPreamble(d,l),this._setSVGHeader(d,l),this.clipPath&&d.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(d,"background"),this._setSVGBgOverlayImage(d,"backgroundImage",u),this._setSVGObjects(d,u),this.clipPath&&d.push(`</g>
`),this._setSVGBgOverlayColor(d,"overlay"),this._setSVGBgOverlayImage(d,"overlayImage",u),d.push("</svg>"),d.join("")},_setSVGPreamble:function(l,u){u.suppressPreamble||l.push('<?xml version="1.0" encoding="',u.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(l,u){var d=u.width||this.width,f=u.height||this.height,p,m='viewBox="0 0 '+this.width+" "+this.height+'" ',h=g.Object.NUM_FRACTION_DIGITS;u.viewBox?m='viewBox="'+u.viewBox.x+" "+u.viewBox.y+" "+u.viewBox.width+" "+u.viewBox.height+'" ':this.svgViewportTransformation&&(p=this.viewportTransform,m='viewBox="'+o(-p[4]/p[0],h)+" "+o(-p[5]/p[3],h)+" "+o(this.width/p[0],h)+" "+o(this.height/p[3],h)+'" '),l.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',d,'" ','height="',f,'" ',m,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",g.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(u),`</defs>
`)},createSVGClipPathMarkup:function(l){var u=this.clipPath;return u?(u.clipPathId="CLIPPATH_"+g.Object.__uid++,'<clipPath id="'+u.clipPathId+`" >
`+this.clipPath.toClipPathSVG(l.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var l=this,u=["background","overlay"].map(function(d){var f=l[d+"Color"];if(f&&f.toLive){var p=l[d+"Vpt"],m=l.viewportTransform,h={width:l.width/(p?m[0]:1),height:l.height/(p?m[3]:1)};return f.toSVG(h,{additionalTransform:p?g.util.matrixToSVG(m):""})}});return u.join("")},createSVGFontFacesMarkup:function(){var l="",u={},d,f,p,m,h,b,x,T,B,A=g.fontPaths,S=[];for(this._objects.forEach(function j(M){S.push(M),M._objects&&M._objects.forEach(j)}),T=0,B=S.length;T<B;T++)if(d=S[T],f=d.fontFamily,!(d.type.indexOf("text")===-1||u[f]||!A[f])&&(u[f]=!0,!!d.styles)){p=d.styles;for(h in p){m=p[h];for(x in m)b=m[x],f=b.fontFamily,!u[f]&&A[f]&&(u[f]=!0)}}for(var H in u)l+=[`		@font-face {
`,"			font-family: '",H,`';
`,"			src: url('",A[H],`');
`,`		}
`].join("");return l&&(l=['	<style type="text/css">',`<![CDATA[
`,l,"]]>",`</style>
`].join("")),l},_setSVGObjects:function(l,u){var d,f,p,m=this._objects;for(f=0,p=m.length;f<p;f++)d=m[f],!d.excludeFromExport&&this._setSVGObject(l,d,u)},_setSVGObject:function(l,u,d){l.push(u.toSVG(d))},_setSVGBgOverlayImage:function(l,u,d){this[u]&&!this[u].excludeFromExport&&this[u].toSVG&&l.push(this[u].toSVG(d))},_setSVGBgOverlayColor:function(l,u){var d=this[u+"Color"],f=this.viewportTransform,p=this.width,m=this.height;if(d)if(d.toLive){var h=d.repeat,b=g.util.invertTransform(f),x=this[u+"Vpt"],T=x?g.util.matrixToSVG(b):"";l.push('<rect transform="'+T+" translate(",p/2,",",m/2,')"',' x="',d.offsetX-p/2,'" y="',d.offsetY-m/2,'" ','width="',h==="repeat-y"||h==="no-repeat"?d.source.width:p,'" height="',h==="repeat-x"||h==="no-repeat"?d.source.height:m,'" fill="url(#SVGID_'+d.id+')"',`></rect>
`)}else l.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',d,'"',`></rect>
`)},sendToBack:function(l){if(!l)return this;var u=this._activeObject,d,f,p;if(l===u&&l.type==="activeSelection")for(p=u._objects,d=p.length;d--;)f=p[d],n(this._objects,f),this._objects.unshift(f);else n(this._objects,l),this._objects.unshift(l);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(l){if(!l)return this;var u=this._activeObject,d,f,p;if(l===u&&l.type==="activeSelection")for(p=u._objects,d=0;d<p.length;d++)f=p[d],n(this._objects,f),this._objects.push(f);else n(this._objects,l),this._objects.push(l);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(l,u){if(!l)return this;var d=this._activeObject,f,p,m,h,b,x=0;if(l===d&&l.type==="activeSelection")for(b=d._objects,f=0;f<b.length;f++)p=b[f],m=this._objects.indexOf(p),m>0+x&&(h=m-1,n(this._objects,p),this._objects.splice(h,0,p)),x++;else m=this._objects.indexOf(l),m!==0&&(h=this._findNewLowerIndex(l,m,u),n(this._objects,l),this._objects.splice(h,0,l));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(l,u,d){var f,p;if(d)for(f=u,p=u-1;p>=0;--p){var m=l.intersectsWithObject(this._objects[p])||l.isContainedWithinObject(this._objects[p])||this._objects[p].isContainedWithinObject(l);if(m){f=p;break}}else f=u-1;return f},bringForward:function(l,u){if(!l)return this;var d=this._activeObject,f,p,m,h,b,x=0;if(l===d&&l.type==="activeSelection")for(b=d._objects,f=b.length;f--;)p=b[f],m=this._objects.indexOf(p),m<this._objects.length-1-x&&(h=m+1,n(this._objects,p),this._objects.splice(h,0,p)),x++;else m=this._objects.indexOf(l),m!==this._objects.length-1&&(h=this._findNewUpperIndex(l,m,u),n(this._objects,l),this._objects.splice(h,0,l));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(l,u,d){var f,p,m;if(d)for(f=u,p=u+1,m=this._objects.length;p<m;++p){var h=l.intersectsWithObject(this._objects[p])||l.isContainedWithinObject(this._objects[p])||this._objects[p].isContainedWithinObject(l);if(h){f=p;break}}else f=u+1;return f},moveTo:function(l,u){return n(this._objects,l),this._objects.splice(u,0,l),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(g.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(l){l.dispose&&l.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),g.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),g.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),t(g.StaticCanvas.prototype,g.Observable),t(g.StaticCanvas.prototype,g.Collection),t(g.StaticCanvas.prototype,g.DataURLExporter),t(g.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(l){var u=s();if(!u||!u.getContext)return null;var d=u.getContext("2d");if(!d)return null;switch(l){case"setLineDash":return typeof d.setLineDash<"u";default:return null}}}),g.StaticCanvas.prototype.toJSON=g.StaticCanvas.prototype.toObject,g.isLikelyNode&&(g.StaticCanvas.prototype.createPNGStream=function(){var l=a(this.lowerCanvasEl);return l&&l.createPNGStream()},g.StaticCanvas.prototype.createJPEGStream=function(l){var u=a(this.lowerCanvasEl);return u&&u.createJPEGStream(l)})})();g.BaseBrush=g.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(t){t.strokeStyle=this.color,t.lineWidth=this.width,t.lineCap=this.strokeLineCap,t.miterLimit=this.strokeMiterLimit,t.lineJoin=this.strokeLineJoin,t.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(t){var e=this.canvas.viewportTransform;t.save(),t.transform(e[0],e[1],e[2],e[3],e[4],e[5])},_setShadow:function(){if(this.shadow){var t=this.canvas,e=this.shadow,n=t.contextTop,o=t.getZoom();t&&t._isRetinaScaling()&&(o*=g.devicePixelRatio),n.shadowColor=e.color,n.shadowBlur=e.blur*o,n.shadowOffsetX=e.offsetX*o,n.shadowOffsetY=e.offsetY*o}},needsFullRender:function(){var t=new g.Color(this.color);return t.getAlpha()<1||!!this.shadow},_resetShadow:function(){var t=this.canvas.contextTop;t.shadowColor="",t.shadowBlur=t.shadowOffsetX=t.shadowOffsetY=0},_isOutSideCanvas:function(t){return t.x<0||t.x>this.canvas.getWidth()||t.y<0||t.y>this.canvas.getHeight()}});(function(){g.PencilBrush=g.util.createClass(g.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(t){this.canvas=t,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(t,e,n){var o=e.midPointFrom(n);return t.quadraticCurveTo(e.x,e.y,o.x,o.y),o},onMouseDown:function(t,e){this.canvas._isMainEvent(e.e)&&(this.drawStraightLine=e.e[this.straightLineKey],this._prepareForDrawing(t),this._captureDrawingPath(t),this._render())},onMouseMove:function(t,e){if(this.canvas._isMainEvent(e.e)&&(this.drawStraightLine=e.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(t))&&this._captureDrawingPath(t)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var n=this._points,o=n.length,r=this.canvas.contextTop;this._saveAndTransform(r),this.oldEnd&&(r.beginPath(),r.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(r,n[o-2],n[o-1],!0),r.stroke(),r.restore()}},onMouseUp:function(t){return this.canvas._isMainEvent(t.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(t){var e=new g.Point(t.x,t.y);this._reset(),this._addPoint(e),this.canvas.contextTop.moveTo(e.x,e.y)},_addPoint:function(t){return this._points.length>1&&t.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(t),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(t){var e=new g.Point(t.x,t.y);return this._addPoint(e)},_render:function(t){var e,n,o=this._points[0],r=this._points[1];if(t=t||this.canvas.contextTop,this._saveAndTransform(t),t.beginPath(),this._points.length===2&&o.x===r.x&&o.y===r.y){var i=this.width/1e3;o=new g.Point(o.x,o.y),r=new g.Point(r.x,r.y),o.x-=i,r.x+=i}for(t.moveTo(o.x,o.y),e=1,n=this._points.length;e<n;e++)this._drawSegment(t,o,r),o=this._points[e],r=this._points[e+1];t.lineTo(o.x,o.y),t.stroke(),t.restore()},convertPointsToSVGPath:function(t){var e=this.width/1e3;return g.util.getSmoothPathFromPoints(t,e)},_isEmptySVGPath:function(t){var e=g.util.joinPath(t);return e==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(t){var e=new g.Path(t,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,e.shadow=new g.Shadow(this.shadow)),e},decimatePoints:function(t,e){if(t.length<=2)return t;var n=this.canvas.getZoom(),o=Math.pow(e/n,2),r,i=t.length-1,a=t[0],s=[a],c;for(r=1;r<i-1;r++)c=Math.pow(a.x-t[r].x,2)+Math.pow(a.y-t[r].y,2),c>=o&&(a=t[r],s.push(a));return s.push(t[i]),s},_finalizeAndAddPath:function(){var t=this.canvas.contextTop;t.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var e=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(e)){this.canvas.requestRenderAll();return}var n=this.createPath(e);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:n}),this.canvas.add(n),this.canvas.requestRenderAll(),n.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:n})}})})();g.CircleBrush=g.util.createClass(g.BaseBrush,{width:10,initialize:function(t){this.canvas=t,this.points=[]},drawDot:function(t){var e=this.addPoint(t),n=this.canvas.contextTop;this._saveAndTransform(n),this.dot(n,e),n.restore()},dot:function(t,e){t.fillStyle=e.fill,t.beginPath(),t.arc(e.x,e.y,e.radius,0,Math.PI*2,!1),t.closePath(),t.fill()},onMouseDown:function(t){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(t)},_render:function(){var t=this.canvas.contextTop,e,n,o=this.points;for(this._saveAndTransform(t),e=0,n=o.length;e<n;e++)this.dot(t,o[e]);t.restore()},onMouseMove:function(t){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(t)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(t),this._render()):this.drawDot(t))},onMouseUp:function(){var t=this.canvas.renderOnAddRemove,e,n;this.canvas.renderOnAddRemove=!1;var o=[];for(e=0,n=this.points.length;e<n;e++){var r=this.points[e],i=new g.Circle({radius:r.radius,left:r.x,top:r.y,originX:"center",originY:"center",fill:r.fill});this.shadow&&(i.shadow=new g.Shadow(this.shadow)),o.push(i)}var a=new g.Group(o);a.canvas=this.canvas,this.canvas.fire("before:path:created",{path:a}),this.canvas.add(a),this.canvas.fire("path:created",{path:a}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.requestRenderAll()},addPoint:function(t){var e=new g.Point(t.x,t.y),n=g.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,o=new g.Color(this.color).setAlpha(g.util.getRandomInt(0,100)/100).toRgba();return e.radius=n,e.fill=o,this.points.push(e),e}});g.SprayBrush=g.util.createClass(g.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(t){this.canvas=t,this.sprayChunks=[]},onMouseDown:function(t){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(t),this.render(this.sprayChunkPoints)},onMouseMove:function(t){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(t)||(this.addSprayChunk(t),this.render(this.sprayChunkPoints))},onMouseUp:function(){var t=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var e=[],n=0,o=this.sprayChunks.length;n<o;n++)for(var r=this.sprayChunks[n],i=0,a=r.length;i<a;i++){var s=new g.Rect({width:r[i].width,height:r[i].width,left:r[i].x+1,top:r[i].y+1,originX:"center",originY:"center",fill:this.color});e.push(s)}this.optimizeOverlapping&&(e=this._getOptimizedRects(e));var c=new g.Group(e);this.shadow&&c.set("shadow",new g.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:c}),this.canvas.add(c),this.canvas.fire("path:created",{path:c}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=t,this.canvas.requestRenderAll()},_getOptimizedRects:function(t){var e={},n,o,r;for(o=0,r=t.length;o<r;o++)n=t[o].left+""+t[o].top,e[n]||(e[n]=t[o]);var i=[];for(n in e)i.push(e[n]);return i},render:function(t){var e=this.canvas.contextTop,n,o;for(e.fillStyle=this.color,this._saveAndTransform(e),n=0,o=t.length;n<o;n++){var r=t[n];typeof r.opacity<"u"&&(e.globalAlpha=r.opacity),e.fillRect(r.x,r.y,r.width,r.width)}e.restore()},_render:function(){var t=this.canvas.contextTop,e,n;for(t.fillStyle=this.color,this._saveAndTransform(t),e=0,n=this.sprayChunks.length;e<n;e++)this.render(this.sprayChunks[e]);t.restore()},addSprayChunk:function(t){this.sprayChunkPoints=[];var e,n,o,r=this.width/2,i;for(i=0;i<this.density;i++){e=g.util.getRandomInt(t.x-r,t.x+r),n=g.util.getRandomInt(t.y-r,t.y+r),this.dotWidthVariance?o=g.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):o=this.dotWidth;var a=new g.Point(e,n);a.width=o,this.randomOpacity&&(a.opacity=g.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(a)}this.sprayChunks.push(this.sprayChunkPoints)}});g.PatternBrush=g.util.createClass(g.PencilBrush,{getPatternSrc:function(){var t=20,e=5,n=g.util.createCanvasElement(),o=n.getContext("2d");return n.width=n.height=t+e,o.fillStyle=this.color,o.beginPath(),o.arc(t/2,t/2,t/2,0,Math.PI*2,!1),o.closePath(),o.fill(),n},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(t){return t.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(t){this.callSuper("_setBrushStyles",t),t.strokeStyle=this.getPattern(t)},createPath:function(t){var e=this.callSuper("createPath",t),n=e._getLeftTopCoords().scalarAdd(e.strokeWidth/2);return e.stroke=new g.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-n.x,offsetY:-n.y}),e}});(function(){var t=g.util.getPointer,e=g.util.degreesToRadians,n=g.util.isTouchEvent;g.Canvas=g.util.createClass(g.StaticCanvas,{initialize:function(r,i){i||(i={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(r,i),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=g.PencilBrush&&new g.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var r=this.getActiveObjects(),i,a,s;if(r.length>0&&!this.preserveObjectStacking){a=[],s=[];for(var c=0,l=this._objects.length;c<l;c++)i=this._objects[c],r.indexOf(i)===-1?a.push(i):s.push(i);r.length>1&&(this._activeObject._objects=s),a.push.apply(a,s)}else a=this._objects;return a},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var r=this.contextContainer;return this.renderCanvas(r,this._chooseObjectsToRender()),this},renderTopLayer:function(r){r.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(r),this.contextTopDirty=!0),r.restore()},renderTop:function(){var r=this.contextTop;return this.clearContext(r),this.renderTopLayer(r),this.fire("after:render"),this},_normalizePointer:function(r,i){var a=r.calcTransformMatrix(),s=g.util.invertTransform(a),c=this.restorePointerVpt(i);return g.util.transformPoint(c,s)},isTargetTransparent:function(r,i,a){if(r.shouldCache()&&r._cacheCanvas&&r!==this._activeObject){var s=this._normalizePointer(r,{x:i,y:a}),c=Math.max(r.cacheTranslationX+s.x*r.zoomX,0),l=Math.max(r.cacheTranslationY+s.y*r.zoomY,0),p=g.util.isTransparent(r._cacheContext,Math.round(c),Math.round(l),this.targetFindTolerance);return p}var u=this.contextCache,d=r.selectionBackgroundColor,f=this.viewportTransform;r.selectionBackgroundColor="",this.clearContext(u),u.save(),u.transform(f[0],f[1],f[2],f[3],f[4],f[5]),r.render(u),u.restore(),r.selectionBackgroundColor=d;var p=g.util.isTransparent(u,i,a,this.targetFindTolerance);return p},_isSelectionKeyPressed:function(r){var i=!1;return Array.isArray(this.selectionKey)?i=!!this.selectionKey.find(function(a){return r[a]===!0}):i=r[this.selectionKey],i},_shouldClearSelection:function(r,i){var a=this.getActiveObjects(),s=this._activeObject;return!i||i&&s&&a.length>1&&a.indexOf(i)===-1&&s!==i&&!this._isSelectionKeyPressed(r)||i&&!i.evented||i&&!i.selectable&&s&&s!==i},_shouldCenterTransform:function(r,i,a){if(r){var s;return i==="scale"||i==="scaleX"||i==="scaleY"||i==="resizing"?s=this.centeredScaling||r.centeredScaling:i==="rotate"&&(s=this.centeredRotation||r.centeredRotation),s?!a:a}},_getOriginFromCorner:function(r,i){var a={x:r.originX,y:r.originY};return i==="ml"||i==="tl"||i==="bl"?a.x="right":(i==="mr"||i==="tr"||i==="br")&&(a.x="left"),i==="tl"||i==="mt"||i==="tr"?a.y="bottom":(i==="bl"||i==="mb"||i==="br")&&(a.y="top"),a},_getActionFromCorner:function(r,i,a,s){if(!i||!r)return"drag";var c=s.controls[i];return c.getActionName(a,c,s)},_setupCurrentTransform:function(r,i,a){if(i){var s=this.getPointer(r),c=i.__corner,l=i.controls[c],u=a&&c?l.getActionHandler(r,i,l):g.controlsUtils.dragHandler,d=this._getActionFromCorner(a,c,r,i),f=this._getOriginFromCorner(i,c),p=r[this.centeredKey],m={target:i,action:d,actionHandler:u,corner:c,scaleX:i.scaleX,scaleY:i.scaleY,skewX:i.skewX,skewY:i.skewY,offsetX:s.x-i.left,offsetY:s.y-i.top,originX:f.x,originY:f.y,ex:s.x,ey:s.y,lastX:s.x,lastY:s.y,theta:e(i.angle),width:i.width*i.scaleX,shiftKey:r.shiftKey,altKey:p,original:g.util.saveObjectTransform(i)};this._shouldCenterTransform(i,d,p)&&(m.originX="center",m.originY="center"),m.original.originX=f.x,m.original.originY=f.y,this._currentTransform=m,this._beforeTransform(r)}},setCursor:function(r){this.upperCanvasEl.style.cursor=r},_drawSelection:function(r){var i=this._groupSelector,a=new g.Point(i.ex,i.ey),s=g.util.transformPoint(a,this.viewportTransform),c=new g.Point(i.ex+i.left,i.ey+i.top),l=g.util.transformPoint(c,this.viewportTransform),u=Math.min(s.x,l.x),d=Math.min(s.y,l.y),f=Math.max(s.x,l.x),p=Math.max(s.y,l.y),m=this.selectionLineWidth/2;this.selectionColor&&(r.fillStyle=this.selectionColor,r.fillRect(u,d,f-u,p-d)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&(r.lineWidth=this.selectionLineWidth,r.strokeStyle=this.selectionBorderColor,u+=m,d+=m,f-=m,p-=m,g.Object.prototype._setLineDash.call(this,r,this.selectionDashArray),r.strokeRect(u,d,f-u,p-d))},findTarget:function(r,i){if(!this.skipTargetFind){var a=!0,s=this.getPointer(r,a),c=this._activeObject,l=this.getActiveObjects(),u,d,f=n(r),p=l.length>1&&!i||l.length===1;if(this.targets=[],p&&c._findTargetCorner(s,f)||l.length>1&&!i&&c===this._searchPossibleTargets([c],s))return c;if(l.length===1&&c===this._searchPossibleTargets([c],s))if(this.preserveObjectStacking)u=c,d=this.targets,this.targets=[];else return c;var m=this._searchPossibleTargets(this._objects,s);return r[this.altSelectionKey]&&m&&u&&m!==u&&(m=u,this.targets=d),m}},_checkTarget:function(r,i,a){if(i&&i.visible&&i.evented&&i.containsPoint(r))if((this.perPixelTargetFind||i.perPixelTargetFind)&&!i.isEditing){var s=this.isTargetTransparent(i,a.x,a.y);if(!s)return!0}else return!0},_searchPossibleTargets:function(r,i){for(var a,s=r.length,c;s--;){var l=r[s],u=l.group?this._normalizePointer(l.group,i):i;if(this._checkTarget(u,l,i)){a=r[s],a.subTargetCheck&&a instanceof g.Group&&(c=this._searchPossibleTargets(a._objects,i),c&&this.targets.push(c));break}}return a},restorePointerVpt:function(r){return g.util.transformPoint(r,g.util.invertTransform(this.viewportTransform))},getPointer:function(r,i){if(this._absolutePointer&&!i)return this._absolutePointer;if(this._pointer&&i)return this._pointer;var a=t(r),s=this.upperCanvasEl,c=s.getBoundingClientRect(),l=c.width||0,u=c.height||0,d;(!l||!u)&&("top"in c&&"bottom"in c&&(u=Math.abs(c.top-c.bottom)),"right"in c&&"left"in c&&(l=Math.abs(c.right-c.left))),this.calcOffset(),a.x=a.x-this._offset.left,a.y=a.y-this._offset.top,i||(a=this.restorePointerVpt(a));var f=this.getRetinaScaling();return f!==1&&(a.x/=f,a.y/=f),l===0||u===0?d={width:1,height:1}:d={width:s.width/l,height:s.height/u},{x:a.x*d.width,y:a.y*d.height}},_createUpperCanvas:function(){var r=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),i=this.lowerCanvasEl,a=this.upperCanvasEl;a?a.className="":(a=this._createCanvasElement(),this.upperCanvasEl=a),g.util.addClass(a,"upper-canvas "+r),this.wrapperEl.appendChild(a),this._copyCanvasStyle(i,a),this._applyCanvasStyle(a),this.contextTop=a.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=g.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),g.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),g.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(r){var i=this.width||r.width,a=this.height||r.height;g.util.setStyle(r,{position:"absolute",width:i+"px",height:a+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),r.width=i,r.height=a,g.util.makeElementUnselectable(r)},_copyCanvasStyle:function(r,i){i.style.cssText=r.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var r=this._activeObject;return r?r.type==="activeSelection"&&r._objects?r._objects.slice(0):[r]:[]},_onObjectRemoved:function(r){r===this._activeObject&&(this.fire("before:selection:cleared",{target:r}),this._discardActiveObject(),this.fire("selection:cleared",{target:r}),r.fire("deselected")),r===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",r)},_fireSelectionEvents:function(r,i){var a=!1,s=this.getActiveObjects(),c=[],l=[];r.forEach(function(u){s.indexOf(u)===-1&&(a=!0,u.fire("deselected",{e:i,target:u}),l.push(u))}),s.forEach(function(u){r.indexOf(u)===-1&&(a=!0,u.fire("selected",{e:i,target:u}),c.push(u))}),r.length>0&&s.length>0?a&&this.fire("selection:updated",{e:i,selected:c,deselected:l}):s.length>0?this.fire("selection:created",{e:i,selected:c}):r.length>0&&this.fire("selection:cleared",{e:i,deselected:l})},setActiveObject:function(r,i){var a=this.getActiveObjects();return this._setActiveObject(r,i),this._fireSelectionEvents(a,i),this},_setActiveObject:function(r,i){return this._activeObject===r||!this._discardActiveObject(i,r)||r.onSelect({e:i})?!1:(this._activeObject=r,!0)},_discardActiveObject:function(r,i){var a=this._activeObject;if(a){if(a.onDeselect({e:r,object:i}))return!1;this._activeObject=null}return!0},discardActiveObject:function(r){var i=this.getActiveObjects(),a=this.getActiveObject();return i.length&&this.fire("before:selection:cleared",{target:a,e:r}),this._discardActiveObject(r),this._fireSelectionEvents(i,r),this},dispose:function(){var r=this.wrapperEl;return this.removeListeners(),r.removeChild(this.upperCanvasEl),r.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(i){g.util.cleanUpJsdomNode(this[i]),this[i]=void 0}.bind(this)),r.parentNode&&r.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,g.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(r){var i=this._activeObject;i&&i._renderControls(r)},_toObject:function(r,i,a){var s=this._realizeGroupTransformOnObject(r),c=this.callSuper("_toObject",r,i,a);return this._unwindGroupTransformOnObject(r,s),c},_realizeGroupTransformOnObject:function(r){if(r.group&&r.group.type==="activeSelection"&&this._activeObject===r.group){var i=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],a={};return i.forEach(function(s){a[s]=r[s]}),g.util.addTransformToObject(r,this._activeObject.calcOwnMatrix()),a}else return null},_unwindGroupTransformOnObject:function(r,i){i&&r.set(i)},_setSVGObject:function(r,i,a){var s=this._realizeGroupTransformOnObject(i);this.callSuper("_setSVGObject",r,i,a),this._unwindGroupTransformOnObject(i,s)},setViewportTransform:function(r){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),g.StaticCanvas.prototype.setViewportTransform.call(this,r)}});for(var o in g.StaticCanvas)o!=="prototype"&&(g.Canvas[o]=g.StaticCanvas[o])})();(function(){var t=g.util.addListener,e=g.util.removeListener,n=3,o=2,r=1,i={passive:!1};function a(s,c){return s.button&&s.button===c-1}g.util.object.extend(g.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(t,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(s,c){var l=this.upperCanvasEl,u=this._getEventPrefix();s(g.window,"resize",this._onResize),s(l,u+"down",this._onMouseDown),s(l,u+"move",this._onMouseMove,i),s(l,u+"out",this._onMouseOut),s(l,u+"enter",this._onMouseEnter),s(l,"wheel",this._onMouseWheel),s(l,"contextmenu",this._onContextMenu),s(l,"dblclick",this._onDoubleClick),s(l,"dragover",this._onDragOver),s(l,"dragenter",this._onDragEnter),s(l,"dragleave",this._onDragLeave),s(l,"drop",this._onDrop),this.enablePointerEvents||s(l,"touchstart",this._onTouchStart,i),typeof eventjs<"u"&&c in eventjs&&(eventjs[c](l,"gesture",this._onGesture),eventjs[c](l,"drag",this._onDrag),eventjs[c](l,"orientation",this._onOrientationChange),eventjs[c](l,"shake",this._onShake),eventjs[c](l,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(e,"remove");var s=this._getEventPrefix();e(g.document,s+"up",this._onMouseUp),e(g.document,"touchend",this._onTouchEnd,i),e(g.document,s+"move",this._onMouseMove,i),e(g.document,"touchmove",this._onMouseMove,i)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(s,c){this.__onTransformGesture&&this.__onTransformGesture(s,c)},_onDrag:function(s,c){this.__onDrag&&this.__onDrag(s,c)},_onMouseWheel:function(s){this.__onMouseWheel(s)},_onMouseOut:function(s){var c=this._hoveredTarget;this.fire("mouse:out",{target:c,e:s}),this._hoveredTarget=null,c&&c.fire("mouseout",{e:s});var l=this;this._hoveredTargets.forEach(function(u){l.fire("mouse:out",{target:c,e:s}),u&&c.fire("mouseout",{e:s})}),this._hoveredTargets=[]},_onMouseEnter:function(s){!this._currentTransform&&!this.findTarget(s)&&(this.fire("mouse:over",{target:null,e:s}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(s,c){this.__onOrientationChange&&this.__onOrientationChange(s,c)},_onShake:function(s,c){this.__onShake&&this.__onShake(s,c)},_onLongPress:function(s,c){this.__onLongPress&&this.__onLongPress(s,c)},_onDragOver:function(s){s.preventDefault();var c=this._simpleEventHandler("dragover",s);this._fireEnterLeaveEvents(c,s)},_onDrop:function(s){return this._simpleEventHandler("drop:before",s),this._simpleEventHandler("drop",s)},_onContextMenu:function(s){return this.stopContextMenu&&(s.stopPropagation(),s.preventDefault()),!1},_onDoubleClick:function(s){this._cacheTransformEventData(s),this._handleEvent(s,"dblclick"),this._resetTransformEventData(s)},getPointerId:function(s){var c=s.changedTouches;return c?c[0]&&c[0].identifier:this.enablePointerEvents?s.pointerId:-1},_isMainEvent:function(s){return s.isPrimary===!0?!0:s.isPrimary===!1?!1:s.type==="touchend"&&s.touches.length===0?!0:s.changedTouches?s.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(s){s.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(s)),this.__onMouseDown(s),this._resetTransformEventData();var c=this.upperCanvasEl,l=this._getEventPrefix();t(g.document,"touchend",this._onTouchEnd,i),t(g.document,"touchmove",this._onMouseMove,i),e(c,l+"down",this._onMouseDown)},_onMouseDown:function(s){this.__onMouseDown(s),this._resetTransformEventData();var c=this.upperCanvasEl,l=this._getEventPrefix();e(c,l+"move",this._onMouseMove,i),t(g.document,l+"up",this._onMouseUp),t(g.document,l+"move",this._onMouseMove,i)},_onTouchEnd:function(s){if(!(s.touches.length>0)){this.__onMouseUp(s),this._resetTransformEventData(),this.mainTouchId=null;var c=this._getEventPrefix();e(g.document,"touchend",this._onTouchEnd,i),e(g.document,"touchmove",this._onMouseMove,i);var l=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){t(l.upperCanvasEl,c+"down",l._onMouseDown),l._willAddMouseDown=0},400)}},_onMouseUp:function(s){this.__onMouseUp(s),this._resetTransformEventData();var c=this.upperCanvasEl,l=this._getEventPrefix();this._isMainEvent(s)&&(e(g.document,l+"up",this._onMouseUp),e(g.document,l+"move",this._onMouseMove,i),t(c,l+"move",this._onMouseMove,i))},_onMouseMove:function(s){!this.allowTouchScrolling&&s.preventDefault&&s.preventDefault(),this.__onMouseMove(s)},_onResize:function(){this.calcOffset()},_shouldRender:function(s){var c=this._activeObject;return!!c!=!!s||c&&s&&c!==s?!0:(c&&c.isEditing,!1)},__onMouseUp:function(s){var c,l=this._currentTransform,u=this._groupSelector,d=!1,f=!u||u.left===0&&u.top===0;if(this._cacheTransformEventData(s),c=this._target,this._handleEvent(s,"up:before"),a(s,n)){this.fireRightClick&&this._handleEvent(s,"up",n,f);return}if(a(s,o)){this.fireMiddleClick&&this._handleEvent(s,"up",o,f),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(s);return}if(this._isMainEvent(s)){if(l&&(this._finalizeCurrentTransform(s),d=l.actionPerformed),!f){var p=c===this._activeObject;this._maybeGroupObjects(s),d||(d=this._shouldRender(c)||!p&&c===this._activeObject)}var m,h;if(c){if(m=c._findTargetCorner(this.getPointer(s,!0),g.util.isTouchEvent(s)),c.selectable&&c!==this._activeObject&&c.activeOn==="up")this.setActiveObject(c,s),d=!0;else{var b=c.controls[m],x=b&&b.getMouseUpHandler(s,c,b);x&&(h=this.getPointer(s),x(s,l,h.x,h.y))}c.isMoving=!1}if(l&&(l.target!==c||l.corner!==m)){var T=l.target&&l.target.controls[l.corner],B=T&&T.getMouseUpHandler(s,c,b);h=h||this.getPointer(s),B&&B(s,l,h.x,h.y)}this._setCursorFromEvent(s,c),this._handleEvent(s,"up",r,f),this._groupSelector=null,this._currentTransform=null,c&&(c.__corner=0),d?this.requestRenderAll():f||this.renderTop()}},_simpleEventHandler:function(s,c){var l=this.findTarget(c),u=this.targets,d={e:c,target:l,subTargets:u};if(this.fire(s,d),l&&l.fire(s,d),!u)return l;for(var f=0;f<u.length;f++)u[f].fire(s,d);return l},_handleEvent:function(s,c,l,u){var d=this._target,f=this.targets||[],p={e:s,target:d,subTargets:f,button:l||r,isClick:u||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};c==="up"&&(p.currentTarget=this.findTarget(s),p.currentSubTargets=this.targets),this.fire("mouse:"+c,p),d&&d.fire("mouse"+c,p);for(var m=0;m<f.length;m++)f[m].fire("mouse"+c,p)},_finalizeCurrentTransform:function(s){var c=this._currentTransform,l=c.target,u={e:s,target:l,transform:c,action:c.action};l._scaling&&(l._scaling=!1),l.setCoords(),(c.actionPerformed||this.stateful&&l.hasStateChanged())&&this._fire("modified",u)},_onMouseDownInDrawingMode:function(s){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(s).requestRenderAll();var c=this.getPointer(s);this.freeDrawingBrush.onMouseDown(c,{e:s,pointer:c}),this._handleEvent(s,"down")},_onMouseMoveInDrawingMode:function(s){if(this._isCurrentlyDrawing){var c=this.getPointer(s);this.freeDrawingBrush.onMouseMove(c,{e:s,pointer:c})}this.setCursor(this.freeDrawingCursor),this._handleEvent(s,"move")},_onMouseUpInDrawingMode:function(s){var c=this.getPointer(s);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:s,pointer:c}),this._handleEvent(s,"up")},__onMouseDown:function(s){this._cacheTransformEventData(s),this._handleEvent(s,"down:before");var c=this._target;if(a(s,n)){this.fireRightClick&&this._handleEvent(s,"down",n);return}if(a(s,o)){this.fireMiddleClick&&this._handleEvent(s,"down",o);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(s);return}if(this._isMainEvent(s)&&!this._currentTransform){var l=this._pointer;this._previousPointer=l;var u=this._shouldRender(c),d=this._shouldGroup(s,c);if(this._shouldClearSelection(s,c)?this.discardActiveObject(s):d&&(this._handleGrouping(s,c),c=this._activeObject),this.selection&&(!c||!c.selectable&&!c.isEditing&&c!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),c){var f=c===this._activeObject;c.selectable&&c.activeOn==="down"&&this.setActiveObject(c,s);var p=c._findTargetCorner(this.getPointer(s,!0),g.util.isTouchEvent(s));if(c.__corner=p,c===this._activeObject&&(p||!d)){this._setupCurrentTransform(s,c,f);var m=c.controls[p],l=this.getPointer(s),h=m&&m.getMouseDownHandler(s,c,m);h&&h(s,this._currentTransform,l.x,l.y)}}this._handleEvent(s,"down"),(u||d)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(s){this._resetTransformEventData(),this._pointer=this.getPointer(s,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(s)||null},_beforeTransform:function(s){var c=this._currentTransform;this.stateful&&c.target.saveState(),this.fire("before:transform",{e:s,transform:c})},__onMouseMove:function(s){this._handleEvent(s,"move:before"),this._cacheTransformEventData(s);var c,l;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(s);return}if(this._isMainEvent(s)){var u=this._groupSelector;u?(l=this._absolutePointer,u.left=l.x-u.ex,u.top=l.y-u.ey,this.renderTop()):this._currentTransform?this._transformObject(s):(c=this.findTarget(s)||null,this._setCursorFromEvent(s,c),this._fireOverOutEvents(c,s)),this._handleEvent(s,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(s,c){var l=this._hoveredTarget,u=this._hoveredTargets,d=this.targets,f=Math.max(u.length,d.length);this.fireSyntheticInOutEvents(s,c,{oldTarget:l,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var p=0;p<f;p++)this.fireSyntheticInOutEvents(d[p],c,{oldTarget:u[p],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=s,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(s,c){var l=this._draggedoverTarget,u=this._hoveredTargets,d=this.targets,f=Math.max(u.length,d.length);this.fireSyntheticInOutEvents(s,c,{oldTarget:l,evtOut:"dragleave",evtIn:"dragenter"});for(var p=0;p<f;p++)this.fireSyntheticInOutEvents(d[p],c,{oldTarget:u[p],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=s},fireSyntheticInOutEvents:function(s,c,l){var u,d,f=l.oldTarget,p,m,h=f!==s,b=l.canvasEvtIn,x=l.canvasEvtOut;h&&(u={e:c,target:s,previousTarget:f},d={e:c,target:f,nextTarget:s}),m=s&&h,p=f&&h,p&&(x&&this.fire(x,d),f.fire(l.evtOut,d)),m&&(b&&this.fire(b,u),s.fire(l.evtIn,u))},__onMouseWheel:function(s){this._cacheTransformEventData(s),this._handleEvent(s,"wheel"),this._resetTransformEventData()},_transformObject:function(s){var c=this.getPointer(s),l=this._currentTransform;l.reset=!1,l.shiftKey=s.shiftKey,l.altKey=s[this.centeredKey],this._performTransformAction(s,l,c),l.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(s,c,l){var u=l.x,d=l.y,f=c.action,p=!1,m=c.actionHandler;m&&(p=m(s,c,u,d)),f==="drag"&&p&&(c.target.isMoving=!0,this.setCursor(c.target.moveCursor||this.moveCursor)),c.actionPerformed=c.actionPerformed||p},_fire:g.controlsUtils.fireEvent,_setCursorFromEvent:function(s,c){if(!c)return this.setCursor(this.defaultCursor),!1;var l=c.hoverCursor||this.hoverCursor,u=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,d=(!u||!u.contains(c))&&c._findTargetCorner(this.getPointer(s,!0));d?this.setCursor(this.getCornerCursor(d,c,s)):(c.subTargetCheck&&this.targets.concat().reverse().map(function(f){l=f.hoverCursor||l}),this.setCursor(l))},getCornerCursor:function(s,c,l){var u=c.controls[s];return u.cursorStyleHandler(l,u,c)}})})();(function(){var t=Math.min,e=Math.max;g.util.object.extend(g.Canvas.prototype,{_shouldGroup:function(n,o){var r=this._activeObject;return r&&this._isSelectionKeyPressed(n)&&o&&o.selectable&&this.selection&&(r!==o||r.type==="activeSelection")&&!o.onSelect({e:n})},_handleGrouping:function(n,o){var r=this._activeObject;r.__corner||o===r&&(o=this.findTarget(n,!0),!o||!o.selectable)||(r&&r.type==="activeSelection"?this._updateActiveSelection(o,n):this._createActiveSelection(o,n))},_updateActiveSelection:function(n,o){var r=this._activeObject,i=r._objects.slice(0);r.contains(n)?(r.removeWithUpdate(n),this._hoveredTarget=n,this._hoveredTargets=this.targets.concat(),r.size()===1&&this._setActiveObject(r.item(0),o)):(r.addWithUpdate(n),this._hoveredTarget=r,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(i,o)},_createActiveSelection:function(n,o){var r=this.getActiveObjects(),i=this._createGroup(n);this._hoveredTarget=i,this._setActiveObject(i,o),this._fireSelectionEvents(r,o)},_createGroup:function(n){var o=this._objects,r=o.indexOf(this._activeObject)<o.indexOf(n),i=r?[this._activeObject,n]:[n,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new g.ActiveSelection(i,{canvas:this})},_groupSelectedObjects:function(n){var o=this._collectObjects(n),r;o.length===1?this.setActiveObject(o[0],n):o.length>1&&(r=new g.ActiveSelection(o.reverse(),{canvas:this}),this.setActiveObject(r,n))},_collectObjects:function(n){for(var o=[],r,i=this._groupSelector.ex,a=this._groupSelector.ey,s=i+this._groupSelector.left,c=a+this._groupSelector.top,l=new g.Point(t(i,s),t(a,c)),u=new g.Point(e(i,s),e(a,c)),d=!this.selectionFullyContained,f=i===s&&a===c,p=this._objects.length;p--&&(r=this._objects[p],!(!(!r||!r.selectable||!r.visible)&&(d&&r.intersectsWithRect(l,u,!0)||r.isContainedWithinRect(l,u,!0)||d&&r.containsPoint(l,null,!0)||d&&r.containsPoint(u,null,!0))&&(o.push(r),f))););return o.length>1&&(o=o.filter(function(m){return!m.onSelect({e:n})})),o},_maybeGroupObjects:function(n){this.selection&&this._groupSelector&&this._groupSelectedObjects(n),this.setCursor(this.defaultCursor),this._groupSelector=null}})})();(function(){g.util.object.extend(g.StaticCanvas.prototype,{toDataURL:function(t){t||(t={});var e=t.format||"png",n=t.quality||1,o=(t.multiplier||1)*(t.enableRetinaScaling?this.getRetinaScaling():1),r=this.toCanvasElement(o,t);return g.util.toDataURL(r,e,n)},toCanvasElement:function(t,e){t=t||1,e=e||{};var n=(e.width||this.width)*t,o=(e.height||this.height)*t,r=this.getZoom(),i=this.width,a=this.height,s=r*t,c=this.viewportTransform,l=(c[4]-(e.left||0))*t,u=(c[5]-(e.top||0))*t,d=this.interactive,f=[s,0,0,s,l,u],p=this.enableRetinaScaling,m=g.util.createCanvasElement(),h=this.contextTop;return m.width=n,m.height=o,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=f,this.width=n,this.height=o,this.calcViewportBoundaries(),this.renderCanvas(m.getContext("2d"),this._objects),this.viewportTransform=c,this.width=i,this.height=a,this.calcViewportBoundaries(),this.interactive=d,this.enableRetinaScaling=p,this.contextTop=h,m}})})();g.util.object.extend(g.StaticCanvas.prototype,{loadFromJSON:function(t,e,n){if(t){var o=typeof t=="string"?JSON.parse(t):g.util.object.clone(t),r=this,i=o.clipPath,a=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete o.clipPath,this._enlivenObjects(o.objects,function(s){r.clear(),r._setBgOverlay(o,function(){i?r._enlivenObjects([i],function(c){r.clipPath=c[0],r.__setupCanvas.call(r,o,s,a,e)}):r.__setupCanvas.call(r,o,s,a,e)})},n),this}},__setupCanvas:function(t,e,n,o){var r=this;e.forEach(function(i,a){r.insertAt(i,a)}),this.renderOnAddRemove=n,delete t.objects,delete t.backgroundImage,delete t.overlayImage,delete t.background,delete t.overlay,this._setOptions(t),this.renderAll(),o&&o()},_setBgOverlay:function(t,e){var n={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!t.backgroundImage&&!t.overlayImage&&!t.background&&!t.overlay){e&&e();return}var o=function(){n.backgroundImage&&n.overlayImage&&n.backgroundColor&&n.overlayColor&&e&&e()};this.__setBgOverlay("backgroundImage",t.backgroundImage,n,o),this.__setBgOverlay("overlayImage",t.overlayImage,n,o),this.__setBgOverlay("backgroundColor",t.background,n,o),this.__setBgOverlay("overlayColor",t.overlay,n,o)},__setBgOverlay:function(t,e,n,o){var r=this;if(!e){n[t]=!0,o&&o();return}t==="backgroundImage"||t==="overlayImage"?g.util.enlivenObjects([e],function(i){r[t]=i[0],n[t]=!0,o&&o()}):this["set"+g.util.string.capitalize(t,!0)](e,function(){n[t]=!0,o&&o()})},_enlivenObjects:function(t,e,n){if(!t||t.length===0){e&&e([]);return}g.util.enlivenObjects(t,function(o){e&&e(o)},null,n)},_toDataURL:function(t,e){this.clone(function(n){e(n.toDataURL(t))})},_toDataURLWithMultiplier:function(t,e,n){this.clone(function(o){n(o.toDataURLWithMultiplier(t,e))})},clone:function(t,e){var n=JSON.stringify(this.toJSON(e));this.cloneWithoutData(function(o){o.loadFromJSON(n,function(){t&&t(o)})})},cloneWithoutData:function(t){var e=g.util.createCanvasElement();e.width=this.width,e.height=this.height;var n=new g.Canvas(e);this.backgroundImage?(n.setBackgroundImage(this.backgroundImage.src,function(){n.renderAll(),t&&t(n)}),n.backgroundImageOpacity=this.backgroundImageOpacity,n.backgroundImageStretch=this.backgroundImageStretch):t&&t(n)}});(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,o=e.util.object.clone,r=e.util.toFixed,i=e.util.string.capitalize,a=e.util.degreesToRadians,s=!e.isLikelyNode,c=2;e.Object||(e.Object=e.util.createClass(e.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:s,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(l){l&&this.setOptions(l)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=e.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(l){var u=e.perfLimitSizeTotal,d=l.width,f=l.height,p=e.maxCacheSideLimit,m=e.minCacheSideLimit;if(d<=p&&f<=p&&d*f<=u)return d<m&&(l.width=m),f<m&&(l.height=m),l;var h=d/f,b=e.util.limitDimsByArea(h,u),x=e.util.capValue,T=x(m,b.x,p),B=x(m,b.y,p);return d>T&&(l.zoomX/=d/T,l.width=T,l.capped=!0),f>B&&(l.zoomY/=f/B,l.height=B,l.capped=!0),l},_getCacheCanvasDimensions:function(){var l=this.getTotalObjectScaling(),u=this._getTransformedDimensions(0,0),d=u.x*l.scaleX/this.scaleX,f=u.y*l.scaleY/this.scaleY;return{width:d+c,height:f+c,zoomX:l.scaleX,zoomY:l.scaleY,x:d,y:f}},_updateCacheCanvas:function(){var l=this.canvas;if(this.noScaleCache&&l&&l._currentTransform){var u=l._currentTransform.target,d=l._currentTransform.action;if(this===u&&d.slice&&d.slice(0,5)==="scale")return!1}var f=this._cacheCanvas,p=this._limitCacheSize(this._getCacheCanvasDimensions()),m=e.minCacheSideLimit,h=p.width,b=p.height,x,T,B=p.zoomX,A=p.zoomY,S=h!==this.cacheWidth||b!==this.cacheHeight,H=this.zoomX!==B||this.zoomY!==A,j=S||H,M=0,I=0,O=!1;if(S){var Q=this._cacheCanvas.width,v=this._cacheCanvas.height,k=h>Q||b>v,R=(h<Q*.9||b<v*.9)&&Q>m&&v>m;O=k||R,k&&!p.capped&&(h>m||b>m)&&(M=h*.1,I=b*.1)}return this instanceof e.Text&&this.path&&(j=!0,O=!0,M+=this.getHeightOfLine(0)*this.zoomX,I+=this.getHeightOfLine(0)*this.zoomY),j?(O?(f.width=Math.ceil(h+M),f.height=Math.ceil(b+I)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,f.width,f.height)),x=p.x/2,T=p.y/2,this.cacheTranslationX=Math.round(f.width/2-x)+x,this.cacheTranslationY=Math.round(f.height/2-T)+T,this.cacheWidth=h,this.cacheHeight=b,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(B,A),this.zoomX=B,this.zoomY=A,!0):!1},setOptions:function(l){this._setOptions(l),this._initGradient(l.fill,"fill"),this._initGradient(l.stroke,"stroke"),this._initPattern(l.fill,"fill"),this._initPattern(l.stroke,"stroke")},transform:function(l){var u=this.group&&!this.group._transformDone||this.group&&this.canvas&&l===this.canvas.contextTop,d=this.calcTransformMatrix(!u);l.transform(d[0],d[1],d[2],d[3],d[4],d[5])},toObject:function(l){var u=e.Object.NUM_FRACTION_DIGITS,d={type:this.type,version:e.version,originX:this.originX,originY:this.originY,left:r(this.left,u),top:r(this.top,u),width:r(this.width,u),height:r(this.height,u),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:r(this.strokeWidth,u),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:r(this.strokeMiterLimit,u),scaleX:r(this.scaleX,u),scaleY:r(this.scaleY,u),angle:r(this.angle,u),flipX:this.flipX,flipY:this.flipY,opacity:r(this.opacity,u),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:r(this.skewX,u),skewY:r(this.skewY,u)};return this.clipPath&&!this.clipPath.excludeFromExport&&(d.clipPath=this.clipPath.toObject(l),d.clipPath.inverted=this.clipPath.inverted,d.clipPath.absolutePositioned=this.clipPath.absolutePositioned),e.util.populateWithProperties(this,d,l),this.includeDefaultValues||(d=this._removeDefaultValues(d)),d},toDatalessObject:function(l){return this.toObject(l)},_removeDefaultValues:function(l){var u=e.util.getKlass(l.type).prototype,d=u.stateProperties;return d.forEach(function(f){f==="left"||f==="top"||(l[f]===u[f]&&delete l[f],Array.isArray(l[f])&&Array.isArray(u[f])&&l[f].length===0&&u[f].length===0&&delete l[f])}),l},toString:function(){return"#<fabric."+i(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var l=e.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(l.scaleX),scaleY:Math.abs(l.scaleY)}},getTotalObjectScaling:function(){var l=this.getObjectScaling(),u=l.scaleX,d=l.scaleY;if(this.canvas){var f=this.canvas.getZoom(),p=this.canvas.getRetinaScaling();u*=f*p,d*=f*p}return{scaleX:u,scaleY:d}},getObjectOpacity:function(){var l=this.opacity;return this.group&&(l*=this.group.getObjectOpacity()),l},_set:function(l,u){var d=l==="scaleX"||l==="scaleY",f=this[l]!==u,p=!1;return d&&(u=this._constrainScale(u)),l==="scaleX"&&u<0?(this.flipX=!this.flipX,u*=-1):l==="scaleY"&&u<0?(this.flipY=!this.flipY,u*=-1):l==="shadow"&&u&&!(u instanceof e.Shadow)?u=new e.Shadow(u):l==="dirty"&&this.group&&this.group.set("dirty",u),this[l]=u,f&&(p=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(l)>-1?(this.dirty=!0,p&&this.group.set("dirty",!0)):p&&this.stateProperties.indexOf(l)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:e.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(l){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(l.save(),this._setupCompositeOperation(l),this.drawSelectionBackground(l),this.transform(l),this._setOpacity(l),this._setShadow(l,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(l)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(l),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),l.restore())},renderCache:function(l){l=l||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,l.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(l,u){if(l.save(),u.inverted?l.globalCompositeOperation="destination-out":l.globalCompositeOperation="destination-in",u.absolutePositioned){var d=e.util.invertTransform(this.calcTransformMatrix());l.transform(d[0],d[1],d[2],d[3],d[4],d[5])}u.transform(l),l.scale(1/u.zoomX,1/u.zoomY),l.drawImage(u._cacheCanvas,-u.cacheTranslationX,-u.cacheTranslationY),l.restore()},drawObject:function(l,u){var d=this.fill,f=this.stroke;u?(this.fill="black",this.stroke="",this._setClippingProperties(l)):this._renderBackground(l),this._render(l),this._drawClipPath(l,this.clipPath),this.fill=d,this.stroke=f},_drawClipPath:function(l,u){u&&(u.canvas=this.canvas,u.shouldCache(),u._transformDone=!0,u.renderCache({forClipping:!0}),this.drawClipPathOnCache(l,u))},drawCacheOnCanvas:function(l){l.scale(1/this.zoomX,1/this.zoomY),l.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(l){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!l&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!l){var u=this.cacheWidth/this.zoomX,d=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-u/2,-d/2,u,d)}return!0}return!1},_renderBackground:function(l){if(this.backgroundColor){var u=this._getNonTransformedDimensions();l.fillStyle=this.backgroundColor,l.fillRect(-u.x/2,-u.y/2,u.x,u.y),this._removeShadow(l)}},_setOpacity:function(l){this.group&&!this.group._transformDone?l.globalAlpha=this.getObjectOpacity():l.globalAlpha*=this.opacity},_setStrokeStyles:function(l,u){var d=u.stroke;d&&(l.lineWidth=u.strokeWidth,l.lineCap=u.strokeLineCap,l.lineDashOffset=u.strokeDashOffset,l.lineJoin=u.strokeLineJoin,l.miterLimit=u.strokeMiterLimit,d.toLive?d.gradientUnits==="percentage"||d.gradientTransform||d.patternTransform?this._applyPatternForTransformedGradient(l,d):(l.strokeStyle=d.toLive(l,this),this._applyPatternGradientTransform(l,d)):l.strokeStyle=u.stroke)},_setFillStyles:function(l,u){var d=u.fill;d&&(d.toLive?(l.fillStyle=d.toLive(l,this),this._applyPatternGradientTransform(l,u.fill)):l.fillStyle=d)},_setClippingProperties:function(l){l.globalAlpha=1,l.strokeStyle="transparent",l.fillStyle="#000000"},_setLineDash:function(l,u){!u||u.length===0||(1&u.length&&u.push.apply(u,u),l.setLineDash(u))},_renderControls:function(l,u){var d=this.getViewportTransform(),f=this.calcTransformMatrix(),p,m,h;u=u||{},m=typeof u.hasBorders<"u"?u.hasBorders:this.hasBorders,h=typeof u.hasControls<"u"?u.hasControls:this.hasControls,f=e.util.multiplyTransformMatrices(d,f),p=e.util.qrDecompose(f),l.save(),l.translate(p.translateX,p.translateY),l.lineWidth=1*this.borderScaleFactor,this.group||(l.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(p.angle-=180),l.rotate(a(this.group?p.angle:this.angle)),u.forActiveSelection||this.group?m&&this.drawBordersInGroup(l,p,u):m&&this.drawBorders(l,u),h&&this.drawControls(l,u),l.restore()},_setShadow:function(l){if(this.shadow){var u=this.shadow,d=this.canvas,f,p=d&&d.viewportTransform[0]||1,m=d&&d.viewportTransform[3]||1;u.nonScaling?f={scaleX:1,scaleY:1}:f=this.getObjectScaling(),d&&d._isRetinaScaling()&&(p*=e.devicePixelRatio,m*=e.devicePixelRatio),l.shadowColor=u.color,l.shadowBlur=u.blur*e.browserShadowBlurConstant*(p+m)*(f.scaleX+f.scaleY)/4,l.shadowOffsetX=u.offsetX*p*f.scaleX,l.shadowOffsetY=u.offsetY*m*f.scaleY}},_removeShadow:function(l){this.shadow&&(l.shadowColor="",l.shadowBlur=l.shadowOffsetX=l.shadowOffsetY=0)},_applyPatternGradientTransform:function(l,u){if(!u||!u.toLive)return{offsetX:0,offsetY:0};var d=u.gradientTransform||u.patternTransform,f=-this.width/2+u.offsetX||0,p=-this.height/2+u.offsetY||0;return u.gradientUnits==="percentage"?l.transform(this.width,0,0,this.height,f,p):l.transform(1,0,0,1,f,p),d&&l.transform(d[0],d[1],d[2],d[3],d[4],d[5]),{offsetX:f,offsetY:p}},_renderPaintInOrder:function(l){this.paintFirst==="stroke"?(this._renderStroke(l),this._renderFill(l)):(this._renderFill(l),this._renderStroke(l))},_render:function(){},_renderFill:function(l){this.fill&&(l.save(),this._setFillStyles(l,this),this.fillRule==="evenodd"?l.fill("evenodd"):l.fill(),l.restore())},_renderStroke:function(l){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(l),l.save(),this.strokeUniform&&this.group){var u=this.getObjectScaling();l.scale(1/u.scaleX,1/u.scaleY)}else this.strokeUniform&&l.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(l,this.strokeDashArray),this._setStrokeStyles(l,this),l.stroke(),l.restore()}},_applyPatternForTransformedGradient:function(l,u){var d=this._limitCacheSize(this._getCacheCanvasDimensions()),f=e.util.createCanvasElement(),p,m=this.canvas.getRetinaScaling(),h=d.x/this.scaleX/m,b=d.y/this.scaleY/m;f.width=h,f.height=b,p=f.getContext("2d"),p.beginPath(),p.moveTo(0,0),p.lineTo(h,0),p.lineTo(h,b),p.lineTo(0,b),p.closePath(),p.translate(h/2,b/2),p.scale(d.zoomX/this.scaleX/m,d.zoomY/this.scaleY/m),this._applyPatternGradientTransform(p,u),p.fillStyle=u.toLive(l),p.fill(),l.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),l.scale(m*this.scaleX/d.zoomX,m*this.scaleY/d.zoomY),l.strokeStyle=p.createPattern(f,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var l=e.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",l.scaleX),this.set("scaleY",l.scaleY),this.angle=l.angle,this.skewX=l.skewX,this.skewY=0}},_removeTransformMatrix:function(l){var u=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),u=e.util.transformPoint(u,this.transformMatrix)),this.transformMatrix=null,l&&(this.scaleX*=l.scaleX,this.scaleY*=l.scaleY,this.cropX=l.cropX,this.cropY=l.cropY,u.x+=l.offsetLeft,u.y+=l.offsetTop,this.width=l.width,this.height=l.height),this.setPositionByOrigin(u,"center","center")},clone:function(l,u){var d=this.toObject(u);this.constructor.fromObject?this.constructor.fromObject(d,l):e.Object._fromObject("Object",d,l)},cloneAsImage:function(l,u){var d=this.toCanvasElement(u);return l&&l(new e.Image(d)),this},toCanvasElement:function(l){l||(l={});var u=e.util,d=u.saveObjectTransform(this),f=this.group,p=this.shadow,m=Math.abs,h=(l.multiplier||1)*(l.enableRetinaScaling?e.devicePixelRatio:1);delete this.group,l.withoutTransform&&u.resetObjectTransform(this),l.withoutShadow&&(this.shadow=null);var b=e.util.createCanvasElement(),x=this.getBoundingRect(!0,!0),T=this.shadow,B,A={x:0,y:0},S,H,j;T&&(S=T.blur,T.nonScaling?B={scaleX:1,scaleY:1}:B=this.getObjectScaling(),A.x=2*Math.round(m(T.offsetX)+S)*m(B.scaleX),A.y=2*Math.round(m(T.offsetY)+S)*m(B.scaleY)),H=x.width+A.x,j=x.height+A.y,b.width=Math.ceil(H),b.height=Math.ceil(j);var M=new e.StaticCanvas(b,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});l.format==="jpeg"&&(M.backgroundColor="#fff"),this.setPositionByOrigin(new e.Point(M.width/2,M.height/2),"center","center");var I=this.canvas;M.add(this);var O=M.toCanvasElement(h||1,l);return this.shadow=p,this.set("canvas",I),f&&(this.group=f),this.set(d).setCoords(),M._objects=[],M.dispose(),M=null,O},toDataURL:function(l){return l||(l={}),e.util.toDataURL(this.toCanvasElement(l),l.format||"png",l.quality||1)},isType:function(l){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===l},complexity:function(){return 1},toJSON:function(l){return this.toObject(l)},rotate:function(l){var u=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return u&&this._setOriginToCenter(),this.set("angle",l),u&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(l,u){u=u||this.canvas.getPointer(l);var d=new e.Point(u.x,u.y),f=this._getLeftTopCoords();return this.angle&&(d=e.util.rotatePoint(d,f,a(-this.angle))),{x:d.x-f.x,y:d.y-f.y}},_setupCompositeOperation:function(l){this.globalCompositeOperation&&(l.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){e.runningAnimations&&e.runningAnimations.cancelByTarget(this)}}),e.util.createAccessors&&e.util.createAccessors(e.Object),n(e.Object.prototype,e.Observable),e.Object.NUM_FRACTION_DIGITS=2,e.Object.ENLIVEN_PROPS=["clipPath"],e.Object._fromObject=function(l,u,d,f){var p=e[l];u=o(u,!0),e.util.enlivenPatterns([u.fill,u.stroke],function(m){typeof m[0]<"u"&&(u.fill=m[0]),typeof m[1]<"u"&&(u.stroke=m[1]),e.util.enlivenObjectEnlivables(u,u,function(){var h=f?new p(u[f],u):new p(u);d&&d(h)})})},e.Object.__uid=0)})(ae);(function(){var t=g.util.degreesToRadians,e={left:-.5,center:0,right:.5},n={top:-.5,center:0,bottom:.5};g.util.object.extend(g.Object.prototype,{translateToGivenOrigin:function(o,r,i,a,s){var c=o.x,l=o.y,u,d,f;return typeof r=="string"?r=e[r]:r-=.5,typeof a=="string"?a=e[a]:a-=.5,u=a-r,typeof i=="string"?i=n[i]:i-=.5,typeof s=="string"?s=n[s]:s-=.5,d=s-i,(u||d)&&(f=this._getTransformedDimensions(),c=o.x+u*f.x,l=o.y+d*f.y),new g.Point(c,l)},translateToCenterPoint:function(o,r,i){var a=this.translateToGivenOrigin(o,r,i,"center","center");return this.angle?g.util.rotatePoint(a,o,t(this.angle)):a},translateToOriginPoint:function(o,r,i){var a=this.translateToGivenOrigin(o,"center","center",r,i);return this.angle?g.util.rotatePoint(a,o,t(this.angle)):a},getCenterPoint:function(){var o=new g.Point(this.left,this.top);return this.translateToCenterPoint(o,this.originX,this.originY)},getPointByOrigin:function(o,r){var i=this.getCenterPoint();return this.translateToOriginPoint(i,o,r)},toLocalPoint:function(o,r,i){var a=this.getCenterPoint(),s,c;return typeof r<"u"&&typeof i<"u"?s=this.translateToGivenOrigin(a,"center","center",r,i):s=new g.Point(this.left,this.top),c=new g.Point(o.x,o.y),this.angle&&(c=g.util.rotatePoint(c,a,-t(this.angle))),c.subtractEquals(s)},setPositionByOrigin:function(o,r,i){var a=this.translateToCenterPoint(o,r,i),s=this.translateToOriginPoint(a,this.originX,this.originY);this.set("left",s.x),this.set("top",s.y)},adjustPosition:function(o){var r=t(this.angle),i=this.getScaledWidth(),a=g.util.cos(r)*i,s=g.util.sin(r)*i,c,l;typeof this.originX=="string"?c=e[this.originX]:c=this.originX-.5,typeof o=="string"?l=e[o]:l=o-.5,this.left+=a*(l-c),this.top+=s*(l-c),this.setCoords(),this.originX=o},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var o=this.getCenterPoint();this.originX="center",this.originY="center",this.left=o.x,this.top=o.y},_resetOrigin:function(){var o=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=o.x,this.top=o.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})})();(function(){function t(i){return[new g.Point(i.tl.x,i.tl.y),new g.Point(i.tr.x,i.tr.y),new g.Point(i.br.x,i.br.y),new g.Point(i.bl.x,i.bl.y)]}var e=g.util,n=e.degreesToRadians,o=e.multiplyTransformMatrices,r=e.transformPoint;e.object.extend(g.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(i,a){return a?i?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),i?this.aCoords:this.lineCoords)},getCoords:function(i,a){return t(this._getCoords(i,a))},intersectsWithRect:function(i,a,s,c){var l=this.getCoords(s,c),u=g.Intersection.intersectPolygonRectangle(l,i,a);return u.status==="Intersection"},intersectsWithObject:function(i,a,s){var c=g.Intersection.intersectPolygonPolygon(this.getCoords(a,s),i.getCoords(a,s));return c.status==="Intersection"||i.isContainedWithinObject(this,a,s)||this.isContainedWithinObject(i,a,s)},isContainedWithinObject:function(i,a,s){for(var c=this.getCoords(a,s),l=a?i.aCoords:i.lineCoords,u=0,d=i._getImageLines(l);u<4;u++)if(!i.containsPoint(c[u],d))return!1;return!0},isContainedWithinRect:function(i,a,s,c){var l=this.getBoundingRect(s,c);return l.left>=i.x&&l.left+l.width<=a.x&&l.top>=i.y&&l.top+l.height<=a.y},containsPoint:function(i,u,s,c){var l=this._getCoords(s,c),u=u||this._getImageLines(l),d=this._findCrossPoints(i,u);return d!==0&&d%2===1},isOnScreen:function(i){if(!this.canvas)return!1;var a=this.canvas.vptCoords.tl,s=this.canvas.vptCoords.br,c=this.getCoords(!0,i);return c.some(function(l){return l.x<=s.x&&l.x>=a.x&&l.y<=s.y&&l.y>=a.y})||this.intersectsWithRect(a,s,!0,i)?!0:this._containsCenterOfCanvas(a,s,i)},_containsCenterOfCanvas:function(i,a,s){var c={x:(i.x+a.x)/2,y:(i.y+a.y)/2};return!!this.containsPoint(c,null,!0,s)},isPartiallyOnScreen:function(i){if(!this.canvas)return!1;var a=this.canvas.vptCoords.tl,s=this.canvas.vptCoords.br;if(this.intersectsWithRect(a,s,!0,i))return!0;var c=this.getCoords(!0,i).every(function(l){return(l.x>=s.x||l.x<=a.x)&&(l.y>=s.y||l.y<=a.y)});return c&&this._containsCenterOfCanvas(a,s,i)},_getImageLines:function(i){var a={topline:{o:i.tl,d:i.tr},rightline:{o:i.tr,d:i.br},bottomline:{o:i.br,d:i.bl},leftline:{o:i.bl,d:i.tl}};return a},_findCrossPoints:function(i,a){var s,c,l,u,d,f=0,p;for(var m in a)if(p=a[m],!(p.o.y<i.y&&p.d.y<i.y)&&!(p.o.y>=i.y&&p.d.y>=i.y)&&(p.o.x===p.d.x&&p.o.x>=i.x?d=p.o.x:(s=0,c=(p.d.y-p.o.y)/(p.d.x-p.o.x),l=i.y-s*i.x,u=p.o.y-c*p.o.x,d=-(l-u)/(s-c)),d>=i.x&&(f+=1),f===2))break;return f},getBoundingRect:function(i,a){var s=this.getCoords(i,a);return e.makeBoundingBoxFromPoints(s)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(i){return Math.abs(i)<this.minScaleLimit?i<0?-this.minScaleLimit:this.minScaleLimit:i===0?1e-4:i},scale:function(i){return this._set("scaleX",i),this._set("scaleY",i),this.setCoords()},scaleToWidth:function(i,a){var s=this.getBoundingRect(a).width/this.getScaledWidth();return this.scale(i/this.width/s)},scaleToHeight:function(i,a){var s=this.getBoundingRect(a).height/this.getScaledHeight();return this.scale(i/this.height/s)},calcLineCoords:function(){var i=this.getViewportTransform(),a=this.padding,s=n(this.angle),c=e.cos(s),l=e.sin(s),u=c*a,d=l*a,f=u+d,p=u-d,m=this.calcACoords(),h={tl:r(m.tl,i),tr:r(m.tr,i),bl:r(m.bl,i),br:r(m.br,i)};return a&&(h.tl.x-=p,h.tl.y-=f,h.tr.x+=f,h.tr.y-=p,h.bl.x-=f,h.bl.y+=p,h.br.x+=p,h.br.y+=f),h},calcOCoords:function(){var i=this._calcRotateMatrix(),a=this._calcTranslateMatrix(),s=this.getViewportTransform(),c=o(s,a),l=o(c,i),l=o(l,[1/s[0],0,0,1/s[3],0,0]),u=this._calculateCurrentDimensions(),d={};return this.forEachControl(function(f,p,m){d[p]=f.positionHandler(u,l,m)}),d},calcACoords:function(){var i=this._calcRotateMatrix(),a=this._calcTranslateMatrix(),s=o(a,i),c=this._getTransformedDimensions(),l=c.x/2,u=c.y/2;return{tl:r({x:-l,y:-u},s),tr:r({x:l,y:-u},s),bl:r({x:-l,y:u},s),br:r({x:l,y:u},s)}},setCoords:function(i){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),i?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return e.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var i=this.getCenterPoint();return[1,0,0,1,i.x,i.y]},transformMatrixKey:function(i){var a="_",s="";return!i&&this.group&&(s=this.group.transformMatrixKey(i)+a),s+this.top+a+this.left+a+this.scaleX+a+this.scaleY+a+this.skewX+a+this.skewY+a+this.angle+a+this.originX+a+this.originY+a+this.width+a+this.height+a+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(i){var a=this.calcOwnMatrix();if(i||!this.group)return a;var s=this.transformMatrixKey(i),c=this.matrixCache||(this.matrixCache={});return c.key===s?c.value:(this.group&&(a=o(this.group.calcTransformMatrix(!1),a)),c.key=s,c.value=a,a)},calcOwnMatrix:function(){var i=this.transformMatrixKey(!0),a=this.ownMatrixCache||(this.ownMatrixCache={});if(a.key===i)return a.value;var s=this._calcTranslateMatrix(),c={angle:this.angle,translateX:s[4],translateY:s[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return a.key=i,a.value=e.composeMatrix(c),a.value},_getNonTransformedDimensions:function(){var i=this.strokeWidth,a=this.width+i,s=this.height+i;return{x:a,y:s}},_getTransformedDimensions:function(i,a){typeof i>"u"&&(i=this.skewX),typeof a>"u"&&(a=this.skewY);var s,c,l,u=i===0&&a===0;if(this.strokeUniform?(c=this.width,l=this.height):(s=this._getNonTransformedDimensions(),c=s.x,l=s.y),u)return this._finalizeDimensions(c*this.scaleX,l*this.scaleY);var d=e.sizeAfterTransform(c,l,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:i,skewY:a});return this._finalizeDimensions(d.x,d.y)},_finalizeDimensions:function(i,a){return this.strokeUniform?{x:i+this.strokeWidth,y:a+this.strokeWidth}:{x:i,y:a}},_calculateCurrentDimensions:function(){var i=this.getViewportTransform(),a=this._getTransformedDimensions(),s=r(a,i,!0);return s.scalarAdd(2*this.padding)}})})();g.util.object.extend(g.Object.prototype,{sendToBack:function(){return this.group?g.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?g.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(t){return this.group?g.StaticCanvas.prototype.sendBackwards.call(this.group,this,t):this.canvas&&this.canvas.sendBackwards(this,t),this},bringForward:function(t){return this.group?g.StaticCanvas.prototype.bringForward.call(this.group,this,t):this.canvas&&this.canvas.bringForward(this,t),this},moveTo:function(t){return this.group&&this.group.type!=="activeSelection"?g.StaticCanvas.prototype.moveTo.call(this.group,this,t):this.canvas&&this.canvas.moveTo(this,t),this}});(function(){function t(n,o){if(o){if(o.toLive)return n+": url(#SVGID_"+o.id+"); ";var r=new g.Color(o),i=n+": "+r.toRgb()+"; ",a=r.getAlpha();return a!==1&&(i+=n+"-opacity: "+a.toString()+"; "),i}else return n+": none; "}var e=g.util.toFixed;g.util.object.extend(g.Object.prototype,{getSvgStyles:function(n){var o=this.fillRule?this.fillRule:"nonzero",r=this.strokeWidth?this.strokeWidth:"0",i=this.strokeDashArray?this.strokeDashArray.join(" "):"none",a=this.strokeDashOffset?this.strokeDashOffset:"0",s=this.strokeLineCap?this.strokeLineCap:"butt",c=this.strokeLineJoin?this.strokeLineJoin:"miter",l=this.strokeMiterLimit?this.strokeMiterLimit:"4",u=typeof this.opacity<"u"?this.opacity:"1",d=this.visible?"":" visibility: hidden;",f=n?"":this.getSvgFilter(),p=t("fill",this.fill),m=t("stroke",this.stroke);return[m,"stroke-width: ",r,"; ","stroke-dasharray: ",i,"; ","stroke-linecap: ",s,"; ","stroke-dashoffset: ",a,"; ","stroke-linejoin: ",c,"; ","stroke-miterlimit: ",l,"; ",p,"fill-rule: ",o,"; ","opacity: ",u,";",f,d].join("")},getSvgSpanStyles:function(n,o){var r="; ",a=n.fontFamily?"font-family: "+(n.fontFamily.indexOf("'")===-1&&n.fontFamily.indexOf('"')===-1?"'"+n.fontFamily+"'":n.fontFamily)+r:"",i=n.strokeWidth?"stroke-width: "+n.strokeWidth+r:"",a=a,s=n.fontSize?"font-size: "+n.fontSize+"px"+r:"",c=n.fontStyle?"font-style: "+n.fontStyle+r:"",l=n.fontWeight?"font-weight: "+n.fontWeight+r:"",u=n.fill?t("fill",n.fill):"",d=n.stroke?t("stroke",n.stroke):"",f=this.getSvgTextDecoration(n),p=n.deltaY?"baseline-shift: "+-n.deltaY+"; ":"";return f&&(f="text-decoration: "+f+r),[d,i,a,s,c,l,f,u,p,o?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(n){return["overline","underline","line-through"].filter(function(o){return n[o.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(n,o){var r=n?this.calcTransformMatrix():this.calcOwnMatrix(),i='transform="'+g.util.matrixToSVG(r);return i+(o||"")+'" '},_setSVGBg:function(n){if(this.backgroundColor){var o=g.Object.NUM_FRACTION_DIGITS;n.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',e(-this.width/2,o),'" y="',e(-this.height/2,o),'" width="',e(this.width,o),'" height="',e(this.height,o),`"></rect>
`)}},toSVG:function(n){return this._createBaseSVGMarkup(this._toSVG(n),{reviver:n})},toClipPathSVG:function(n){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(n),{reviver:n})},_createBaseClipPathSVGMarkup:function(n,o){o=o||{};var r=o.reviver,i=o.additionalTransform||"",a=[this.getSvgTransform(!0,i),this.getSvgCommons()].join(""),s=n.indexOf("COMMON_PARTS");return n[s]=a,r?r(n.join("")):n.join("")},_createBaseSVGMarkup:function(n,o){o=o||{};var r=o.noStyle,i=o.reviver,a=r?"":'style="'+this.getSvgStyles()+'" ',s=o.withShadow?'style="'+this.getSvgFilter()+'" ':"",c=this.clipPath,l=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",u=c&&c.absolutePositioned,d=this.stroke,f=this.fill,p=this.shadow,m,h=[],b,x=n.indexOf("COMMON_PARTS"),T=o.additionalTransform;return c&&(c.clipPathId="CLIPPATH_"+g.Object.__uid++,b='<clipPath id="'+c.clipPathId+`" >
`+c.toClipPathSVG(i)+`</clipPath>
`),u&&h.push("<g ",s,this.getSvgCommons(),` >
`),h.push("<g ",this.getSvgTransform(!1),u?"":s+this.getSvgCommons(),` >
`),m=[a,l,r?"":this.addPaintOrder()," ",T?'transform="'+T+'" ':""].join(""),n[x]=m,f&&f.toLive&&h.push(f.toSVG(this)),d&&d.toLive&&h.push(d.toSVG(this)),p&&h.push(p.toSVG(this)),c&&h.push(b),h.push(n.join("")),h.push(`</g>
`),u&&h.push(`</g>
`),i?i(h.join("")):h.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})})();(function(){var t=g.util.object.extend,e="stateProperties";function n(r,i,a){var s={},c=!0;a.forEach(function(l){s[l]=r[l]}),t(r[i],s,c)}function o(r,i,a){if(r===i)return!0;if(Array.isArray(r)){if(!Array.isArray(i)||r.length!==i.length)return!1;for(var s=0,c=r.length;s<c;s++)if(!o(r[s],i[s]))return!1;return!0}else if(r&&typeof r=="object"){var l=Object.keys(r),u;if(!i||typeof i!="object"||!a&&l.length!==Object.keys(i).length)return!1;for(var s=0,c=l.length;s<c;s++)if(u=l[s],!(u==="canvas"||u==="group")&&!o(r[u],i[u]))return!1;return!0}}g.util.object.extend(g.Object.prototype,{hasStateChanged:function(r){r=r||e;var i="_"+r;return Object.keys(this[i]).length<this[r].length?!0:!o(this[i],this,!0)},saveState:function(r){var i=r&&r.propertySet||e,a="_"+i;return this[a]?(n(this,a,this[i]),r&&r.stateProperties&&n(this,a,r.stateProperties),this):this.setupState(r)},setupState:function(r){r=r||{};var i=r.propertySet||e;return r.propertySet=i,this["_"+i]={},this.saveState(r),this}})})();(function(){var t=g.util.degreesToRadians;g.util.object.extend(g.Object.prototype,{_findTargetCorner:function(e,n){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var o=e.x,r=e.y,i,a,s=Object.keys(this.oCoords),c=s.length-1,l;for(this.__corner=0;c>=0;c--)if(l=s[c],!!this.isControlVisible(l)&&(a=this._getImageLines(n?this.oCoords[l].touchCorner:this.oCoords[l].corner),i=this._findCrossPoints({x:o,y:r},a),i!==0&&i%2===1))return this.__corner=l,l;return!1},forEachControl:function(e){for(var n in this.controls)e(this.controls[n],n,this)},_setCornerCoords:function(){var e=this.oCoords;for(var n in e){var o=this.controls[n];e[n].corner=o.calcCornerCoords(this.angle,this.cornerSize,e[n].x,e[n].y,!1),e[n].touchCorner=o.calcCornerCoords(this.angle,this.touchCornerSize,e[n].x,e[n].y,!0)}},drawSelectionBackground:function(e){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;e.save();var n=this.getCenterPoint(),o=this._calculateCurrentDimensions(),r=this.canvas.viewportTransform;return e.translate(n.x,n.y),e.scale(1/r[0],1/r[3]),e.rotate(t(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-o.x/2,-o.y/2,o.x,o.y),e.restore(),this},drawBorders:function(e,n){n=n||{};var o=this._calculateCurrentDimensions(),r=this.borderScaleFactor,i=o.x+r,a=o.y+r,s=typeof n.hasControls<"u"?n.hasControls:this.hasControls,c=!1;return e.save(),e.strokeStyle=n.borderColor||this.borderColor,this._setLineDash(e,n.borderDashArray||this.borderDashArray),e.strokeRect(-i/2,-a/2,i,a),s&&(e.beginPath(),this.forEachControl(function(l,u,d){l.withConnection&&l.getVisibility(d,u)&&(c=!0,e.moveTo(l.x*i,l.y*a),e.lineTo(l.x*i+l.offsetX,l.y*a+l.offsetY))}),c&&e.stroke()),e.restore(),this},drawBordersInGroup:function(e,n,o){o=o||{};var r=g.util.sizeAfterTransform(this.width,this.height,n),i=this.strokeWidth,a=this.strokeUniform,s=this.borderScaleFactor,c=r.x+i*(a?this.canvas.getZoom():n.scaleX)+s,l=r.y+i*(a?this.canvas.getZoom():n.scaleY)+s;return e.save(),this._setLineDash(e,o.borderDashArray||this.borderDashArray),e.strokeStyle=o.borderColor||this.borderColor,e.strokeRect(-c/2,-l/2,c,l),e.restore(),this},drawControls:function(e,n){n=n||{},e.save();var o=this.canvas.getRetinaScaling(),r,i;return e.setTransform(o,0,0,o,0,0),e.strokeStyle=e.fillStyle=n.cornerColor||this.cornerColor,this.transparentCorners||(e.strokeStyle=n.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(e,n.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(r=this.group.calcTransformMatrix()),this.forEachControl(function(a,s,c){i=c.oCoords[s],a.getVisibility(c,s)&&(r&&(i=g.util.transformPoint(i,r)),a.render(e,i.x,i.y,n,c))}),e.restore(),this},isControlVisible:function(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)},setControlVisible:function(e,n){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=n,this},setControlsVisibility:function(e){e||(e={});for(var n in e)this.setControlVisible(n,e[n]);return this},onDeselect:function(){},onSelect:function(){}})})();g.util.object.extend(g.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(t,e){e=e||{};var n=function(){},o=e.onComplete||n,r=e.onChange||n,i=this;return g.util.animate({target:this,startValue:t.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(a){t.set("left",a),i.requestRenderAll(),r()},onComplete:function(){t.setCoords(),o()}})},fxCenterObjectV:function(t,e){e=e||{};var n=function(){},o=e.onComplete||n,r=e.onChange||n,i=this;return g.util.animate({target:this,startValue:t.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(a){t.set("top",a),i.requestRenderAll(),r()},onComplete:function(){t.setCoords(),o()}})},fxRemove:function(t,e){e=e||{};var n=function(){},o=e.onComplete||n,r=e.onChange||n,i=this;return g.util.animate({target:this,startValue:t.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(a){t.set("opacity",a),i.requestRenderAll(),r()},onComplete:function(){i.remove(t),o()}})}});g.util.object.extend(g.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var t=[],e,n,o=[];for(e in arguments[0])t.push(e);for(var r=0,i=t.length;r<i;r++)e=t[r],n=r!==i-1,o.push(this._animate(e,arguments[0][e],arguments[1],n));return o}else return this._animate.apply(this,arguments)},_animate:function(t,e,n,o){var r=this,i;e=e.toString(),n?n=g.util.object.clone(n):n={},~t.indexOf(".")&&(i=t.split("."));var a=r.colorProperties.indexOf(t)>-1||i&&r.colorProperties.indexOf(i[1])>-1,s=i?this.get(i[0])[i[1]]:this.get(t);"from"in n||(n.from=s),a||(~e.indexOf("=")?e=s+parseFloat(e.replace("=","")):e=parseFloat(e));var c={target:this,startValue:n.from,endValue:e,byValue:n.by,easing:n.easing,duration:n.duration,abort:n.abort&&function(l,u,d){return n.abort.call(r,l,u,d)},onChange:function(l,u,d){i?r[i[0]][i[1]]=l:r.set(t,l),!o&&n.onChange&&n.onChange(l,u,d)},onComplete:function(l,u,d){o||(r.setCoords(),n.onComplete&&n.onComplete(l,u,d))}};return a?g.util.animateColor(c.startValue,c.endValue,c.duration,c):g.util.animate(c)}});(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,o=e.util.object.clone,r={x1:1,x2:1,y1:1,y2:1};if(e.Line){e.warn("fabric.Line is already defined");return}e.Line=e.util.createClass(e.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:e.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(a,s){a||(a=[0,0,0,0]),this.callSuper("initialize",s),this.set("x1",a[0]),this.set("y1",a[1]),this.set("x2",a[2]),this.set("y2",a[3]),this._setWidthHeight(s)},_setWidthHeight:function(a){a||(a={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in a?a.left:this._getLeftToOriginX(),this.top="top"in a?a.top:this._getTopToOriginY()},_set:function(a,s){return this.callSuper("_set",a,s),typeof r[a]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:i({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:i({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(a){a.beginPath();var s=this.calcLinePoints();a.moveTo(s.x1,s.y1),a.lineTo(s.x2,s.y2),a.lineWidth=this.strokeWidth;var c=a.strokeStyle;a.strokeStyle=this.stroke||a.fillStyle,this.stroke&&this._renderStroke(a),a.strokeStyle=c},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(a){return n(this.callSuper("toObject",a),this.calcLinePoints())},_getNonTransformedDimensions:function(){var a=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(a.y-=this.strokeWidth),this.height===0&&(a.x-=this.strokeWidth)),a},calcLinePoints:function(){var a=this.x1<=this.x2?-1:1,s=this.y1<=this.y2?-1:1,c=a*this.width*.5,l=s*this.height*.5,u=a*this.width*-.5,d=s*this.height*-.5;return{x1:c,x2:u,y1:l,y2:d}},_toSVG:function(){var a=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',a.x1,'" y1="',a.y1,'" x2="',a.x2,'" y2="',a.y2,`" />
`]}}),e.Line.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),e.Line.fromElement=function(a,s,c){c=c||{};var l=e.parseAttributes(a,e.Line.ATTRIBUTE_NAMES),u=[l.x1||0,l.y1||0,l.x2||0,l.y2||0];s(new e.Line(u,n(l,c)))},e.Line.fromObject=function(a,s){function c(u){delete u.points,s&&s(u)}var l=o(a,!0);l.points=[a.x1,a.y1,a.x2,a.y2],e.Object._fromObject("Line",l,c,"points")};function i(a,s){var c=a.origin,l=a.axis1,u=a.axis2,d=a.dimension,f=s.nearest,p=s.center,m=s.farthest;return function(){switch(this.get(c)){case f:return Math.min(this.get(l),this.get(u));case p:return Math.min(this.get(l),this.get(u))+.5*this.get(d);case m:return Math.max(this.get(l),this.get(u))}}}})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.degreesToRadians;if(e.Circle){e.warn("fabric.Circle is already defined.");return}e.Circle=e.util.createClass(e.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:e.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(r,i){return this.callSuper("_set",r,i),r==="radius"&&this.setRadius(i),this},toObject:function(r){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(r))},_toSVG:function(){var r,i=0,a=0,s=(this.endAngle-this.startAngle)%360;if(s===0)r=["<circle ","COMMON_PARTS",'cx="'+i+'" cy="'+a+'" ','r="',this.radius,`" />
`];else{var c=n(this.startAngle),l=n(this.endAngle),u=this.radius,d=e.util.cos(c)*u,f=e.util.sin(c)*u,p=e.util.cos(l)*u,m=e.util.sin(l)*u,h=s>180?"1":"0";r=['<path d="M '+d+" "+f," A "+u+" "+u," 0 ",+h+" 1"," "+p+" "+m,'" ',"COMMON_PARTS",` />
`]}return r},_render:function(r){r.beginPath(),r.arc(0,0,this.radius,n(this.startAngle),n(this.endAngle),!1),this._renderPaintInOrder(r)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(r){return this.radius=r,this.set("width",r*2).set("height",r*2)}}),e.Circle.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),e.Circle.fromElement=function(r,i){var a=e.parseAttributes(r,e.Circle.ATTRIBUTE_NAMES);if(!o(a))throw new Error("value of `r` attribute is required and can not be negative");a.left=(a.left||0)-a.radius,a.top=(a.top||0)-a.radius,i(new e.Circle(a))};function o(r){return"radius"in r&&r.radius>=0}e.Circle.fromObject=function(r,i){e.Object._fromObject("Circle",r,i)}})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={});if(e.Triangle){e.warn("fabric.Triangle is already defined");return}e.Triangle=e.util.createClass(e.Object,{type:"triangle",width:100,height:100,_render:function(n){var o=this.width/2,r=this.height/2;n.beginPath(),n.moveTo(-o,r),n.lineTo(0,-r),n.lineTo(o,r),n.closePath(),this._renderPaintInOrder(n)},_toSVG:function(){var n=this.width/2,o=this.height/2,r=[-n+" "+o,"0 "+-o,n+" "+o].join(",");return["<polygon ","COMMON_PARTS",'points="',r,'" />']}}),e.Triangle.fromObject=function(n,o){return e.Object._fromObject("Triangle",n,o)}})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=Math.PI*2;if(e.Ellipse){e.warn("fabric.Ellipse is already defined.");return}e.Ellipse=e.util.createClass(e.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(o){this.callSuper("initialize",o),this.set("rx",o&&o.rx||0),this.set("ry",o&&o.ry||0)},_set:function(o,r){switch(this.callSuper("_set",o,r),o){case"rx":this.rx=r,this.set("width",r*2);break;case"ry":this.ry=r,this.set("height",r*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(o){return this.callSuper("toObject",["rx","ry"].concat(o))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(o){o.beginPath(),o.save(),o.transform(1,0,0,this.ry/this.rx,0,0),o.arc(0,0,this.rx,0,n,!1),o.restore(),this._renderPaintInOrder(o)}}),e.Ellipse.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),e.Ellipse.fromElement=function(o,r){var i=e.parseAttributes(o,e.Ellipse.ATTRIBUTE_NAMES);i.left=(i.left||0)-i.rx,i.top=(i.top||0)-i.ry,r(new e.Ellipse(i))},e.Ellipse.fromObject=function(o,r){e.Object._fromObject("Ellipse",o,r)}})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend;if(e.Rect){e.warn("fabric.Rect is already defined");return}e.Rect=e.util.createClass(e.Object,{stateProperties:e.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:e.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(o){this.callSuper("initialize",o),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(o){var r=this.rx?Math.min(this.rx,this.width/2):0,i=this.ry?Math.min(this.ry,this.height/2):0,a=this.width,s=this.height,c=-this.width/2,l=-this.height/2,u=r!==0||i!==0,d=1-.5522847498;o.beginPath(),o.moveTo(c+r,l),o.lineTo(c+a-r,l),u&&o.bezierCurveTo(c+a-d*r,l,c+a,l+d*i,c+a,l+i),o.lineTo(c+a,l+s-i),u&&o.bezierCurveTo(c+a,l+s-d*i,c+a-d*r,l+s,c+a-r,l+s),o.lineTo(c+r,l+s),u&&o.bezierCurveTo(c+d*r,l+s,c,l+s-d*i,c,l+s-i),o.lineTo(c,l+i),u&&o.bezierCurveTo(c,l+d*i,c+d*r,l,c+r,l),o.closePath(),this._renderPaintInOrder(o)},toObject:function(o){return this.callSuper("toObject",["rx","ry"].concat(o))},_toSVG:function(){var o=-this.width/2,r=-this.height/2;return["<rect ","COMMON_PARTS",'x="',o,'" y="',r,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),e.Rect.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),e.Rect.fromElement=function(o,r,i){if(!o)return r(null);i=i||{};var a=e.parseAttributes(o,e.Rect.ATTRIBUTE_NAMES);a.left=a.left||0,a.top=a.top||0,a.height=a.height||0,a.width=a.width||0;var s=new e.Rect(n(i?e.util.object.clone(i):{},a));s.visible=s.visible&&s.width>0&&s.height>0,r(s)},e.Rect.fromObject=function(o,r){return e.Object._fromObject("Rect",o,r)}})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,o=e.util.array.min,r=e.util.array.max,i=e.util.toFixed,a=e.util.projectStrokeOnPoints;if(e.Polyline){e.warn("fabric.Polyline is already defined");return}e.Polyline=e.util.createClass(e.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:e.Object.prototype.cacheProperties.concat("points"),initialize:function(s,c){c=c||{},this.points=s||[],this.callSuper("initialize",c),this._setPositionDimensions(c)},_projectStrokeOnPoints:function(){return a(this.points,this,!0)},_setPositionDimensions:function(s){var c=this._calcDimensions(s),l,u=this.exactBoundingBox?this.strokeWidth:0;this.width=c.width-u,this.height=c.height-u,s.fromSVG||(l=this.translateToGivenOrigin({x:c.left-this.strokeWidth/2+u/2,y:c.top-this.strokeWidth/2+u/2},"left","top",this.originX,this.originY)),typeof s.left>"u"&&(this.left=s.fromSVG?c.left:l.x),typeof s.top>"u"&&(this.top=s.fromSVG?c.top:l.y),this.pathOffset={x:c.left+this.width/2+u/2,y:c.top+this.height/2+u/2}},_calcDimensions:function(){var s=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,c=o(s,"x")||0,l=o(s,"y")||0,u=r(s,"x")||0,d=r(s,"y")||0,f=u-c,p=d-l;return{left:c,top:l,width:f,height:p}},toObject:function(s){return n(this.callSuper("toObject",s),{points:this.points.concat()})},_toSVG:function(){for(var s=[],c=this.pathOffset.x,l=this.pathOffset.y,u=e.Object.NUM_FRACTION_DIGITS,d=0,f=this.points.length;d<f;d++)s.push(i(this.points[d].x-c,u),",",i(this.points[d].y-l,u)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',s.join(""),`" />
`]},commonRender:function(s){var c,l=this.points.length,u=this.pathOffset.x,d=this.pathOffset.y;if(!l||isNaN(this.points[l-1].y))return!1;s.beginPath(),s.moveTo(this.points[0].x-u,this.points[0].y-d);for(var f=0;f<l;f++)c=this.points[f],s.lineTo(c.x-u,c.y-d);return!0},_render:function(s){this.commonRender(s)&&this._renderPaintInOrder(s)},complexity:function(){return this.get("points").length}}),e.Polyline.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polyline.fromElementGenerator=function(s){return function(c,l,u){if(!c)return l(null);u||(u={});var d=e.parsePointsAttribute(c.getAttribute("points")),f=e.parseAttributes(c,e[s].ATTRIBUTE_NAMES);f.fromSVG=!0,l(new e[s](d,n(f,u)))}},e.Polyline.fromElement=e.Polyline.fromElementGenerator("Polyline"),e.Polyline.fromObject=function(s,c){return e.Object._fromObject("Polyline",s,c,"points")}})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.projectStrokeOnPoints;if(e.Polygon){e.warn("fabric.Polygon is already defined");return}e.Polygon=e.util.createClass(e.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return n(this.points,this)},_render:function(o){this.commonRender(o)&&(o.closePath(),this._renderPaintInOrder(o))}}),e.Polygon.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(),e.Polygon.fromElement=e.Polyline.fromElementGenerator("Polygon"),e.Polygon.fromObject=function(o,r){e.Object._fromObject("Polygon",o,r,"points")}})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.array.min,o=e.util.array.max,r=e.util.object.extend,i=e.util.object.clone,a=e.util.toFixed;if(e.Path){e.warn("fabric.Path is already defined");return}e.Path=e.util.createClass(e.Object,{type:"path",path:null,cacheProperties:e.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:e.Object.prototype.stateProperties.concat("path"),initialize:function(s,c){c=i(c||{}),delete c.path,this.callSuper("initialize",c),this._setPath(s||[],c)},_setPath:function(s,c){this.path=e.util.makePathSimpler(Array.isArray(s)?s:e.util.parsePath(s)),e.Polyline.prototype._setPositionDimensions.call(this,c||{})},_renderPathCommands:function(s){var c,l=0,u=0,d=0,f=0,p=0,m=0,h=-this.pathOffset.x,b=-this.pathOffset.y;s.beginPath();for(var x=0,T=this.path.length;x<T;++x)switch(c=this.path[x],c[0]){case"L":d=c[1],f=c[2],s.lineTo(d+h,f+b);break;case"M":d=c[1],f=c[2],l=d,u=f,s.moveTo(d+h,f+b);break;case"C":d=c[5],f=c[6],p=c[3],m=c[4],s.bezierCurveTo(c[1]+h,c[2]+b,p+h,m+b,d+h,f+b);break;case"Q":s.quadraticCurveTo(c[1]+h,c[2]+b,c[3]+h,c[4]+b),d=c[3],f=c[4],p=c[1],m=c[2];break;case"z":case"Z":d=l,f=u,s.closePath();break}},_render:function(s){this._renderPathCommands(s),this._renderPaintInOrder(s)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(s){return r(this.callSuper("toObject",s),{path:this.path.map(function(c){return c.slice()})})},toDatalessObject:function(s){var c=this.toObject(["sourcePath"].concat(s));return c.sourcePath&&delete c.path,c},_toSVG:function(){var s=e.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',s,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var s=e.Object.NUM_FRACTION_DIGITS;return" translate("+a(-this.pathOffset.x,s)+", "+a(-this.pathOffset.y,s)+")"},toClipPathSVG:function(s){var c=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:s,additionalTransform:c})},toSVG:function(s){var c=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:s,additionalTransform:c})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var s=[],c=[],l,u=0,d=0,f=0,p=0,m,h=0,b=this.path.length;h<b;++h){switch(l=this.path[h],l[0]){case"L":f=l[1],p=l[2],m=[];break;case"M":f=l[1],p=l[2],u=f,d=p,m=[];break;case"C":m=e.util.getBoundsOfCurve(f,p,l[1],l[2],l[3],l[4],l[5],l[6]),f=l[5],p=l[6];break;case"Q":m=e.util.getBoundsOfCurve(f,p,l[1],l[2],l[1],l[2],l[3],l[4]),f=l[3],p=l[4];break;case"z":case"Z":f=u,p=d;break}m.forEach(function(j){s.push(j.x),c.push(j.y)}),s.push(f),c.push(p)}var x=n(s)||0,T=n(c)||0,B=o(s)||0,A=o(c)||0,S=B-x,H=A-T;return{left:x,top:T,width:S,height:H}}}),e.Path.fromObject=function(s,c){if(typeof s.sourcePath=="string"){var l=s.sourcePath;e.loadSVGFromURL(l,function(u){var d=u[0];d.setOptions(s),s.clipPath?e.util.enlivenObjects([s.clipPath],function(f){d.clipPath=f[0],c&&c(d)}):c&&c(d)})}else e.Object._fromObject("Path",s,c,"path")},e.Path.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat(["d"]),e.Path.fromElement=function(s,c,l){var u=e.parseAttributes(s,e.Path.ATTRIBUTE_NAMES);u.fromSVG=!0,c(new e.Path(u.d,r(u,l)))}})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.array.min,o=e.util.array.max;e.Group||(e.Group=e.util.createClass(e.Object,e.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(r,i,a){i=i||{},this._objects=[],a&&this.callSuper("initialize",i),this._objects=r||[];for(var s=this._objects.length;s--;)this._objects[s].group=this;if(a)this._updateObjectsACoords();else{var c=i&&i.centerPoint;i.originX!==void 0&&(this.originX=i.originX),i.originY!==void 0&&(this.originY=i.originY),c||this._calcBounds(),this._updateObjectsCoords(c),delete i.centerPoint,this.callSuper("initialize",i)}this.setCoords()},_updateObjectsACoords:function(){for(var r=!0,i=this._objects.length;i--;)this._objects[i].setCoords(r)},_updateObjectsCoords:function(i){for(var i=i||this.getCenterPoint(),a=this._objects.length;a--;)this._updateObjectCoords(this._objects[a],i)},_updateObjectCoords:function(r,i){var a=r.left,s=r.top,c=!0;r.set({left:a-i.x,top:s-i.y}),r.group=this,r.setCoords(c)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(r){var i=!!this.group;return this._restoreObjectsState(),e.util.resetObjectTransform(this),r&&(i&&e.util.removeTransformFromObject(r,this.group.calcTransformMatrix()),this._objects.push(r),r.group=this,r._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,i?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(r){return this._restoreObjectsState(),e.util.resetObjectTransform(this),this.remove(r),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(r){this.dirty=!0,r.group=this,r._set("canvas",this.canvas)},_onObjectRemoved:function(r){this.dirty=!0,delete r.group},_set:function(r,i){var a=this._objects.length;if(this.useSetOnGroup)for(;a--;)this._objects[a].setOnGroup(r,i);if(r==="canvas")for(;a--;)this._objects[a]._set(r,i);e.Object.prototype._set.call(this,r,i)},toObject:function(r){var i=this.includeDefaultValues,a=this._objects.filter(function(c){return!c.excludeFromExport}).map(function(c){var l=c.includeDefaultValues;c.includeDefaultValues=i;var u=c.toObject(r);return c.includeDefaultValues=l,u}),s=e.Object.prototype.toObject.call(this,r);return s.objects=a,s},toDatalessObject:function(r){var i,a=this.sourcePath;if(a)i=a;else{var s=this.includeDefaultValues;i=this._objects.map(function(l){var u=l.includeDefaultValues;l.includeDefaultValues=s;var d=l.toDatalessObject(r);return l.includeDefaultValues=u,d})}var c=e.Object.prototype.toDatalessObject.call(this,r);return c.objects=i,c},render:function(r){this._transformDone=!0,this.callSuper("render",r),this._transformDone=!1},shouldCache:function(){var r=e.Object.prototype.shouldCache.call(this);if(r){for(var i=0,a=this._objects.length;i<a;i++)if(this._objects[i].willDrawShadow())return this.ownCaching=!1,!1}return r},willDrawShadow:function(){if(e.Object.prototype.willDrawShadow.call(this))return!0;for(var r=0,i=this._objects.length;r<i;r++)if(this._objects[r].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(r){for(var i=0,a=this._objects.length;i<a;i++)this._objects[i].render(r);this._drawClipPath(r,this.clipPath)},isCacheDirty:function(r){if(this.callSuper("isCacheDirty",r))return!0;if(!this.statefullCache)return!1;for(var i=0,a=this._objects.length;i<a;i++)if(this._objects[i].isCacheDirty(!0)){if(this._cacheCanvas){var s=this.cacheWidth/this.zoomX,c=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-s/2,-c/2,s,c)}return!0}return!1},_restoreObjectsState:function(){var r=this.calcOwnMatrix();return this._objects.forEach(function(i){e.util.addTransformToObject(i,r),delete i.group,i.setCoords()}),this},destroy:function(){return this._objects.forEach(function(r){r.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(r){r.dispose&&r.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var r=this._objects,i=this.canvas;this._objects=[];var a=this.toObject();delete a.objects;var s=new e.ActiveSelection([]);return s.set(a),s.type="activeSelection",i.remove(this),r.forEach(function(c){c.group=s,c.dirty=!0,i.add(c)}),s.canvas=i,s._objects=r,i._activeObject=s,s.setCoords(),s}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var r=!0;return this.forEachObject(function(i){i.setCoords(r)}),this},_calcBounds:function(r){for(var i=[],a=[],s,c,l,u=["tr","br","bl","tl"],d=0,f=this._objects.length,p,m=u.length;d<f;++d){for(s=this._objects[d],l=s.calcACoords(),p=0;p<m;p++)c=u[p],i.push(l[c].x),a.push(l[c].y);s.aCoords=l}this._getBounds(i,a,r)},_getBounds:function(r,i,a){var s=new e.Point(n(r),n(i)),c=new e.Point(o(r),o(i)),l=s.y||0,u=s.x||0,d=c.x-s.x||0,f=c.y-s.y||0;this.width=d,this.height=f,a||this.setPositionByOrigin({x:u,y:l},"left","top")},_toSVG:function(r){for(var i=["<g ","COMMON_PARTS",` >
`],a=0,s=this._objects.length;a<s;a++)i.push("		",this._objects[a].toSVG(r));return i.push(`</g>
`),i},getSvgStyles:function(){var r=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",i=this.visible?"":" visibility: hidden;";return[r,this.getSvgFilter(),i].join("")},toClipPathSVG:function(r){for(var i=[],a=0,s=this._objects.length;a<s;a++)i.push("	",this._objects[a].toClipPathSVG(r));return this._createBaseClipPathSVGMarkup(i,{reviver:r})}}),e.Group.fromObject=function(r,i){var a=r.objects,s=e.util.object.clone(r,!0);if(delete s.objects,typeof a=="string"){e.loadSVGFromURL(a,function(c){var l=e.util.groupSVGElements(c,r,a),u=s.clipPath;delete s.clipPath,l.set(s),u?e.util.enlivenObjects([u],function(d){l.clipPath=d[0],i&&i(l)}):i&&i(l)});return}e.util.enlivenObjects(a,function(c){e.util.enlivenObjectEnlivables(r,s,function(){i&&i(new e.Group(c,s,!0))})})})})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={});e.ActiveSelection||(e.ActiveSelection=e.util.createClass(e.Group,{type:"activeSelection",initialize:function(n,o){o=o||{},this._objects=n||[];for(var r=this._objects.length;r--;)this._objects[r].group=this;o.originX&&(this.originX=o.originX),o.originY&&(this.originY=o.originY),this._calcBounds(),this._updateObjectsCoords(),e.Object.prototype.initialize.call(this,o),this.setCoords()},toGroup:function(){var n=this._objects.concat();this._objects=[];var o=e.Object.prototype.toObject.call(this),r=new e.Group([]);if(delete o.type,r.set(o),n.forEach(function(a){a.canvas.remove(a),a.group=r}),r._objects=n,!this.canvas)return r;var i=this.canvas;return i.add(r),i._activeObject=r,r.setCoords(),r},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(n,o,r){n.save(),n.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",n,o),r=r||{},typeof r.hasControls>"u"&&(r.hasControls=!1),r.forActiveSelection=!0;for(var i=0,a=this._objects.length;i<a;i++)this._objects[i]._renderControls(n,r);n.restore()}}),e.ActiveSelection.fromObject=function(n,o){e.util.enlivenObjects(n.objects,function(r){delete n.objects,o&&o(new e.ActiveSelection(r,n,!0))})})})(ae);(function(t){"use strict";var e=g.util.object.extend;if(t.fabric||(t.fabric={}),t.fabric.Image){g.warn("fabric.Image is already defined.");return}g.Image=g.util.createClass(g.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:g.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:g.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(n,o){o||(o={}),this.filters=[],this.cacheKey="texture"+g.Object.__uid++,this.callSuper("initialize",o),this._initElement(n,o)},getElement:function(){return this._element||{}},setElement:function(n,o){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=n,this._originalElement=n,this._initConfig(o),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(n){var o=g.filterBackend;o&&o.evictCachesForKey&&o.evictCachesForKey(n)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(n){g.util.cleanUpJsdomNode(this[n]),this[n]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var n=this.getElement();return{width:n.naturalWidth||n.width,height:n.naturalHeight||n.height}},_stroke:function(n){if(!(!this.stroke||this.strokeWidth===0)){var o=this.width/2,r=this.height/2;n.beginPath(),n.moveTo(-o,-r),n.lineTo(o,-r),n.lineTo(o,r),n.lineTo(-o,r),n.lineTo(-o,-r),n.closePath()}},toObject:function(n){var o=[];this.filters.forEach(function(i){i&&o.push(i.toObject())});var r=e(this.callSuper("toObject",["cropX","cropY"].concat(n)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:o});return this.resizeFilter&&(r.resizeFilter=this.resizeFilter.toObject()),r},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var n=[],o=[],r,i=this._element,a=-this.width/2,s=-this.height/2,c="",l="";if(!i)return[];if(this.hasCrop()){var u=g.Object.__uid++;n.push('<clipPath id="imageCrop_'+u+`">
`,'	<rect x="'+a+'" y="'+s+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),c=' clip-path="url(#imageCrop_'+u+')" '}if(this.imageSmoothing||(l='" image-rendering="optimizeSpeed'),o.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',a-this.cropX,'" y="',s-this.cropY,'" width="',i.width||i.naturalWidth,'" height="',i.height||i.height,l,'"',c,`></image>
`),this.stroke||this.strokeDashArray){var d=this.fill;this.fill=null,r=["	<rect ",'x="',a,'" y="',s,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=d}return this.paintFirst!=="fill"?n=n.concat(r,o):n=n.concat(o,r),n},getSrc:function(n){var o=n?this._element:this._originalElement;return o?o.toDataURL?o.toDataURL():this.srcFromAttribute?o.getAttribute("src"):o.src:this.src||""},setSrc:function(n,o,r){return g.util.loadImage(n,function(i,a){this.setElement(i,r),this._setWidthHeight(),o&&o(this,a)},this,r&&r.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var n=this.resizeFilter,o=this.minimumScaleTrigger,r=this.getTotalObjectScaling(),i=r.scaleX,a=r.scaleY,s=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!n||i>o&&a>o){this._element=s,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=i,this._lastScaleY=a;return}g.filterBackend||(g.filterBackend=g.initFilterBackend());var c=g.util.createCanvasElement(),l=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,u=s.width,d=s.height;c.width=u,c.height=d,this._element=c,this._lastScaleX=n.scaleX=i,this._lastScaleY=n.scaleY=a,g.filterBackend.applyFilters([n],s,u,d,this._element,l),this._filterScalingX=c.width/this._originalElement.width,this._filterScalingY=c.height/this._originalElement.height},applyFilters:function(n){if(n=n||this.filters||[],n=n.filter(function(s){return s&&!s.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),n.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var o=this._originalElement,r=o.naturalWidth||o.width,i=o.naturalHeight||o.height;if(this._element===this._originalElement){var a=g.util.createCanvasElement();a.width=r,a.height=i,this._element=a,this._filteredEl=a}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,r,i),this._lastScaleX=1,this._lastScaleY=1;return g.filterBackend||(g.filterBackend=g.initFilterBackend()),g.filterBackend.applyFilters(n,this._originalElement,r,i,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(n){g.util.setImageSmoothing(n,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(n),this._renderPaintInOrder(n)},drawCacheOnCanvas:function(n){g.util.setImageSmoothing(n,this.imageSmoothing),g.Object.prototype.drawCacheOnCanvas.call(this,n)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(n){var o=this._element;if(o){var r=this._filterScalingX,i=this._filterScalingY,a=this.width,s=this.height,c=Math.min,l=Math.max,u=l(this.cropX,0),d=l(this.cropY,0),f=o.naturalWidth||o.width,p=o.naturalHeight||o.height,m=u*r,h=d*i,b=c(a*r,f-m),x=c(s*i,p-h),T=-a/2,B=-s/2,A=c(a,f/r-u),S=c(s,p/i-d);o&&n.drawImage(o,m,h,b,x,T,B,A,S)}},_needsResize:function(){var n=this.getTotalObjectScaling();return n.scaleX!==this._lastScaleX||n.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(n,o){this.setElement(g.util.getById(n),o),g.util.addClass(this.getElement(),g.Image.CSS_CANVAS)},_initConfig:function(n){n||(n={}),this.setOptions(n),this._setWidthHeight(n)},_initFilters:function(n,o){n&&n.length?g.util.enlivenObjects(n,function(r){o&&o(r)},"fabric.Image.filters"):o&&o()},_setWidthHeight:function(n){n||(n={});var o=this.getElement();this.width=n.width||o.naturalWidth||o.width||0,this.height=n.height||o.naturalHeight||o.height||0},parsePreserveAspectRatioAttribute:function(){var n=g.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),o=this._element.width,r=this._element.height,i=1,a=1,s=0,c=0,l=0,u=0,d,f=this.width,p=this.height,m={width:f,height:p};return n&&(n.alignX!=="none"||n.alignY!=="none")?(n.meetOrSlice==="meet"&&(i=a=g.util.findScaleToFit(this._element,m),d=(f-o*i)/2,n.alignX==="Min"&&(s=-d),n.alignX==="Max"&&(s=d),d=(p-r*a)/2,n.alignY==="Min"&&(c=-d),n.alignY==="Max"&&(c=d)),n.meetOrSlice==="slice"&&(i=a=g.util.findScaleToCover(this._element,m),d=o-f/i,n.alignX==="Mid"&&(l=d/2),n.alignX==="Max"&&(l=d),d=r-p/a,n.alignY==="Mid"&&(u=d/2),n.alignY==="Max"&&(u=d),o=f/i,r=p/a)):(i=f/o,a=p/r),{width:o,height:r,scaleX:i,scaleY:a,offsetLeft:s,offsetTop:c,cropX:l,cropY:u}}}),g.Image.CSS_CANVAS="canvas-img",g.Image.prototype.getSvgSrc=g.Image.prototype.getSrc,g.Image.fromObject=function(n,o){var r=g.util.object.clone(n);g.util.loadImage(r.src,function(i,a){if(a){o&&o(null,!0);return}g.Image.prototype._initFilters.call(r,r.filters,function(s){r.filters=s||[],g.Image.prototype._initFilters.call(r,[r.resizeFilter],function(c){r.resizeFilter=c[0],g.util.enlivenObjectEnlivables(r,r,function(){var l=new g.Image(i,r);o(l,!1)})})})},null,r.crossOrigin)},g.Image.fromURL=function(n,o,r){g.util.loadImage(n,function(i,a){o&&o(new g.Image(i,r),a)},null,r&&r.crossOrigin)},g.Image.ATTRIBUTE_NAMES=g.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),g.Image.fromElement=function(n,o,r){var i=g.parseAttributes(n,g.Image.ATTRIBUTE_NAMES);g.Image.fromURL(i["xlink:href"],o,e(r?g.util.object.clone(r):{},i))}})(ae);g.util.object.extend(g.Object.prototype,{_getAngleValueForStraighten:function(){var t=this.angle%360;return t>0?Math.round((t-1)/90)*90:Math.round(t/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(t){t=t||{};var e=function(){},n=t.onComplete||e,o=t.onChange||e,r=this;return g.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(i){r.rotate(i),o()},onComplete:function(){r.setCoords(),n()}})}});g.util.object.extend(g.StaticCanvas.prototype,{straightenObject:function(t){return t.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(t){return t.fxStraighten({onChange:this.requestRenderAllBound})}});(function(){"use strict";function t(n,o){var r="precision "+o+` float;
void main(){}`,i=n.createShader(n.FRAGMENT_SHADER);return n.shaderSource(i,r),n.compileShader(i),!!n.getShaderParameter(i,n.COMPILE_STATUS)}g.isWebglSupported=function(n){if(g.isLikelyNode)return!1;n=n||g.WebglFilterBackend.prototype.tileSize;var o=document.createElement("canvas"),r=o.getContext("webgl")||o.getContext("experimental-webgl"),i=!1;if(r){g.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),i=g.maxTextureSize>=n;for(var a=["highp","mediump","lowp"],s=0;s<3;s++)if(t(r,a[s])){g.webGlPrecision=a[s];break}}return this.isSupported=i,i},g.WebglFilterBackend=e;function e(n){n&&n.tileSize&&(this.tileSize=n.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}e.prototype={tileSize:2048,resources:{},setupGLContext:function(n,o){this.dispose(),this.createWebGLCanvas(n,o),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(n,o)},chooseFastestCopyGLTo2DMethod:function(n,o){var r=typeof window.performance<"u",i;try{new ImageData(1,1),i=!0}catch{i=!1}var a=typeof ArrayBuffer<"u",s=typeof Uint8ClampedArray<"u";if(r&&i&&a&&s){var c=g.util.createCanvasElement(),l=new ArrayBuffer(n*o*4);if(g.forceGLPutImageData){this.imageBuffer=l,this.copyGLTo2D=rl;return}var u={imageBuffer:l,destinationWidth:n,destinationHeight:o,targetCanvas:c},d,f,p;c.width=n,c.height=o,d=window.performance.now(),nl.call(u,this.gl,u),f=window.performance.now()-d,d=window.performance.now(),rl.call(u,this.gl,u),p=window.performance.now()-d,f>p?(this.imageBuffer=l,this.copyGLTo2D=rl):this.copyGLTo2D=nl}},createWebGLCanvas:function(n,o){var r=g.util.createCanvasElement();r.width=n,r.height=o;var i={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},a=r.getContext("webgl",i);a||(a=r.getContext("experimental-webgl",i)),a&&(a.clearColor(0,0,0,0),this.canvas=r,this.gl=a)},applyFilters:function(n,o,r,i,a,s){var c=this.gl,l;s&&(l=this.getCachedTexture(s,o));var u={originalWidth:o.width||o.originalWidth,originalHeight:o.height||o.originalHeight,sourceWidth:r,sourceHeight:i,destinationWidth:r,destinationHeight:i,context:c,sourceTexture:this.createTexture(c,r,i,!l&&o),targetTexture:this.createTexture(c,r,i),originalTexture:l||this.createTexture(c,r,i,!l&&o),passes:n.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:a},d=c.createFramebuffer();return c.bindFramebuffer(c.FRAMEBUFFER,d),n.forEach(function(f){f&&f.applyTo(u)}),Gw(u),this.copyGLTo2D(c,u),c.bindTexture(c.TEXTURE_2D,null),c.deleteTexture(u.sourceTexture),c.deleteTexture(u.targetTexture),c.deleteFramebuffer(d),a.getContext("2d").setTransform(1,0,0,1,0,0),u},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(n,o,r,i,a){var s=n.createTexture();return n.bindTexture(n.TEXTURE_2D,s),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,a||n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,a||n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),i?n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,i):n.texImage2D(n.TEXTURE_2D,0,n.RGBA,o,r,0,n.RGBA,n.UNSIGNED_BYTE,null),s},getCachedTexture:function(n,o){if(this.textureCache[n])return this.textureCache[n];var r=this.createTexture(this.gl,o.width,o.height,o);return this.textureCache[n]=r,r},evictCachesForKey:function(n){this.textureCache[n]&&(this.gl.deleteTexture(this.textureCache[n]),delete this.textureCache[n])},copyGLTo2D:nl,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var n=this.gl,o={renderer:"",vendor:""};if(!n)return o;var r=n.getExtension("WEBGL_debug_renderer_info");if(r){var i=n.getParameter(r.UNMASKED_RENDERER_WEBGL),a=n.getParameter(r.UNMASKED_VENDOR_WEBGL);i&&(o.renderer=i.toLowerCase()),a&&(o.vendor=a.toLowerCase())}return this.gpuInfo=o,o}}})();function Gw(t){var e=t.targetCanvas,n=e.width,o=e.height,r=t.destinationWidth,i=t.destinationHeight;(n!==r||o!==i)&&(e.width=r,e.height=i)}function nl(t,e){var n=t.canvas,o=e.targetCanvas,r=o.getContext("2d");r.translate(0,o.height),r.scale(1,-1);var i=n.height-o.height;r.drawImage(n,0,i,o.width,o.height,0,0,o.width,o.height)}function rl(t,e){var n=e.targetCanvas,o=n.getContext("2d"),r=e.destinationWidth,i=e.destinationHeight,a=r*i*4,s=new Uint8Array(this.imageBuffer,0,a),c=new Uint8ClampedArray(this.imageBuffer,0,a);t.readPixels(0,0,r,i,t.RGBA,t.UNSIGNED_BYTE,s);var l=new ImageData(c,r,i);o.putImageData(l,0,0)}(function(){"use strict";var t=function(){};g.Canvas2dFilterBackend=e;function e(){}e.prototype={evictCachesForKey:t,dispose:t,clearWebGLCaches:t,resources:{},applyFilters:function(n,o,r,i,a){var s=a.getContext("2d");s.drawImage(o,0,0,r,i);var c=s.getImageData(0,0,r,i),l=s.getImageData(0,0,r,i),u={sourceWidth:r,sourceHeight:i,imageData:c,originalEl:o,originalImageData:l,canvasEl:a,ctx:s,filterBackend:this};return n.forEach(function(d){d.applyTo(u)}),(u.imageData.width!==r||u.imageData.height!==i)&&(a.width=u.imageData.width,a.height=u.imageData.height),s.putImageData(u.imageData,0,0),u}}})();g.Image=g.Image||{};g.Image.filters=g.Image.filters||{};g.Image.filters.BaseFilter=g.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(t){t&&this.setOptions(t)},setOptions:function(t){for(var e in t)this[e]=t[e]},createProgram:function(t,e,n){e=e||this.fragmentSource,n=n||this.vertexSource,g.webGlPrecision!=="highp"&&(e=e.replace(/precision highp float/g,"precision "+g.webGlPrecision+" float"));var o=t.createShader(t.VERTEX_SHADER);if(t.shaderSource(o,n),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+t.getShaderInfoLog(o));var r=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(r,e),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+t.getShaderInfoLog(r));var i=t.createProgram();if(t.attachShader(i,o),t.attachShader(i,r),t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+t.getProgramInfoLog(i));var a=this.getAttributeLocations(t,i),s=this.getUniformLocations(t,i)||{};return s.uStepW=t.getUniformLocation(i,"uStepW"),s.uStepH=t.getUniformLocation(i,"uStepH"),{program:i,attributeLocations:a,uniformLocations:s}},getAttributeLocations:function(t,e){return{aPosition:t.getAttribLocation(e,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(t,e,n){var o=e.aPosition,r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r),t.enableVertexAttribArray(o),t.vertexAttribPointer(o,2,t.FLOAT,!1,0,0),t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)},_setupFrameBuffer:function(t){var e=t.context,n,o;t.passes>1?(n=t.destinationWidth,o=t.destinationHeight,(t.sourceWidth!==n||t.sourceHeight!==o)&&(e.deleteTexture(t.targetTexture),t.targetTexture=t.filterBackend.createTexture(e,n,o)),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.targetTexture,0)):(e.bindFramebuffer(e.FRAMEBUFFER,null),e.finish())},_swapTextures:function(t){t.passes--,t.pass++;var e=t.targetTexture;t.targetTexture=t.sourceTexture,t.sourceTexture=e},isNeutralState:function(){var t=this.mainParameter,e=g.Image.filters[this.type].prototype;if(t)if(Array.isArray(e[t])){for(var n=e[t].length;n--;)if(this[t][n]!==e[t][n])return!1;return!0}else return e[t]===this[t];else return!1},applyTo:function(t){t.webgl?(this._setupFrameBuffer(t),this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},retrieveShader:function(t){return t.programCache.hasOwnProperty(this.type)||(t.programCache[this.type]=this.createProgram(t.context)),t.programCache[this.type]},applyToWebGL:function(t){var e=t.context,n=this.retrieveShader(t);t.pass===0&&t.originalTexture?e.bindTexture(e.TEXTURE_2D,t.originalTexture):e.bindTexture(e.TEXTURE_2D,t.sourceTexture),e.useProgram(n.program),this.sendAttributeData(e,n.attributeLocations,t.aPosition),e.uniform1f(n.uniformLocations.uStepW,1/t.sourceWidth),e.uniform1f(n.uniformLocations.uStepH,1/t.sourceHeight),this.sendUniformData(e,n.uniformLocations),e.viewport(0,0,t.destinationWidth,t.destinationHeight),e.drawArrays(e.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(t,e,n){t.activeTexture(n),t.bindTexture(t.TEXTURE_2D,e),t.activeTexture(t.TEXTURE0)},unbindAdditionalTexture:function(t,e){t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,null),t.activeTexture(t.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(t){this[this.mainParameter]=t},sendUniformData:function(){},createHelpLayer:function(t){if(!t.helpLayer){var e=document.createElement("canvas");e.width=t.sourceWidth,e.height=t.sourceHeight,t.helpLayer=e}},toObject:function(){var t={type:this.type},e=this.mainParameter;return e&&(t[e]=this[e]),t},toJSON:function(){return this.toObject()}});g.Image.filters.BaseFilter.fromObject=function(t,e){var n=new g.Image.filters[t.type](t);return e&&e(n),n};(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.ColorMatrix=o(n.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(r){this.callSuper("initialize",r),this.matrix=this.matrix.slice(0)},applyTo2d:function(r){var i=r.imageData,a=i.data,s=a.length,c=this.matrix,l,u,d,f,p,m=this.colorsOnly;for(p=0;p<s;p+=4)l=a[p],u=a[p+1],d=a[p+2],m?(a[p]=l*c[0]+u*c[1]+d*c[2]+c[4]*255,a[p+1]=l*c[5]+u*c[6]+d*c[7]+c[9]*255,a[p+2]=l*c[10]+u*c[11]+d*c[12]+c[14]*255):(f=a[p+3],a[p]=l*c[0]+u*c[1]+d*c[2]+f*c[3]+c[4]*255,a[p+1]=l*c[5]+u*c[6]+d*c[7]+f*c[8]+c[9]*255,a[p+2]=l*c[10]+u*c[11]+d*c[12]+f*c[13]+c[14]*255,a[p+3]=l*c[15]+u*c[16]+d*c[17]+f*c[18]+c[19]*255)},getUniformLocations:function(r,i){return{uColorMatrix:r.getUniformLocation(i,"uColorMatrix"),uConstants:r.getUniformLocation(i,"uConstants")}},sendUniformData:function(r,i){var a=this.matrix,s=[a[0],a[1],a[2],a[3],a[5],a[6],a[7],a[8],a[10],a[11],a[12],a[13],a[15],a[16],a[17],a[18]],c=[a[4],a[9],a[14],a[19]];r.uniformMatrix4fv(i.uColorMatrix,!1,s),r.uniform4fv(i.uConstants,c)}}),e.Image.filters.ColorMatrix.fromObject=e.Image.filters.BaseFilter.fromObject})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.Brightness=o(n.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(r){if(this.brightness!==0){var i=r.imageData,a=i.data,s,c=a.length,l=Math.round(this.brightness*255);for(s=0;s<c;s+=4)a[s]=a[s]+l,a[s+1]=a[s+1]+l,a[s+2]=a[s+2]+l}},getUniformLocations:function(r,i){return{uBrightness:r.getUniformLocation(i,"uBrightness")}},sendUniformData:function(r,i){r.uniform1f(i.uBrightness,this.brightness)}}),e.Image.filters.Brightness.fromObject=e.Image.filters.BaseFilter.fromObject})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,o=e.Image.filters,r=e.util.createClass;o.Convolute=r(o.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(i){var a=Math.sqrt(this.matrix.length),s=this.type+"_"+a+"_"+(this.opaque?1:0),c=this.fragmentSource[s];return i.programCache.hasOwnProperty(s)||(i.programCache[s]=this.createProgram(i.context,c)),i.programCache[s]},applyTo2d:function(i){var a=i.imageData,s=a.data,c=this.matrix,l=Math.round(Math.sqrt(c.length)),u=Math.floor(l/2),d=a.width,f=a.height,p=i.ctx.createImageData(d,f),m=p.data,h=this.opaque?1:0,b,x,T,B,A,S,H,j,M,I,O,Q,v;for(O=0;O<f;O++)for(I=0;I<d;I++){for(A=(O*d+I)*4,b=0,x=0,T=0,B=0,v=0;v<l;v++)for(Q=0;Q<l;Q++)H=O+v-u,S=I+Q-u,!(H<0||H>=f||S<0||S>=d)&&(j=(H*d+S)*4,M=c[v*l+Q],b+=s[j]*M,x+=s[j+1]*M,T+=s[j+2]*M,h||(B+=s[j+3]*M));m[A]=b,m[A+1]=x,m[A+2]=T,h?m[A+3]=s[A+3]:m[A+3]=B}i.imageData=p},getUniformLocations:function(i,a){return{uMatrix:i.getUniformLocation(a,"uMatrix"),uOpaque:i.getUniformLocation(a,"uOpaque"),uHalfSize:i.getUniformLocation(a,"uHalfSize"),uSize:i.getUniformLocation(a,"uSize")}},sendUniformData:function(i,a){i.uniform1fv(a.uMatrix,this.matrix)},toObject:function(){return n(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),e.Image.filters.Convolute.fromObject=e.Image.filters.BaseFilter.fromObject})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.Grayscale=o(n.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(r){var i=r.imageData,a=i.data,s,c=a.length,l,u=this.mode;for(s=0;s<c;s+=4)u==="average"?l=(a[s]+a[s+1]+a[s+2])/3:u==="lightness"?l=(Math.min(a[s],a[s+1],a[s+2])+Math.max(a[s],a[s+1],a[s+2]))/2:u==="luminosity"&&(l=.21*a[s]+.72*a[s+1]+.07*a[s+2]),a[s]=l,a[s+1]=l,a[s+2]=l},retrieveShader:function(r){var i=this.type+"_"+this.mode;if(!r.programCache.hasOwnProperty(i)){var a=this.fragmentSource[this.mode];r.programCache[i]=this.createProgram(r.context,a)}return r.programCache[i]},getUniformLocations:function(r,i){return{uMode:r.getUniformLocation(i,"uMode")}},sendUniformData:function(r,i){var a=1;r.uniform1i(i.uMode,a)},isNeutralState:function(){return!1}}),e.Image.filters.Grayscale.fromObject=e.Image.filters.BaseFilter.fromObject})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.Invert=o(n.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(r){var i=r.imageData,a=i.data,s,c=a.length;for(s=0;s<c;s+=4)a[s]=255-a[s],a[s+1]=255-a[s+1],a[s+2]=255-a[s+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(r,i){return{uInvert:r.getUniformLocation(i,"uInvert")}},sendUniformData:function(r,i){r.uniform1i(i.uInvert,this.invert)}}),e.Image.filters.Invert.fromObject=e.Image.filters.BaseFilter.fromObject})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,o=e.Image.filters,r=e.util.createClass;o.Noise=r(o.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(i){if(this.noise!==0){var a=i.imageData,s=a.data,c,l=s.length,u=this.noise,d;for(c=0,l=s.length;c<l;c+=4)d=(.5-Math.random())*u,s[c]+=d,s[c+1]+=d,s[c+2]+=d}},getUniformLocations:function(i,a){return{uNoise:i.getUniformLocation(a,"uNoise"),uSeed:i.getUniformLocation(a,"uSeed")}},sendUniformData:function(i,a){i.uniform1f(a.uNoise,this.noise/255),i.uniform1f(a.uSeed,Math.random())},toObject:function(){return n(this.callSuper("toObject"),{noise:this.noise})}}),e.Image.filters.Noise.fromObject=e.Image.filters.BaseFilter.fromObject})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.Pixelate=o(n.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(r){var i=r.imageData,a=i.data,s=i.height,c=i.width,l,u,d,f,p,m,h,b,x,T,B;for(u=0;u<s;u+=this.blocksize)for(d=0;d<c;d+=this.blocksize)for(l=u*4*c+d*4,f=a[l],p=a[l+1],m=a[l+2],h=a[l+3],T=Math.min(u+this.blocksize,s),B=Math.min(d+this.blocksize,c),b=u;b<T;b++)for(x=d;x<B;x++)l=b*4*c+x*4,a[l]=f,a[l+1]=p,a[l+2]=m,a[l+3]=h},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(r,i){return{uBlocksize:r.getUniformLocation(i,"uBlocksize"),uStepW:r.getUniformLocation(i,"uStepW"),uStepH:r.getUniformLocation(i,"uStepH")}},sendUniformData:function(r,i){r.uniform1f(i.uBlocksize,this.blocksize)}}),e.Image.filters.Pixelate.fromObject=e.Image.filters.BaseFilter.fromObject})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.extend,o=e.Image.filters,r=e.util.createClass;o.RemoveColor=r(o.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(i){var a=i.imageData,s=a.data,c,l=this.distance*255,u,d,f,p=new e.Color(this.color).getSource(),m=[p[0]-l,p[1]-l,p[2]-l],h=[p[0]+l,p[1]+l,p[2]+l];for(c=0;c<s.length;c+=4)u=s[c],d=s[c+1],f=s[c+2],u>m[0]&&d>m[1]&&f>m[2]&&u<h[0]&&d<h[1]&&f<h[2]&&(s[c+3]=0)},getUniformLocations:function(i,a){return{uLow:i.getUniformLocation(a,"uLow"),uHigh:i.getUniformLocation(a,"uHigh")}},sendUniformData:function(i,a){var s=new e.Color(this.color).getSource(),c=parseFloat(this.distance),l=[0+s[0]/255-c,0+s[1]/255-c,0+s[2]/255-c,1],u=[s[0]/255+c,s[1]/255+c,s[2]/255+c,1];i.uniform4fv(a.uLow,l),i.uniform4fv(a.uHigh,u)},toObject:function(){return n(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),e.Image.filters.RemoveColor.fromObject=e.Image.filters.BaseFilter.fromObject})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass,r={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var i in r)n[i]=o(n.ColorMatrix,{type:i,matrix:r[i],mainParameter:!1,colorsOnly:!0}),e.Image.filters[i].fromObject=e.Image.filters.BaseFilter.fromObject})(ae);(function(t){"use strict";var e=t.fabric,n=e.Image.filters,o=e.util.createClass;n.BlendColor=o(n.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(r){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[r]+`}
}`},retrieveShader:function(r){var i=this.type+"_"+this.mode,a;return r.programCache.hasOwnProperty(i)||(a=this.buildSource(this.mode),r.programCache[i]=this.createProgram(r.context,a)),r.programCache[i]},applyTo2d:function(r){var i=r.imageData,a=i.data,s=a.length,c,l,u,d,f,p,m,h=1-this.alpha;m=new e.Color(this.color).getSource(),c=m[0]*this.alpha,l=m[1]*this.alpha,u=m[2]*this.alpha;for(var b=0;b<s;b+=4)switch(d=a[b],f=a[b+1],p=a[b+2],this.mode){case"multiply":a[b]=d*c/255,a[b+1]=f*l/255,a[b+2]=p*u/255;break;case"screen":a[b]=255-(255-d)*(255-c)/255,a[b+1]=255-(255-f)*(255-l)/255,a[b+2]=255-(255-p)*(255-u)/255;break;case"add":a[b]=d+c,a[b+1]=f+l,a[b+2]=p+u;break;case"diff":case"difference":a[b]=Math.abs(d-c),a[b+1]=Math.abs(f-l),a[b+2]=Math.abs(p-u);break;case"subtract":a[b]=d-c,a[b+1]=f-l,a[b+2]=p-u;break;case"darken":a[b]=Math.min(d,c),a[b+1]=Math.min(f,l),a[b+2]=Math.min(p,u);break;case"lighten":a[b]=Math.max(d,c),a[b+1]=Math.max(f,l),a[b+2]=Math.max(p,u);break;case"overlay":a[b]=c<128?2*d*c/255:255-2*(255-d)*(255-c)/255,a[b+1]=l<128?2*f*l/255:255-2*(255-f)*(255-l)/255,a[b+2]=u<128?2*p*u/255:255-2*(255-p)*(255-u)/255;break;case"exclusion":a[b]=c+d-2*c*d/255,a[b+1]=l+f-2*l*f/255,a[b+2]=u+p-2*u*p/255;break;case"tint":a[b]=c+d*h,a[b+1]=l+f*h,a[b+2]=u+p*h}},getUniformLocations:function(r,i){return{uColor:r.getUniformLocation(i,"uColor")}},sendUniformData:function(r,i){var a=new e.Color(this.color).getSource();a[0]=this.alpha*a[0]/255,a[1]=this.alpha*a[1]/255,a[2]=this.alpha*a[2]/255,a[3]=this.alpha,r.uniform4fv(i.uColor,a)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendColor.fromObject=e.Image.filters.BaseFilter.fromObject})(ae);(function(t){"use strict";var e=t.fabric,n=e.Image.filters,o=e.util.createClass;n.BlendImage=o(n.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(r){var i=this.type+"_"+this.mode,a=this.fragmentSource[this.mode];return r.programCache.hasOwnProperty(i)||(r.programCache[i]=this.createProgram(r.context,a)),r.programCache[i]},applyToWebGL:function(r){var i=r.context,a=this.createTexture(r.filterBackend,this.image);this.bindAdditionalTexture(i,a,i.TEXTURE1),this.callSuper("applyToWebGL",r),this.unbindAdditionalTexture(i,i.TEXTURE1)},createTexture:function(r,i){return r.getCachedTexture(i.cacheKey,i._element)},calculateMatrix:function(){var r=this.image,i=r._element.width,a=r._element.height;return[1/r.scaleX,0,0,0,1/r.scaleY,0,-r.left/i,-r.top/a,1]},applyTo2d:function(r){var i=r.imageData,a=r.filterBackend.resources,s=i.data,c=s.length,l=i.width,u=i.height,d,f,p,m,h,b,x,T,B,A,S=this.image,H;a.blendImage||(a.blendImage=e.util.createCanvasElement()),B=a.blendImage,A=B.getContext("2d"),B.width!==l||B.height!==u?(B.width=l,B.height=u):A.clearRect(0,0,l,u),A.setTransform(S.scaleX,0,0,S.scaleY,S.left,S.top),A.drawImage(S._element,0,0,l,u),H=A.getImageData(0,0,l,u).data;for(var j=0;j<c;j+=4)switch(h=s[j],b=s[j+1],x=s[j+2],T=s[j+3],d=H[j],f=H[j+1],p=H[j+2],m=H[j+3],this.mode){case"multiply":s[j]=h*d/255,s[j+1]=b*f/255,s[j+2]=x*p/255,s[j+3]=T*m/255;break;case"mask":s[j+3]=m;break}},getUniformLocations:function(r,i){return{uTransformMatrix:r.getUniformLocation(i,"uTransformMatrix"),uImage:r.getUniformLocation(i,"uImage")}},sendUniformData:function(r,i){var a=this.calculateMatrix();r.uniform1i(i.uImage,1),r.uniformMatrix3fv(i.uTransformMatrix,!1,a)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),e.Image.filters.BlendImage.fromObject=function(r,i){e.Image.fromObject(r.image,function(a){var s=e.util.object.clone(r);s.image=a,i(new e.Image.filters.BlendImage(s))})}})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=Math.pow,o=Math.floor,r=Math.sqrt,i=Math.abs,a=Math.round,s=Math.sin,c=Math.ceil,l=e.Image.filters,u=e.util.createClass;l.Resize=u(l.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(d,f){return{uDelta:d.getUniformLocation(f,"uDelta"),uTaps:d.getUniformLocation(f,"uTaps")}},sendUniformData:function(d,f){d.uniform2fv(f.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),d.uniform1fv(f.uTaps,this.taps)},retrieveShader:function(d){var f=this.getFilterWindow(),p=this.type+"_"+f;if(!d.programCache.hasOwnProperty(p)){var m=this.generateShader(f);d.programCache[p]=this.createProgram(d.context,m)}return d.programCache[p]},getFilterWindow:function(){var d=this.tempScale;return Math.ceil(this.lanczosLobes/d)},getTaps:function(){for(var d=this.lanczosCreate(this.lanczosLobes),f=this.tempScale,p=this.getFilterWindow(),m=new Array(p),h=1;h<=p;h++)m[h-1]=d(h*f);return m},generateShader:function(m){for(var f=new Array(m),p=this.fragmentSourceTOP,m,h=1;h<=m;h++)f[h-1]=h+".0 * uDelta";return p+="uniform float uTaps["+m+`];
`,p+=`void main() {
`,p+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,p+=`  float sum = 1.0;
`,f.forEach(function(b,x){p+="  color += texture2D(uTexture, vTexCoord + "+b+") * uTaps["+x+`];
`,p+="  color += texture2D(uTexture, vTexCoord - "+b+") * uTaps["+x+`];
`,p+="  sum += 2.0 * uTaps["+x+`];
`}),p+=`  gl_FragColor = color / sum;
`,p+="}",p},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(d){d.webgl?(d.passes++,this.width=d.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=d.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),d.destinationWidth=this.dW,this._setupFrameBuffer(d),this.applyToWebGL(d),this._swapTextures(d),d.sourceWidth=d.destinationWidth,this.height=d.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),d.destinationHeight=this.dH,this._setupFrameBuffer(d),this.applyToWebGL(d),this._swapTextures(d),d.sourceHeight=d.destinationHeight):this.applyTo2d(d)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(d){return function(f){if(f>=d||f<=-d)return 0;if(f<11920929e-14&&f>-11920929e-14)return 1;f*=Math.PI;var p=f/d;return s(f)/f*s(p)/p}},applyTo2d:function(d){var f=d.imageData,p=this.scaleX,m=this.scaleY;this.rcpScaleX=1/p,this.rcpScaleY=1/m;var h=f.width,b=f.height,x=a(h*p),T=a(b*m),B;this.resizeType==="sliceHack"?B=this.sliceByTwo(d,h,b,x,T):this.resizeType==="hermite"?B=this.hermiteFastResize(d,h,b,x,T):this.resizeType==="bilinear"?B=this.bilinearFiltering(d,h,b,x,T):this.resizeType==="lanczos"&&(B=this.lanczosResize(d,h,b,x,T)),d.imageData=B},sliceByTwo:function(d,f,p,m,h){var b=d.imageData,x=.5,T=!1,B=!1,A=f*x,S=p*x,H=e.filterBackend.resources,j,M,I=0,O=0,Q=f,v=0;for(H.sliceByTwo||(H.sliceByTwo=document.createElement("canvas")),j=H.sliceByTwo,(j.width<f*1.5||j.height<p)&&(j.width=f*1.5,j.height=p),M=j.getContext("2d"),M.clearRect(0,0,f*1.5,p),M.putImageData(b,0,0),m=o(m),h=o(h);!T||!B;)f=A,p=S,m<o(A*x)?A=o(A*x):(A=m,T=!0),h<o(S*x)?S=o(S*x):(S=h,B=!0),M.drawImage(j,I,O,f,p,Q,v,A,S),I=Q,O=v,v+=S;return M.getImageData(I,O,m,h)},lanczosResize:function(d,f,p,m,h){function b(R){var N,W,C,w,D,_,F,G,$,X,U;for(v.x=(R+.5)*S,k.x=o(v.x),N=0;N<h;N++){for(v.y=(N+.5)*H,k.y=o(v.y),D=0,_=0,F=0,G=0,$=0,W=k.x-I;W<=k.x+I;W++)if(!(W<0||W>=f)){X=o(1e3*i(W-v.x)),Q[X]||(Q[X]={});for(var P=k.y-O;P<=k.y+O;P++)P<0||P>=p||(U=o(1e3*i(P-v.y)),Q[X][U]||(Q[X][U]=A(r(n(X*j,2)+n(U*M,2))/1e3)),C=Q[X][U],C>0&&(w=(P*f+W)*4,D+=C,_+=C*x[w],F+=C*x[w+1],G+=C*x[w+2],$+=C*x[w+3]))}w=(N*m+R)*4,B[w]=_/D,B[w+1]=F/D,B[w+2]=G/D,B[w+3]=$/D}return++R<m?b(R):T}var x=d.imageData.data,T=d.ctx.createImageData(m,h),B=T.data,A=this.lanczosCreate(this.lanczosLobes),S=this.rcpScaleX,H=this.rcpScaleY,j=2/this.rcpScaleX,M=2/this.rcpScaleY,I=c(S*this.lanczosLobes/2),O=c(H*this.lanczosLobes/2),Q={},v={},k={};return b(0)},bilinearFiltering:function(d,f,p,m,h){var b,x,T,B,A,S,H,j,M,I,O,Q,v=0,k,R=this.rcpScaleX,N=this.rcpScaleY,W=4*(f-1),C=d.imageData,w=C.data,D=d.ctx.createImageData(m,h),_=D.data;for(H=0;H<h;H++)for(j=0;j<m;j++)for(A=o(R*j),S=o(N*H),M=R*j-A,I=N*H-S,k=4*(S*f+A),O=0;O<4;O++)b=w[k+O],x=w[k+4+O],T=w[k+W+O],B=w[k+W+4+O],Q=b*(1-M)*(1-I)+x*M*(1-I)+T*I*(1-M)+B*M*I,_[v++]=Q;return D},hermiteFastResize:function(d,f,p,m,h){for(var b=this.rcpScaleX,x=this.rcpScaleY,T=c(b/2),B=c(x/2),A=d.imageData,S=A.data,H=d.ctx.createImageData(m,h),j=H.data,M=0;M<h;M++)for(var I=0;I<m;I++){for(var O=(I+M*m)*4,Q=0,v=0,k=0,R=0,N=0,W=0,C=0,w=(M+.5)*x,D=o(M*x);D<(M+1)*x;D++)for(var _=i(w-(D+.5))/B,F=(I+.5)*b,G=_*_,$=o(I*b);$<(I+1)*b;$++){var X=i(F-($+.5))/T,U=r(G+X*X);U>1&&U<-1||(Q=2*U*U*U-3*U*U+1,Q>0&&(X=4*($+D*f),C+=Q*S[X+3],k+=Q,S[X+3]<255&&(Q=Q*S[X+3]/250),R+=Q*S[X],N+=Q*S[X+1],W+=Q*S[X+2],v+=Q))}j[O]=R/v,j[O+1]=N/v,j[O+2]=W/v,j[O+3]=C/k}return H},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),e.Image.filters.Resize.fromObject=e.Image.filters.BaseFilter.fromObject})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.Contrast=o(n.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(r){if(this.contrast!==0){var i=r.imageData,a,c,s=i.data,c=s.length,l=Math.floor(this.contrast*255),u=259*(l+255)/(255*(259-l));for(a=0;a<c;a+=4)s[a]=u*(s[a]-128)+128,s[a+1]=u*(s[a+1]-128)+128,s[a+2]=u*(s[a+2]-128)+128}},getUniformLocations:function(r,i){return{uContrast:r.getUniformLocation(i,"uContrast")}},sendUniformData:function(r,i){r.uniform1f(i.uContrast,this.contrast)}}),e.Image.filters.Contrast.fromObject=e.Image.filters.BaseFilter.fromObject})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.Saturation=o(n.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(r){if(this.saturation!==0){var i=r.imageData,a=i.data,s=a.length,c=-this.saturation,l,u;for(l=0;l<s;l+=4)u=Math.max(a[l],a[l+1],a[l+2]),a[l]+=u!==a[l]?(u-a[l])*c:0,a[l+1]+=u!==a[l+1]?(u-a[l+1])*c:0,a[l+2]+=u!==a[l+2]?(u-a[l+2])*c:0}},getUniformLocations:function(r,i){return{uSaturation:r.getUniformLocation(i,"uSaturation")}},sendUniformData:function(r,i){r.uniform1f(i.uSaturation,-this.saturation)}}),e.Image.filters.Saturation.fromObject=e.Image.filters.BaseFilter.fromObject})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.Vibrance=o(n.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(r){if(this.vibrance!==0){var i=r.imageData,a=i.data,s=a.length,c=-this.vibrance,l,u,d,f;for(l=0;l<s;l+=4)u=Math.max(a[l],a[l+1],a[l+2]),d=(a[l]+a[l+1]+a[l+2])/3,f=Math.abs(u-d)*2/255*c,a[l]+=u!==a[l]?(u-a[l])*f:0,a[l+1]+=u!==a[l+1]?(u-a[l+1])*f:0,a[l+2]+=u!==a[l+2]?(u-a[l+2])*f:0}},getUniformLocations:function(r,i){return{uVibrance:r.getUniformLocation(i,"uVibrance")}},sendUniformData:function(r,i){r.uniform1f(i.uVibrance,-this.vibrance)}}),e.Image.filters.Vibrance.fromObject=e.Image.filters.BaseFilter.fromObject})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.Blur=o(n.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(r){r.webgl?(this.aspectRatio=r.sourceWidth/r.sourceHeight,r.passes++,this._setupFrameBuffer(r),this.horizontal=!0,this.applyToWebGL(r),this._swapTextures(r),this._setupFrameBuffer(r),this.horizontal=!1,this.applyToWebGL(r),this._swapTextures(r)):this.applyTo2d(r)},applyTo2d:function(r){r.imageData=this.simpleBlur(r)},simpleBlur:function(r){var i=r.filterBackend.resources,a,s,c=r.imageData.width,l=r.imageData.height;i.blurLayer1||(i.blurLayer1=e.util.createCanvasElement(),i.blurLayer2=e.util.createCanvasElement()),a=i.blurLayer1,s=i.blurLayer2,(a.width!==c||a.height!==l)&&(s.width=a.width=c,s.height=a.height=l);var u=a.getContext("2d"),d=s.getContext("2d"),f=15,p,m,h,b,x=this.blur*.06*.5;for(u.putImageData(r.imageData,0,0),d.clearRect(0,0,c,l),b=-f;b<=f;b++)p=(Math.random()-.5)/4,m=b/f,h=x*m*c+p,d.globalAlpha=1-Math.abs(m),d.drawImage(a,h,p),u.drawImage(s,0,0),d.globalAlpha=1,d.clearRect(0,0,s.width,s.height);for(b=-f;b<=f;b++)p=(Math.random()-.5)/4,m=b/f,h=x*m*l+p,d.globalAlpha=1-Math.abs(m),d.drawImage(a,p,h),u.drawImage(s,0,0),d.globalAlpha=1,d.clearRect(0,0,s.width,s.height);r.ctx.drawImage(a,0,0);var T=r.ctx.getImageData(0,0,a.width,a.height);return u.globalAlpha=1,u.clearRect(0,0,a.width,a.height),T},getUniformLocations:function(r,i){return{delta:r.getUniformLocation(i,"uDelta")}},sendUniformData:function(r,i){var a=this.chooseRightDelta();r.uniform2fv(i.delta,a)},chooseRightDelta:function(){var r=1,i=[0,0],a;return this.horizontal?this.aspectRatio>1&&(r=1/this.aspectRatio):this.aspectRatio<1&&(r=this.aspectRatio),a=r*this.blur*.12,this.horizontal?i[0]=a:i[1]=a,i}}),n.Blur.fromObject=e.Image.filters.BaseFilter.fromObject})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.Gamma=o(n.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(r){this.gamma=[1,1,1],n.BaseFilter.prototype.initialize.call(this,r)},applyTo2d:function(r){var i=r.imageData,a=i.data,s=this.gamma,c=a.length,l=1/s[0],u=1/s[1],d=1/s[2],f;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),f=0,c=256;f<c;f++)this.rVals[f]=Math.pow(f/255,l)*255,this.gVals[f]=Math.pow(f/255,u)*255,this.bVals[f]=Math.pow(f/255,d)*255;for(f=0,c=a.length;f<c;f+=4)a[f]=this.rVals[a[f]],a[f+1]=this.gVals[a[f+1]],a[f+2]=this.bVals[a[f+2]]},getUniformLocations:function(r,i){return{uGamma:r.getUniformLocation(i,"uGamma")}},sendUniformData:function(r,i){r.uniform3fv(i.uGamma,this.gamma)}}),e.Image.filters.Gamma.fromObject=e.Image.filters.BaseFilter.fromObject})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.Composed=o(n.BaseFilter,{type:"Composed",subFilters:[],initialize:function(r){this.callSuper("initialize",r),this.subFilters=this.subFilters.slice(0)},applyTo:function(r){r.passes+=this.subFilters.length-1,this.subFilters.forEach(function(i){i.applyTo(r)})},toObject:function(){return e.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(r){return r.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(r){return!r.isNeutralState()})}}),e.Image.filters.Composed.fromObject=function(r,i){var a=r.subFilters||[],s=a.map(function(l){return new e.Image.filters[l.type](l)}),c=new e.Image.filters.Composed({subFilters:s});return i&&i(c),c}})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.Image.filters,o=e.util.createClass;n.HueRotation=o(n.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var r=this.rotation*Math.PI,i=e.util.cos(r),a=e.util.sin(r),s=1/3,c=Math.sqrt(s)*a,l=1-i;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=i+l/3,this.matrix[1]=s*l-c,this.matrix[2]=s*l+c,this.matrix[5]=s*l+c,this.matrix[6]=i+s*l,this.matrix[7]=s*l-c,this.matrix[10]=s*l-c,this.matrix[11]=s*l+c,this.matrix[12]=i+s*l},isNeutralState:function(r){return this.calculateMatrix(),n.BaseFilter.prototype.isNeutralState.call(this,r)},applyTo:function(r){this.calculateMatrix(),n.BaseFilter.prototype.applyTo.call(this,r)}}),e.Image.filters.HueRotation.fromObject=e.Image.filters.BaseFilter.fromObject})(ae);(function(t){"use strict";var e=t.fabric||(t.fabric={}),n=e.util.object.clone;if(e.Text){e.warn("fabric.Text is already defined");return}var o="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");e.Text=e.util.createClass(e.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:e.Object.prototype.stateProperties.concat(o),cacheProperties:e.Object.prototype.cacheProperties.concat(o),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(r,i){this.styles=i?i.styles||{}:{},this.text=r,this.__skipDimension=!0,this.callSuper("initialize",i),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var r=this.path;r&&(r.segmentsInfo=e.util.getPathSegmentsInfo(r.path))},getMeasuringContext:function(){return e._measuringContext||(e._measuringContext=this.canvas&&this.canvas.contextCache||e.util.createCanvasElement().getContext("2d")),e._measuringContext},_splitText:function(){var r=this._splitTextIntoLines(this.text);return this.textLines=r.lines,this._textLines=r.graphemeLines,this._unwrappedTextLines=r._unwrappedLines,this._text=r.graphemeText,r},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var r,i,a,s,c,l,u,d=0,f=this._textLines.length;d<f;d++)if(!(this.textAlign!=="justify"&&(d===f-1||this.isEndOfWrapping(d)))&&(s=0,c=this._textLines[d],i=this.getLineWidth(d),i<this.width&&(u=this.textLines[d].match(this._reSpacesAndTabs)))){a=u.length,r=(this.width-i)/a;for(var p=0,m=c.length;p<=m;p++)l=this.__charBounds[d][p],this._reSpaceAndTab.test(c[p])?(l.width+=r,l.kernedWidth+=r,l.left+=s,s+=r):l.left+=s}},isEndOfWrapping:function(r){return r===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var r=this.callSuper("_getCacheCanvasDimensions"),i=this.fontSize;return r.width+=i*r.zoomX,r.height+=i*r.zoomY,r},_render:function(r){var i=this.path;i&&!i.isNotVisible()&&i._render(r),this._setTextStyles(r),this._renderTextLinesBackground(r),this._renderTextDecoration(r,"underline"),this._renderText(r),this._renderTextDecoration(r,"overline"),this._renderTextDecoration(r,"linethrough")},_renderText:function(r){this.paintFirst==="stroke"?(this._renderTextStroke(r),this._renderTextFill(r)):(this._renderTextFill(r),this._renderTextStroke(r))},_setTextStyles:function(r,i,a){if(r.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":r.textBaseline="middle";break;case"ascender":r.textBaseline="top";break;case"descender":r.textBaseline="bottom";break}r.font=this._getFontDeclaration(i,a)},calcTextWidth:function(){for(var r=this.getLineWidth(0),i=1,a=this._textLines.length;i<a;i++){var s=this.getLineWidth(i);s>r&&(r=s)}return r},_renderTextLine:function(r,i,a,s,c,l){this._renderChars(r,i,a,s,c,l)},_renderTextLinesBackground:function(r){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var i,a,s=r.fillStyle,c,l,u=this._getLeftOffset(),d=this._getTopOffset(),f=0,p=0,m,h,b=this.path,x,T=0,B=this._textLines.length;T<B;T++){if(i=this.getHeightOfLine(T),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",T)){d+=i;continue}c=this._textLines[T],a=this._getLineLeftOffset(T),p=0,f=0,l=this.getValueOfPropertyAt(T,0,"textBackgroundColor");for(var A=0,S=c.length;A<S;A++)m=this.__charBounds[T][A],h=this.getValueOfPropertyAt(T,A,"textBackgroundColor"),b?(r.save(),r.translate(m.renderLeft,m.renderTop),r.rotate(m.angle),r.fillStyle=h,h&&r.fillRect(-m.width/2,-i/this.lineHeight*(1-this._fontSizeFraction),m.width,i/this.lineHeight),r.restore()):h!==l?(x=u+a+f,this.direction==="rtl"&&(x=this.width-x-p),r.fillStyle=l,l&&r.fillRect(x,d,p,i/this.lineHeight),f=m.left,p=m.width,l=h):p+=m.kernedWidth;h&&!b&&(x=u+a+f,this.direction==="rtl"&&(x=this.width-x-p),r.fillStyle=h,r.fillRect(x,d,p,i/this.lineHeight)),d+=i}r.fillStyle=s,this._removeShadow(r)}},getFontCache:function(r){var i=r.fontFamily.toLowerCase();e.charWidthsCache[i]||(e.charWidthsCache[i]={});var a=e.charWidthsCache[i],s=r.fontStyle.toLowerCase()+"_"+(r.fontWeight+"").toLowerCase();return a[s]||(a[s]={}),a[s]},_measureChar:function(r,i,a,s){var c=this.getFontCache(i),l=this._getFontDeclaration(i),u=this._getFontDeclaration(s),d=a+r,f=l===u,p,m,h,b=i.fontSize/this.CACHE_FONT_SIZE,x;if(a&&c[a]!==void 0&&(h=c[a]),c[r]!==void 0&&(x=p=c[r]),f&&c[d]!==void 0&&(m=c[d],x=m-h),p===void 0||h===void 0||m===void 0){var T=this.getMeasuringContext();this._setTextStyles(T,i,!0)}return p===void 0&&(x=p=T.measureText(r).width,c[r]=p),h===void 0&&f&&a&&(h=T.measureText(a).width,c[a]=h),f&&m===void 0&&(m=T.measureText(d).width,c[d]=m,x=m-h),{width:p*b,kernedWidth:x*b}},getHeightOfChar:function(r,i){return this.getValueOfPropertyAt(r,i,"fontSize")},measureLine:function(r){var i=this._measureLine(r);return this.charSpacing!==0&&(i.width-=this._getWidthOfCharSpacing()),i.width<0&&(i.width=0),i},_measureLine:function(r){var i=0,a,s,c=this._textLines[r],l,u,d=0,f=new Array(c.length),p=0,m,h,b=this.path,x=this.pathSide==="right";for(this.__charBounds[r]=f,a=0;a<c.length;a++)s=c[a],u=this._getGraphemeBox(s,r,a,l),f[a]=u,i+=u.kernedWidth,l=s;if(f[a]={left:u?u.left+u.width:0,width:0,kernedWidth:0,height:this.fontSize},b){switch(h=b.segmentsInfo[b.segmentsInfo.length-1].length,m=e.util.getPointOnPath(b.path,0,b.segmentsInfo),m.x+=b.pathOffset.x,m.y+=b.pathOffset.y,this.textAlign){case"left":p=x?h-i:0;break;case"center":p=(h-i)/2;break;case"right":p=x?0:h-i;break}for(p+=this.pathStartOffset*(x?-1:1),a=x?c.length-1:0;x?a>=0:a<c.length;x?a--:a++)u=f[a],p>h?p%=h:p<0&&(p+=h),this._setGraphemeOnPath(p,u,m),p+=u.kernedWidth}return{width:i,numOfSpaces:d}},_setGraphemeOnPath:function(r,i,a){var s=r+i.kernedWidth/2,c=this.path,l=e.util.getPointOnPath(c.path,s,c.segmentsInfo);i.renderLeft=l.x-a.x,i.renderTop=l.y-a.y,i.angle=l.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(r,i,a,s,c){var l=this.getCompleteStyleDeclaration(i,a),u=s?this.getCompleteStyleDeclaration(i,a-1):{},d=this._measureChar(r,l,s,u),f=d.kernedWidth,p=d.width,m;this.charSpacing!==0&&(m=this._getWidthOfCharSpacing(),p+=m,f+=m);var h={width:p,left:0,height:l.fontSize,kernedWidth:f,deltaY:l.deltaY};if(a>0&&!c){var b=this.__charBounds[i][a-1];h.left=b.left+b.width+d.kernedWidth-d.width}return h},getHeightOfLine:function(r){if(this.__lineHeights[r])return this.__lineHeights[r];for(var i=this._textLines[r],a=this.getHeightOfChar(r,0),s=1,c=i.length;s<c;s++)a=Math.max(this.getHeightOfChar(r,s),a);return this.__lineHeights[r]=a*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var r,i=0,a=0,s=this._textLines.length;a<s;a++)r=this.getHeightOfLine(a),i+=a===s-1?r/this.lineHeight:r;return i},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(r,i){r.save();for(var a=0,s=this._getLeftOffset(),c=this._getTopOffset(),l=0,u=this._textLines.length;l<u;l++){var d=this.getHeightOfLine(l),f=d/this.lineHeight,p=this._getLineLeftOffset(l);this._renderTextLine(i,r,this._textLines[l],s+p,c+a+f,l),a+=d}r.restore()},_renderTextFill:function(r){!this.fill&&!this.styleHas("fill")||this._renderTextCommon(r,"fillText")},_renderTextStroke:function(r){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(r),r.save(),this._setLineDash(r,this.strokeDashArray),r.beginPath(),this._renderTextCommon(r,"strokeText"),r.closePath(),r.restore())},_renderChars:function(r,i,a,s,c,l){var u=this.getHeightOfLine(l),d=this.textAlign.indexOf("justify")!==-1,f,p,m="",h,b=0,x,T=this.path,B=!d&&this.charSpacing===0&&this.isEmptyStyles(l)&&!T,A=this.direction==="ltr",S=this.direction==="ltr"?1:-1,H,j=i.canvas.getAttribute("dir");if(i.save(),j!==this.direction&&(i.canvas.setAttribute("dir",A?"ltr":"rtl"),i.direction=A?"ltr":"rtl",i.textAlign=A?"left":"right"),c-=u*this._fontSizeFraction/this.lineHeight,B){this._renderChar(r,i,l,0,a.join(""),s,c,u),i.restore();return}for(var M=0,I=a.length-1;M<=I;M++)x=M===I||this.charSpacing||T,m+=a[M],h=this.__charBounds[l][M],b===0?(s+=S*(h.kernedWidth-h.width),b+=h.width):b+=h.kernedWidth,d&&!x&&this._reSpaceAndTab.test(a[M])&&(x=!0),x||(f=f||this.getCompleteStyleDeclaration(l,M),p=this.getCompleteStyleDeclaration(l,M+1),x=e.util.hasStyleChanged(f,p,!1)),x&&(T?(i.save(),i.translate(h.renderLeft,h.renderTop),i.rotate(h.angle),this._renderChar(r,i,l,M,m,-b/2,0,u),i.restore()):(H=s,this._renderChar(r,i,l,M,m,H,c,u)),m="",f=p,s+=S*b,b=0);i.restore()},_applyPatternGradientTransformText:function(r){var i=e.util.createCanvasElement(),a,s=this.width+this.strokeWidth,c=this.height+this.strokeWidth;return i.width=s,i.height=c,a=i.getContext("2d"),a.beginPath(),a.moveTo(0,0),a.lineTo(s,0),a.lineTo(s,c),a.lineTo(0,c),a.closePath(),a.translate(s/2,c/2),a.fillStyle=r.toLive(a),this._applyPatternGradientTransform(a,r),a.fill(),a.createPattern(i,"no-repeat")},handleFiller:function(r,i,a){var s,c;return a.toLive?a.gradientUnits==="percentage"||a.gradientTransform||a.patternTransform?(s=-this.width/2,c=-this.height/2,r.translate(s,c),r[i]=this._applyPatternGradientTransformText(a),{offsetX:s,offsetY:c}):(r[i]=a.toLive(r,this),this._applyPatternGradientTransform(r,a)):(r[i]=a,{offsetX:0,offsetY:0})},_setStrokeStyles:function(r,i){return r.lineWidth=i.strokeWidth,r.lineCap=this.strokeLineCap,r.lineDashOffset=this.strokeDashOffset,r.lineJoin=this.strokeLineJoin,r.miterLimit=this.strokeMiterLimit,this.handleFiller(r,"strokeStyle",i.stroke)},_setFillStyles:function(r,i){return this.handleFiller(r,"fillStyle",i.fill)},_renderChar:function(r,i,a,s,c,l,u){var d=this._getStyleDeclaration(a,s),f=this.getCompleteStyleDeclaration(a,s),p=r==="fillText"&&f.fill,m=r==="strokeText"&&f.stroke&&f.strokeWidth,h,b;!m&&!p||(i.save(),p&&(h=this._setFillStyles(i,f)),m&&(b=this._setStrokeStyles(i,f)),i.font=this._getFontDeclaration(f),d&&d.textBackgroundColor&&this._removeShadow(i),d&&d.deltaY&&(u+=d.deltaY),p&&i.fillText(c,l-h.offsetX,u-h.offsetY),m&&i.strokeText(c,l-b.offsetX,u-b.offsetY),i.restore())},setSuperscript:function(r,i){return this._setScript(r,i,this.superscript)},setSubscript:function(r,i){return this._setScript(r,i,this.subscript)},_setScript:function(r,i,a){var s=this.get2DCursorLocation(r,!0),c=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"fontSize"),l=this.getValueOfPropertyAt(s.lineIndex,s.charIndex,"deltaY"),u={fontSize:c*a.size,deltaY:l+c*a.baseline};return this.setSelectionStyles(u,r,i),this},_getLineLeftOffset:function(r){var i=this.getLineWidth(r),a=this.width-i,s=this.textAlign,c=this.direction,u,l=0,u=this.isEndOfWrapping(r);return s==="justify"||s==="justify-center"&&!u||s==="justify-right"&&!u||s==="justify-left"&&!u?0:(s==="center"&&(l=a/2),s==="right"&&(l=a),s==="justify-center"&&(l=a/2),s==="justify-right"&&(l=a),c==="rtl"&&(l-=a),l)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var r=this._forceClearCache;return r||(r=this.hasStateChanged("_dimensionAffectingProps")),r&&(this.dirty=!0,this._forceClearCache=!1),r},getLineWidth:function(r){if(this.__lineWidths[r]!==void 0)return this.__lineWidths[r];var i=this.measureLine(r),a=i.width;return this.__lineWidths[r]=a,a},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(r,i,a){var s=this._getStyleDeclaration(r,i);return s&&typeof s[a]<"u"?s[a]:this[a]},_renderTextDecoration:function(r,i){if(!(!this[i]&&!this.styleHas(i))){for(var a,s,c,l,u,d,f,p,m=this._getLeftOffset(),h=this._getTopOffset(),b,x,T,B,A,S,H,j,M=this.path,I=this._getWidthOfCharSpacing(),O=this.offsets[i],Q=0,v=this._textLines.length;Q<v;Q++){if(a=this.getHeightOfLine(Q),!this[i]&&!this.styleHas(i,Q)){h+=a;continue}f=this._textLines[Q],S=a/this.lineHeight,l=this._getLineLeftOffset(Q),x=0,T=0,p=this.getValueOfPropertyAt(Q,0,i),j=this.getValueOfPropertyAt(Q,0,"fill"),b=h+S*(1-this._fontSizeFraction),s=this.getHeightOfChar(Q,0),u=this.getValueOfPropertyAt(Q,0,"deltaY");for(var k=0,R=f.length;k<R;k++)if(B=this.__charBounds[Q][k],A=this.getValueOfPropertyAt(Q,k,i),H=this.getValueOfPropertyAt(Q,k,"fill"),c=this.getHeightOfChar(Q,k),d=this.getValueOfPropertyAt(Q,k,"deltaY"),M&&A&&H)r.save(),r.fillStyle=j,r.translate(B.renderLeft,B.renderTop),r.rotate(B.angle),r.fillRect(-B.kernedWidth/2,O*c+d,B.kernedWidth,this.fontSize/15),r.restore();else if((A!==p||H!==j||c!==s||d!==u)&&T>0){var N=m+l+x;this.direction==="rtl"&&(N=this.width-N-T),p&&j&&(r.fillStyle=j,r.fillRect(N,b+O*s+u,T,this.fontSize/15)),x=B.left,T=B.width,p=A,j=H,s=c,u=d}else T+=B.kernedWidth;var N=m+l+x;this.direction==="rtl"&&(N=this.width-N-T),r.fillStyle=H,A&&H&&r.fillRect(N,b+O*s+u,T-I,this.fontSize/15),h+=a}this._removeShadow(r)}},_getFontDeclaration:function(r,i){var a=r||this,s=this.fontFamily,c=e.Text.genericFonts.indexOf(s.toLowerCase())>-1,l=s===void 0||s.indexOf("'")>-1||s.indexOf(",")>-1||s.indexOf('"')>-1||c?a.fontFamily:'"'+a.fontFamily+'"';return[e.isLikelyNode?a.fontWeight:a.fontStyle,e.isLikelyNode?a.fontStyle:a.fontWeight,i?this.CACHE_FONT_SIZE+"px":a.fontSize+"px",l].join(" ")},render:function(r){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",r)))},_splitTextIntoLines:function(r){for(var i=r.split(this._reNewline),a=new Array(i.length),s=[`
`],c=[],l=0;l<i.length;l++)a[l]=e.util.string.graphemeSplit(i[l]),c=c.concat(a[l],s);return c.pop(),{_unwrappedLines:a,lines:i,graphemeText:c,graphemeLines:a}},toObject:function(r){var i=o.concat(r),a=this.callSuper("toObject",i);return a.styles=e.util.stylesToArray(this.styles,this.text),a.path&&(a.path=this.path.toObject()),a},set:function(r,i){this.callSuper("set",r,i);var a=!1,s=!1;if(typeof r=="object")for(var c in r)c==="path"&&this.setPathInfo(),a=a||this._dimensionAffectingProps.indexOf(c)!==-1,s=s||c==="path";else a=this._dimensionAffectingProps.indexOf(r)!==-1,s=r==="path";return s&&this.setPathInfo(),a&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),e.Text.ATTRIBUTE_NAMES=e.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),e.Text.DEFAULT_SVG_FONT_SIZE=16,e.Text.fromElement=function(r,i,a){if(!r)return i(null);var s=e.parseAttributes(r,e.Text.ATTRIBUTE_NAMES),c=s.textAnchor||"left";if(a=e.util.object.extend(a?n(a):{},s),a.top=a.top||0,a.left=a.left||0,s.textDecoration){var l=s.textDecoration;l.indexOf("underline")!==-1&&(a.underline=!0),l.indexOf("overline")!==-1&&(a.overline=!0),l.indexOf("line-through")!==-1&&(a.linethrough=!0),delete a.textDecoration}"dx"in s&&(a.left+=s.dx),"dy"in s&&(a.top+=s.dy),"fontSize"in a||(a.fontSize=e.Text.DEFAULT_SVG_FONT_SIZE);var u="";"textContent"in r?u=r.textContent:"firstChild"in r&&r.firstChild!==null&&"data"in r.firstChild&&r.firstChild.data!==null&&(u=r.firstChild.data),u=u.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var d=a.strokeWidth;a.strokeWidth=0;var f=new e.Text(u,a),p=f.getScaledHeight()/f.height,m=(f.height+f.strokeWidth)*f.lineHeight-f.height,h=m*p,b=f.getScaledHeight()+h,x=0;c==="center"&&(x=f.getScaledWidth()/2),c==="right"&&(x=f.getScaledWidth()),f.set({left:f.left-x,top:f.top-(b-f.fontSize*(.07+f._fontSizeFraction))/f.lineHeight,strokeWidth:typeof d<"u"?d:1}),i(f)},e.Text.fromObject=function(r,i){var a=n(r),s=r.path;return delete a.path,e.Object._fromObject("Text",a,function(c){c.styles=e.util.stylesFromArray(r.styles,r.text),s?e.Object._fromObject("Path",s,function(l){c.set("path",l),i(c)},"path"):i(c)},"text")},e.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],e.util.createAccessors&&e.util.createAccessors(e.Text)})(ae);(function(){g.util.object.extend(g.Text.prototype,{isEmptyStyles:function(t){if(!this.styles||typeof t<"u"&&!this.styles[t])return!0;var e=typeof t>"u"?this.styles:{line:this.styles[t]};for(var n in e)for(var o in e[n])for(var r in e[n][o])return!1;return!0},styleHas:function(t,e){if(!this.styles||!t||t===""||typeof e<"u"&&!this.styles[e])return!1;var n=typeof e>"u"?this.styles:{0:this.styles[e]};for(var o in n)for(var r in n[o])if(typeof n[o][r][t]<"u")return!0;return!1},cleanStyle:function(t){if(!this.styles||!t||t==="")return!1;var e=this.styles,n=0,o,r,i=!0,a=0,s;for(var c in e){o=0;for(var l in e[c]){var s=e[c][l],u=s.hasOwnProperty(t);n++,u?(r?s[t]!==r&&(i=!1):r=s[t],s[t]===this[t]&&delete s[t]):i=!1,Object.keys(s).length!==0?o++:delete e[c][l]}o===0&&delete e[c]}for(var d=0;d<this._textLines.length;d++)a+=this._textLines[d].length;i&&n===a&&(this[t]=r,this.removeStyle(t))},removeStyle:function(t){if(!(!this.styles||!t||t==="")){var e=this.styles,n,o,r;for(o in e){n=e[o];for(r in n)delete n[r][t],Object.keys(n[r]).length===0&&delete n[r];Object.keys(n).length===0&&delete e[o]}}},_extendStyles:function(t,e){var n=this.get2DCursorLocation(t);this._getLineStyle(n.lineIndex)||this._setLineStyle(n.lineIndex),this._getStyleDeclaration(n.lineIndex,n.charIndex)||this._setStyleDeclaration(n.lineIndex,n.charIndex,{}),g.util.object.extend(this._getStyleDeclaration(n.lineIndex,n.charIndex),e)},get2DCursorLocation:function(t,e){typeof t>"u"&&(t=this.selectionStart);for(var n=e?this._unwrappedTextLines:this._textLines,o=n.length,r=0;r<o;r++){if(t<=n[r].length)return{lineIndex:r,charIndex:t};t-=n[r].length+this.missingNewlineOffset(r)}return{lineIndex:r-1,charIndex:n[r-1].length<t?n[r-1].length:t}},getSelectionStyles:function(t,e,n){typeof t>"u"&&(t=this.selectionStart||0),typeof e>"u"&&(e=this.selectionEnd||t);for(var o=[],r=t;r<e;r++)o.push(this.getStyleAtPosition(r,n));return o},getStyleAtPosition:function(t,e){var n=this.get2DCursorLocation(t),o=e?this.getCompleteStyleDeclaration(n.lineIndex,n.charIndex):this._getStyleDeclaration(n.lineIndex,n.charIndex);return o||{}},setSelectionStyles:function(t,e,n){typeof e>"u"&&(e=this.selectionStart||0),typeof n>"u"&&(n=this.selectionEnd||e);for(var o=e;o<n;o++)this._extendStyles(o,t);return this._forceClearCache=!0,this},_getStyleDeclaration:function(t,e){var n=this.styles&&this.styles[t];return n?n[e]:null},getCompleteStyleDeclaration:function(t,e){for(var n=this._getStyleDeclaration(t,e)||{},o={},r,i=0;i<this._styleProperties.length;i++)r=this._styleProperties[i],o[r]=typeof n[r]>"u"?this[r]:n[r];return o},_setStyleDeclaration:function(t,e,n){this.styles[t][e]=n},_deleteStyleDeclaration:function(t,e){delete this.styles[t][e]},_getLineStyle:function(t){return!!this.styles[t]},_setLineStyle:function(t){this.styles[t]={}},_deleteLineStyle:function(t){delete this.styles[t]}})})();(function(){function t(e){e.textDecoration&&(e.textDecoration.indexOf("underline")>-1&&(e.underline=!0),e.textDecoration.indexOf("line-through")>-1&&(e.linethrough=!0),e.textDecoration.indexOf("overline")>-1&&(e.overline=!0),delete e.textDecoration)}g.IText=g.util.createClass(g.Text,g.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(e,n){this.callSuper("initialize",e,n),this.initBehavior()},setSelectionStart:function(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)},setSelectionEnd:function(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)},_updateAndFire:function(e,n){this[e]!==n&&(this._fireSelectionChanged(),this[e]=n),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(e){this.clearContextTop(),this.callSuper("render",e),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(e){this.callSuper("_render",e)},clearContextTop:function(e){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var n=this.canvas.contextTop,o=this.canvas.viewportTransform;n.save(),n.transform(o[0],o[1],o[2],o[3],o[4],o[5]),this.transform(n),this._clearTextArea(n),e||n.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var e=this._getCursorBoundaries(),n=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(e,n):this.renderSelection(e,n),n.restore()}},_clearTextArea:function(e){var n=this.width+4,o=this.height+4;e.clearRect(-n/2,-o/2,n,o)},_getCursorBoundaries:function(e){typeof e>"u"&&(e=this.selectionStart);var n=this._getLeftOffset(),o=this._getTopOffset(),r=this._getCursorBoundariesOffsets(e);return{left:n,top:o,leftOffset:r.left,topOffset:r.top}},_getCursorBoundariesOffsets:function(e){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var n,o,r,i=0,a=0,s,c=this.get2DCursorLocation(e);r=c.charIndex,o=c.lineIndex;for(var l=0;l<o;l++)i+=this.getHeightOfLine(l);n=this._getLineLeftOffset(o);var u=this.__charBounds[o][r];return u&&(a=u.left),this.charSpacing!==0&&r===this._textLines[o].length&&(a-=this._getWidthOfCharSpacing()),s={top:i,left:n+(a>0?a:0)},this.direction==="rtl"&&(s.left*=-1),this.cursorOffsetCache=s,this.cursorOffsetCache},renderCursor:function(e,n){var o=this.get2DCursorLocation(),r=o.lineIndex,i=o.charIndex>0?o.charIndex-1:0,a=this.getValueOfPropertyAt(r,i,"fontSize"),s=this.scaleX*this.canvas.getZoom(),c=this.cursorWidth/s,l=e.topOffset,u=this.getValueOfPropertyAt(r,i,"deltaY");l+=(1-this._fontSizeFraction)*this.getHeightOfLine(r)/this.lineHeight-a*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(e,n),n.fillStyle=this.cursorColor||this.getValueOfPropertyAt(r,i,"fill"),n.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,n.fillRect(e.left+e.leftOffset-c/2,l+e.top+u,c,a)},renderSelection:function(e,n){for(var o=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,r=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,i=this.textAlign.indexOf("justify")!==-1,a=this.get2DCursorLocation(o),s=this.get2DCursorLocation(r),c=a.lineIndex,l=s.lineIndex,u=a.charIndex<0?0:a.charIndex,d=s.charIndex<0?0:s.charIndex,f=c;f<=l;f++){var p=this._getLineLeftOffset(f)||0,m=this.getHeightOfLine(f),h=0,b=0,x=0;if(f===c&&(b=this.__charBounds[c][u].left),f>=c&&f<l)x=i&&!this.isEndOfWrapping(f)?this.width:this.getLineWidth(f)||5;else if(f===l)if(d===0)x=this.__charBounds[l][d].left;else{var T=this._getWidthOfCharSpacing();x=this.__charBounds[l][d-1].left+this.__charBounds[l][d-1].width-T}h=m,(this.lineHeight<1||f===l&&this.lineHeight>1)&&(m/=this.lineHeight);var B=e.left+p+b,A=x-b,S=m,H=0;this.inCompositionMode?(n.fillStyle=this.compositionColor||"black",S=1,H=m):n.fillStyle=this.selectionColor,this.direction==="rtl"&&(B=this.width-B-A),n.fillRect(B,e.top+e.topOffset+H,A,S),e.topOffset+=h}},getCurrentCharFontSize:function(){var e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")},getCurrentCharColor:function(){var e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fill")},_getCurrentCharIndex:function(){var e=this.get2DCursorLocation(this.selectionStart,!0),n=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:n}}}),g.IText.fromObject=function(e,n){var o=g.util.stylesFromArray(e.styles,e.text),r=Object.assign({},e,{styles:o});if(t(r),r.styles)for(var i in r.styles)for(var a in r.styles[i])t(r.styles[i][a]);g.Object._fromObject("IText",r,n,"text")}})();(function(){var t=g.util.object.clone;g.util.object.extend(g.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var e=this;this.on("added",function(){var n=e.canvas;n&&(n._hasITextHandlers||(n._hasITextHandlers=!0,e._initCanvasHandlers(n)),n._iTextInstances=n._iTextInstances||[],n._iTextInstances.push(e))})},initRemovedHandler:function(){var e=this;this.on("removed",function(){var n=e.canvas;n&&(n._iTextInstances=n._iTextInstances||[],g.util.removeFromArray(n._iTextInstances,e),n._iTextInstances.length===0&&(n._hasITextHandlers=!1,e._removeCanvasHandlers(n)))})},_initCanvasHandlers:function(e){e._mouseUpITextHandler=function(){e._iTextInstances&&e._iTextInstances.forEach(function(n){n.__isMousedown=!1})},e.on("mouse:up",e._mouseUpITextHandler)},_removeCanvasHandlers:function(e){e.off("mouse:up",e._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(e,n,o,r){var i;return i={isAborted:!1,abort:function(){this.isAborted=!0}},e.animate("_currentCursorOpacity",n,{duration:o,onComplete:function(){i.isAborted||e[r]()},onChange:function(){e.canvas&&e.selectionStart===e.selectionEnd&&e.renderCursorOrSelection()},abort:function(){return i.isAborted}}),i},_onTickComplete:function(){var e=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){e._currentTickCompleteState=e._animateCursor(e,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(e){var n=this,o=e?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){n._tick()},o)},abortCursorAnimation:function(){var e=this._currentTickState||this._currentTickCompleteState,n=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,e&&n&&n.clearContext(n.contextTop||n.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(e){var n=0,o=e-1;if(this._reSpace.test(this._text[o]))for(;this._reSpace.test(this._text[o]);)n++,o--;for(;/\S/.test(this._text[o])&&o>-1;)n++,o--;return e-n},findWordBoundaryRight:function(e){var n=0,o=e;if(this._reSpace.test(this._text[o]))for(;this._reSpace.test(this._text[o]);)n++,o++;for(;/\S/.test(this._text[o])&&o<this._text.length;)n++,o++;return e+n},findLineBoundaryLeft:function(e){for(var n=0,o=e-1;!/\n/.test(this._text[o])&&o>-1;)n++,o--;return e-n},findLineBoundaryRight:function(e){for(var n=0,o=e;!/\n/.test(this._text[o])&&o<this._text.length;)n++,o++;return e+n},searchWordBoundary:function(e,n){for(var o=this._text,r=this._reSpace.test(o[e])?e-1:e,i=o[r],a=g.reNonWord;!a.test(i)&&r>0&&r<o.length;)r+=n,i=o[r];return a.test(i)&&(r+=n===1?0:1),r},selectWord:function(e){e=e||this.selectionStart;var n=this.searchWordBoundary(e,-1),o=this.searchWordBoundary(e,1);this.selectionStart=n,this.selectionEnd=o,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(e){e=e||this.selectionStart;var n=this.findLineBoundaryLeft(e),o=this.findLineBoundaryRight(e);return this.selectionStart=n,this.selectionEnd=o,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(e){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(e),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(e){e._iTextInstances&&e._iTextInstances.forEach(function(n){n.selected=!1,n.isEditing&&n.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(e){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var n=this.getSelectionStartFromPointer(e.e),o=this.selectionStart,r=this.selectionEnd;(n!==this.__selectionStartOnMouseDown||o===r)&&(o===n||r===n)||(n>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=n):(this.selectionStart=n,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==o||this.selectionEnd!==r)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(e,n,o){var r=o.slice(0,e),i=g.util.string.graphemeSplit(r).length;if(e===n)return{selectionStart:i,selectionEnd:i};var a=o.slice(e,n),s=g.util.string.graphemeSplit(a).length;return{selectionStart:i,selectionEnd:i+s}},fromGraphemeToStringSelection:function(e,n,o){var r=o.slice(0,e),i=r.join("").length;if(e===n)return{selectionStart:i,selectionEnd:i};var a=o.slice(e,n),s=a.join("").length;return{selectionStart:i,selectionEnd:i+s}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var e=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=e.selectionEnd,this.inCompositionMode||(this.selectionStart=e.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var e=this.inCompositionMode?this.compositionStart:this.selectionStart,n=this._getCursorBoundaries(e),o=this.get2DCursorLocation(e),r=o.lineIndex,i=o.charIndex,a=this.getValueOfPropertyAt(r,i,"fontSize")*this.lineHeight,s=n.leftOffset,c=this.calcTransformMatrix(),l={x:n.left+s,y:n.top+n.topOffset+a},u=this.canvas.getRetinaScaling(),d=this.canvas.upperCanvasEl,f=d.width/u,p=d.height/u,m=f-a,h=p-a,b=d.clientWidth/f,x=d.clientHeight/p;return l=g.util.transformPoint(l,c),l=g.util.transformPoint(l,this.canvas.viewportTransform),l.x*=b,l.y*=x,l.x<0&&(l.x=0),l.x>m&&(l.x=m),l.y<0&&(l.y=0),l.y>h&&(l.y=h),l.x+=this.canvas._offset.left,l.y+=this.canvas._offset.top,{left:l.x+"px",top:l.y+"px",fontSize:a+"px",charHeight:a}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var e=this._textBeforeEdit!==this.text,n=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,n&&(n.blur&&n.blur(),n.parentNode&&n.parentNode.removeChild(n)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),e&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var e in this.styles)this._textLines[e]||delete this.styles[e]},removeStyleFromTo:function(e,n){var o=this.get2DCursorLocation(e,!0),r=this.get2DCursorLocation(n,!0),i=o.lineIndex,a=o.charIndex,s=r.lineIndex,c=r.charIndex,l,u;if(i!==s){if(this.styles[i])for(l=a;l<this._unwrappedTextLines[i].length;l++)delete this.styles[i][l];if(this.styles[s])for(l=c;l<this._unwrappedTextLines[s].length;l++)u=this.styles[s][l],u&&(this.styles[i]||(this.styles[i]={}),this.styles[i][a+l-c]=u);for(l=i+1;l<=s;l++)delete this.styles[l];this.shiftLineStyles(s,i-s)}else if(this.styles[i]){u=this.styles[i];var d=c-a,f,p;for(l=a;l<c;l++)delete u[l];for(p in this.styles[i])f=parseInt(p,10),f>=c&&(u[f-d]=u[p],delete u[p])}},shiftLineStyles:function(e,n){var o=t(this.styles);for(var r in this.styles){var i=parseInt(r,10);i>e&&(this.styles[i+n]=o[i],o[i-n]||delete this.styles[i])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(e,n,o,r){var i,a={},s=!1,c=this._unwrappedTextLines[e].length===n;o||(o=1),this.shiftLineStyles(e,o),this.styles[e]&&(i=this.styles[e][n===0?n:n-1]);for(var l in this.styles[e]){var u=parseInt(l,10);u>=n&&(s=!0,a[u-n]=this.styles[e][l],c&&n===0||delete this.styles[e][l])}var d=!1;for(s&&!c&&(this.styles[e+o]=a,d=!0),d&&o--;o>0;)r&&r[o-1]?this.styles[e+o]={0:t(r[o-1])}:i?this.styles[e+o]={0:t(i)}:delete this.styles[e+o],o--;this._forceClearCache=!0},insertCharStyleObject:function(e,n,o,r){this.styles||(this.styles={});var i=this.styles[e],a=i?t(i):{};o||(o=1);for(var s in a){var c=parseInt(s,10);c>=n&&(i[c+o]=a[c],a[c-o]||delete i[c])}if(this._forceClearCache=!0,r){for(;o--;)Object.keys(r[o]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][n+o]=t(r[o]));return}if(i)for(var l=i[n?n-1:1];l&&o--;)this.styles[e][n+o]=t(l)},insertNewStyleBlock:function(e,n,o){for(var r=this.get2DCursorLocation(n,!0),i=[0],a=0,s=0;s<e.length;s++)e[s]===`
`?(a++,i[a]=0):i[a]++;i[0]>0&&(this.insertCharStyleObject(r.lineIndex,r.charIndex,i[0],o),o=o&&o.slice(i[0]+1)),a&&this.insertNewlineStyleObject(r.lineIndex,r.charIndex+i[0],a);for(var s=1;s<a;s++)i[s]>0?this.insertCharStyleObject(r.lineIndex+s,0,i[s],o):o&&this.styles[r.lineIndex+s]&&o[0]&&(this.styles[r.lineIndex+s][0]=o[0]),o=o&&o.slice(i[s]+1);i[s]>0&&this.insertCharStyleObject(r.lineIndex+s,0,i[s],o)},setSelectionStartEndWithShift:function(e,n,o){o<=e?(n===e?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=e),this.selectionStart=o):o>e&&o<n?this._selectionDirection==="right"?this.selectionEnd=o:this.selectionStart=o:(n===e?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=n),this.selectionEnd=o)},setSelectionInBoundaries:function(){var e=this.text.length;this.selectionStart>e?this.selectionStart=e:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>e?this.selectionEnd=e:this.selectionEnd<0&&(this.selectionEnd=0)}})})();g.util.object.extend(g.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(t){if(this.canvas){this.__newClickTime=+new Date;var e=t.pointer;this.isTripleClick(e)&&(this.fire("tripleclick",t),this._stopEvent(t.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=e,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(t){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===t.x&&this.__lastPointer.y===t.y},_stopEvent:function(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(t){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(t.e))},tripleClickHandler:function(t){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(t.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(t){!this.canvas||!this.editable||t.e.button&&t.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(t.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(t){!this.canvas||!this.editable||t.e.button&&t.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(t){if(this.__isMousedown=!1,!(!this.editable||this.group||t.transform&&t.transform.actionPerformed||t.e.button&&t.e.button!==1)){if(this.canvas){var e=this.canvas._activeObject;if(e&&e!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(t){var e=this.getSelectionStartFromPointer(t),n=this.selectionStart,o=this.selectionEnd;t.shiftKey?this.setSelectionStartEndWithShift(n,o,e):(this.selectionStart=e,this.selectionEnd=e),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(t){for(var e=this.getLocalPointer(t),n=0,o=0,r=0,i=0,a=0,s,c,l=0,u=this._textLines.length;l<u&&r<=e.y;l++)r+=this.getHeightOfLine(l)*this.scaleY,a=l,l>0&&(i+=this._textLines[l-1].length+this.missingNewlineOffset(l-1));s=this._getLineLeftOffset(a),o=s*this.scaleX,c=this._textLines[a],this.direction==="rtl"&&(e.x=this.width*this.scaleX-e.x+o);for(var d=0,f=c.length;d<f&&(n=o,o+=this.__charBounds[a][d].kernedWidth*this.scaleX,o<=e.x);d++)i++;return this._getNewSelectionStartFromOffset(e,n,o,i,f)},_getNewSelectionStartFromOffset:function(t,e,n,o,r){var i=t.x-e,a=n-t.x,s=a>i||a<0?0:1,c=o+s;return this.flipX&&(c=r-c),c>this._text.length&&(c=this._text.length),c}});g.util.object.extend(g.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=g.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var t=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+t.top+"; left: "+t.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+t.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):g.document.body.appendChild(this.hiddenTextarea),g.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),g.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),g.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),g.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),g.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),g.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),g.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),g.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),g.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(g.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(t){if(this.isEditing){var e=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(t.keyCode in e)this[e[t.keyCode]](t);else if(t.keyCode in this.ctrlKeysMapDown&&(t.ctrlKey||t.metaKey))this[this.ctrlKeysMapDown[t.keyCode]](t);else return;t.stopImmediatePropagation(),t.preventDefault(),t.keyCode>=33&&t.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(t){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(t.keyCode in this.ctrlKeysMapUp&&(t.ctrlKey||t.metaKey))this[this.ctrlKeysMapUp[t.keyCode]](t);else return;t.stopImmediatePropagation(),t.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(t){var e=this.fromPaste;if(this.fromPaste=!1,t&&t.stopPropagation(),!!this.isEditing){var n=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,o=this._text.length,r=n.length,i,a,s=r-o,c=this.selectionStart,l=this.selectionEnd,u=c!==l,d,f,p;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var m=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),h=c>m.selectionStart;u?(i=this._text.slice(c,l),s+=l-c):r<o&&(h?i=this._text.slice(l+s,l):i=this._text.slice(c,c-s)),a=n.slice(m.selectionEnd-s,m.selectionEnd),i&&i.length&&(a.length&&(d=this.getSelectionStyles(c,c+1,!1),d=a.map(function(){return d[0]})),u?(f=c,p=l):h?(f=l-i.length,p=l):(f=l,p=l+i.length),this.removeStyleFromTo(f,p)),a.length&&(e&&a.join("")===g.copiedText&&!g.disableStyleCopyPaste&&(d=g.copiedTextStyle),this.insertNewStyleBlock(a,c,d)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(t){this.compositionStart=t.target.selectionStart,this.compositionEnd=t.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(g.copiedText=this.getSelectedText(),g.disableStyleCopyPaste?g.copiedTextStyle=null:g.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(t){return t&&t.clipboardData||g.window.clipboardData},_getWidthBeforeCursor:function(t,e){var n=this._getLineLeftOffset(t),o;return e>0&&(o=this.__charBounds[t][e-1],n+=o.left+o.width),n},getDownCursorOffset:function(t,e){var n=this._getSelectionForOffset(t,e),o=this.get2DCursorLocation(n),r=o.lineIndex;if(r===this._textLines.length-1||t.metaKey||t.keyCode===34)return this._text.length-n;var i=o.charIndex,a=this._getWidthBeforeCursor(r,i),s=this._getIndexOnLine(r+1,a),c=this._textLines[r].slice(i);return c.length+s+1+this.missingNewlineOffset(r)},_getSelectionForOffset:function(t,e){return t.shiftKey&&this.selectionStart!==this.selectionEnd&&e?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(t,e){var n=this._getSelectionForOffset(t,e),o=this.get2DCursorLocation(n),r=o.lineIndex;if(r===0||t.metaKey||t.keyCode===33)return-n;var i=o.charIndex,a=this._getWidthBeforeCursor(r,i),s=this._getIndexOnLine(r-1,a),c=this._textLines[r].slice(0,i),l=this.missingNewlineOffset(r-1);return-this._textLines[r-1].length+s-c.length+(1-l)},_getIndexOnLine:function(t,e){for(var n=this._textLines[t],o=this._getLineLeftOffset(t),r=o,i=0,a,s,c=0,l=n.length;c<l;c++)if(a=this.__charBounds[t][c].width,r+=a,r>e){s=!0;var u=r-a,d=r,f=Math.abs(u-e),p=Math.abs(d-e);i=p<f?c:c-1;break}return s||(i=n.length-1),i},moveCursorDown:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",t)},moveCursorUp:function(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",t)},_moveCursorUpOrDown:function(t,e){var n="get"+t+"CursorOffset",o=this[n](e,this._selectionDirection==="right");e.shiftKey?this.moveCursorWithShift(o):this.moveCursorWithoutShift(o),o!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(t){var e=this._selectionDirection==="left"?this.selectionStart+t:this.selectionEnd+t;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,e),t!==0},moveCursorWithoutShift:function(t){return t<0?(this.selectionStart+=t,this.selectionEnd=this.selectionStart):(this.selectionEnd+=t,this.selectionStart=this.selectionEnd),t!==0},moveCursorLeft:function(t){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",t)},_move:function(t,e,n){var o;if(t.altKey)o=this["findWordBoundary"+n](this[e]);else if(t.metaKey||t.keyCode===35||t.keyCode===36)o=this["findLineBoundary"+n](this[e]);else return this[e]+=n==="Left"?-1:1,!0;if(typeof o<"u"&&this[e]!==o)return this[e]=o,!0},_moveLeft:function(t,e){return this._move(t,e,"Left")},_moveRight:function(t,e){return this._move(t,e,"Right")},moveCursorLeftWithoutShift:function(t){var e=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(e=this._moveLeft(t,"selectionStart")),this.selectionEnd=this.selectionStart,e},moveCursorLeftWithShift:function(t){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(t,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(t,"selectionStart")},moveCursorRight:function(t){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",t)},_moveCursorLeftOrRight:function(t,e){var n="moveCursor"+t+"With";this._currentCursorOpacity=1,e.shiftKey?n+="Shift":n+="outShift",this[n](e)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(t){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(t,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(t,"selectionEnd")},moveCursorRightWithoutShift:function(t){var e=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(e=this._moveRight(t,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,e},removeChars:function(t,e){typeof e>"u"&&(e=t+1),this.removeStyleFromTo(t,e),this._text.splice(t,e-t),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(t,e,n,o){typeof o>"u"&&(o=n),o>n&&this.removeStyleFromTo(n,o);var r=g.util.string.graphemeSplit(t);this.insertNewStyleBlock(r,n,e),this._text=[].concat(this._text.slice(0,n),r,this._text.slice(o)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}});(function(){var t=g.util.toFixed,e=/  +/g;g.util.object.extend(g.Text.prototype,{_toSVG:function(){var n=this._getSVGLeftTopOffsets(),o=this._getSVGTextAndBg(n.textTop,n.textLeft);return this._wrapSVGTextAndBg(o)},toSVG:function(n){return this._createBaseSVGMarkup(this._toSVG(),{reviver:n,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(n){var o=!0,r=this.getSvgTextDecoration(this);return[n.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",r?'text-decoration="'+r+'" ':"",'style="',this.getSvgStyles(o),'"',this.addPaintOrder()," >",n.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(n,o){var r=[],i=[],a=n,s;this._setSVGBg(i);for(var c=0,l=this._textLines.length;c<l;c++)s=this._getLineLeftOffset(c),(this.textBackgroundColor||this.styleHas("textBackgroundColor",c))&&this._setSVGTextLineBg(i,c,o+s,a),this._setSVGTextLineText(r,c,o+s,a),a+=this.getHeightOfLine(c);return{textSpans:r,textBgRects:i}},_createTextCharSpan:function(n,o,r,i){var a=n!==n.trim()||n.match(e),s=this.getSvgSpanStyles(o,a),c=s?'style="'+s+'"':"",l=o.deltaY,u="",d=g.Object.NUM_FRACTION_DIGITS;return l&&(u=' dy="'+t(l,d)+'" '),['<tspan x="',t(r,d),'" y="',t(i,d),'" ',u,c,">",g.util.string.escapeXml(n),"</tspan>"].join("")},_setSVGTextLineText:function(n,o,r,i){var a=this.getHeightOfLine(o),s=this.textAlign.indexOf("justify")!==-1,c,l,u="",d,f,p=0,m=this._textLines[o],h;i+=a*(1-this._fontSizeFraction)/this.lineHeight;for(var b=0,x=m.length-1;b<=x;b++)h=b===x||this.charSpacing,u+=m[b],d=this.__charBounds[o][b],p===0?(r+=d.kernedWidth-d.width,p+=d.width):p+=d.kernedWidth,s&&!h&&this._reSpaceAndTab.test(m[b])&&(h=!0),h||(c=c||this.getCompleteStyleDeclaration(o,b),l=this.getCompleteStyleDeclaration(o,b+1),h=g.util.hasStyleChanged(c,l,!0)),h&&(f=this._getStyleDeclaration(o,b)||{},n.push(this._createTextCharSpan(u,f,r,i)),u="",c=l,r+=p,p=0)},_pushTextBgRect:function(n,o,r,i,a,s){var c=g.Object.NUM_FRACTION_DIGITS;n.push("		<rect ",this._getFillAttributes(o),' x="',t(r,c),'" y="',t(i,c),'" width="',t(a,c),'" height="',t(s,c),`"></rect>
`)},_setSVGTextLineBg:function(n,o,r,i){for(var a=this._textLines[o],s=this.getHeightOfLine(o)/this.lineHeight,c=0,l=0,u,d,f=this.getValueOfPropertyAt(o,0,"textBackgroundColor"),p=0,m=a.length;p<m;p++)u=this.__charBounds[o][p],d=this.getValueOfPropertyAt(o,p,"textBackgroundColor"),d!==f?(f&&this._pushTextBgRect(n,f,r+l,i,c,s),l=u.left,c=u.width,f=d):c+=u.kernedWidth;d&&this._pushTextBgRect(n,d,r+l,i,c,s)},_getFillAttributes:function(n){var o=n&&typeof n=="string"?new g.Color(n):"";return!o||!o.getSource()||o.getAlpha()===1?'fill="'+n+'"':'opacity="'+o.getAlpha()+'" fill="'+o.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(n){for(var o=0,r=0,i=0;i<n;i++)o+=this.getHeightOfLine(i);return r=this.getHeightOfLine(i),{lineTop:o,offset:(this._fontSizeMult-this._fontSizeFraction)*r/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(n){var o=g.Object.prototype.getSvgStyles.call(this,n);return o+" white-space: pre;"}})})();(function(t){"use strict";var e=t.fabric||(t.fabric={});e.Textbox=e.util.createClass(e.IText,e.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:e.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(n){for(var o=0,r=0,i=0,a={},s=0;s<n.graphemeLines.length;s++)n.graphemeText[i]===`
`&&s>0?(r=0,i++,o++):!this.splitByGrapheme&&this._reSpaceAndTab.test(n.graphemeText[i])&&s>0&&(r++,i++),a[s]={line:o,offset:r},i+=n.graphemeLines[s].length,r+=n.graphemeLines[s].length;return a},styleHas:function(n,o){if(this._styleMap&&!this.isWrapping){var r=this._styleMap[o];r&&(o=r.line)}return e.Text.prototype.styleHas.call(this,n,o)},isEmptyStyles:function(n){if(!this.styles)return!0;var o=0,r=n+1,i,a,s=!1,c=this._styleMap[n],l=this._styleMap[n+1];c&&(n=c.line,o=c.offset),l&&(r=l.line,s=r===n,i=l.offset),a=typeof n>"u"?this.styles:{line:this.styles[n]};for(var u in a)for(var d in a[u])if(d>=o&&(!s||d<i))for(var f in a[u][d])return!1;return!0},_getStyleDeclaration:function(n,o){if(this._styleMap&&!this.isWrapping){var r=this._styleMap[n];if(!r)return null;n=r.line,o=r.offset+o}return this.callSuper("_getStyleDeclaration",n,o)},_setStyleDeclaration:function(n,o,r){var i=this._styleMap[n];n=i.line,o=i.offset+o,this.styles[n][o]=r},_deleteStyleDeclaration:function(n,o){var r=this._styleMap[n];n=r.line,o=r.offset+o,delete this.styles[n][o]},_getLineStyle:function(n){var o=this._styleMap[n];return!!this.styles[o.line]},_setLineStyle:function(n){var o=this._styleMap[n];this.styles[o.line]={}},_wrapText:function(n,o){var r=[],i;for(this.isWrapping=!0,i=0;i<n.length;i++)r=r.concat(this._wrapLine(n[i],i,o));return this.isWrapping=!1,r},_measureWord:function(n,o,r){var i=0,a,s=!0;r=r||0;for(var c=0,l=n.length;c<l;c++){var u=this._getGraphemeBox(n[c],o,c+r,a,s);i+=u.kernedWidth,a=n[c]}return i},_wrapLine:function(n,o,r,B){var a=0,s=this.splitByGrapheme,c=[],l=[],u=s?e.util.string.graphemeSplit(n):n.split(this._wordJoiners),d="",f=0,p=s?"":" ",m=0,h=0,b=0,x=!0,T=this._getWidthOfCharSpacing(),B=B||0;u.length===0&&u.push([]),r-=B;for(var A=0;A<u.length;A++)d=s?u[A]:e.util.string.graphemeSplit(u[A]),m=this._measureWord(d,o,f),f+=d.length,a+=h+m-T,a>r&&!x?(c.push(l),l=[],a=m,x=!0):a+=T,!x&&!s&&l.push(p),l=l.concat(d),h=s?0:this._measureWord([p],o,f),f++,x=!1,m>b&&(b=m);return A&&c.push(l),b+B>this.dynamicMinWidth&&(this.dynamicMinWidth=b-T+B),c},isEndOfWrapping:function(n){return!this._styleMap[n+1]||this._styleMap[n+1].line!==this._styleMap[n].line},missingNewlineOffset:function(n){return this.splitByGrapheme?this.isEndOfWrapping(n)?1:0:1},_splitTextIntoLines:function(n){for(var o=e.Text.prototype._splitTextIntoLines.call(this,n),r=this._wrapText(o.lines,this.width),i=new Array(r.length),a=0;a<r.length;a++)i[a]=r[a].join("");return o.lines=i,o.graphemeLines=r,o},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var n={};for(var o in this._styleMap)this._textLines[o]&&(n[this._styleMap[o].line]=1);for(var o in this.styles)n[o]||delete this.styles[o]},toObject:function(n){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(n))}}),e.Textbox.fromObject=function(n,o){var r=e.util.stylesFromArray(n.styles,n.text),i=Object.assign({},n,{styles:r});return e.Object._fromObject("Textbox",i,o,"text")}})(ae);(function(){var t=g.controlsUtils,e=t.scaleSkewCursorStyleHandler,n=t.scaleCursorStyleHandler,o=t.scalingEqually,r=t.scalingYOrSkewingX,i=t.scalingXOrSkewingY,a=t.scaleOrSkewActionName,s=g.Object.prototype.controls;if(s.ml=new g.Control({x:-.5,y:0,cursorStyleHandler:e,actionHandler:i,getActionName:a}),s.mr=new g.Control({x:.5,y:0,cursorStyleHandler:e,actionHandler:i,getActionName:a}),s.mb=new g.Control({x:0,y:.5,cursorStyleHandler:e,actionHandler:r,getActionName:a}),s.mt=new g.Control({x:0,y:-.5,cursorStyleHandler:e,actionHandler:r,getActionName:a}),s.tl=new g.Control({x:-.5,y:-.5,cursorStyleHandler:n,actionHandler:o}),s.tr=new g.Control({x:.5,y:-.5,cursorStyleHandler:n,actionHandler:o}),s.bl=new g.Control({x:-.5,y:.5,cursorStyleHandler:n,actionHandler:o}),s.br=new g.Control({x:.5,y:.5,cursorStyleHandler:n,actionHandler:o}),s.mtr=new g.Control({x:0,y:-.5,actionHandler:t.rotationWithSnapping,cursorStyleHandler:t.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),g.Textbox){var c=g.Textbox.prototype.controls={};c.mtr=s.mtr,c.tr=s.tr,c.br=s.br,c.tl=s.tl,c.bl=s.bl,c.mt=s.mt,c.mb=s.mb,c.mr=new g.Control({x:.5,y:0,actionHandler:t.changeWidth,cursorStyleHandler:e,actionName:"resizing"}),c.ml=new g.Control({x:-.5,y:0,actionHandler:t.changeWidth,cursorStyleHandler:e,actionName:"resizing"})}})()});var gg=ct((sz,Fa)=>{(function(t,e,n,o){"use strict";var r=["","webkit","Moz","MS","ms","o"],i=e.createElement("div"),a="function",s=Math.round,c=Math.abs,l=Date.now;function u(y,E,z){return setTimeout(T(y,z),E)}function d(y,E,z){return Array.isArray(y)?(f(y,z[E],z),!0):!1}function f(y,E,z){var ee;if(y)if(y.forEach)y.forEach(E,z);else if(y.length!==o)for(ee=0;ee<y.length;)E.call(z,y[ee],ee,y),ee++;else for(ee in y)y.hasOwnProperty(ee)&&E.call(z,y[ee],ee,y)}function p(y,E,z){var ee="DEPRECATED METHOD: "+E+`
`+z+` AT 
`;return function(){var le=new Error("get-stack-trace"),be=le&&le.stack?le.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Me=t.console&&(t.console.warn||t.console.log);return Me&&Me.call(t.console,ee,be),y.apply(this,arguments)}}var m;typeof Object.assign!="function"?m=function(E){if(E===o||E===null)throw new TypeError("Cannot convert undefined or null to object");for(var z=Object(E),ee=1;ee<arguments.length;ee++){var le=arguments[ee];if(le!==o&&le!==null)for(var be in le)le.hasOwnProperty(be)&&(z[be]=le[be])}return z}:m=Object.assign;var h=p(function(E,z,ee){for(var le=Object.keys(z),be=0;be<le.length;)(!ee||ee&&E[le[be]]===o)&&(E[le[be]]=z[le[be]]),be++;return E},"extend","Use `assign`."),b=p(function(E,z){return h(E,z,!0)},"merge","Use `assign`.");function x(y,E,z){var ee=E.prototype,le;le=y.prototype=Object.create(ee),le.constructor=y,le._super=ee,z&&m(le,z)}function T(y,E){return function(){return y.apply(E,arguments)}}function B(y,E){return typeof y==a?y.apply(E&&E[0]||o,E):y}function A(y,E){return y===o?E:y}function S(y,E,z){f(I(E),function(ee){y.addEventListener(ee,z,!1)})}function H(y,E,z){f(I(E),function(ee){y.removeEventListener(ee,z,!1)})}function j(y,E){for(;y;){if(y==E)return!0;y=y.parentNode}return!1}function M(y,E){return y.indexOf(E)>-1}function I(y){return y.trim().split(/\s+/g)}function O(y,E,z){if(y.indexOf&&!z)return y.indexOf(E);for(var ee=0;ee<y.length;){if(z&&y[ee][z]==E||!z&&y[ee]===E)return ee;ee++}return-1}function Q(y){return Array.prototype.slice.call(y,0)}function v(y,E,z){for(var ee=[],le=[],be=0;be<y.length;){var Me=E?y[be][E]:y[be];O(le,Me)<0&&ee.push(y[be]),le[be]=Me,be++}return z&&(E?ee=ee.sort(function(gt,kt){return gt[E]>kt[E]}):ee=ee.sort()),ee}function k(y,E){for(var z,ee,le=E[0].toUpperCase()+E.slice(1),be=0;be<r.length;){if(z=r[be],ee=z?z+le:E,ee in y)return ee;be++}return o}var R=1;function N(){return R++}function W(y){var E=y.ownerDocument||y;return E.defaultView||E.parentWindow||t}var C=/mobile|tablet|ip(ad|hone|od)|android/i,w="ontouchstart"in t,D=k(t,"PointerEvent")!==o,_=w&&C.test(navigator.userAgent),F="touch",G="pen",$="mouse",X="kinect",U=25,P=1,V=2,K=4,te=8,L=1,re=2,ce=4,Te=8,ve=16,ie=re|ce,ge=Te|ve,Ee=ie|ge,Ne=["x","y"],Pe=["clientX","clientY"];function Se(y,E){var z=this;this.manager=y,this.callback=E,this.element=y.element,this.target=y.options.inputTarget,this.domHandler=function(ee){B(y.options.enable,[y])&&z.handler(ee)},this.init()}Se.prototype={handler:function(){},init:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(W(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&H(this.element,this.evEl,this.domHandler),this.evTarget&&H(this.target,this.evTarget,this.domHandler),this.evWin&&H(W(this.element),this.evWin,this.domHandler)}};function et(y){var E,z=y.options.inputClass;return z?E=z:D?E=Do:_?E=ki:w?E=ds:E=zr,new E(y,Ye)}function Ye(y,E,z){var ee=z.pointers.length,le=z.changedPointers.length,be=E&P&&ee-le===0,Me=E&(K|te)&&ee-le===0;z.isFirst=!!be,z.isFinal=!!Me,be&&(y.session={}),z.eventType=E,St(y,z),y.emit("hammer.input",z),y.recognize(z),y.session.prevInput=z}function St(y,E){var z=y.session,ee=E.pointers,le=ee.length;z.firstInput||(z.firstInput=En(E)),le>1&&!z.firstMultiple?z.firstMultiple=En(E):le===1&&(z.firstMultiple=!1);var be=z.firstInput,Me=z.firstMultiple,ft=Me?Me.center:be.center,gt=E.center=ln(ee);E.timeStamp=l(),E.deltaTime=E.timeStamp-be.timeStamp,E.angle=Io(ft,gt),E.distance=jr(ft,gt),Ft(z,E),E.offsetDirection=Ur(E.deltaX,E.deltaY);var kt=On(E.deltaTime,E.deltaX,E.deltaY);E.overallVelocityX=kt.x,E.overallVelocityY=kt.y,E.overallVelocity=c(kt.x)>c(kt.y)?kt.x:kt.y,E.scale=Me?os(Me.pointers,ee):1,E.rotation=Me?rs(Me.pointers,ee):0,E.maxPointers=z.prevInput?E.pointers.length>z.prevInput.maxPointers?E.pointers.length:z.prevInput.maxPointers:E.pointers.length,ht(z,E);var un=y.element;j(E.srcEvent.target,un)&&(un=E.srcEvent.target),E.target=un}function Ft(y,E){var z=E.center,ee=y.offsetDelta||{},le=y.prevDelta||{},be=y.prevInput||{};(E.eventType===P||be.eventType===K)&&(le=y.prevDelta={x:be.deltaX||0,y:be.deltaY||0},ee=y.offsetDelta={x:z.x,y:z.y}),E.deltaX=le.x+(z.x-ee.x),E.deltaY=le.y+(z.y-ee.y)}function ht(y,E){var z=y.lastInterval||E,ee=E.timeStamp-z.timeStamp,le,be,Me,ft;if(E.eventType!=te&&(ee>U||z.velocity===o)){var gt=E.deltaX-z.deltaX,kt=E.deltaY-z.deltaY,un=On(ee,gt,kt);be=un.x,Me=un.y,le=c(un.x)>c(un.y)?un.x:un.y,ft=Ur(gt,kt),y.lastInterval=E}else le=z.velocity,be=z.velocityX,Me=z.velocityY,ft=z.direction;E.velocity=le,E.velocityX=be,E.velocityY=Me,E.direction=ft}function En(y){for(var E=[],z=0;z<y.pointers.length;)E[z]={clientX:s(y.pointers[z].clientX),clientY:s(y.pointers[z].clientY)},z++;return{timeStamp:l(),pointers:E,center:ln(E),deltaX:y.deltaX,deltaY:y.deltaY}}function ln(y){var E=y.length;if(E===1)return{x:s(y[0].clientX),y:s(y[0].clientY)};for(var z=0,ee=0,le=0;le<E;)z+=y[le].clientX,ee+=y[le].clientY,le++;return{x:s(z/E),y:s(ee/E)}}function On(y,E,z){return{x:E/y||0,y:z/y||0}}function Ur(y,E){return y===E?L:c(y)>=c(E)?y<0?re:ce:E<0?Te:ve}function jr(y,E,z){z||(z=Ne);var ee=E[z[0]]-y[z[0]],le=E[z[1]]-y[z[1]];return Math.sqrt(ee*ee+le*le)}function Io(y,E,z){z||(z=Ne);var ee=E[z[0]]-y[z[0]],le=E[z[1]]-y[z[1]];return Math.atan2(le,ee)*180/Math.PI}function rs(y,E){return Io(E[1],E[0],Pe)+Io(y[1],y[0],Pe)}function os(y,E){return jr(E[0],E[1],Pe)/jr(y[0],y[1],Pe)}var is={mousedown:P,mousemove:V,mouseup:K},as="mousedown",ss="mousemove mouseup";function zr(){this.evEl=as,this.evWin=ss,this.pressed=!1,Se.apply(this,arguments)}x(zr,Se,{handler:function(E){var z=is[E.type];z&P&&E.button===0&&(this.pressed=!0),z&V&&E.which!==1&&(z=K),this.pressed&&(z&K&&(this.pressed=!1),this.callback(this.manager,z,{pointers:[E],changedPointers:[E],pointerType:$,srcEvent:E}))}});var ls={pointerdown:P,pointermove:V,pointerup:K,pointercancel:te,pointerout:te},cs={2:F,3:G,4:$,5:X},wi="pointerdown",_i="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(wi="MSPointerDown",_i="MSPointerMove MSPointerUp MSPointerCancel");function Do(){this.evEl=wi,this.evWin=_i,Se.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}x(Do,Se,{handler:function(E){var z=this.store,ee=!1,le=E.type.toLowerCase().replace("ms",""),be=ls[le],Me=cs[E.pointerType]||E.pointerType,ft=Me==F,gt=O(z,E.pointerId,"pointerId");be&P&&(E.button===0||ft)?gt<0&&(z.push(E),gt=z.length-1):be&(K|te)&&(ee=!0),!(gt<0)&&(z[gt]=E,this.callback(this.manager,be,{pointers:z,changedPointers:[E],pointerType:Me,srcEvent:E}),ee&&z.splice(gt,1))}});var us={touchstart:P,touchmove:V,touchend:K,touchcancel:te},ne="touchstart",we="touchstart touchmove touchend touchcancel";function dt(){this.evTarget=ne,this.evWin=we,this.started=!1,Se.apply(this,arguments)}x(dt,Se,{handler:function(E){var z=us[E.type];if(z===P&&(this.started=!0),!!this.started){var ee=An.call(this,E,z);z&(K|te)&&ee[0].length-ee[1].length===0&&(this.started=!1),this.callback(this.manager,z,{pointers:ee[0],changedPointers:ee[1],pointerType:F,srcEvent:E})}}});function An(y,E){var z=Q(y.touches),ee=Q(y.changedTouches);return E&(K|te)&&(z=v(z.concat(ee),"identifier",!0)),[z,ee]}var Hr={touchstart:P,touchmove:V,touchend:K,touchcancel:te},py="touchstart touchmove touchend touchcancel";function ki(){this.evTarget=py,this.targetIds={},Se.apply(this,arguments)}x(ki,Se,{handler:function(E){var z=Hr[E.type],ee=my.call(this,E,z);ee&&this.callback(this.manager,z,{pointers:ee[0],changedPointers:ee[1],pointerType:F,srcEvent:E})}});function my(y,E){var z=Q(y.touches),ee=this.targetIds;if(E&(P|V)&&z.length===1)return ee[z[0].identifier]=!0,[z,z];var le,be,Me=Q(y.changedTouches),ft=[],gt=this.target;if(be=z.filter(function(kt){return j(kt.target,gt)}),E===P)for(le=0;le<be.length;)ee[be[le].identifier]=!0,le++;for(le=0;le<Me.length;)ee[Me[le].identifier]&&ft.push(Me[le]),E&(K|te)&&delete ee[Me[le].identifier],le++;if(ft.length)return[v(be.concat(ft),"identifier",!0),ft]}var hy=2500,Xu=25;function ds(){Se.apply(this,arguments);var y=T(this.handler,this);this.touch=new ki(this.manager,y),this.mouse=new zr(this.manager,y),this.primaryTouch=null,this.lastTouches=[]}x(ds,Se,{handler:function(E,z,ee){var le=ee.pointerType==F,be=ee.pointerType==$;if(!(be&&ee.sourceCapabilities&&ee.sourceCapabilities.firesTouchEvents)){if(le)gy.call(this,z,ee);else if(be&&by.call(this,ee))return;this.callback(E,z,ee)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function gy(y,E){y&P?(this.primaryTouch=E.changedPointers[0].identifier,Yu.call(this,E)):y&(K|te)&&Yu.call(this,E)}function Yu(y){var E=y.changedPointers[0];if(E.identifier===this.primaryTouch){var z={x:E.clientX,y:E.clientY};this.lastTouches.push(z);var ee=this.lastTouches,le=function(){var be=ee.indexOf(z);be>-1&&ee.splice(be,1)};setTimeout(le,hy)}}function by(y){for(var E=y.srcEvent.clientX,z=y.srcEvent.clientY,ee=0;ee<this.lastTouches.length;ee++){var le=this.lastTouches[ee],be=Math.abs(E-le.x),Me=Math.abs(z-le.y);if(be<=Xu&&Me<=Xu)return!0}return!1}var Qu=k(i.style,"touchAction"),$u=Qu!==o,Ku="compute",Ju="auto",fs="manipulation",wr="none",Fo="pan-x",Mo="pan-y",Ti=vy();function ps(y,E){this.manager=y,this.set(E)}ps.prototype={set:function(y){y==Ku&&(y=this.compute()),$u&&this.manager.element.style&&Ti[y]&&(this.manager.element.style[Qu]=y),this.actions=y.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var y=[];return f(this.manager.recognizers,function(E){B(E.options.enable,[E])&&(y=y.concat(E.getTouchAction()))}),xy(y.join(" "))},preventDefaults:function(y){var E=y.srcEvent,z=y.offsetDirection;if(this.manager.session.prevented){E.preventDefault();return}var ee=this.actions,le=M(ee,wr)&&!Ti[wr],be=M(ee,Mo)&&!Ti[Mo],Me=M(ee,Fo)&&!Ti[Fo];if(le){var ft=y.pointers.length===1,gt=y.distance<2,kt=y.deltaTime<250;if(ft&&gt&&kt)return}if(!(Me&&be)&&(le||be&&z&ie||Me&&z&ge))return this.preventSrc(E)},preventSrc:function(y){this.manager.session.prevented=!0,y.preventDefault()}};function xy(y){if(M(y,wr))return wr;var E=M(y,Fo),z=M(y,Mo);return E&&z?wr:E||z?E?Fo:Mo:M(y,fs)?fs:Ju}function vy(){if(!$u)return!1;var y={},E=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(z){y[z]=E?t.CSS.supports("touch-action",z):!0}),y}var Ci=1,zt=2,Vr=4,$n=8,Nn=$n,Po=16,cn=32;function Rn(y){this.options=m({},this.defaults,y||{}),this.id=N(),this.manager=null,this.options.enable=A(this.options.enable,!0),this.state=Ci,this.simultaneous={},this.requireFail=[]}Rn.prototype={defaults:{},set:function(y){return m(this.options,y),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(y){if(d(y,"recognizeWith",this))return this;var E=this.simultaneous;return y=Si(y,this),E[y.id]||(E[y.id]=y,y.recognizeWith(this)),this},dropRecognizeWith:function(y){return d(y,"dropRecognizeWith",this)?this:(y=Si(y,this),delete this.simultaneous[y.id],this)},requireFailure:function(y){if(d(y,"requireFailure",this))return this;var E=this.requireFail;return y=Si(y,this),O(E,y)===-1&&(E.push(y),y.requireFailure(this)),this},dropRequireFailure:function(y){if(d(y,"dropRequireFailure",this))return this;y=Si(y,this);var E=O(this.requireFail,y);return E>-1&&this.requireFail.splice(E,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(y){return!!this.simultaneous[y.id]},emit:function(y){var E=this,z=this.state;function ee(le){E.manager.emit(le,y)}z<$n&&ee(E.options.event+Zu(z)),ee(E.options.event),y.additionalEvent&&ee(y.additionalEvent),z>=$n&&ee(E.options.event+Zu(z))},tryEmit:function(y){if(this.canEmit())return this.emit(y);this.state=cn},canEmit:function(){for(var y=0;y<this.requireFail.length;){if(!(this.requireFail[y].state&(cn|Ci)))return!1;y++}return!0},recognize:function(y){var E=m({},y);if(!B(this.options.enable,[this,E])){this.reset(),this.state=cn;return}this.state&(Nn|Po|cn)&&(this.state=Ci),this.state=this.process(E),this.state&(zt|Vr|$n|Po)&&this.tryEmit(E)},process:function(y){},getTouchAction:function(){},reset:function(){}};function Zu(y){return y&Po?"cancel":y&$n?"end":y&Vr?"move":y&zt?"start":""}function ed(y){return y==ve?"down":y==Te?"up":y==re?"left":y==ce?"right":""}function Si(y,E){var z=E.manager;return z?z.get(y):y}function $t(){Rn.apply(this,arguments)}x($t,Rn,{defaults:{pointers:1},attrTest:function(y){var E=this.options.pointers;return E===0||y.pointers.length===E},process:function(y){var E=this.state,z=y.eventType,ee=E&(zt|Vr),le=this.attrTest(y);return ee&&(z&te||!le)?E|Po:ee||le?z&K?E|$n:E&zt?E|Vr:zt:cn}});function Ei(){$t.apply(this,arguments),this.pX=null,this.pY=null}x(Ei,$t,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ee},getTouchAction:function(){var y=this.options.direction,E=[];return y&ie&&E.push(Mo),y&ge&&E.push(Fo),E},directionTest:function(y){var E=this.options,z=!0,ee=y.distance,le=y.direction,be=y.deltaX,Me=y.deltaY;return le&E.direction||(E.direction&ie?(le=be===0?L:be<0?re:ce,z=be!=this.pX,ee=Math.abs(y.deltaX)):(le=Me===0?L:Me<0?Te:ve,z=Me!=this.pY,ee=Math.abs(y.deltaY))),y.direction=le,z&&ee>E.threshold&&le&E.direction},attrTest:function(y){return $t.prototype.attrTest.call(this,y)&&(this.state&zt||!(this.state&zt)&&this.directionTest(y))},emit:function(y){this.pX=y.deltaX,this.pY=y.deltaY;var E=ed(y.direction);E&&(y.additionalEvent=this.options.event+E),this._super.emit.call(this,y)}});function ms(){$t.apply(this,arguments)}x(ms,$t,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[wr]},attrTest:function(y){return this._super.attrTest.call(this,y)&&(Math.abs(y.scale-1)>this.options.threshold||this.state&zt)},emit:function(y){if(y.scale!==1){var E=y.scale<1?"in":"out";y.additionalEvent=this.options.event+E}this._super.emit.call(this,y)}});function hs(){Rn.apply(this,arguments),this._timer=null,this._input=null}x(hs,Rn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Ju]},process:function(y){var E=this.options,z=y.pointers.length===E.pointers,ee=y.distance<E.threshold,le=y.deltaTime>E.time;if(this._input=y,!ee||!z||y.eventType&(K|te)&&!le)this.reset();else if(y.eventType&P)this.reset(),this._timer=u(function(){this.state=Nn,this.tryEmit()},E.time,this);else if(y.eventType&K)return Nn;return cn},reset:function(){clearTimeout(this._timer)},emit:function(y){this.state===Nn&&(y&&y.eventType&K?this.manager.emit(this.options.event+"up",y):(this._input.timeStamp=l(),this.manager.emit(this.options.event,this._input)))}});function gs(){$t.apply(this,arguments)}x(gs,$t,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[wr]},attrTest:function(y){return this._super.attrTest.call(this,y)&&(Math.abs(y.rotation)>this.options.threshold||this.state&zt)}});function bs(){$t.apply(this,arguments)}x(bs,$t,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:ie|ge,pointers:1},getTouchAction:function(){return Ei.prototype.getTouchAction.call(this)},attrTest:function(y){var E=this.options.direction,z;return E&(ie|ge)?z=y.overallVelocity:E&ie?z=y.overallVelocityX:E&ge&&(z=y.overallVelocityY),this._super.attrTest.call(this,y)&&E&y.offsetDirection&&y.distance>this.options.threshold&&y.maxPointers==this.options.pointers&&c(z)>this.options.velocity&&y.eventType&K},emit:function(y){var E=ed(y.offsetDirection);E&&this.manager.emit(this.options.event+E,y),this.manager.emit(this.options.event,y)}});function Oi(){Rn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}x(Oi,Rn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[fs]},process:function(y){var E=this.options,z=y.pointers.length===E.pointers,ee=y.distance<E.threshold,le=y.deltaTime<E.time;if(this.reset(),y.eventType&P&&this.count===0)return this.failTimeout();if(ee&&le&&z){if(y.eventType!=K)return this.failTimeout();var be=this.pTime?y.timeStamp-this.pTime<E.interval:!0,Me=!this.pCenter||jr(this.pCenter,y.center)<E.posThreshold;this.pTime=y.timeStamp,this.pCenter=y.center,!Me||!be?this.count=1:this.count+=1,this._input=y;var ft=this.count%E.taps;if(ft===0)return this.hasRequireFailures()?(this._timer=u(function(){this.state=Nn,this.tryEmit()},E.interval,this),zt):Nn}return cn},failTimeout:function(){return this._timer=u(function(){this.state=cn},this.options.interval,this),cn},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Nn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function In(y,E){return E=E||{},E.recognizers=A(E.recognizers,In.defaults.preset),new xs(y,E)}In.VERSION="2.0.7",In.defaults={domEvents:!1,touchAction:Ku,enable:!0,inputTarget:null,inputClass:null,preset:[[gs,{enable:!1}],[ms,{enable:!1},["rotate"]],[bs,{direction:ie}],[Ei,{direction:ie},["swipe"]],[Oi],[Oi,{event:"doubletap",taps:2},["tap"]],[hs]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var yy=1,td=2;function xs(y,E){this.options=m({},In.defaults,E||{}),this.options.inputTarget=this.options.inputTarget||y,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=y,this.input=et(this),this.touchAction=new ps(this,this.options.touchAction),nd(this,!0),f(this.options.recognizers,function(z){var ee=this.add(new z[0](z[1]));z[2]&&ee.recognizeWith(z[2]),z[3]&&ee.requireFailure(z[3])},this)}xs.prototype={set:function(y){return m(this.options,y),y.touchAction&&this.touchAction.update(),y.inputTarget&&(this.input.destroy(),this.input.target=y.inputTarget,this.input.init()),this},stop:function(y){this.session.stopped=y?td:yy},recognize:function(y){var E=this.session;if(!E.stopped){this.touchAction.preventDefaults(y);var z,ee=this.recognizers,le=E.curRecognizer;(!le||le&&le.state&Nn)&&(le=E.curRecognizer=null);for(var be=0;be<ee.length;)z=ee[be],E.stopped!==td&&(!le||z==le||z.canRecognizeWith(le))?z.recognize(y):z.reset(),!le&&z.state&(zt|Vr|$n)&&(le=E.curRecognizer=z),be++}},get:function(y){if(y instanceof Rn)return y;for(var E=this.recognizers,z=0;z<E.length;z++)if(E[z].options.event==y)return E[z];return null},add:function(y){if(d(y,"add",this))return this;var E=this.get(y.options.event);return E&&this.remove(E),this.recognizers.push(y),y.manager=this,this.touchAction.update(),y},remove:function(y){if(d(y,"remove",this))return this;if(y=this.get(y),y){var E=this.recognizers,z=O(E,y);z!==-1&&(E.splice(z,1),this.touchAction.update())}return this},on:function(y,E){if(y!==o&&E!==o){var z=this.handlers;return f(I(y),function(ee){z[ee]=z[ee]||[],z[ee].push(E)}),this}},off:function(y,E){if(y!==o){var z=this.handlers;return f(I(y),function(ee){E?z[ee]&&z[ee].splice(O(z[ee],E),1):delete z[ee]}),this}},emit:function(y,E){this.options.domEvents&&wy(y,E);var z=this.handlers[y]&&this.handlers[y].slice();if(!(!z||!z.length)){E.type=y,E.preventDefault=function(){E.srcEvent.preventDefault()};for(var ee=0;ee<z.length;)z[ee](E),ee++}},destroy:function(){this.element&&nd(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function nd(y,E){var z=y.element;if(z.style){var ee;f(y.options.cssProps,function(le,be){ee=k(z.style,be),E?(y.oldCssProps[ee]=z.style[ee],z.style[ee]=le):z.style[ee]=y.oldCssProps[ee]||""}),E||(y.oldCssProps={})}}function wy(y,E){var z=e.createEvent("Event");z.initEvent(y,!0,!0),z.gesture=E,E.target.dispatchEvent(z)}m(In,{INPUT_START:P,INPUT_MOVE:V,INPUT_END:K,INPUT_CANCEL:te,STATE_POSSIBLE:Ci,STATE_BEGAN:zt,STATE_CHANGED:Vr,STATE_ENDED:$n,STATE_RECOGNIZED:Nn,STATE_CANCELLED:Po,STATE_FAILED:cn,DIRECTION_NONE:L,DIRECTION_LEFT:re,DIRECTION_RIGHT:ce,DIRECTION_UP:Te,DIRECTION_DOWN:ve,DIRECTION_HORIZONTAL:ie,DIRECTION_VERTICAL:ge,DIRECTION_ALL:Ee,Manager:xs,Input:Se,TouchAction:ps,TouchInput:ki,MouseInput:zr,PointerEventInput:Do,TouchMouseInput:ds,SingleTouchInput:dt,Recognizer:Rn,AttrRecognizer:$t,Tap:Oi,Pan:Ei,Swipe:bs,Pinch:ms,Rotate:gs,Press:hs,on:S,off:H,each:f,merge:b,extend:h,assign:m,inherit:x,bindFn:T,prefixed:k});var _y=typeof t<"u"?t:typeof self<"u"?self:{};_y.Hammer=In,typeof define=="function"&&define.amd?define(function(){return In}):typeof Fa<"u"&&Fa.exports?Fa.exports=In:t[n]=In})(window,document,"Hammer")});var Ev=ct(_t=>{"use strict";Object.defineProperty(_t,"__esModule",{value:!0});function jt(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Lr(t){var e=jt(t).Element;return t instanceof e||t instanceof Element}function Xt(t){var e=jt(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function tu(t){if(typeof ShadowRoot>"u")return!1;var e=jt(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}var Pr=Math.max,Ka=Math.min,Eo=Math.round;function Zc(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function fv(){return!/^((?!chrome|android).)*safari/i.test(Zc())}function Oo(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var o=t.getBoundingClientRect(),r=1,i=1;e&&Xt(t)&&(r=t.offsetWidth>0&&Eo(o.width)/t.offsetWidth||1,i=t.offsetHeight>0&&Eo(o.height)/t.offsetHeight||1);var a=Lr(t)?jt(t):window,s=a.visualViewport,c=!fv()&&n,l=(o.left+(c&&s?s.offsetLeft:0))/r,u=(o.top+(c&&s?s.offsetTop:0))/i,d=o.width/r,f=o.height/i;return{width:d,height:f,top:u,right:l+d,bottom:u+f,left:l,x:l,y:u}}function nu(t){var e=jt(t),n=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:n,scrollTop:o}}function zE(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function HE(t){return t===jt(t)||!Xt(t)?nu(t):zE(t)}function Sn(t){return t?(t.nodeName||"").toLowerCase():null}function yr(t){return((Lr(t)?t.ownerDocument:t.document)||window.document).documentElement}function ru(t){return Oo(yr(t)).left+nu(t).scrollLeft}function Qn(t){return jt(t).getComputedStyle(t)}function ou(t){var e=Qn(t),n=e.overflow,o=e.overflowX,r=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+r+o)}function VE(t){var e=t.getBoundingClientRect(),n=Eo(e.width)/t.offsetWidth||1,o=Eo(e.height)/t.offsetHeight||1;return n!==1||o!==1}function WE(t,e,n){n===void 0&&(n=!1);var o=Xt(e),r=Xt(e)&&VE(e),i=yr(e),a=Oo(t,r,n),s={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(o||!o&&!n)&&((Sn(e)!=="body"||ou(i))&&(s=HE(e)),Xt(e)?(c=Oo(e,!0),c.x+=e.clientLeft,c.y+=e.clientTop):i&&(c.x=ru(i))),{x:a.left+s.scrollLeft-c.x,y:a.top+s.scrollTop-c.y,width:a.width,height:a.height}}function iu(t){var e=Oo(t),n=t.offsetWidth,o=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:o}}function Ja(t){return Sn(t)==="html"?t:t.assignedSlot||t.parentNode||(tu(t)?t.host:null)||yr(t)}function pv(t){return["html","body","#document"].indexOf(Sn(t))>=0?t.ownerDocument.body:Xt(t)&&ou(t)?t:pv(Ja(t))}function gi(t,e){var n;e===void 0&&(e=[]);var o=pv(t),r=o===((n=t.ownerDocument)==null?void 0:n.body),i=jt(o),a=r?[i].concat(i.visualViewport||[],ou(o)?o:[]):o,s=e.concat(a);return r?s:s.concat(gi(Ja(a)))}function GE(t){return["table","td","th"].indexOf(Sn(t))>=0}function rv(t){return!Xt(t)||Qn(t).position==="fixed"?null:t.offsetParent}function qE(t){var e=/firefox/i.test(Zc()),n=/Trident/i.test(Zc());if(n&&Xt(t)){var o=Qn(t);if(o.position==="fixed")return null}var r=Ja(t);for(tu(r)&&(r=r.host);Xt(r)&&["html","body"].indexOf(Sn(r))<0;){var i=Qn(r);if(i.transform!=="none"||i.perspective!=="none"||i.contain==="paint"||["transform","perspective"].indexOf(i.willChange)!==-1||e&&i.willChange==="filter"||e&&i.filter&&i.filter!=="none")return r;r=r.parentNode}return null}function vi(t){for(var e=jt(t),n=rv(t);n&&GE(n)&&Qn(n).position==="static";)n=rv(n);return n&&(Sn(n)==="html"||Sn(n)==="body"&&Qn(n).position==="static")?e:n||qE(t)||e}var It="top",Yt="bottom",Qt="right",Dt="left",au="auto",yi=[It,Yt,Qt,Dt],Ao="start",xi="end",XE="clippingParents",mv="viewport",hi="popper",YE="reference",ov=yi.reduce(function(t,e){return t.concat([e+"-"+Ao,e+"-"+xi])},[]),hv=[].concat(yi,[au]).reduce(function(t,e){return t.concat([e,e+"-"+Ao,e+"-"+xi])},[]),QE="beforeRead",$E="read",KE="afterRead",JE="beforeMain",ZE="main",eO="afterMain",tO="beforeWrite",nO="write",rO="afterWrite",oO=[QE,$E,KE,JE,ZE,eO,tO,nO,rO];function iO(t){var e=new Map,n=new Set,o=[];t.forEach(function(i){e.set(i.name,i)});function r(i){n.add(i.name);var a=[].concat(i.requires||[],i.requiresIfExists||[]);a.forEach(function(s){if(!n.has(s)){var c=e.get(s);c&&r(c)}}),o.push(i)}return t.forEach(function(i){n.has(i.name)||r(i)}),o}function aO(t){var e=iO(t);return oO.reduce(function(n,o){return n.concat(e.filter(function(r){return r.phase===o}))},[])}function sO(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function lO(t){var e=t.reduce(function(n,o){var r=n[o.name];return n[o.name]=r?Object.assign({},r,o,{options:Object.assign({},r.options,o.options),data:Object.assign({},r.data,o.data)}):o,n},{});return Object.keys(e).map(function(n){return e[n]})}function cO(t,e){var n=jt(t),o=yr(t),r=n.visualViewport,i=o.clientWidth,a=o.clientHeight,s=0,c=0;if(r){i=r.width,a=r.height;var l=fv();(l||!l&&e==="fixed")&&(s=r.offsetLeft,c=r.offsetTop)}return{width:i,height:a,x:s+ru(t),y:c}}function uO(t){var e,n=yr(t),o=nu(t),r=(e=t.ownerDocument)==null?void 0:e.body,i=Pr(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),a=Pr(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),s=-o.scrollLeft+ru(t),c=-o.scrollTop;return Qn(r||n).direction==="rtl"&&(s+=Pr(n.clientWidth,r?r.clientWidth:0)-i),{width:i,height:a,x:s,y:c}}function gv(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&tu(n)){var o=e;do{if(o&&t.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function eu(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function dO(t,e){var n=Oo(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function iv(t,e,n){return e===mv?eu(cO(t,n)):Lr(e)?dO(e,n):eu(uO(yr(t)))}function fO(t){var e=gi(Ja(t)),n=["absolute","fixed"].indexOf(Qn(t).position)>=0,o=n&&Xt(t)?vi(t):t;return Lr(o)?e.filter(function(r){return Lr(r)&&gv(r,o)&&Sn(r)!=="body"}):[]}function pO(t,e,n,o){var r=e==="clippingParents"?fO(t):[].concat(e),i=[].concat(r,[n]),a=i[0],s=i.reduce(function(c,l){var u=iv(t,l,o);return c.top=Pr(u.top,c.top),c.right=Ka(u.right,c.right),c.bottom=Ka(u.bottom,c.bottom),c.left=Pr(u.left,c.left),c},iv(t,a,o));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function Cn(t){return t.split("-")[0]}function No(t){return t.split("-")[1]}function su(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function bv(t){var e=t.reference,n=t.element,o=t.placement,r=o?Cn(o):null,i=o?No(o):null,a=e.x+e.width/2-n.width/2,s=e.y+e.height/2-n.height/2,c;switch(r){case It:c={x:a,y:e.y-n.height};break;case Yt:c={x:a,y:e.y+e.height};break;case Qt:c={x:e.x+e.width,y:s};break;case Dt:c={x:e.x-n.width,y:s};break;default:c={x:e.x,y:e.y}}var l=r?su(r):null;if(l!=null){var u=l==="y"?"height":"width";switch(i){case Ao:c[l]=c[l]-(e[u]/2-n[u]/2);break;case xi:c[l]=c[l]+(e[u]/2-n[u]/2);break}}return c}function xv(){return{top:0,right:0,bottom:0,left:0}}function vv(t){return Object.assign({},xv(),t)}function yv(t,e){return e.reduce(function(n,o){return n[o]=t,n},{})}function Ro(t,e){e===void 0&&(e={});var n=e,o=n.placement,r=o===void 0?t.placement:o,i=n.strategy,a=i===void 0?t.strategy:i,s=n.boundary,c=s===void 0?XE:s,l=n.rootBoundary,u=l===void 0?mv:l,d=n.elementContext,f=d===void 0?hi:d,p=n.altBoundary,m=p===void 0?!1:p,h=n.padding,b=h===void 0?0:h,x=vv(typeof b!="number"?b:yv(b,yi)),T=f===hi?YE:hi,B=t.rects.popper,A=t.elements[m?T:f],S=pO(Lr(A)?A:A.contextElement||yr(t.elements.popper),c,u,a),H=Oo(t.elements.reference),j=bv({reference:H,element:B,strategy:"absolute",placement:r}),M=eu(Object.assign({},B,j)),I=f===hi?M:H,O={top:S.top-I.top+x.top,bottom:I.bottom-S.bottom+x.bottom,left:S.left-I.left+x.left,right:I.right-S.right+x.right},Q=t.modifiersData.offset;if(f===hi&&Q){var v=Q[r];Object.keys(O).forEach(function(k){var R=[Qt,Yt].indexOf(k)>=0?1:-1,N=[It,Yt].indexOf(k)>=0?"y":"x";O[k]+=v[N]*R})}return O}var av={placement:"bottom",modifiers:[],strategy:"absolute"};function sv(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function lu(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,o=n===void 0?[]:n,r=e.defaultOptions,i=r===void 0?av:r;return function(s,c,l){l===void 0&&(l=i);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},av,i),modifiersData:{},elements:{reference:s,popper:c},attributes:{},styles:{}},d=[],f=!1,p={state:u,setOptions:function(x){var T=typeof x=="function"?x(u.options):x;h(),u.options=Object.assign({},i,u.options,T),u.scrollParents={reference:Lr(s)?gi(s):s.contextElement?gi(s.contextElement):[],popper:gi(c)};var B=aO(lO([].concat(o,u.options.modifiers)));return u.orderedModifiers=B.filter(function(A){return A.enabled}),m(),p.update()},forceUpdate:function(){if(!f){var x=u.elements,T=x.reference,B=x.popper;if(sv(T,B)){u.rects={reference:WE(T,vi(B),u.options.strategy==="fixed"),popper:iu(B)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(O){return u.modifiersData[O.name]=Object.assign({},O.data)});for(var A=0;A<u.orderedModifiers.length;A++){if(u.reset===!0){u.reset=!1,A=-1;continue}var S=u.orderedModifiers[A],H=S.fn,j=S.options,M=j===void 0?{}:j,I=S.name;typeof H=="function"&&(u=H({state:u,options:M,name:I,instance:p})||u)}}}},update:sO(function(){return new Promise(function(b){p.forceUpdate(),b(u)})}),destroy:function(){h(),f=!0}};if(!sv(s,c))return p;p.setOptions(l).then(function(b){!f&&l.onFirstUpdate&&l.onFirstUpdate(b)});function m(){u.orderedModifiers.forEach(function(b){var x=b.name,T=b.options,B=T===void 0?{}:T,A=b.effect;if(typeof A=="function"){var S=A({state:u,name:x,instance:p,options:B}),H=function(){};d.push(S||H)}})}function h(){d.forEach(function(b){return b()}),d=[]}return p}}var Qa={passive:!0};function mO(t){var e=t.state,n=t.instance,o=t.options,r=o.scroll,i=r===void 0?!0:r,a=o.resize,s=a===void 0?!0:a,c=jt(e.elements.popper),l=[].concat(e.scrollParents.reference,e.scrollParents.popper);return i&&l.forEach(function(u){u.addEventListener("scroll",n.update,Qa)}),s&&c.addEventListener("resize",n.update,Qa),function(){i&&l.forEach(function(u){u.removeEventListener("scroll",n.update,Qa)}),s&&c.removeEventListener("resize",n.update,Qa)}}var cu={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:mO,data:{}};function hO(t){var e=t.state,n=t.name;e.modifiersData[n]=bv({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}var uu={name:"popperOffsets",enabled:!0,phase:"read",fn:hO,data:{}},gO={top:"auto",right:"auto",bottom:"auto",left:"auto"};function bO(t,e){var n=t.x,o=t.y,r=e.devicePixelRatio||1;return{x:Eo(n*r)/r||0,y:Eo(o*r)/r||0}}function lv(t){var e,n=t.popper,o=t.popperRect,r=t.placement,i=t.variation,a=t.offsets,s=t.position,c=t.gpuAcceleration,l=t.adaptive,u=t.roundOffsets,d=t.isFixed,f=a.x,p=f===void 0?0:f,m=a.y,h=m===void 0?0:m,b=typeof u=="function"?u({x:p,y:h}):{x:p,y:h};p=b.x,h=b.y;var x=a.hasOwnProperty("x"),T=a.hasOwnProperty("y"),B=Dt,A=It,S=window;if(l){var H=vi(n),j="clientHeight",M="clientWidth";if(H===jt(n)&&(H=yr(n),Qn(H).position!=="static"&&s==="absolute"&&(j="scrollHeight",M="scrollWidth")),H=H,r===It||(r===Dt||r===Qt)&&i===xi){A=Yt;var I=d&&H===S&&S.visualViewport?S.visualViewport.height:H[j];h-=I-o.height,h*=c?1:-1}if(r===Dt||(r===It||r===Yt)&&i===xi){B=Qt;var O=d&&H===S&&S.visualViewport?S.visualViewport.width:H[M];p-=O-o.width,p*=c?1:-1}}var Q=Object.assign({position:s},l&&gO),v=u===!0?bO({x:p,y:h},jt(n)):{x:p,y:h};if(p=v.x,h=v.y,c){var k;return Object.assign({},Q,(k={},k[A]=T?"0":"",k[B]=x?"0":"",k.transform=(S.devicePixelRatio||1)<=1?"translate("+p+"px, "+h+"px)":"translate3d("+p+"px, "+h+"px, 0)",k))}return Object.assign({},Q,(e={},e[A]=T?h+"px":"",e[B]=x?p+"px":"",e.transform="",e))}function xO(t){var e=t.state,n=t.options,o=n.gpuAcceleration,r=o===void 0?!0:o,i=n.adaptive,a=i===void 0?!0:i,s=n.roundOffsets,c=s===void 0?!0:s,l={placement:Cn(e.placement),variation:No(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:r,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,lv(Object.assign({},l,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:a,roundOffsets:c})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,lv(Object.assign({},l,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:c})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}var du={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:xO,data:{}};function vO(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var o=e.styles[n]||{},r=e.attributes[n]||{},i=e.elements[n];!Xt(i)||!Sn(i)||(Object.assign(i.style,o),Object.keys(r).forEach(function(a){var s=r[a];s===!1?i.removeAttribute(a):i.setAttribute(a,s===!0?"":s)}))})}function yO(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(o){var r=e.elements[o],i=e.attributes[o]||{},a=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:n[o]),s=a.reduce(function(c,l){return c[l]="",c},{});!Xt(r)||!Sn(r)||(Object.assign(r.style,s),Object.keys(i).forEach(function(c){r.removeAttribute(c)}))})}}var fu={name:"applyStyles",enabled:!0,phase:"write",fn:vO,effect:yO,requires:["computeStyles"]};function wO(t,e,n){var o=Cn(t),r=[Dt,It].indexOf(o)>=0?-1:1,i=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,a=i[0],s=i[1];return a=a||0,s=(s||0)*r,[Dt,Qt].indexOf(o)>=0?{x:s,y:a}:{x:a,y:s}}function _O(t){var e=t.state,n=t.options,o=t.name,r=n.offset,i=r===void 0?[0,0]:r,a=hv.reduce(function(u,d){return u[d]=wO(d,e.rects,i),u},{}),s=a[e.placement],c=s.x,l=s.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=c,e.modifiersData.popperOffsets.y+=l),e.modifiersData[o]=a}var wv={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:_O},kO={left:"right",right:"left",bottom:"top",top:"bottom"};function $a(t){return t.replace(/left|right|bottom|top/g,function(e){return kO[e]})}var TO={start:"end",end:"start"};function cv(t){return t.replace(/start|end/g,function(e){return TO[e]})}function CO(t,e){e===void 0&&(e={});var n=e,o=n.placement,r=n.boundary,i=n.rootBoundary,a=n.padding,s=n.flipVariations,c=n.allowedAutoPlacements,l=c===void 0?hv:c,u=No(o),d=u?s?ov:ov.filter(function(m){return No(m)===u}):yi,f=d.filter(function(m){return l.indexOf(m)>=0});f.length===0&&(f=d);var p=f.reduce(function(m,h){return m[h]=Ro(t,{placement:h,boundary:r,rootBoundary:i,padding:a})[Cn(h)],m},{});return Object.keys(p).sort(function(m,h){return p[m]-p[h]})}function SO(t){if(Cn(t)===au)return[];var e=$a(t);return[cv(t),e,cv(e)]}function EO(t){var e=t.state,n=t.options,o=t.name;if(!e.modifiersData[o]._skip){for(var r=n.mainAxis,i=r===void 0?!0:r,a=n.altAxis,s=a===void 0?!0:a,c=n.fallbackPlacements,l=n.padding,u=n.boundary,d=n.rootBoundary,f=n.altBoundary,p=n.flipVariations,m=p===void 0?!0:p,h=n.allowedAutoPlacements,b=e.options.placement,x=Cn(b),T=x===b,B=c||(T||!m?[$a(b)]:SO(b)),A=[b].concat(B).reduce(function(X,U){return X.concat(Cn(U)===au?CO(e,{placement:U,boundary:u,rootBoundary:d,padding:l,flipVariations:m,allowedAutoPlacements:h}):U)},[]),S=e.rects.reference,H=e.rects.popper,j=new Map,M=!0,I=A[0],O=0;O<A.length;O++){var Q=A[O],v=Cn(Q),k=No(Q)===Ao,R=[It,Yt].indexOf(v)>=0,N=R?"width":"height",W=Ro(e,{placement:Q,boundary:u,rootBoundary:d,altBoundary:f,padding:l}),C=R?k?Qt:Dt:k?Yt:It;S[N]>H[N]&&(C=$a(C));var w=$a(C),D=[];if(i&&D.push(W[v]<=0),s&&D.push(W[C]<=0,W[w]<=0),D.every(function(X){return X})){I=Q,M=!1;break}j.set(Q,D)}if(M)for(var _=m?3:1,F=function(U){var P=A.find(function(V){var K=j.get(V);if(K)return K.slice(0,U).every(function(te){return te})});if(P)return I=P,"break"},G=_;G>0;G--){var $=F(G);if($==="break")break}e.placement!==I&&(e.modifiersData[o]._skip=!0,e.placement=I,e.reset=!0)}}var _v={name:"flip",enabled:!0,phase:"main",fn:EO,requiresIfExists:["offset"],data:{_skip:!1}};function OO(t){return t==="x"?"y":"x"}function bi(t,e,n){return Pr(t,Ka(e,n))}function AO(t,e,n){var o=bi(t,e,n);return o>n?n:o}function NO(t){var e=t.state,n=t.options,o=t.name,r=n.mainAxis,i=r===void 0?!0:r,a=n.altAxis,s=a===void 0?!1:a,c=n.boundary,l=n.rootBoundary,u=n.altBoundary,d=n.padding,f=n.tether,p=f===void 0?!0:f,m=n.tetherOffset,h=m===void 0?0:m,b=Ro(e,{boundary:c,rootBoundary:l,padding:d,altBoundary:u}),x=Cn(e.placement),T=No(e.placement),B=!T,A=su(x),S=OO(A),H=e.modifiersData.popperOffsets,j=e.rects.reference,M=e.rects.popper,I=typeof h=="function"?h(Object.assign({},e.rects,{placement:e.placement})):h,O=typeof I=="number"?{mainAxis:I,altAxis:I}:Object.assign({mainAxis:0,altAxis:0},I),Q=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,v={x:0,y:0};if(H){if(i){var k,R=A==="y"?It:Dt,N=A==="y"?Yt:Qt,W=A==="y"?"height":"width",C=H[A],w=C+b[R],D=C-b[N],_=p?-M[W]/2:0,F=T===Ao?j[W]:M[W],G=T===Ao?-M[W]:-j[W],$=e.elements.arrow,X=p&&$?iu($):{width:0,height:0},U=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:xv(),P=U[R],V=U[N],K=bi(0,j[W],X[W]),te=B?j[W]/2-_-K-P-O.mainAxis:F-K-P-O.mainAxis,L=B?-j[W]/2+_+K+V+O.mainAxis:G+K+V+O.mainAxis,re=e.elements.arrow&&vi(e.elements.arrow),ce=re?A==="y"?re.clientTop||0:re.clientLeft||0:0,Te=(k=Q==null?void 0:Q[A])!=null?k:0,ve=C+te-Te-ce,ie=C+L-Te,ge=bi(p?Ka(w,ve):w,C,p?Pr(D,ie):D);H[A]=ge,v[A]=ge-C}if(s){var Ee,Ne=A==="x"?It:Dt,Pe=A==="x"?Yt:Qt,Se=H[S],et=S==="y"?"height":"width",Ye=Se+b[Ne],St=Se-b[Pe],Ft=[It,Dt].indexOf(x)!==-1,ht=(Ee=Q==null?void 0:Q[S])!=null?Ee:0,En=Ft?Ye:Se-j[et]-M[et]-ht+O.altAxis,ln=Ft?Se+j[et]+M[et]-ht-O.altAxis:St,On=p&&Ft?AO(En,Se,ln):bi(p?En:Ye,Se,p?ln:St);H[S]=On,v[S]=On-Se}e.modifiersData[o]=v}}var kv={name:"preventOverflow",enabled:!0,phase:"main",fn:NO,requiresIfExists:["offset"]},RO=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,vv(typeof e!="number"?e:yv(e,yi))};function IO(t){var e,n=t.state,o=t.name,r=t.options,i=n.elements.arrow,a=n.modifiersData.popperOffsets,s=Cn(n.placement),c=su(s),l=[Dt,Qt].indexOf(s)>=0,u=l?"height":"width";if(!(!i||!a)){var d=RO(r.padding,n),f=iu(i),p=c==="y"?It:Dt,m=c==="y"?Yt:Qt,h=n.rects.reference[u]+n.rects.reference[c]-a[c]-n.rects.popper[u],b=a[c]-n.rects.reference[c],x=vi(i),T=x?c==="y"?x.clientHeight||0:x.clientWidth||0:0,B=h/2-b/2,A=d[p],S=T-f[u]-d[m],H=T/2-f[u]/2+B,j=bi(A,H,S),M=c;n.modifiersData[o]=(e={},e[M]=j,e.centerOffset=j-H,e)}}function DO(t){var e=t.state,n=t.options,o=n.element,r=o===void 0?"[data-popper-arrow]":o;r!=null&&(typeof r=="string"&&(r=e.elements.popper.querySelector(r),!r)||gv(e.elements.popper,r)&&(e.elements.arrow=r))}var Tv={name:"arrow",enabled:!0,phase:"main",fn:IO,effect:DO,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function uv(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function dv(t){return[It,Qt,Yt,Dt].some(function(e){return t[e]>=0})}function FO(t){var e=t.state,n=t.name,o=e.rects.reference,r=e.rects.popper,i=e.modifiersData.preventOverflow,a=Ro(e,{elementContext:"reference"}),s=Ro(e,{altBoundary:!0}),c=uv(a,o),l=uv(s,r,i),u=dv(c),d=dv(l);e.modifiersData[n]={referenceClippingOffsets:c,popperEscapeOffsets:l,isReferenceHidden:u,hasPopperEscaped:d},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}var Cv={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:FO},MO=[cu,uu,du,fu],PO=lu({defaultModifiers:MO}),Sv=[cu,uu,du,fu,wv,_v,kv,Tv,Cv],LO=lu({defaultModifiers:Sv});_t.applyStyles=fu;_t.arrow=Tv;_t.computeStyles=du;_t.createPopper=LO;_t.createPopperLite=PO;_t.defaultModifiers=Sv;_t.detectOverflow=Ro;_t.eventListeners=cu;_t.flip=_v;_t.hide=Cv;_t.offset=wv;_t.popperGenerator=lu;_t.popperOffsets=uu;_t.preventOverflow=kv});var Ov=ct((pu,mu)=>{(function(t,e){typeof pu=="object"&&typeof mu<"u"?mu.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis<"u"?globalThis:t||self,t.Data=e())})(pu,function(){"use strict";let t=new Map;return{set(n,o,r){t.has(n)||t.set(n,new Map);let i=t.get(n);if(!i.has(o)&&i.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(i.keys())[0]}.`);return}i.set(o,r)},get(n,o){return t.has(n)&&t.get(n).get(o)||null},remove(n,o){if(!t.has(n))return;let r=t.get(n);r.delete(o),r.size===0&&t.delete(n)}}})});var Br=ct((Za,Av)=>{(function(t,e){typeof Za=="object"&&typeof Av<"u"?e(Za):typeof define=="function"&&define.amd?define(["exports"],e):(t=typeof globalThis<"u"?globalThis:t||self,e(t.Index={}))})(Za,function(t){"use strict";let o="transitionend",r=M=>(M&&window.CSS&&window.CSS.escape&&(M=M.replace(/#([^\s"#']+)/g,(I,O)=>`#${CSS.escape(O)}`)),M),i=M=>M==null?`${M}`:Object.prototype.toString.call(M).match(/\s([a-z]+)/i)[1].toLowerCase(),a=M=>{do M+=Math.floor(Math.random()*1e6);while(document.getElementById(M));return M},s=M=>{if(!M)return 0;let{transitionDuration:I,transitionDelay:O}=window.getComputedStyle(M),Q=Number.parseFloat(I),v=Number.parseFloat(O);return!Q&&!v?0:(I=I.split(",")[0],O=O.split(",")[0],(Number.parseFloat(I)+Number.parseFloat(O))*1e3)},c=M=>{M.dispatchEvent(new Event(o))},l=M=>!M||typeof M!="object"?!1:(typeof M.jquery<"u"&&(M=M[0]),typeof M.nodeType<"u"),u=M=>l(M)?M.jquery?M[0]:M:typeof M=="string"&&M.length>0?document.querySelector(r(M)):null,d=M=>{if(!l(M)||M.getClientRects().length===0)return!1;let I=getComputedStyle(M).getPropertyValue("visibility")==="visible",O=M.closest("details:not([open])");if(!O)return I;if(O!==M){let Q=M.closest("summary");if(Q&&Q.parentNode!==O||Q===null)return!1}return I},f=M=>!M||M.nodeType!==Node.ELEMENT_NODE||M.classList.contains("disabled")?!0:typeof M.disabled<"u"?M.disabled:M.hasAttribute("disabled")&&M.getAttribute("disabled")!=="false",p=M=>{if(!document.documentElement.attachShadow)return null;if(typeof M.getRootNode=="function"){let I=M.getRootNode();return I instanceof ShadowRoot?I:null}return M instanceof ShadowRoot?M:M.parentNode?p(M.parentNode):null},m=()=>{},h=M=>{M.offsetHeight},b=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,x=[],T=M=>{document.readyState==="loading"?(x.length||document.addEventListener("DOMContentLoaded",()=>{for(let I of x)I()}),x.push(M)):M()},B=()=>document.documentElement.dir==="rtl",A=M=>{T(()=>{let I=b();if(I){let O=M.NAME,Q=I.fn[O];I.fn[O]=M.jQueryInterface,I.fn[O].Constructor=M,I.fn[O].noConflict=()=>(I.fn[O]=Q,M.jQueryInterface)}})},S=(M,I=[],O=M)=>typeof M=="function"?M(...I):O,H=(M,I,O=!0)=>{if(!O){S(M);return}let Q=5,v=s(I)+Q,k=!1,R=({target:N})=>{N===I&&(k=!0,I.removeEventListener(o,R),S(M))};I.addEventListener(o,R),setTimeout(()=>{k||c(I)},v)},j=(M,I,O,Q)=>{let v=M.length,k=M.indexOf(I);return k===-1?!O&&Q?M[v-1]:M[0]:(k+=O?1:-1,Q&&(k=(k+v)%v),M[Math.max(0,Math.min(k,v-1))])};t.defineJQueryPlugin=A,t.execute=S,t.executeAfterTransition=H,t.findShadowRoot=p,t.getElement=u,t.getNextActiveElement=j,t.getTransitionDurationFromElement=s,t.getUID=a,t.getjQuery=b,t.isDisabled=f,t.isElement=l,t.isRTL=B,t.isVisible=d,t.noop=m,t.onDOMContentLoaded=T,t.parseSelector=r,t.reflow=h,t.toType=i,t.triggerTransitionEnd=c,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})})});var bu=ct((hu,gu)=>{(function(t,e){typeof hu=="object"&&typeof gu<"u"?gu.exports=e(Br()):typeof define=="function"&&define.amd?define(["../util/index"],e):(t=typeof globalThis<"u"?globalThis:t||self,t.EventHandler=e(t.Index))})(hu,function(t){"use strict";let e=/[^.]*(?=\..*)\.|.*/,n=/\..*/,o=/::\d+$/,r={},i=1,a={mouseenter:"mouseover",mouseleave:"mouseout"},s=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function c(A,S){return S&&`${S}::${i++}`||A.uidEvent||i++}function l(A){let S=c(A);return A.uidEvent=S,r[S]=r[S]||{},r[S]}function u(A,S){return function H(j){return B(j,{delegateTarget:A}),H.oneOff&&T.off(A,j.type,S),S.apply(A,[j])}}function d(A,S,H){return function j(M){let I=A.querySelectorAll(S);for(let{target:O}=M;O&&O!==this;O=O.parentNode)for(let Q of I)if(Q===O)return B(M,{delegateTarget:O}),j.oneOff&&T.off(A,M.type,S,H),H.apply(O,[M])}}function f(A,S,H=null){return Object.values(A).find(j=>j.callable===S&&j.delegationSelector===H)}function p(A,S,H){let j=typeof S=="string",M=j?H:S||H,I=x(A);return s.has(I)||(I=A),[j,M,I]}function m(A,S,H,j,M){if(typeof S!="string"||!A)return;let[I,O,Q]=p(S,H,j);S in a&&(O=(w=>function(D){if(!D.relatedTarget||D.relatedTarget!==D.delegateTarget&&!D.delegateTarget.contains(D.relatedTarget))return w.call(this,D)})(O));let v=l(A),k=v[Q]||(v[Q]={}),R=f(k,O,I?H:null);if(R){R.oneOff=R.oneOff&&M;return}let N=c(O,S.replace(e,"")),W=I?d(A,H,O):u(A,O);W.delegationSelector=I?H:null,W.callable=O,W.oneOff=M,W.uidEvent=N,k[N]=W,A.addEventListener(Q,W,I)}function h(A,S,H,j,M){let I=f(S[H],j,M);I&&(A.removeEventListener(H,I,!!M),delete S[H][I.uidEvent])}function b(A,S,H,j){let M=S[H]||{};for(let[I,O]of Object.entries(M))I.includes(j)&&h(A,S,H,O.callable,O.delegationSelector)}function x(A){return A=A.replace(n,""),a[A]||A}let T={on(A,S,H,j){m(A,S,H,j,!1)},one(A,S,H,j){m(A,S,H,j,!0)},off(A,S,H,j){if(typeof S!="string"||!A)return;let[M,I,O]=p(S,H,j),Q=O!==S,v=l(A),k=v[O]||{},R=S.startsWith(".");if(typeof I<"u"){if(!Object.keys(k).length)return;h(A,v,O,I,M?H:null);return}if(R)for(let N of Object.keys(v))b(A,v,N,S.slice(1));for(let[N,W]of Object.entries(k)){let C=N.replace(o,"");(!Q||S.includes(C))&&h(A,v,O,W.callable,W.delegationSelector)}},trigger(A,S,H){if(typeof S!="string"||!A)return null;let j=t.getjQuery(),M=x(S),I=S!==M,O=null,Q=!0,v=!0,k=!1;I&&j&&(O=j.Event(S,H),j(A).trigger(O),Q=!O.isPropagationStopped(),v=!O.isImmediatePropagationStopped(),k=O.isDefaultPrevented());let R=B(new Event(S,{bubbles:Q,cancelable:!0}),H);return k&&R.preventDefault(),v&&A.dispatchEvent(R),R.defaultPrevented&&O&&O.preventDefault(),R}};function B(A,S={}){for(let[H,j]of Object.entries(S))try{A[H]=j}catch{Object.defineProperty(A,H,{configurable:!0,get(){return j}})}return A}return T})});var yu=ct((xu,vu)=>{(function(t,e){typeof xu=="object"&&typeof vu<"u"?vu.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis<"u"?globalThis:t||self,t.Manipulator=e())})(xu,function(){"use strict";function t(o){if(o==="true")return!0;if(o==="false")return!1;if(o===Number(o).toString())return Number(o);if(o===""||o==="null")return null;if(typeof o!="string")return o;try{return JSON.parse(decodeURIComponent(o))}catch{return o}}function e(o){return o.replace(/[A-Z]/g,r=>`-${r.toLowerCase()}`)}return{setDataAttribute(o,r,i){o.setAttribute(`data-bs-${e(r)}`,i)},removeDataAttribute(o,r){o.removeAttribute(`data-bs-${e(r)}`)},getDataAttributes(o){if(!o)return{};let r={},i=Object.keys(o.dataset).filter(a=>a.startsWith("bs")&&!a.startsWith("bsConfig"));for(let a of i){let s=a.replace(/^bs/,"");s=s.charAt(0).toLowerCase()+s.slice(1,s.length),r[s]=t(o.dataset[a])}return r},getDataAttribute(o,r){return t(o.getAttribute(`data-bs-${e(r)}`))}}})});var ku=ct((wu,_u)=>{(function(t,e){typeof wu=="object"&&typeof _u<"u"?_u.exports=e(yu(),Br()):typeof define=="function"&&define.amd?define(["../dom/manipulator","./index"],e):(t=typeof globalThis<"u"?globalThis:t||self,t.Config=e(t.Manipulator,t.Index))})(wu,function(t,e){"use strict";class n{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(r){return r=this._mergeConfigObj(r),r=this._configAfterMerge(r),this._typeCheckConfig(r),r}_configAfterMerge(r){return r}_mergeConfigObj(r,i){let a=e.isElement(i)?t.getDataAttribute(i,"config"):{};return{...this.constructor.Default,...typeof a=="object"?a:{},...e.isElement(i)?t.getDataAttributes(i):{},...typeof r=="object"?r:{}}}_typeCheckConfig(r,i=this.constructor.DefaultType){for(let[a,s]of Object.entries(i)){let c=r[a],l=e.isElement(c)?"element":e.toType(c);if(!new RegExp(s).test(l))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${a}" provided type "${l}" but expected type "${s}".`)}}}return n})});var Nv=ct((Tu,Cu)=>{(function(t,e){typeof Tu=="object"&&typeof Cu<"u"?Cu.exports=e(Ov(),bu(),ku(),Br()):typeof define=="function"&&define.amd?define(["./dom/data","./dom/event-handler","./util/config","./util/index"],e):(t=typeof globalThis<"u"?globalThis:t||self,t.BaseComponent=e(t.Data,t.EventHandler,t.Config,t.Index))})(Tu,function(t,e,n,o){"use strict";let r="5.3.3";class i extends n{constructor(s,c){super(),s=o.getElement(s),s&&(this._element=s,this._config=this._getConfig(c),t.set(this._element,this.constructor.DATA_KEY,this))}dispose(){t.remove(this._element,this.constructor.DATA_KEY),e.off(this._element,this.constructor.EVENT_KEY);for(let s of Object.getOwnPropertyNames(this))this[s]=null}_queueCallback(s,c,l=!0){o.executeAfterTransition(s,c,l)}_getConfig(s){return s=this._mergeConfigObj(s,this._element),s=this._configAfterMerge(s),this._typeCheckConfig(s),s}static getInstance(s){return t.get(o.getElement(s),this.DATA_KEY)}static getOrCreateInstance(s,c={}){return this.getInstance(s)||new this(s,typeof c=="object"?c:null)}static get VERSION(){return r}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(s){return`${s}${this.EVENT_KEY}`}}return i})});var Su=ct((es,Rv)=>{(function(t,e){typeof es=="object"&&typeof Rv<"u"?e(es):typeof define=="function"&&define.amd?define(["exports"],e):(t=typeof globalThis<"u"?globalThis:t||self,e(t.Sanitizer={}))})(es,function(t){"use strict";let n={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},o=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),r=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,i=(s,c)=>{let l=s.nodeName.toLowerCase();return c.includes(l)?o.has(l)?!!r.test(s.nodeValue):!0:c.filter(u=>u instanceof RegExp).some(u=>u.test(l))};function a(s,c,l){if(!s.length)return s;if(l&&typeof l=="function")return l(s);let d=new window.DOMParser().parseFromString(s,"text/html"),f=[].concat(...d.body.querySelectorAll("*"));for(let p of f){let m=p.nodeName.toLowerCase();if(!Object.keys(c).includes(m)){p.remove();continue}let h=[].concat(...p.attributes),b=[].concat(c["*"]||[],c[m]||[]);for(let x of h)i(x,b)||p.removeAttribute(x.nodeName)}return d.body.innerHTML}t.DefaultAllowlist=n,t.sanitizeHtml=a,Object.defineProperty(t,Symbol.toStringTag,{value:"Module"})})});var Iv=ct((Eu,Ou)=>{(function(t,e){typeof Eu=="object"&&typeof Ou<"u"?Ou.exports=e(Br()):typeof define=="function"&&define.amd?define(["../util/index"],e):(t=typeof globalThis<"u"?globalThis:t||self,t.SelectorEngine=e(t.Index))})(Eu,function(t){"use strict";let e=o=>{let r=o.getAttribute("data-bs-target");if(!r||r==="#"){let i=o.getAttribute("href");if(!i||!i.includes("#")&&!i.startsWith("."))return null;i.includes("#")&&!i.startsWith("#")&&(i=`#${i.split("#")[1]}`),r=i&&i!=="#"?i.trim():null}return r?r.split(",").map(i=>t.parseSelector(i)).join(","):null},n={find(o,r=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(r,o))},findOne(o,r=document.documentElement){return Element.prototype.querySelector.call(r,o)},children(o,r){return[].concat(...o.children).filter(i=>i.matches(r))},parents(o,r){let i=[],a=o.parentNode.closest(r);for(;a;)i.push(a),a=a.parentNode.closest(r);return i},prev(o,r){let i=o.previousElementSibling;for(;i;){if(i.matches(r))return[i];i=i.previousElementSibling}return[]},next(o,r){let i=o.nextElementSibling;for(;i;){if(i.matches(r))return[i];i=i.nextElementSibling}return[]},focusableChildren(o){let r=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(i=>`${i}:not([tabindex^="-"])`).join(",");return this.find(r,o).filter(i=>!t.isDisabled(i)&&t.isVisible(i))},getSelectorFromElement(o){let r=e(o);return r&&n.findOne(r)?r:null},getElementFromSelector(o){let r=e(o);return r?n.findOne(r):null},getMultipleElementsFromSelector(o){let r=e(o);return r?n.find(r):[]}};return n})});var Dv=ct((Au,Nu)=>{(function(t,e){typeof Au=="object"&&typeof Nu<"u"?Nu.exports=e(Iv(),ku(),Su(),Br()):typeof define=="function"&&define.amd?define(["../dom/selector-engine","./config","./sanitizer","./index"],e):(t=typeof globalThis<"u"?globalThis:t||self,t.TemplateFactory=e(t.SelectorEngine,t.Config,t.Sanitizer,t.Index))})(Au,function(t,e,n,o){"use strict";let r="TemplateFactory",i={allowList:n.DefaultAllowlist,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},a={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},s={entry:"(string|element|function|null)",selector:"(string|element)"};class c extends e{constructor(u){super(),this._config=this._getConfig(u)}static get Default(){return i}static get DefaultType(){return a}static get NAME(){return r}getContent(){return Object.values(this._config.content).map(u=>this._resolvePossibleFunction(u)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(u){return this._checkContent(u),this._config.content={...this._config.content,...u},this}toHtml(){let u=document.createElement("div");u.innerHTML=this._maybeSanitize(this._config.template);for(let[p,m]of Object.entries(this._config.content))this._setContent(u,m,p);let d=u.children[0],f=this._resolvePossibleFunction(this._config.extraClass);return f&&d.classList.add(...f.split(" ")),d}_typeCheckConfig(u){super._typeCheckConfig(u),this._checkContent(u.content)}_checkContent(u){for(let[d,f]of Object.entries(u))super._typeCheckConfig({selector:d,entry:f},s)}_setContent(u,d,f){let p=t.findOne(f,u);if(p){if(d=this._resolvePossibleFunction(d),!d){p.remove();return}if(o.isElement(d)){this._putElementInTemplate(o.getElement(d),p);return}if(this._config.html){p.innerHTML=this._maybeSanitize(d);return}p.textContent=d}}_maybeSanitize(u){return this._config.sanitize?n.sanitizeHtml(u,this._config.allowList,this._config.sanitizeFn):u}_resolvePossibleFunction(u){return o.execute(u,[this])}_putElementInTemplate(u,d){if(this._config.html){d.innerHTML="",d.append(u);return}d.textContent=u.textContent}}return c})});var Fv=ct((Ru,Iu)=>{(function(t,e){typeof Ru=="object"&&typeof Iu<"u"?Iu.exports=e(Ev(),Nv(),bu(),yu(),Br(),Su(),Dv()):typeof define=="function"&&define.amd?define(["@popperjs/core","./base-component","./dom/event-handler","./dom/manipulator","./util/index","./util/sanitizer","./util/template-factory"],e):(t=typeof globalThis<"u"?globalThis:t||self,t.Tooltip=e(t["@popperjs/core"],t.BaseComponent,t.EventHandler,t.Manipulator,t.Index,t.Sanitizer,t.TemplateFactory))})(Ru,function(t,e,n,o,r,i,a){"use strict";function s(D){let _=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(D){for(let F in D)if(F!=="default"){let G=Object.getOwnPropertyDescriptor(D,F);Object.defineProperty(_,F,G.get?G:{enumerable:!0,get:()=>D[F]})}}return _.default=D,Object.freeze(_)}let c=s(t),l="tooltip",u=new Set(["sanitize","allowList","sanitizeFn"]),d="fade",f="modal",p="show",m=".tooltip-inner",h=`.${f}`,b="hide.bs.modal",x="hover",T="focus",B="click",A="manual",S="hide",H="hidden",j="show",M="shown",I="inserted",O="click",Q="focusin",v="focusout",k="mouseenter",R="mouseleave",N={AUTO:"auto",TOP:"top",RIGHT:r.isRTL()?"left":"right",BOTTOM:"bottom",LEFT:r.isRTL()?"right":"left"},W={allowList:i.DefaultAllowlist,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},C={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class w extends e{constructor(_,F){if(typeof c>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(_,F),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return W}static get DefaultType(){return C}static get NAME(){return l}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),n.off(this._element.closest(h),b,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;let _=n.trigger(this._element,this.constructor.eventName(j)),G=(r.findShadowRoot(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(_.defaultPrevented||!G)return;this._disposePopper();let $=this._getTipElement();this._element.setAttribute("aria-describedby",$.getAttribute("id"));let{container:X}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(X.append($),n.trigger(this._element,this.constructor.eventName(I))),this._popper=this._createPopper($),$.classList.add(p),"ontouchstart"in document.documentElement)for(let P of[].concat(...document.body.children))n.on(P,"mouseover",r.noop);let U=()=>{n.trigger(this._element,this.constructor.eventName(M)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(U,this.tip,this._isAnimated())}hide(){if(!this._isShown()||n.trigger(this._element,this.constructor.eventName(S)).defaultPrevented)return;if(this._getTipElement().classList.remove(p),"ontouchstart"in document.documentElement)for(let $ of[].concat(...document.body.children))n.off($,"mouseover",r.noop);this._activeTrigger[B]=!1,this._activeTrigger[T]=!1,this._activeTrigger[x]=!1,this._isHovered=null;let G=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),n.trigger(this._element,this.constructor.eventName(H)))};this._queueCallback(G,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(_){let F=this._getTemplateFactory(_).toHtml();if(!F)return null;F.classList.remove(d,p),F.classList.add(`bs-${this.constructor.NAME}-auto`);let G=r.getUID(this.constructor.NAME).toString();return F.setAttribute("id",G),this._isAnimated()&&F.classList.add(d),F}setContent(_){this._newContent=_,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(_){return this._templateFactory?this._templateFactory.changeContent(_):this._templateFactory=new a({...this._config,content:_,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[m]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(_){return this.constructor.getOrCreateInstance(_.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(d)}_isShown(){return this.tip&&this.tip.classList.contains(p)}_createPopper(_){let F=r.execute(this._config.placement,[this,_,this._element]),G=N[F.toUpperCase()];return c.createPopper(this._element,_,this._getPopperConfig(G))}_getOffset(){let{offset:_}=this._config;return typeof _=="string"?_.split(",").map(F=>Number.parseInt(F,10)):typeof _=="function"?F=>_(F,this._element):_}_resolvePossibleFunction(_){return r.execute(_,[this._element])}_getPopperConfig(_){let F={placement:_,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:G=>{this._getTipElement().setAttribute("data-popper-placement",G.state.placement)}}]};return{...F,...r.execute(this._config.popperConfig,[F])}}_setListeners(){let _=this._config.trigger.split(" ");for(let F of _)if(F==="click")n.on(this._element,this.constructor.eventName(O),this._config.selector,G=>{this._initializeOnDelegatedTarget(G).toggle()});else if(F!==A){let G=F===x?this.constructor.eventName(k):this.constructor.eventName(Q),$=F===x?this.constructor.eventName(R):this.constructor.eventName(v);n.on(this._element,G,this._config.selector,X=>{let U=this._initializeOnDelegatedTarget(X);U._activeTrigger[X.type==="focusin"?T:x]=!0,U._enter()}),n.on(this._element,$,this._config.selector,X=>{let U=this._initializeOnDelegatedTarget(X);U._activeTrigger[X.type==="focusout"?T:x]=U._element.contains(X.relatedTarget),U._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},n.on(this._element.closest(h),b,this._hideModalHandler)}_fixTitle(){let _=this._element.getAttribute("title");_&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",_),this._element.setAttribute("data-bs-original-title",_),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(_,F){clearTimeout(this._timeout),this._timeout=setTimeout(_,F)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(_){let F=o.getDataAttributes(this._element);for(let G of Object.keys(F))u.has(G)&&delete F[G];return _={...F,...typeof _=="object"&&_?_:{}},_=this._mergeConfigObj(_),_=this._configAfterMerge(_),this._typeCheckConfig(_),_}_configAfterMerge(_){return _.container=_.container===!1?document.body:r.getElement(_.container),typeof _.delay=="number"&&(_.delay={show:_.delay,hide:_.delay}),typeof _.title=="number"&&(_.title=_.title.toString()),typeof _.content=="number"&&(_.content=_.content.toString()),_}_getDelegateConfig(){let _={};for(let[F,G]of Object.entries(this._config))this.constructor.Default[F]!==G&&(_[F]=G);return _.selector=!1,_.trigger="manual",_}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(_){return this.each(function(){let F=w.getOrCreateInstance(this,_);if(typeof _=="string"){if(typeof F[_]>"u")throw new TypeError(`No method named "${_}"`);F[_]()}})}}return r.defineJQueryPlugin(w),w})});var F3={};rd(F3,{setupImageOcclusion:()=>qu});var vs={};function Re(t,e={}){var n;return(n=vs.getMessage(t,e))!=null?n:`missing key: ${t}`}var Ae={};Ae.ABOUT="about";Ae.ACTIONS="actions";Ae.ADDING="adding";Ae.ADDONS="addons";Ae.BROWSING="browsing";Ae.CARD_STATS="card_stats";Ae.CARD_TEMPLATE_RENDERING="card_template_rendering";Ae.CARD_TEMPLATES="card_templates";Ae.CHANGE_NOTETYPE="change_notetype";Ae.CUSTOM_STUDY="custom_study";Ae.DATABASE_CHECK="database_check";Ae.DECK_CONFIG="deck_config";Ae.DECKS="decks";Ae.EDITING="editing";Ae.EMPTY_CARDS="empty_cards";Ae.ERRORS="errors";Ae.EXPORTING="exporting";Ae.FIELDS="fields";Ae.FINDREPLACE="findreplace";Ae.HELP="help";Ae.IMPORTING="importing";Ae.KEYBOARD="keyboard";Ae.MEDIA="media";Ae.MEDIA_CHECK="media_check";Ae.NETWORK="network";Ae.NOTETYPES="notetypes";Ae.PREFERENCES="preferences";Ae.PROFILES="profiles";Ae.QT_ACCEL="qt_accel";Ae.QT_MISC="qt_misc";Ae.SCHEDULING="scheduling";Ae.SEARCH="search";Ae.STATISTICS="statistics";Ae.STUDYING="studying";Ae.SYNC="sync";Ae.UNDO="undo";function ad(t){return Re("browsing-cards-updated",t)}function sd(){return Re("editing-bold-text")}function ld(){return Re("editing-image-occlusion-align-bottom")}function cd(){return Re("editing-image-occlusion-align-h-center")}function ud(){return Re("editing-image-occlusion-align-left")}function dd(){return Re("editing-image-occlusion-align-right")}function fd(){return Re("editing-image-occlusion-align-top")}function pd(){return Re("editing-image-occlusion-align-v-center")}function md(){return Re("editing-image-occlusion-alignment")}function hd(){return Re("editing-image-occlusion-delete")}function gd(){return Re("editing-image-occlusion-duplicate")}function bd(){return Re("editing-image-occlusion-ellipse-tool")}function xd(){return Re("editing-image-occlusion-group")}function vd(){return Re("editing-image-occlusion-mode")}function yd(){return Re("editing-image-occlusion-polygon-tool")}function wd(){return Re("editing-image-occlusion-rectangle-tool")}function _d(){return Re("editing-image-occlusion-select-all")}function kd(){return Re("editing-image-occlusion-select-tool")}function Td(){return Re("editing-image-occlusion-text-tool")}function Cd(){return Re("editing-image-occlusion-toggle-translucent")}function Sd(){return Re("editing-image-occlusion-ungroup")}function Ed(){return Re("editing-image-occlusion-zoom-in")}function Od(){return Re("editing-image-occlusion-zoom-out")}function Ad(){return Re("editing-image-occlusion-zoom-reset")}function Nd(){return Re("editing-italic-text")}function ys(){return Re("editing-tags-add")}function Rd(){return Re("editing-tags-copy")}function Id(){return Re("editing-tags-remove")}function Dd(){return Re("editing-tags-select-all")}function Fd(){return Re("editing-underline-text")}function Md(t){return Re("importing-cards-added",t)}function Pd(){return Re("keyboard-ctrl")}function Ld(){return Re("keyboard-shift")}function Bd(){return Re("notetypes-back-extra-field")}function Ud(){return Re("notetypes-error-generating-cloze")}function jd(){return Re("notetypes-error-getting-imagecloze")}function zd(){return Re("notetypes-header")}function Hd(){return Re("notetypes-hide-all-guess-one")}function Vd(){return Re("notetypes-hide-one-guess-one")}function Wd(){return Re("notetypes-occlusion-mask")}function Gd(){return Re("notetypes-occlusion-note")}function qd(){return Re("undo-redo")}function Xd(){return Re("undo-undo")}var Kn=class{constructor(e){this.value=e}valueOf(){return this.value}},$e=class extends Kn{constructor(e="???"){super(e)}toString(e){return`{${this.value}}`}},xt=class extends Kn{constructor(e,n={}){super(e),this.opts=n}toString(e){try{return e.memoizeIntlObject(Intl.NumberFormat,this.opts).format(this.value)}catch(n){return e.reportError(n),this.value.toString(10)}}},dn=class extends Kn{constructor(e,n={}){super(e),this.opts=n}toString(e){try{return e.memoizeIntlObject(Intl.DateTimeFormat,this.opts).format(this.value)}catch(n){return e.reportError(n),new Date(this.value).toISOString()}}};var Yd=100,Ny="\u2068",Ry="\u2069";function Iy(t,e,n){if(n===e||n instanceof xt&&e instanceof xt&&n.value===e.value)return!0;if(e instanceof xt&&typeof n=="string"){let o=t.memoizeIntlObject(Intl.PluralRules,e.opts).select(e.value);if(n===o)return!0}return!1}function Qd(t,e,n){return e[n]?Wr(t,e[n].value):(t.reportError(new RangeError("No default")),new $e)}function ws(t,e){let n=[],o=Object.create(null);for(let r of e)r.type==="narg"?o[r.name]=Bo(t,r.value):n.push(Bo(t,r));return{positional:n,named:o}}function Bo(t,e){switch(e.type){case"str":return e.value;case"num":return new xt(e.value,{minimumFractionDigits:e.precision});case"var":return Dy(t,e);case"mesg":return Fy(t,e);case"term":return My(t,e);case"func":return Py(t,e);case"select":return Ly(t,e);default:return new $e}}function Dy(t,{name:e}){let n;if(t.params)if(Object.prototype.hasOwnProperty.call(t.params,e))n=t.params[e];else return new $e(`$${e}`);else if(t.args&&Object.prototype.hasOwnProperty.call(t.args,e))n=t.args[e];else return t.reportError(new ReferenceError(`Unknown variable: $${e}`)),new $e(`$${e}`);if(n instanceof Kn)return n;switch(typeof n){case"string":return n;case"number":return new xt(n);case"object":if(n instanceof Date)return new dn(n.getTime());default:return t.reportError(new TypeError(`Variable type not supported: $${e}, ${typeof n}`)),new $e(`$${e}`)}}function Fy(t,{name:e,attr:n}){let o=t.bundle._messages.get(e);if(!o)return t.reportError(new ReferenceError(`Unknown message: ${e}`)),new $e(e);if(n){let r=o.attributes[n];return r?Wr(t,r):(t.reportError(new ReferenceError(`Unknown attribute: ${n}`)),new $e(`${e}.${n}`))}return o.value?Wr(t,o.value):(t.reportError(new ReferenceError(`No value: ${e}`)),new $e(e))}function My(t,{name:e,attr:n,args:o}){let r=`-${e}`,i=t.bundle._terms.get(r);if(!i)return t.reportError(new ReferenceError(`Unknown term: ${r}`)),new $e(r);if(n){let s=i.attributes[n];if(s){t.params=ws(t,o).named;let c=Wr(t,s);return t.params=null,c}return t.reportError(new ReferenceError(`Unknown attribute: ${n}`)),new $e(`${r}.${n}`)}t.params=ws(t,o).named;let a=Wr(t,i.value);return t.params=null,a}function Py(t,{name:e,args:n}){let o=t.bundle._functions[e];if(!o)return t.reportError(new ReferenceError(`Unknown function: ${e}()`)),new $e(`${e}()`);if(typeof o!="function")return t.reportError(new TypeError(`Function ${e}() is not callable`)),new $e(`${e}()`);try{let r=ws(t,n);return o(r.positional,r.named)}catch(r){return t.reportError(r),new $e(`${e}()`)}}function Ly(t,{selector:e,variants:n,star:o}){let r=Bo(t,e);if(r instanceof $e)return Qd(t,n,o);for(let i of n){let a=Bo(t,i.key);if(Iy(t,r,a))return Wr(t,i.value)}return Qd(t,n,o)}function _s(t,e){if(t.dirty.has(e))return t.reportError(new RangeError("Cyclic reference")),new $e;t.dirty.add(e);let n=[],o=t.bundle._useIsolating&&e.length>1;for(let r of e){if(typeof r=="string"){n.push(t.bundle._transform(r));continue}if(t.placeables++,t.placeables>Yd)throw t.dirty.delete(e),new RangeError(`Too many placeables expanded: ${t.placeables}, max allowed is ${Yd}`);o&&n.push(Ny),n.push(Bo(t,r).toString(t)),o&&n.push(Ry)}return t.dirty.delete(e),n.join("")}function Wr(t,e){return typeof e=="string"?t.bundle._transform(e):_s(t,e)}var Ai=class{constructor(e,n,o){this.dirty=new WeakSet,this.params=null,this.placeables=0,this.bundle=e,this.errors=n,this.args=o}reportError(e){if(!this.errors||!(e instanceof Error))throw e;this.errors.push(e)}memoizeIntlObject(e,n){let o=this.bundle._intls.get(e);o||(o={},this.bundle._intls.set(e,o));let r=JSON.stringify(n);return o[r]||(o[r]=new e(this.bundle.locales,n)),o[r]}};function Ni(t,e){let n=Object.create(null);for(let[o,r]of Object.entries(t))e.includes(o)&&(n[o]=r.valueOf());return n}var $d=["unitDisplay","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"];function Jd(t,e){let n=t[0];if(n instanceof $e)return new $e(`NUMBER(${n.valueOf()})`);if(n instanceof xt)return new xt(n.valueOf(),{...n.opts,...Ni(e,$d)});if(n instanceof dn)return new xt(n.valueOf(),{...Ni(e,$d)});throw new TypeError("Invalid argument to NUMBER")}var Kd=["dateStyle","timeStyle","fractionalSecondDigits","dayPeriod","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName"];function Zd(t,e){let n=t[0];if(n instanceof $e)return new $e(`DATETIME(${n.valueOf()})`);if(n instanceof dn)return new dn(n.valueOf(),{...n.opts,...Ni(e,Kd)});if(n instanceof xt)return new dn(n.valueOf(),{...Ni(e,Kd)});throw new TypeError("Invalid argument to DATETIME")}var ef=new Map;function tf(t){let e=Array.isArray(t)?t.join(" "):t,n=ef.get(e);return n===void 0&&(n=new Map,ef.set(e,n)),n}var Uo=class{constructor(e,{functions:n,useIsolating:o=!0,transform:r=i=>i}={}){this._terms=new Map,this._messages=new Map,this.locales=Array.isArray(e)?e:[e],this._functions={NUMBER:Jd,DATETIME:Zd,...n},this._useIsolating=o,this._transform=r,this._intls=tf(e)}hasMessage(e){return this._messages.has(e)}getMessage(e){return this._messages.get(e)}addResource(e,{allowOverrides:n=!1}={}){let o=[];for(let r=0;r<e.body.length;r++){let i=e.body[r];if(i.id.startsWith("-")){if(n===!1&&this._terms.has(i.id)){o.push(new Error(`Attempt to override an existing term: "${i.id}"`));continue}this._terms.set(i.id,i)}else{if(n===!1&&this._messages.has(i.id)){o.push(new Error(`Attempt to override an existing message: "${i.id}"`));continue}this._messages.set(i.id,i)}}return o}formatPattern(e,n=null,o=null){if(typeof e=="string")return this._transform(e);let r=new Ai(this,o,n);try{return _s(r,e).toString(r)}catch(i){if(r.errors&&i instanceof Error)return r.errors.push(i),new $e().toString(r);throw i}}};var ks=/^(-?[a-zA-Z][\w-]*) *= */gm,nf=/\.([a-zA-Z][\w-]*) *= */y,By=/\*?\[/y,Ts=/(-?[0-9]+(?:\.([0-9]+))?)/y,Uy=/([a-zA-Z][\w-]*)/y,rf=/([$-])?([a-zA-Z][\w-]*)(?:\.([a-zA-Z][\w-]*))?/y,jy=/^[A-Z][A-Z0-9_-]*$/,Ri=/([^{}\n\r]+)/y,zy=/([^\\"\n\r]*)/y,of=/\\([\\"])/y,af=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{6})/y,Hy=/^\n+/,sf=/ +$/,Vy=/ *\r?\n/g,Wy=/( *)$/,Gy=/{\s*/y,lf=/\s*}/y,qy=/\[\s*/y,Xy=/\s*] */y,Yy=/\s*\(\s*/y,Qy=/\s*->\s*/y,$y=/\s*:\s*/y,Ky=/\s*,?\s*/y,Jy=/\s+/y,jo=class{constructor(e){this.body=[],ks.lastIndex=0;let n=0;for(;;){let I=ks.exec(e);if(I===null)break;n=ks.lastIndex;try{this.body.push(c(I[1]))}catch(O){if(O instanceof SyntaxError)continue;throw O}}function o(I){return I.lastIndex=n,I.test(e)}function r(I,O){if(e[n]===I)return n++,!0;if(O)throw new O(`Expected ${I}`);return!1}function i(I,O){if(o(I))return n=I.lastIndex,!0;if(O)throw new O(`Expected ${I.toString()}`);return!1}function a(I){I.lastIndex=n;let O=I.exec(e);if(O===null)throw new SyntaxError(`Expected ${I.toString()}`);return n=I.lastIndex,O}function s(I){return a(I)[1]}function c(I){let O=u(),Q=l();if(O===null&&Object.keys(Q).length===0)throw new SyntaxError("Expected message value or attributes");return{id:I,value:O,attributes:Q}}function l(){let I=Object.create(null);for(;o(nf);){let O=s(nf),Q=u();if(Q===null)throw new SyntaxError("Expected attribute value");I[O]=Q}return I}function u(){let I;if(o(Ri)&&(I=s(Ri)),e[n]==="{"||e[n]==="}")return d(I?[I]:[],1/0);let O=H();return O?I?d([I,O],O.length):(O.value=j(O.value,Hy),d([O],O.length)):I?j(I,sf):null}function d(I=[],O){for(;;){if(o(Ri)){I.push(s(Ri));continue}if(e[n]==="{"){I.push(f());continue}if(e[n]==="}")throw new SyntaxError("Unbalanced closing brace");let R=H();if(R){I.push(R),O=Math.min(O,R.length);continue}break}let Q=I.length-1,v=I[Q];typeof v=="string"&&(I[Q]=j(v,sf));let k=[];for(let R of I)R instanceof Ii&&(R=R.value.slice(0,R.value.length-O)),R&&k.push(R);return k}function f(){i(Gy,SyntaxError);let I=p();if(i(lf))return I;if(i(Qy)){let O=b();return i(lf,SyntaxError),{type:"select",selector:I,...O}}throw new SyntaxError("Unclosed placeable")}function p(){if(e[n]==="{")return f();if(o(rf)){let[,I,O,Q=null]=a(rf);if(I==="$")return{type:"var",name:O};if(i(Yy)){let v=m();if(I==="-")return{type:"term",name:O,attr:Q,args:v};if(jy.test(O))return{type:"func",name:O,args:v};throw new SyntaxError("Function names must be all upper-case")}return I==="-"?{type:"term",name:O,attr:Q,args:[]}:{type:"mesg",name:O,attr:Q}}return T()}function m(){let I=[];for(;;){switch(e[n]){case")":return n++,I;case void 0:throw new SyntaxError("Unclosed argument list")}I.push(h()),i(Ky)}}function h(){let I=p();return I.type!=="mesg"?I:i($y)?{type:"narg",name:I.name,value:T()}:I}function b(){let I=[],O=0,Q;for(;o(By);){r("*")&&(Q=O);let v=x(),k=u();if(k===null)throw new SyntaxError("Expected variant value");I[O++]={key:v,value:k}}if(O===0)return null;if(Q===void 0)throw new SyntaxError("Expected default variant");return{variants:I,star:Q}}function x(){i(qy,SyntaxError);let I;return o(Ts)?I=B():I={type:"str",value:s(Uy)},i(Xy,SyntaxError),I}function T(){if(o(Ts))return B();if(e[n]==='"')return A();throw new SyntaxError("Invalid expression")}function B(){let[,I,O=""]=a(Ts),Q=O.length;return{type:"num",value:parseFloat(I),precision:Q}}function A(){r('"',SyntaxError);let I="";for(;;){if(I+=s(zy),e[n]==="\\"){I+=S();continue}if(r('"'))return{type:"str",value:I};throw new SyntaxError("Unclosed string literal")}}function S(){if(o(of))return s(of);if(o(af)){let[,I,O]=a(af),Q=parseInt(I||O,16);return Q<=55295||57344<=Q?String.fromCodePoint(Q):"\uFFFD"}throw new SyntaxError("Unknown escape sequence")}function H(){let I=n;switch(i(Jy),e[n]){case".":case"[":case"*":case"}":case void 0:return!1;case"{":return M(e.slice(I,n))}return e[n-1]===" "?M(e.slice(I,n)):!1}function j(I,O){return I.replace(O,"")}function M(I){let O=I.replace(Vy,`
`),Q=Wy.exec(I)[1].length;return new Ii(O,Q)}}},Ii=class{constructor(e,n){this.value=e,this.length=n}};var Cs=[];function cf(t){Cs=t}function uf(){return Cs[0].locales[0]}function Zy(t){return new xt(t,{maximumFractionDigits:2})}function e0(t){let e=Object.entries(t).map(([o,r])=>[o,typeof r=="number"?Zy(r):r]),n={};for(let[o,r]of e)n[o]=r;return n}function df(t,e={}){for(let n of Cs){let o=n.getMessage(t);if(o&&o.value)return n.formatPattern(o.value,e0(e))}return null}var _D=pt(Cf());var kr=pt(Of());function nt(t,e){if(!t)throw new Error(e)}var E0=34028234663852886e22,O0=-34028234663852886e22,A0=4294967295,N0=2147483647,R0=-2147483648;function Gr(t){if(typeof t!="number")throw new Error("invalid int 32: "+typeof t);if(!Number.isInteger(t)||t>N0||t<R0)throw new Error("invalid int 32: "+t)}function Vo(t){if(typeof t!="number")throw new Error("invalid uint 32: "+typeof t);if(!Number.isInteger(t)||t>A0||t<0)throw new Error("invalid uint 32: "+t)}function Fi(t){if(typeof t!="number")throw new Error("invalid float 32: "+typeof t);if(Number.isFinite(t)&&(t>E0||t<O0))throw new Error("invalid float 32: "+t)}var Af=Symbol("@bufbuild/protobuf/enum-type");function Nf(t){let e=t[Af];return nt(e,"missing enum type on enum object"),e}function Fs(t,e,n,o){t[Af]=Ms(e,n.map(r=>({no:r.no,name:r.name,localName:t[r.no]})),o)}function Ms(t,e,n){let o=Object.create(null),r=Object.create(null),i=[];for(let a of e){let s=If(a);i.push(s),o[a.name]=s,r[a.no]=s}return{typeName:t,values:i,findName(a){return o[a]},findNumber(a){return r[a]}}}function Rf(t,e,n){let o={};for(let r of e){let i=If(r);o[i.localName]=i.no,o[i.no]=i.localName}return Fs(o,t,e,n),o}function If(t){return"localName"in t?t:Object.assign(Object.assign({},t),{localName:t.name})}var Vt=class{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,n){let o=this.getType(),r=o.runtime.bin,i=r.makeReadOptions(n);return r.readMessage(this,i.readerFactory(e),e.byteLength,i),this}fromJson(e,n){let o=this.getType(),r=o.runtime.json,i=r.makeReadOptions(n);return r.readMessage(o,e,i,this),this}fromJsonString(e,n){let o;try{o=JSON.parse(e)}catch(r){throw new Error(`cannot decode ${this.getType().typeName} from JSON: ${r instanceof Error?r.message:String(r)}`)}return this.fromJson(o,n)}toBinary(e){let n=this.getType(),o=n.runtime.bin,r=o.makeWriteOptions(e),i=r.writerFactory();return o.writeMessage(this,i,r),i.finish()}toJson(e){let n=this.getType(),o=n.runtime.json,r=o.makeWriteOptions(e);return o.writeMessage(this,r)}toJsonString(e){var n;let o=this.toJson(e);return JSON.stringify(o,null,(n=e==null?void 0:e.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}};function Df(t,e,n,o){var r;let i=(r=o==null?void 0:o.localName)!==null&&r!==void 0?r:e.substring(e.lastIndexOf(".")+1),a={[i]:function(s){t.util.initFields(this),t.util.initPartial(s,this)}}[i];return Object.setPrototypeOf(a.prototype,new Vt),Object.assign(a,{runtime:t,typeName:e,fields:t.util.newFieldList(n),fromBinary(s,c){return new a().fromBinary(s,c)},fromJson(s,c){return new a().fromJson(s,c)},fromJsonString(s,c){return new a().fromJsonString(s,c)},equals(s,c){return t.util.equals(a,s,c)}}),a}var se;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})(se||(se={}));var fn;(function(t){t[t.BIGINT=0]="BIGINT",t[t.STRING=1]="STRING"})(fn||(fn={}));function Mf(){let t=0,e=0;for(let o=0;o<28;o+=7){let r=this.buf[this.pos++];if(t|=(r&127)<<o,!(r&128))return this.assertBounds(),[t,e]}let n=this.buf[this.pos++];if(t|=(n&15)<<28,e=(n&112)>>4,!(n&128))return this.assertBounds(),[t,e];for(let o=3;o<=31;o+=7){let r=this.buf[this.pos++];if(e|=(r&127)<<o,!(r&128))return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function Pi(t,e,n){for(let i=0;i<28;i=i+7){let a=t>>>i,s=!(!(a>>>7)&&e==0),c=(s?a|128:a)&255;if(n.push(c),!s)return}let o=t>>>28&15|(e&7)<<4,r=!!(e>>3);if(n.push((r?o|128:o)&255),!!r){for(let i=3;i<31;i=i+7){let a=e>>>i,s=!!(a>>>7),c=(s?a|128:a)&255;if(n.push(c),!s)return}n.push(e>>>31&1)}}var Mi=4294967296;function Ps(t){let e=t[0]==="-";e&&(t=t.slice(1));let n=1e6,o=0,r=0;function i(a,s){let c=Number(t.slice(a,s));r*=n,o=o*n+c,o>=Mi&&(r=r+(o/Mi|0),o=o%Mi)}return i(-24,-18),i(-18,-12),i(-12,-6),i(-6),e?Lf(o,r):Bs(o,r)}function Pf(t,e){let n=Bs(t,e),o=n.hi&2147483648;o&&(n=Lf(n.lo,n.hi));let r=Ls(n.lo,n.hi);return o?"-"+r:r}function Ls(t,e){if({lo:t,hi:e}=I0(t,e),e<=2097151)return String(Mi*e+t);let n=t&16777215,o=(t>>>24|e<<8)&16777215,r=e>>16&65535,i=n+o*6777216+r*6710656,a=o+r*8147497,s=r*2,c=1e7;return i>=c&&(a+=Math.floor(i/c),i%=c),a>=c&&(s+=Math.floor(a/c),a%=c),s.toString()+Ff(a)+Ff(i)}function I0(t,e){return{lo:t>>>0,hi:e>>>0}}function Bs(t,e){return{lo:t|0,hi:e|0}}function Lf(t,e){return e=~e,t?t=~t+1:e+=1,Bs(t,e)}var Ff=t=>{let e=String(t);return"0000000".slice(e.length)+e};function Us(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let n=0;n<9;n++)e.push(t&127|128),t=t>>7;e.push(1)}}function Bf(){let t=this.buf[this.pos++],e=t&127;if(!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,!(t&128))return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let n=5;t&128&&n<10;n++)t=this.buf[this.pos++];if(t&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function D0(){let t=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"&&(typeof process!="object"||typeof process.env!="object"||process.env.BUF_BIGINT_DISABLE!=="1")){let r=BigInt("-9223372036854775808"),i=BigInt("9223372036854775807"),a=BigInt("0"),s=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(c){let l=typeof c=="bigint"?c:BigInt(c);if(l>i||l<r)throw new Error(`int64 invalid: ${c}`);return l},uParse(c){let l=typeof c=="bigint"?c:BigInt(c);if(l>s||l<a)throw new Error(`uint64 invalid: ${c}`);return l},enc(c){return t.setBigInt64(0,this.parse(c),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc(c){return t.setBigInt64(0,this.uParse(c),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec(c,l){return t.setInt32(0,c,!0),t.setInt32(4,l,!0),t.getBigInt64(0,!0)},uDec(c,l){return t.setInt32(0,c,!0),t.setInt32(4,l,!0),t.getBigUint64(0,!0)}}}let n=r=>nt(/^-?[0-9]+$/.test(r),`int64 invalid: ${r}`),o=r=>nt(/^[0-9]+$/.test(r),`uint64 invalid: ${r}`);return{zero:"0",supported:!1,parse(r){return typeof r!="string"&&(r=r.toString()),n(r),r},uParse(r){return typeof r!="string"&&(r=r.toString()),o(r),r},enc(r){return typeof r!="string"&&(r=r.toString()),n(r),Ps(r)},uEnc(r){return typeof r!="string"&&(r=r.toString()),o(r),Ps(r)},dec(r,i){return Pf(r,i)},uDec(r,i){return Ls(r,i)}}}var mt=D0();var We;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})(We||(We={}));var Li=class{constructor(e){this.stack=[],this.textEncoder=e!=null?e:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let r=0;r<this.chunks.length;r++)e+=this.chunks[r].length;let n=new Uint8Array(e),o=0;for(let r=0;r<this.chunks.length;r++)n.set(this.chunks[r],o),o+=this.chunks[r].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(Vo(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Gr(e),Us(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.textEncoder.encode(e);return this.uint32(n.byteLength),this.raw(n)}float(e){Fi(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){Vo(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){Gr(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return Gr(e),e=(e<<1^e>>31)>>>0,Us(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),o=new DataView(n.buffer),r=mt.enc(e);return o.setInt32(0,r.lo,!0),o.setInt32(4,r.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),o=new DataView(n.buffer),r=mt.uEnc(e);return o.setInt32(0,r.lo,!0),o.setInt32(4,r.hi,!0),this.raw(n)}int64(e){let n=mt.enc(e);return Pi(n.lo,n.hi,this.buf),this}sint64(e){let n=mt.enc(e),o=n.hi>>31,r=n.lo<<1^o,i=(n.hi<<1|n.lo>>>31)^o;return Pi(r,i,this.buf),this}uint64(e){let n=mt.uEnc(e);return Pi(n.lo,n.hi,this.buf),this}},Bi=class{constructor(e,n){this.varint64=Mf,this.uint32=Bf,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=n!=null?n:new TextDecoder}tag(){let e=this.uint32(),n=e>>>3,o=e&7;if(n<=0||o<0||o>5)throw new Error("illegal tag: field no "+n+" wire type "+o);return[n,o]}skip(e){let n=this.pos;switch(e){case We.Varint:for(;this.buf[this.pos++]&128;);break;case We.Bit64:this.pos+=4;case We.Bit32:this.pos+=4;break;case We.LengthDelimited:let o=this.uint32();this.pos+=o;break;case We.StartGroup:let r;for(;(r=this.tag()[1])!==We.EndGroup;)this.skip(r);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return mt.dec(...this.varint64())}uint64(){return mt.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),o=-(e&1);return e=(e>>>1|(n&1)<<31)^o,n=n>>>1^o,mt.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return mt.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return mt.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.textDecoder.decode(this.bytes())}};function Dn(t,e,n){if(e===n)return!0;if(t==se.BYTES){if(!(e instanceof Uint8Array)||!(n instanceof Uint8Array)||e.length!==n.length)return!1;for(let o=0;o<e.length;o++)if(e[o]!==n[o])return!1;return!0}switch(t){case se.UINT64:case se.FIXED64:case se.INT64:case se.SFIXED64:case se.SINT64:return e==n}return!1}function _r(t,e){switch(t){case se.BOOL:return!1;case se.UINT64:case se.FIXED64:case se.INT64:case se.SFIXED64:case se.SINT64:return e==0?mt.zero:"0";case se.DOUBLE:case se.FLOAT:return 0;case se.BYTES:return new Uint8Array(0);case se.STRING:return"";default:return 0}}function js(t,e){let n=e===void 0,o=We.Varint,r=e===0;switch(t){case se.STRING:r=n||!e.length,o=We.LengthDelimited;break;case se.BOOL:r=e===!1;break;case se.DOUBLE:o=We.Bit64;break;case se.FLOAT:o=We.Bit32;break;case se.INT64:r=n||e==0;break;case se.UINT64:r=n||e==0;break;case se.FIXED64:r=n||e==0,o=We.Bit64;break;case se.BYTES:r=n||!e.byteLength,o=We.LengthDelimited;break;case se.FIXED32:o=We.Bit32;break;case se.SFIXED32:o=We.Bit32;break;case se.SFIXED64:r=n||e==0,o=We.Bit64;break;case se.SINT64:r=n||e==0;break}let i=se[t].toLowerCase();return[o,i,n||r]}function Uf(t,e,n,o){let r;return{typeName:e,extendee:n,get field(){if(!r){let i=typeof o=="function"?o():o;i.name=e.split(".").pop(),i.jsonName=`[${e}]`,r=t.util.newFieldList([i]).list()[0]}return r},runtime:t}}function Ui(t){let e=t.field.localName,n=Object.create(null);return n[e]=F0(t),[n,()=>n[e]]}function F0(t){let e=t.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return _r(e.T,e.L);case"message":let n=e.T,o=new n;return n.fieldWrapper?n.fieldWrapper.unwrapField(o):o;case"map":throw"map fields are not allowed to be extensions"}}function jf(t,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let n=t.length-1;n>=0;--n)if(t[n].no==e.no)return[t[n]];return[]}return t.filter(n=>n.no===e.no)}function zf(t,e,n,o){return{syntax:t,json:e,bin:n,util:o,makeMessageType(r,i,a){return Df(this,r,i,a)},makeEnum:Rf,makeEnumType:Ms,getEnumType:Nf,makeExtension(r,i,a){return Uf(this,r,i,a)}}}function ji(t,e){return e instanceof Vt||!t.fieldWrapper?e:t.fieldWrapper.wrapField(e)}var M5={"google.protobuf.DoubleValue":se.DOUBLE,"google.protobuf.FloatValue":se.FLOAT,"google.protobuf.Int64Value":se.INT64,"google.protobuf.UInt64Value":se.UINT64,"google.protobuf.Int32Value":se.INT32,"google.protobuf.UInt32Value":se.UINT32,"google.protobuf.BoolValue":se.BOOL,"google.protobuf.StringValue":se.STRING,"google.protobuf.BytesValue":se.BYTES};var qr=Symbol("@bufbuild/protobuf/unknown-fields"),Hf={readUnknownFields:!0,readerFactory:t=>new Bi(t)},Vf={writeUnknownFields:!0,writerFactory:()=>new Li};function M0(t){return t?Object.assign(Object.assign({},Hf),t):Hf}function P0(t){return t?Object.assign(Object.assign({},Vf),t):Vf}function Gf(){return{makeReadOptions:M0,makeWriteOptions:P0,listUnknownFields(t){var e;return(e=t[qr])!==null&&e!==void 0?e:[]},discardUnknownFields(t){delete t[qr]},writeUnknownFields(t,e){let o=t[qr];if(o)for(let r of o)e.tag(r.no,r.wireType).raw(r.data)},onUnknownField(t,e,n,o){let r=t;Array.isArray(r[qr])||(r[qr]=[]),r[qr].push({no:e,wireType:n,data:o})},readMessage(t,e,n,o,r){let i=t.getType(),a=r?e.len:e.pos+n,s,c;for(;e.pos<a&&([s,c]=e.tag(),c!=We.EndGroup);){let l=i.fields.find(s);if(!l){let u=e.skip(c);o.readUnknownFields&&this.onUnknownField(t,s,c,u);continue}Wf(t,e,l,c,o)}if(r&&(c!=We.EndGroup||s!==n))throw new Error("invalid end group tag")},readField:Wf}}function Wf(t,e,n,o,r){let{repeated:i,localName:a}=n;switch(n.oneof&&(t=t[n.oneof.localName],t.case!=a&&delete t.value,t.case=a,a="value"),n.kind){case"scalar":case"enum":let s=n.kind=="enum"?se.INT32:n.T,c=Hi;if(n.kind=="scalar"&&n.L>0&&(c=B0),i){let f=t[a];if(o==We.LengthDelimited&&s!=se.STRING&&s!=se.BYTES){let m=e.uint32()+e.pos;for(;e.pos<m;)f.push(c(e,s))}else f.push(c(e,s))}else t[a]=c(e,s);break;case"message":let l=n.T;i?t[a].push(zi(e,new l,r,n)):t[a]instanceof Vt?zi(e,t[a],r,n):(t[a]=zi(e,new l,r,n),l.fieldWrapper&&!n.oneof&&!n.repeated&&(t[a]=l.fieldWrapper.unwrapField(t[a])));break;case"map":let[u,d]=L0(n,e,r);t[a][u]=d;break}}function zi(t,e,n,o){let r=e.getType().runtime.bin,i=o==null?void 0:o.delimited;return r.readMessage(e,t,i?o==null?void 0:o.no:t.uint32(),n,i),e}function L0(t,e,n){let o=e.uint32(),r=e.pos+o,i,a;for(;e.pos<r;){let[s]=e.tag();switch(s){case 1:i=Hi(e,t.K);break;case 2:switch(t.V.kind){case"scalar":a=Hi(e,t.V.T);break;case"enum":a=e.int32();break;case"message":a=zi(e,new t.V.T,n,void 0);break}break}}if(i===void 0){let s=_r(t.K,fn.BIGINT);i=t.K==se.BOOL?s.toString():s}if(typeof i!="string"&&typeof i!="number"&&(i=i.toString()),a===void 0)switch(t.V.kind){case"scalar":a=_r(t.V.T,fn.BIGINT);break;case"enum":a=0;break;case"message":a=new t.V.T;break}return[i,a]}function B0(t,e){let n=Hi(t,e);return typeof n=="bigint"?n.toString():n}function Hi(t,e){switch(e){case se.STRING:return t.string();case se.BOOL:return t.bool();case se.DOUBLE:return t.double();case se.FLOAT:return t.float();case se.INT32:return t.int32();case se.INT64:return t.int64();case se.UINT64:return t.uint64();case se.FIXED64:return t.fixed64();case se.BYTES:return t.bytes();case se.FIXED32:return t.fixed32();case se.SFIXED32:return t.sfixed32();case se.SFIXED64:return t.sfixed64();case se.SINT64:return t.sint64();case se.UINT32:return t.uint32();case se.SINT32:return t.sint32()}}function qf(t,e,n,o,r){t.tag(n.no,We.LengthDelimited),t.fork();let i=o;switch(n.K){case se.INT32:case se.FIXED32:case se.UINT32:case se.SFIXED32:case se.SINT32:i=Number.parseInt(o);break;case se.BOOL:nt(o=="true"||o=="false"),i=o=="true";break}switch(Xr(t,n.K,1,i,!0),n.V.kind){case"scalar":Xr(t,n.V.T,2,r,!0);break;case"enum":Xr(t,se.INT32,2,r,!0);break;case"message":t.tag(2,We.LengthDelimited).bytes(r.toBinary(e));break}t.join()}function zs(t,e,n,o){let r=ji(n.T,o);n!=null&&n.delimited?t.tag(n.no,We.StartGroup).raw(r.toBinary(e)).tag(n.no,We.EndGroup):t.tag(n.no,We.LengthDelimited).bytes(r.toBinary(e))}function Xr(t,e,n,o,r){let[i,a,s]=js(e,o);(!s||r)&&t.tag(n,i)[a](o)}function Xf(t,e,n,o){if(!o.length)return;t.tag(n,We.LengthDelimited).fork();let[,r]=js(e);for(let i=0;i<o.length;i++)t[r](o[i]);t.join()}function Qf(){return Object.assign(Object.assign({},Gf()),{writeField:Yf,writeMessage(t,e,n){let o=t.getType();for(let r of o.fields.byNumber()){let i,a=r.localName;if(r.oneof){let s=t[r.oneof.localName];if(s.case!==a)continue;i=s.value}else i=t[a];Yf(r,i,e,n)}return n.writeUnknownFields&&this.writeUnknownFields(t,e),e}})}function Yf(t,e,n,o){let r=t.repeated;switch(t.kind){case"scalar":case"enum":let i=t.kind=="enum"?se.INT32:t.T;if(r)if(t.packed)Xf(n,i,t.no,e);else for(let a of e)Xr(n,i,t.no,a,!0);else e!==void 0&&Xr(n,i,t.no,e,!!t.oneof||t.opt);break;case"message":if(r)for(let a of e)zs(n,o,t,a);else e!==void 0&&zs(n,o,t,e);break;case"map":for(let[a,s]of Object.entries(e))qf(n,o,t,a,s);break}}var Fn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Vi=[];for(let t=0;t<Fn.length;t++)Vi[Fn[t].charCodeAt(0)]=t;Vi["-".charCodeAt(0)]=Fn.indexOf("+");Vi["_".charCodeAt(0)]=Fn.indexOf("/");var Hs={dec(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let n=new Uint8Array(e),o=0,r=0,i,a=0;for(let s=0;s<t.length;s++){if(i=Vi[t.charCodeAt(s)],i===void 0)switch(t[s]){case"=":r=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(r){case 0:a=i,r=1;break;case 1:n[o++]=a<<2|(i&48)>>4,a=i,r=2;break;case 2:n[o++]=(a&15)<<4|(i&60)>>2,a=i,r=3;break;case 3:n[o++]=(a&3)<<6|i,r=0;break}}if(r==1)throw Error("invalid base64 string.");return n.subarray(0,o)},enc(t){let e="",n=0,o,r=0;for(let i=0;i<t.length;i++)switch(o=t[i],n){case 0:e+=Fn[o>>2],r=(o&3)<<4,n=1;break;case 1:e+=Fn[r|o>>4],r=(o&15)<<2,n=2;break;case 2:e+=Fn[r|o>>6],e+=Fn[o&63],n=0;break}return n&&(e+=Fn[r],e+="=",n==1&&(e+="=")),e}};function $f(t,e,n){Jf(e,t);let o=e.runtime.bin.makeReadOptions(n),r=jf(t.getType().runtime.bin.listUnknownFields(t),e.field),[i,a]=Ui(e);for(let s of r)e.runtime.bin.readField(i,o.readerFactory(s.data),e.field,s.wireType,o);return a()}function Kf(t,e,n,o){Jf(e,t);let r=e.runtime.bin.makeReadOptions(o),i=e.runtime.bin.makeWriteOptions(o);if(Vs(t,e)){let l=t.getType().runtime.bin.listUnknownFields(t).filter(u=>u.no!=e.field.no);t.getType().runtime.bin.discardUnknownFields(t);for(let u of l)t.getType().runtime.bin.onUnknownField(t,u.no,u.wireType,u.data)}let a=i.writerFactory(),s=e.field;!s.opt&&!s.repeated&&(s.kind=="enum"||s.kind=="scalar")&&(s=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(s,n,a,i);let c=r.readerFactory(a.finish());for(;c.pos<c.len;){let[l,u]=c.tag(),d=c.skip(u);t.getType().runtime.bin.onUnknownField(t,l,u,d)}}function Vs(t,e){let n=t.getType();return e.extendee.typeName===n.typeName&&!!n.runtime.bin.listUnknownFields(t).find(o=>o.no==e.field.no)}function Jf(t,e){nt(t.extendee.typeName==e.getType().typeName,`extension ${t.typeName} can only be applied to message ${t.extendee.typeName}`)}var Zf={ignoreUnknownFields:!1},ep={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function U0(t){return t?Object.assign(Object.assign({},Zf),t):Zf}function j0(t){return t?Object.assign(Object.assign({},ep),t):ep}function rp(t,e){let n=e(z0,np);return{makeReadOptions:U0,makeWriteOptions:j0,readMessage(o,r,i,a){if(r==null||Array.isArray(r)||typeof r!="object")throw new Error(`cannot decode message ${o.typeName} from JSON: ${pn(r)}`);a=a!=null?a:new o;let s=new Map,c=i.typeRegistry;for(let[l,u]of Object.entries(r)){let d=o.fields.findJsonName(l);if(d){if(d.oneof){if(u===null&&d.kind=="scalar")continue;let f=s.get(d.oneof);if(f!==void 0)throw new Error(`cannot decode message ${o.typeName} from JSON: multiple keys for oneof "${d.oneof.name}" present: "${f}", "${l}"`);s.set(d.oneof,l)}tp(a,u,d,i,o,t)}else{let f=!1;if(c!=null&&c.findExtension&&l.startsWith("[")&&l.endsWith("]")){let p=c.findExtension(l.substring(1,l.length-1));if(p&&p.extendee.typeName==o.typeName){f=!0;let[m,h]=Ui(p);tp(m,u,p.field,i,p,!0),Kf(a,p,h(),i)}}if(!f&&!i.ignoreUnknownFields)throw new Error(`cannot decode message ${o.typeName} from JSON: key "${l}" is unknown`)}}return a},writeMessage(o,r){let i=o.getType(),a={},s;try{for(let l of i.fields.byMember()){let u;if(l.kind=="oneof"){let d=o[l.localName];if(d.value===void 0)continue;if(s=l.findField(d.case),!s)throw"oneof case not found: "+d.case;u=n(s,d.value,r)}else s=l,u=n(s,o[s.localName],r);u!==void 0&&(a[r.useProtoFieldName?s.name:s.jsonName]=u)}let c=r.typeRegistry;if(c!=null&&c.findExtensionFor)for(let l of i.runtime.bin.listUnknownFields(o)){let u=c.findExtensionFor(i.typeName,l.no);if(u&&Vs(o,u)){let d=$f(o,u,r),f=n(u.field,d,r);f!==void 0&&(a[u.field.jsonName]=f)}}}catch(c){let l=s?`cannot encode field ${i.typeName}.${s.name} to JSON`:`cannot encode message ${i.typeName} to JSON`,u=c instanceof Error?c.message:String(c);throw new Error(l+(u.length>0?`: ${u}`:""))}return a},readScalar:(o,r,i)=>Wo(o,r,i,t),writeScalar:np,debug:pn}}function pn(t){if(t===null)return"null";switch(typeof t){case"object":return Array.isArray(t)?"array":"object";case"string":return t.length>100?"string":`"${t.split('"').join('\\"')}"`;default:return String(t)}}function tp(t,e,n,o,r,i){let a=n.localName;if(n.oneof){if(e===null&&n.kind=="scalar")return;t=t[n.oneof.localName]={case:a},a="value"}if(n.repeated){if(e===null)return;if(!Array.isArray(e))throw new Error(`cannot decode field ${r.typeName}.${n.name} from JSON: ${pn(e)}`);let s=t[a];for(let c of e){if(c===null)throw new Error(`cannot decode field ${r.typeName}.${n.name} from JSON: ${pn(c)}`);let l;switch(n.kind){case"message":l=n.T.fromJson(c,o);break;case"enum":if(l=Ws(n.T,c,o.ignoreUnknownFields,!0),l===void 0)continue;break;case"scalar":try{l=Wo(n.T,c,n.L,!0)}catch(u){let d=`cannot decode field ${r.typeName}.${n.name} from JSON: ${pn(c)}`;throw u instanceof Error&&u.message.length>0&&(d+=`: ${u.message}`),new Error(d)}break}s.push(l)}}else if(n.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error(`cannot decode field ${r.typeName}.${n.name} from JSON: ${pn(e)}`);let s=t[a];for(let[c,l]of Object.entries(e)){if(l===null)throw new Error(`cannot decode field ${r.typeName}.${n.name} from JSON: map value null`);let u;switch(n.V.kind){case"message":u=n.V.T.fromJson(l,o);break;case"enum":if(u=Ws(n.V.T,l,o.ignoreUnknownFields,!0),u===void 0)continue;break;case"scalar":try{u=Wo(n.V.T,l,fn.BIGINT,!0)}catch(d){let f=`cannot decode map value for field ${r.typeName}.${n.name} from JSON: ${pn(e)}`;throw d instanceof Error&&d.message.length>0&&(f+=`: ${d.message}`),new Error(f)}break}try{s[Wo(n.K,n.K==se.BOOL?c=="true"?!0:c=="false"?!1:c:c,fn.BIGINT,!0).toString()]=u}catch(d){let f=`cannot decode map key for field ${r.typeName}.${n.name} from JSON: ${pn(e)}`;throw d instanceof Error&&d.message.length>0&&(f+=`: ${d.message}`),new Error(f)}}}else switch(n.kind){case"message":let s=n.T;if(e===null&&s.typeName!="google.protobuf.Value"){if(n.oneof)throw new Error(`cannot decode field ${r.typeName}.${n.name} from JSON: null is invalid for oneof field`);return}t[a]instanceof Vt?t[a].fromJson(e,o):(t[a]=s.fromJson(e,o),s.fieldWrapper&&!n.oneof&&(t[a]=s.fieldWrapper.unwrapField(t[a])));break;case"enum":let c=Ws(n.T,e,o.ignoreUnknownFields,i);c!==void 0&&(t[a]=c);break;case"scalar":try{t[a]=Wo(n.T,e,n.L,i)}catch(l){let u=`cannot decode field ${r.typeName}.${n.name} from JSON: ${pn(e)}`;throw l instanceof Error&&l.message.length>0&&(u+=`: ${l.message}`),new Error(u)}break}}function Wo(t,e,n,o){switch(t){case se.DOUBLE:case se.FLOAT:if(e===null)return o?0:void 0;if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;let r=Number(e);if(Number.isNaN(r)||!Number.isFinite(r))break;return t==se.FLOAT&&Fi(r),r;case se.INT32:case se.FIXED32:case se.SFIXED32:case se.SINT32:case se.UINT32:if(e===null)return o?0:void 0;let i;if(typeof e=="number"?i=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(i=Number(e)),i===void 0)break;return t==se.UINT32?Vo(i):Gr(i),i;case se.INT64:case se.SFIXED64:case se.SINT64:if(e===null)return o?mt.zero:void 0;if(typeof e!="number"&&typeof e!="string")break;let a=mt.parse(e);return n?a.toString():a;case se.FIXED64:case se.UINT64:if(e===null)return o?mt.zero:void 0;if(typeof e!="number"&&typeof e!="string")break;let s=mt.uParse(e);return n?s.toString():s;case se.BOOL:if(e===null)return o?!1:void 0;if(typeof e!="boolean")break;return e;case se.STRING:if(e===null)return o?"":void 0;if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case se.BYTES:if(e===null)return o?new Uint8Array(0):void 0;if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return Hs.dec(e)}throw new Error}function Ws(t,e,n,o){if(e===null)return o?t.values[0].no:void 0;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":let r=t.findName(e);if(r||n)return r==null?void 0:r.no;break}throw new Error(`cannot decode enum ${t.typeName} from JSON: ${pn(e)}`)}function z0(t,e,n,o){var r;if(e===void 0)return e;if(!n&&t.values[0].no===e)return;if(o)return e;if(t.typeName=="google.protobuf.NullValue")return null;let i=t.findNumber(e);return(r=i==null?void 0:i.name)!==null&&r!==void 0?r:e}function np(t,e,n){if(e!==void 0)switch(t){case se.INT32:case se.SFIXED32:case se.SINT32:case se.FIXED32:case se.UINT32:return nt(typeof e=="number"),e!=0||n?e:void 0;case se.FLOAT:case se.DOUBLE:return nt(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e!==0||n?e:void 0;case se.STRING:return nt(typeof e=="string"),e.length>0||n?e:void 0;case se.BOOL:return nt(typeof e=="boolean"),e||n?e:void 0;case se.UINT64:case se.FIXED64:case se.INT64:case se.SFIXED64:case se.SINT64:return nt(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),n||e!=0?e.toString(10):void 0;case se.BYTES:return nt(e instanceof Uint8Array),n||e.byteLength>0?Hs.enc(e):void 0}}function op(){return rp(!0,(t,e)=>function(o,r,i){if(o.kind=="map"){let a={};switch(o.V.kind){case"scalar":for(let[c,l]of Object.entries(r)){let u=e(o.V.T,l,!0);nt(u!==void 0),a[c.toString()]=u}break;case"message":for(let[c,l]of Object.entries(r))a[c.toString()]=l.toJson(i);break;case"enum":let s=o.V.T;for(let[c,l]of Object.entries(r)){nt(l===void 0||typeof l=="number");let u=t(s,l,!0,i.enumAsInteger);nt(u!==void 0),a[c.toString()]=u}break}return i.emitDefaultValues||Object.keys(a).length>0?a:void 0}else if(o.repeated){let a=[];switch(o.kind){case"scalar":for(let s=0;s<r.length;s++)a.push(e(o.T,r[s],!0));break;case"enum":for(let s=0;s<r.length;s++)a.push(t(o.T,r[s],!0,i.enumAsInteger));break;case"message":for(let s=0;s<r.length;s++)a.push(r[s].toJson(i));break}return i.emitDefaultValues||a.length>0?a:void 0}else{if(r===void 0)return;switch(o.kind){case"scalar":return e(o.T,r,!!o.oneof||o.opt||i.emitDefaultValues);case"enum":return t(o.T,r,!!o.oneof||o.opt||i.emitDefaultValues,i.enumAsInteger);case"message":return ji(o.T,r).toJson(i)}}})}function ip(){return{setEnumType:Fs,initPartial(t,e){if(t===void 0)return;let n=e.getType();for(let o of n.fields.byMember()){let r=o.localName,i=e,a=t;if(a[r]!==void 0)switch(o.kind){case"oneof":let s=a[r].case;if(s===void 0)continue;let c=o.findField(s),l=a[r].value;c&&c.kind=="message"&&!(l instanceof c.T)?l=new c.T(l):c&&c.kind==="scalar"&&c.T===se.BYTES&&(l=Go(l)),i[r]={case:s,value:l};break;case"scalar":case"enum":let u=a[r];o.T===se.BYTES&&(u=o.repeated?u.map(Go):Go(u)),i[r]=u;break;case"map":switch(o.V.kind){case"scalar":case"enum":if(o.V.T===se.BYTES)for(let[p,m]of Object.entries(a[r]))i[r][p]=Go(m);else Object.assign(i[r],a[r]);break;case"message":let f=o.V.T;for(let p of Object.keys(a[r])){let m=a[r][p];f.fieldWrapper||(m=new f(m)),i[r][p]=m}break}break;case"message":let d=o.T;if(o.repeated)i[r]=a[r].map(f=>f instanceof d?f:new d(f));else if(a[r]!==void 0){let f=a[r];d.fieldWrapper?d.typeName==="google.protobuf.BytesValue"?i[r]=Go(f):i[r]=f:i[r]=f instanceof d?f:new d(f)}break}}},equals(t,e,n){return e===n?!0:!e||!n?!1:t.fields.byMember().every(o=>{let r=e[o.localName],i=n[o.localName];if(o.repeated){if(r.length!==i.length)return!1;switch(o.kind){case"message":return r.every((a,s)=>o.T.equals(a,i[s]));case"scalar":return r.every((a,s)=>Dn(o.T,a,i[s]));case"enum":return r.every((a,s)=>Dn(se.INT32,a,i[s]))}throw new Error(`repeated cannot contain ${o.kind}`)}switch(o.kind){case"message":return o.T.equals(r,i);case"enum":return Dn(se.INT32,r,i);case"scalar":return Dn(o.T,r,i);case"oneof":if(r.case!==i.case)return!1;let a=o.findField(r.case);if(a===void 0)return!0;switch(a.kind){case"message":return a.T.equals(r.value,i.value);case"enum":return Dn(se.INT32,r.value,i.value);case"scalar":return Dn(a.T,r.value,i.value)}throw new Error(`oneof cannot contain ${a.kind}`);case"map":let s=Object.keys(r).concat(Object.keys(i));switch(o.V.kind){case"message":let c=o.V.T;return s.every(u=>c.equals(r[u],i[u]));case"enum":return s.every(u=>Dn(se.INT32,r[u],i[u]));case"scalar":let l=o.V.T;return s.every(u=>Dn(l,r[u],i[u]))}break}})},clone(t){let e=t.getType(),n=new e,o=n;for(let r of e.fields.byMember()){let i=t[r.localName],a;if(r.repeated)a=i.map(Wi);else if(r.kind=="map"){a=o[r.localName];for(let[s,c]of Object.entries(i))a[s]=Wi(c)}else r.kind=="oneof"?a=r.findField(i.case)?{case:i.case,value:Wi(i.value)}:{case:void 0}:a=Wi(i);o[r.localName]=a}return n}}}function Wi(t){if(t===void 0)return t;if(t instanceof Vt)return t.clone();if(t instanceof Uint8Array){let e=new Uint8Array(t.byteLength);return e.set(t),e}return t}function Go(t){return t instanceof Uint8Array?t:new Uint8Array(t)}var Gi=class{constructor(e,n){this._fields=e,this._normalizer=n}findJsonName(e){if(!this.jsonNames){let n={};for(let o of this.list())n[o.jsonName]=n[o.name]=o;this.jsonNames=n}return this.jsonNames[e]}find(e){if(!this.numbers){let n={};for(let o of this.list())n[o.no]=o;this.numbers=n}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,n)=>e.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];let e=this.members,n;for(let o of this.list())o.oneof?o.oneof!==n&&(n=o.oneof,e.push(n)):e.push(o)}return this.members}};function Gs(t,e){let n=lp(t);return e?n:G0(W0(n))}function ap(t){return Gs(t,!1)}var sp=lp;function lp(t){let e=!1,n=[];for(let o=0;o<t.length;o++){let r=t.charAt(o);switch(r){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(r),e=!1;break;default:e&&(e=!1,r=r.toUpperCase()),n.push(r);break}}return n.join("")}var H0=new Set(["constructor","toString","toJSON","valueOf"]),V0=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),cp=t=>`${t}$`,W0=t=>V0.has(t)?cp(t):t,G0=t=>H0.has(t)?cp(t):t;var qi=class{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=ap(e)}addField(e){nt(e.oneof===this,`field ${e.name} not one of ${this.name}`),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[e]}};var ot=zf("proto3",op(),Qf(),Object.assign(Object.assign({},ip()),{newFieldList(t){return new Gi(t,q0)},initFields(t){for(let e of t.getType().fields.byMember()){if(e.opt)continue;let n=e.localName,o=t;if(e.repeated){o[n]=[];continue}switch(e.kind){case"oneof":o[n]={case:void 0};break;case"enum":o[n]=0;break;case"map":o[n]={};break;case"scalar":o[n]=_r(e.T,e.L);break;case"message":break}}}}));function q0(t){var e,n,o,r;let i=[],a;for(let s of typeof t=="function"?t():t){let c=s;if(c.localName=Gs(s.name,s.oneof!==void 0),c.jsonName=(e=s.jsonName)!==null&&e!==void 0?e:sp(s.name),c.repeated=(n=s.repeated)!==null&&n!==void 0?n:!1,s.kind=="scalar"&&(c.L=(o=s.L)!==null&&o!==void 0?o:fn.BIGINT),s.oneof!==void 0){let l=typeof s.oneof=="string"?s.oneof:s.oneof.name;(!a||a.name!=l)&&(a=new qi(l)),c.oneof=a,a.addField(c)}s.kind=="message"&&(c.delimited=!1),c.packed=(r=s.packed)!==null&&r!==void 0?r:s.kind=="enum"||s.kind=="scalar"&&s.T!=se.BYTES&&s.T!=se.STRING,i.push(c)}return i}var up=ot.makeMessageType("",()=>[{no:1,name:"json",kind:"scalar",T:12}]);var qo=ot.makeMessageType("",()=>[{no:1,name:"card",kind:"scalar",T:8},{no:2,name:"note",kind:"scalar",T:8},{no:3,name:"deck",kind:"scalar",T:8},{no:4,name:"tag",kind:"scalar",T:8},{no:5,name:"notetype",kind:"scalar",T:8},{no:6,name:"config",kind:"scalar",T:8},{no:11,name:"deck_config",kind:"scalar",T:8},{no:12,name:"mtime",kind:"scalar",T:8},{no:7,name:"browser_table",kind:"scalar",T:8},{no:8,name:"browser_sidebar",kind:"scalar",T:8},{no:9,name:"note_text",kind:"scalar",T:8},{no:10,name:"study_queues",kind:"scalar",T:8}]);var dp=ot.makeMessageType("",()=>[{no:1,name:"modules",kind:"scalar",T:9,repeated:!0}]);var fp=ot.makeMessageType("",()=>[{no:1,name:"path",kind:"scalar",T:9}]),pp=ot.makeMessageType("",()=>[{no:1,name:"data",kind:"scalar",T:12},{no:2,name:"name",kind:"scalar",T:9}]),mp=ot.makeMessageType("",()=>[{no:1,name:"image_path",kind:"scalar",T:9},{no:2,name:"occlusions",kind:"scalar",T:9},{no:3,name:"header",kind:"scalar",T:9},{no:4,name:"back_extra",kind:"scalar",T:9},{no:5,name:"tags",kind:"scalar",T:9,repeated:!0},{no:6,name:"notetype_id",kind:"scalar",T:3}]),hp=ot.makeMessageType("",()=>[{no:1,name:"note_id",kind:"scalar",T:3}]),gp=ot.makeMessageType("",()=>[{no:1,name:"note",kind:"message",T:hw,oneof:"value"},{no:2,name:"error",kind:"scalar",T:9,oneof:"value"}]),fw=ot.makeMessageType("",()=>[{no:1,name:"name",kind:"scalar",T:9},{no:2,name:"value",kind:"scalar",T:9}],{localName:"GetImageOcclusionNoteResponse_ImageOcclusionProperty"}),pw=ot.makeMessageType("",()=>[{no:1,name:"shape",kind:"scalar",T:9},{no:2,name:"properties",kind:"message",T:fw,repeated:!0}],{localName:"GetImageOcclusionNoteResponse_ImageOcclusionShape"}),mw=ot.makeMessageType("",()=>[{no:1,name:"shapes",kind:"message",T:pw,repeated:!0},{no:2,name:"ordinal",kind:"scalar",T:13}],{localName:"GetImageOcclusionNoteResponse_ImageOcclusion"}),hw=ot.makeMessageType("",()=>[{no:1,name:"image_data",kind:"scalar",T:12},{no:2,name:"occlusions",kind:"message",T:mw,repeated:!0},{no:3,name:"header",kind:"scalar",T:9},{no:4,name:"back_extra",kind:"scalar",T:9},{no:5,name:"tags",kind:"scalar",T:9,repeated:!0},{no:6,name:"image_file_name",kind:"scalar",T:9}],{localName:"GetImageOcclusionNoteResponse_ImageOcclusionNote"}),bp=ot.makeMessageType("",()=>[{no:1,name:"note_id",kind:"scalar",T:3},{no:2,name:"occlusions",kind:"scalar",T:9},{no:3,name:"header",kind:"scalar",T:9},{no:4,name:"back_extra",kind:"scalar",T:9},{no:5,name:"tags",kind:"scalar",T:9,repeated:!0}]);var xp=ot.makeMessageType("",()=>[{no:1,name:"input",kind:"scalar",T:9},{no:2,name:"match_limit",kind:"scalar",T:13}]),vp=ot.makeMessageType("",()=>[{no:1,name:"tags",kind:"scalar",T:9,repeated:!0}]);async function yp(t,e={}){return await(0,kr.postProto)("i18nResources",new dp(t),up,e)}async function Xs(t,e={}){return await(0,kr.postProto)("getImageForOcclusion",new fp(t),pp,e)}async function wp(t,e={}){return await(0,kr.postProto)("getImageOcclusionNote",new hp(t),gp,e)}async function _p(t,e={}){return await(0,kr.postProto)("addImageOcclusionNote",new mp(t),qo,e)}async function kp(t,e={}){return await(0,kr.postProto)("updateImageOcclusionNote",new bp(t),qo,e)}async function Tp(t,e={}){return await(0,kr.postProto)("completeTag",new xp(t),vp,e)}function Ew(){let t=uf();return t.startsWith("ar")||t.startsWith("he")||t.startsWith("fa")?"rtl":"ltr"}var Ow=[];async function Cp(t){let e=await yp(t),n=JSON.parse(new TextDecoder().decode(e.json)),o=[];for(let r in n.resources){let i=n.resources[r],a=n.langs[r],s=new Uo([a,"en-US"]),c=new jo(i);s.addResource(c),o.push(s)}cf(o),Ow=n.langs,document.dir=Ew()}vs.getMessage=df;function _e(){}function Aw(t,e){for(let n in e)t[n]=e[n];return t}function Ys(t){return t()}function Xi(){return Object.create(null)}function ze(t){t.forEach(Ys)}function Jt(t){return typeof t=="function"}function xe(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Sp(t){return Object.keys(t).length===0}function mn(t,...e){if(t==null){for(let o of e)o(void 0);return _e}let n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function rt(t){let e;return mn(t,n=>e=n)(),e}function at(t,e,n){t.$$.on_destroy.push(mn(e,n))}function Le(t,e,n,o){if(t){let r=Ep(t,e,n,o);return t[0](r)}}function Ep(t,e,n,o){return t[1]&&o?Aw(n.ctx.slice(),t[1](o(e))):n.ctx}function Be(t,e,n,o){if(t[2]&&o){let r=t[2](o(n));if(e.dirty===void 0)return r;if(typeof r=="object"){let i=[],a=Math.max(e.dirty.length,r.length);for(let s=0;s<a;s+=1)i[s]=e.dirty[s]|r[s];return i}return e.dirty|r}return e.dirty}function Ue(t,e,n,o,r,i){if(r){let a=Ep(e,n,o,i);t.p(a,r)}}function je(t){if(t.ctx.length>32){let e=[],n=t.ctx.length/32;for(let o=0;o<n;o++)e[o]=-1;return e}return-1}function Op(t){let e={};for(let n in t)e[n]=!0;return e}function er(t,e,n){return t.set(n),e}function Et(t){return t&&Jt(t.destroy)?t.destroy:_e}var Qs=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;var Yi=class t{constructor(e){tt(this,"_listeners","WeakMap"in Qs?new WeakMap:void 0);tt(this,"_observer");tt(this,"options");this.options=e}observe(e,n){return this._listeners.set(e,n),this._getObserver().observe(e,this.options),()=>{this._listeners.delete(e),this._observer.unobserve(e)}}_getObserver(){var e;return(e=this._observer)!=null?e:this._observer=new ResizeObserver(n=>{var o;for(let r of n)t.entries.set(r.target,r),(o=this._listeners.get(r.target))==null||o(r)})}};Yi.entries="WeakMap"in Qs?new WeakMap:void 0;var Ap=!1;function Np(){Ap=!0}function Rp(){Ap=!1}function Oe(t,e){t.appendChild(e)}function Z(t,e,n){t.insertBefore(e,n||null)}function J(t){t.parentNode&&t.parentNode.removeChild(t)}function bt(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function fe(t){return document.createElement(t)}function Iw(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Ge(t){return document.createTextNode(t)}function ke(){return Ge(" ")}function He(){return Ge("")}function Ce(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function Wt(t){return function(e){return e.preventDefault(),t.call(this,e)}}function oe(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Ip(t){return Array.from(t.childNodes)}function Zt(t,e){e=""+e,t.data!==e&&(t.data=e)}function Yr(t,e){t.value=e==null?"":e}function qe(t,e,n,o){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,o?"important":"")}var Qi;function Dw(){if(Qi===void 0){Qi=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{Qi=!0}}return Qi}function Qr(t,e){getComputedStyle(t).position==="static"&&(t.style.position="relative");let o=fe("iframe");o.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),o.setAttribute("aria-hidden","true"),o.tabIndex=-1;let r=Dw(),i;return r?(o.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",i=Ce(window,"message",a=>{a.source===o.contentWindow&&e()})):(o.src="about:blank",o.onload=()=>{i=Ce(o.contentWindow,"resize",e),e()}),Oe(t,o),()=>{(r||i&&o.contentWindow)&&i(),J(o)}}function me(t,e,n){t.classList.toggle(e,!!n)}function $i(t,e,{bubbles:n=!1,cancelable:o=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:o})}var Je=class{constructor(e=!1){tt(this,"is_svg",!1);tt(this,"e");tt(this,"n");tt(this,"t");tt(this,"a");this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,n,o=null){this.e||(this.is_svg?this.e=Iw(n.nodeName):this.e=fe(n.nodeType===11?"TEMPLATE":n.nodeName),this.t=n.tagName!=="TEMPLATE"?n:n.content,this.c(e)),this.i(o)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let n=0;n<this.n.length;n+=1)Z(this.t,this.n[n],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(J)}};function Dp(t){let e={};return t.childNodes.forEach(n=>{e[n.slot||"default"]=!0}),e}var tr;function Mn(t){tr=t}function $r(){if(!tr)throw new Error("Function called outside component initialization");return tr}function Tt(t){$r().$$.on_mount.push(t)}function Tr(t){$r().$$.on_destroy.push(t)}function Qe(){let t=$r();return(e,n,{cancelable:o=!1}={})=>{let r=t.$$.callbacks[e];if(r){let i=$i(e,n,{cancelable:o});return r.slice().forEach(a=>{a.call(t,i)}),!i.defaultPrevented}return!0}}function Xo(t,e){return $r().$$.context.set(t,e),e}function Pn(t){return $r().$$.context.get(t)}function Ie(t,e){let n=t.$$.callbacks[e.type];n&&n.slice().forEach(o=>o.call(this,e))}var Cr=[];var Xe=[],Jr=[],Ks=[],Fp=Promise.resolve(),Js=!1;function Zs(){Js||(Js=!0,Fp.then(Ki))}function vt(){return Zs(),Fp}function Mt(t){Jr.push(t)}function en(t){Ks.push(t)}var $s=new Set,Kr=0;function Ki(){if(Kr!==0)return;let t=tr;do{try{for(;Kr<Cr.length;){let e=Cr[Kr];Kr++,Mn(e),Uw(e.$$)}}catch(e){throw Cr.length=0,Kr=0,e}for(Mn(null),Cr.length=0,Kr=0;Xe.length;)Xe.pop()();for(let e=0;e<Jr.length;e+=1){let n=Jr[e];$s.has(n)||($s.add(n),n())}Jr.length=0}while(Cr.length);for(;Ks.length;)Ks.pop()();Js=!1,$s.clear(),Mn(t)}function Uw(t){if(t.fragment!==null){t.update(),ze(t.before_update);let e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Mt)}}function Mp(t){let e=[],n=[];Jr.forEach(o=>t.indexOf(o)===-1?e.push(o):n.push(o)),n.forEach(o=>o()),Jr=e}var Ji=new Set,Sr;function De(){Sr={r:0,c:[],p:Sr}}function Fe(){Sr.r||ze(Sr.c),Sr=Sr.p}function q(t,e){t&&t.i&&(Ji.delete(t),t.i(e))}function Y(t,e,n,o){if(t&&t.o){if(Ji.has(t))return;Ji.add(t),Sr.c.push(()=>{Ji.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}else o&&o()}function Ve(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Pp(t,e){Y(t,1,1,()=>{e.delete(t.key)})}function Lp(t,e,n,o,r,i,a,s,c,l,u,d){let f=t.length,p=i.length,m=f,h={};for(;m--;)h[t[m].key]=m;let b=[],x=new Map,T=new Map,B=[];for(m=p;m--;){let j=d(r,i,m),M=n(j),I=a.get(M);I?o&&B.push(()=>I.p(j,e)):(I=l(M,j),I.c()),x.set(M,b[m]=I),M in h&&T.set(M,Math.abs(m-h[M]))}let A=new Set,S=new Set;function H(j){q(j,1),j.m(s,u),a.set(j.key,j),u=j.first,p--}for(;f&&p;){let j=b[p-1],M=t[f-1],I=j.key,O=M.key;j===M?(u=j.first,f--,p--):x.has(O)?!a.has(I)||A.has(I)?H(j):S.has(O)?f--:T.get(I)>T.get(O)?(S.add(I),H(j)):(A.add(O),f--):(c(M,a),f--)}for(;f--;){let j=t[f];x.has(j.key)||c(j,a)}for(;p;)H(b[p-1]);return ze(B),b}var jw=["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","inert","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"],zw=new Set([...jw]);function tn(t,e,n){let o=t.$$.props[e];o!==void 0&&(t.$$.bound[o]=n,n(t.$$.ctx[o]))}function pe(t){t&&t.c()}function ue(t,e,n){let{fragment:o,after_update:r}=t.$$;o&&o.m(e,n),Mt(()=>{let i=t.$$.on_mount.map(Ys).filter(Jt);t.$$.on_destroy?t.$$.on_destroy.push(...i):ze(i),t.$$.on_mount=[]}),r.forEach(Mt)}function de(t,e){let n=t.$$;n.fragment!==null&&(Mp(n.after_update),ze(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Vw(t,e){t.$$.dirty[0]===-1&&(Cr.push(t),Zs(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ye(t,e,n,o,r,i,a=null,s=[-1]){let c=tr;Mn(t);let l=t.$$={fragment:null,ctx:[],props:i,update:_e,not_equal:r,bound:Xi(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:Xi(),dirty:s,skip_bound:!1,root:e.target||c.$$.root};a&&a(l.root);let u=!1;if(l.ctx=n?n(t,e.props||{},(d,f,...p)=>{let m=p.length?p[0]:f;return l.ctx&&r(l.ctx[d],l.ctx[d]=m)&&(!l.skip_bound&&l.bound[d]&&l.bound[d](m),u&&Vw(t,d)),f}):[],l.update(),u=!0,ze(l.before_update),l.fragment=o?o(l.ctx):!1,e.target){if(e.hydrate){Np();let d=Ip(e.target);l.fragment&&l.fragment.l(d),d.forEach(J)}else l.fragment&&l.fragment.c();e.intro&&q(t.$$.fragment),ue(t,e.target,e.anchor),Rp(),Ki()}Mn(c)}var Ww;typeof HTMLElement=="function"&&(Ww=class extends HTMLElement{constructor(e,n,o){super();tt(this,"$$ctor");tt(this,"$$s");tt(this,"$$c");tt(this,"$$cn",!1);tt(this,"$$d",{});tt(this,"$$r",!1);tt(this,"$$p_d",{});tt(this,"$$l",{});tt(this,"$$l_u",new Map);this.$$ctor=e,this.$$s=n,o&&this.attachShadow({mode:"open"})}addEventListener(e,n,o){if(this.$$l[e]=this.$$l[e]||[],this.$$l[e].push(n),this.$$c){let r=this.$$c.$on(e,n);this.$$l_u.set(n,r)}super.addEventListener(e,n,o)}removeEventListener(e,n,o){if(super.removeEventListener(e,n,o),this.$$c){let r=this.$$l_u.get(n);r&&(r(),this.$$l_u.delete(n))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){let e=function(i){return()=>{let a;return{c:function(){a=fe("slot"),i!=="default"&&oe(a,"name",i)},m:function(l,u){Z(l,a,u)},d:function(l){l&&J(a)}}}};if(await Promise.resolve(),!this.$$cn||this.$$c)return;let n={},o=Dp(this);for(let i of this.$$s)i in o&&(n[i]=[e(i)]);for(let i of this.attributes){let a=this.$$g_p(i.name);a in this.$$d||(this.$$d[a]=el(a,i.value,this.$$p_d,"toProp"))}for(let i in this.$$p_d)!(i in this.$$d)&&this[i]!==void 0&&(this.$$d[i]=this[i],delete this[i]);this.$$c=new this.$$ctor({target:this.shadowRoot||this,props:{...this.$$d,$$slots:n,$$scope:{ctx:[]}}});let r=()=>{this.$$r=!0;for(let i in this.$$p_d)if(this.$$d[i]=this.$$c.$$.ctx[this.$$c.$$.props[i]],this.$$p_d[i].reflect){let a=el(i,this.$$d[i],this.$$p_d,"toAttribute");a==null?this.removeAttribute(this.$$p_d[i].attribute||i):this.setAttribute(this.$$p_d[i].attribute||i,a)}this.$$r=!1};this.$$c.$$.after_update.push(r),r();for(let i in this.$$l)for(let a of this.$$l[i]){let s=this.$$c.$on(i,a);this.$$l_u.set(a,s)}this.$$l={}}}attributeChangedCallback(e,n,o){var r;this.$$r||(e=this.$$g_p(e),this.$$d[e]=el(e,o,this.$$p_d,"toProp"),(r=this.$$c)==null||r.$set({[e]:this.$$d[e]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then(()=>{this.$$cn||(this.$$c.$destroy(),this.$$c=void 0)})}$$g_p(e){return Object.keys(this.$$p_d).find(n=>this.$$p_d[n].attribute===e||!this.$$p_d[n].attribute&&n.toLowerCase()===e)||e}});function el(t,e,n,o){var i;let r=(i=n[t])==null?void 0:i.type;if(e=r==="Boolean"&&typeof e!="boolean"?e!=null:e,!o||!n[t])return e;if(o==="toAttribute")switch(r){case"Object":case"Array":return e==null?null:JSON.stringify(e);case"Boolean":return e?"":null;case"Number":return e==null?null:e;default:return e}else switch(r){case"Object":case"Array":return e&&JSON.parse(e);case"Boolean":return e;case"Number":return e!=null?+e:e;default:return e}}var he=class{constructor(){tt(this,"$$");tt(this,"$$set")}$destroy(){de(this,1),this.$destroy=_e}$on(e,n){if(!Jt(n))return _e;let o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{let r=o.indexOf(n);r!==-1&&o.splice(r,1)}}$set(e){this.$$set&&!Sp(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}};var Bp="4";var Zr=[];function eo(t,e){return{subscribe:ut(t,e).subscribe}}function ut(t,e=_e){let n,o=new Set;function r(s){if(xe(t,s)&&(t=s,n)){let c=!Zr.length;for(let l of o)l[1](),Zr.push(l,t);if(c){for(let l=0;l<Zr.length;l+=2)Zr[l][0](Zr[l+1]);Zr.length=0}}}function i(s){r(s(t))}function a(s,c=_e){let l=[s,c];return o.add(l),o.size===1&&(n=e(r,i)||_e),s(t),()=>{o.delete(l),o.size===0&&n&&(n(),n=null)}}return{set:r,update:i,subscribe:a}}function to(t,e,n){let o=!Array.isArray(t),r=o?[t]:t;if(!r.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");let i=e.length<2;return eo(n,(a,s)=>{let c=!1,l=[],u=0,d=_e,f=()=>{if(u)return;d();let m=e(o?l[0]:l,a,s);i?a(m):d=Jt(m)?m:_e},p=r.map((m,h)=>mn(m,b=>{l[h]=b,u&=~(1<<h),c&&f()},()=>{u|=1<<h}));return c=!0,f(),function(){ze(p),d(),c=!1}})}function Up(){let t=window.location.hash=="#night";return t&&(document.documentElement.className="night-mode",document.documentElement.dataset.bsTheme="dark"),t}var pl=pt(Ct());var Gp=pt(Ct());var no=ut({id:"",title:"",divValue:"",textareaValue:""}[0]),Er=ut([""]),Wp=ut(!0),Yo=ut(!0),SM=ut(!1),Pt=ut(!1),Or=ut(!1);var nn="#ffeba2",nr="#212121",ea="#ffffff",ta="Arial",na=5,Zi,hn=t=>{t.off("mouse:down"),t.off("mouse:up"),t.off("mouse:move")},ra=(t,e)=>{t.selection=e,t.forEachObject(function(n){n.fill!=="transparent"&&(n.selectable=e)}),t.renderAll()},qp=t=>{let e=t.getActiveObject();e&&(t.remove(e),e.type=="activeSelection"&&(e.getObjects().forEach(n=>t.remove(n)),t.discardActiveObject().renderAll())),it(t)},Xp=t=>{t.getActiveObject()&&(qw(t),Xw(t))},Yp=t=>{if(!t.getActiveObject()||t.getActiveObject().type!=="activeSelection")return;let e=t.getActiveObject(),n=e.getObjects(),o=Math.min(...n.map(r=>r.ordinal));o=Number.isNaN(o)?void 0:o,n.forEach(r=>{r.set({opacity:1,ordinal:o})}),e.toGroup().set({opacity:rt(Pt)?.4:1}),it(t)},Qp=t=>{if(!t.getActiveObject()||t.getActiveObject().type!=="group")return;let e=t.getActiveObject(),n=e.getObjects();e._restoreObjectsState(),e.destroyed=!0,n.forEach(o=>{o.set({opacity:rt(Pt)?.4:1,ordinal:void 0}),t.add(o)}),t.remove(e),it(t)},qw=t=>{t.getActiveObject()&&t.getActiveObject().clone(function(e){Zi=e})},Xw=t=>{Zi.clone(function(e){t.discardActiveObject(),e.set({left:e.left+10,top:e.top+10,evented:!0}),e.type==="activeSelection"?(e.canvas=t,e.forEachObject(function(n){t.add(n)}),e.setCoords()):t.add(e),Zi.top+=10,Zi.left+=10,t.setActiveObject(e),it(t)})},ol=(t,e=!1)=>{Pt.set(e),t.getObjects().forEach(o=>{o.set({opacity:e?.4:1,transparentCorners:!1})}),t.renderAll()},$p=(t,e)=>{t.on("object:modified",function(n){let o=n.target;o&&(o.type==="rect"&&Yw(e,o),o.type==="ellipse"&&Qw(e,o),o.type==="i-text"&&$w(e,o))})},Yw=(t,e)=>{let n=e.width*e.scaleX,o=e.height*e.scaleY;e.set({width:n,height:o,scaleX:1,scaleY:1}),il(t,e)},Qw=(t,e)=>{let n=e.rx*e.scaleX,o=e.ry*e.scaleY,r=e.width*e.scaleX,i=e.height*e.scaleY;e.set({rx:n,ry:o,width:r,height:i,scaleX:1,scaleY:1}),il(t,e)},$w=(t,e)=>{il(t,e)},il=(t,e)=>{e.left<0&&e.set({left:0}),e.top<0&&e.set({top:0}),e.left+e.width*e.scaleX+e.strokeWidth>t.width&&e.set({left:t.width-e.width*e.scaleX}),e.top+e.height*e.scaleY+e.strokeWidth>t.height&&e.set({top:t.height-e.height*e.scaleY}),e.setCoords()};function oa(t,e){e.setControlsVisibility({mb:!1,ml:!1,mt:!1,mr:!1});let n;e.on("scaling",o=>{["bl","br","tr","tl"].includes(o.transform.corner)&&(clearTimeout(n),t.uniformScaling=!0,n=setTimeout(()=>{t.uniformScaling=!1},500))})}function al(t){t.stroke=nr}var it=t=>{t.requestRenderAll()},Kp=t=>{t.clear()},Jp=(t,e)=>{t.on("object:moving",function(n){let o=n.target;if(o.getScaledHeight()>e.height||o.getScaledWidth()>e.width)return;o.setCoords();let r=o.top,i=o.left,a=e.top,s=a+e.height,c=e.left,l=c+e.width;o.left=Math.min(Math.max(i,c),l-o.width),o.top=Math.min(Math.max(r,a),s-o.height)})},Zp=t=>{t.discardActiveObject();let e=new Gp.fabric.ActiveSelection(t.getObjects().filter(n=>n.fill!=="transparent"),{canvas:t});t.setActiveObject(e),it(t)},rr=t=>{let e=ro();return e.selectable=!1,e.evented=!1,!(t.x<e.left||t.x>e.left+e.width||t.y<e.top||t.y>e.top+e.height)},ro=()=>globalThis.canvas.getObjects().find(e=>e.fill==="transparent");var Kw=typeof global=="object"&&global&&global.Object===Object&&global,ia=Kw;var Jw=typeof self=="object"&&self&&self.Object===Object&&self,Zw=ia||Jw||Function("return this")(),st=Zw;var e1=st.Symbol,Ln=e1;var em=Object.prototype,t1=em.hasOwnProperty,n1=em.toString,Qo=Ln?Ln.toStringTag:void 0;function r1(t){var e=t1.call(t,Qo),n=t[Qo];try{t[Qo]=void 0;var o=!0}catch{}var r=n1.call(t);return o&&(e?t[Qo]=n:delete t[Qo]),r}var tm=r1;var o1=Object.prototype,i1=o1.toString;function a1(t){return i1.call(t)}var nm=a1;var s1="[object Null]",l1="[object Undefined]",rm=Ln?Ln.toStringTag:void 0;function c1(t){return t==null?t===void 0?l1:s1:rm&&rm in Object(t)?tm(t):nm(t)}var Bn=c1;function u1(t){return t!=null&&typeof t=="object"}var gn=u1;var d1=Array.isArray,oo=d1;function f1(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var bn=f1;var p1="[object AsyncFunction]",m1="[object Function]",h1="[object GeneratorFunction]",g1="[object Proxy]";function b1(t){if(!bn(t))return!1;var e=Bn(t);return e==m1||e==h1||e==p1||e==g1}var aa=b1;var x1=st["__core-js_shared__"],sa=x1;var om=function(){var t=/[^.]+$/.exec(sa&&sa.keys&&sa.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function v1(t){return!!om&&om in t}var im=v1;var y1=Function.prototype,w1=y1.toString;function _1(t){if(t!=null){try{return w1.call(t)}catch{}try{return t+""}catch{}}return""}var Un=_1;var k1=/[\\^$.*+?()[\]{}|]/g,T1=/^\[object .+?Constructor\]$/,C1=Function.prototype,S1=Object.prototype,E1=C1.toString,O1=S1.hasOwnProperty,A1=RegExp("^"+E1.call(O1).replace(k1,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function N1(t){if(!bn(t)||im(t))return!1;var e=aa(t)?A1:T1;return e.test(Un(t))}var am=N1;function R1(t,e){return t==null?void 0:t[e]}var sm=R1;function I1(t,e){var n=sm(t,e);return am(n)?n:void 0}var Ot=I1;var D1=Ot(st,"WeakMap"),la=D1;var lm=Object.create,F1=function(){function t(){}return function(e){if(!bn(e))return{};if(lm)return lm(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),cm=F1;function M1(t,e){var n=-1,o=t.length;for(e||(e=Array(o));++n<o;)e[n]=t[n];return e}var um=M1;var P1=function(){try{var t=Ot(Object,"defineProperty");return t({},"",{}),t}catch{}}(),sl=P1;function L1(t,e){for(var n=-1,o=t==null?0:t.length;++n<o&&e(t[n],n,t)!==!1;);return t}var dm=L1;var B1=9007199254740991,U1=/^(?:0|[1-9]\d*)$/;function j1(t,e){var n=typeof t;return e=e==null?B1:e,!!e&&(n=="number"||n!="symbol"&&U1.test(t))&&t>-1&&t%1==0&&t<e}var fm=j1;function z1(t,e,n){e=="__proto__"&&sl?sl(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var ca=z1;function H1(t,e){return t===e||t!==t&&e!==e}var ua=H1;var V1=Object.prototype,W1=V1.hasOwnProperty;function G1(t,e,n){var o=t[e];(!(W1.call(t,e)&&ua(o,n))||n===void 0&&!(e in t))&&ca(t,e,n)}var da=G1;function q1(t,e,n,o){var r=!n;n||(n={});for(var i=-1,a=e.length;++i<a;){var s=e[i],c=o?o(n[s],t[s],s,n,t):void 0;c===void 0&&(c=t[s]),r?ca(n,s,c):da(n,s,c)}return n}var or=q1;var X1=9007199254740991;function Y1(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=X1}var fa=Y1;function Q1(t){return t!=null&&fa(t.length)&&!aa(t)}var pa=Q1;var $1=Object.prototype;function K1(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||$1;return t===n}var io=K1;function J1(t,e){for(var n=-1,o=Array(t);++n<t;)o[n]=e(n);return o}var pm=J1;var Z1="[object Arguments]";function e_(t){return gn(t)&&Bn(t)==Z1}var ll=e_;var mm=Object.prototype,t_=mm.hasOwnProperty,n_=mm.propertyIsEnumerable,r_=ll(function(){return arguments}())?ll:function(t){return gn(t)&&t_.call(t,"callee")&&!n_.call(t,"callee")},hm=r_;function o_(){return!1}var gm=o_;var vm=typeof exports=="object"&&exports&&!exports.nodeType&&exports,bm=vm&&typeof module=="object"&&module&&!module.nodeType&&module,i_=bm&&bm.exports===vm,xm=i_?st.Buffer:void 0,a_=xm?xm.isBuffer:void 0,s_=a_||gm,ma=s_;var l_="[object Arguments]",c_="[object Array]",u_="[object Boolean]",d_="[object Date]",f_="[object Error]",p_="[object Function]",m_="[object Map]",h_="[object Number]",g_="[object Object]",b_="[object RegExp]",x_="[object Set]",v_="[object String]",y_="[object WeakMap]",w_="[object ArrayBuffer]",__="[object DataView]",k_="[object Float32Array]",T_="[object Float64Array]",C_="[object Int8Array]",S_="[object Int16Array]",E_="[object Int32Array]",O_="[object Uint8Array]",A_="[object Uint8ClampedArray]",N_="[object Uint16Array]",R_="[object Uint32Array]",Ze={};Ze[k_]=Ze[T_]=Ze[C_]=Ze[S_]=Ze[E_]=Ze[O_]=Ze[A_]=Ze[N_]=Ze[R_]=!0;Ze[l_]=Ze[c_]=Ze[w_]=Ze[u_]=Ze[__]=Ze[d_]=Ze[f_]=Ze[p_]=Ze[m_]=Ze[h_]=Ze[g_]=Ze[b_]=Ze[x_]=Ze[v_]=Ze[y_]=!1;function I_(t){return gn(t)&&fa(t.length)&&!!Ze[Bn(t)]}var ym=I_;function D_(t){return function(e){return t(e)}}var ao=D_;var wm=typeof exports=="object"&&exports&&!exports.nodeType&&exports,$o=wm&&typeof module=="object"&&module&&!module.nodeType&&module,F_=$o&&$o.exports===wm,cl=F_&&ia.process,M_=function(){try{var t=$o&&$o.require&&$o.require("util").types;return t||cl&&cl.binding&&cl.binding("util")}catch{}}(),jn=M_;var _m=jn&&jn.isTypedArray,P_=_m?ao(_m):ym,km=P_;var L_=Object.prototype,B_=L_.hasOwnProperty;function U_(t,e){var n=oo(t),o=!n&&hm(t),r=!n&&!o&&ma(t),i=!n&&!o&&!r&&km(t),a=n||o||r||i,s=a?pm(t.length,String):[],c=s.length;for(var l in t)(e||B_.call(t,l))&&!(a&&(l=="length"||r&&(l=="offset"||l=="parent")||i&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||fm(l,c)))&&s.push(l);return s}var ha=U_;function j_(t,e){return function(n){return t(e(n))}}var ga=j_;var z_=ga(Object.keys,Object),Tm=z_;var H_=Object.prototype,V_=H_.hasOwnProperty;function W_(t){if(!io(t))return Tm(t);var e=[];for(var n in Object(t))V_.call(t,n)&&n!="constructor"&&e.push(n);return e}var Cm=W_;function G_(t){return pa(t)?ha(t):Cm(t)}var so=G_;function q_(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var Sm=q_;var X_=Object.prototype,Y_=X_.hasOwnProperty;function Q_(t){if(!bn(t))return Sm(t);var e=io(t),n=[];for(var o in t)o=="constructor"&&(e||!Y_.call(t,o))||n.push(o);return n}var Em=Q_;function $_(t){return pa(t)?ha(t,!0):Em(t)}var lo=$_;var K_=Ot(Object,"create"),zn=K_;function J_(){this.__data__=zn?zn(null):{},this.size=0}var Om=J_;function Z_(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Am=Z_;var ek="__lodash_hash_undefined__",tk=Object.prototype,nk=tk.hasOwnProperty;function rk(t){var e=this.__data__;if(zn){var n=e[t];return n===ek?void 0:n}return nk.call(e,t)?e[t]:void 0}var Nm=rk;var ok=Object.prototype,ik=ok.hasOwnProperty;function ak(t){var e=this.__data__;return zn?e[t]!==void 0:ik.call(e,t)}var Rm=ak;var sk="__lodash_hash_undefined__";function lk(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=zn&&e===void 0?sk:e,this}var Im=lk;function co(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}co.prototype.clear=Om;co.prototype.delete=Am;co.prototype.get=Nm;co.prototype.has=Rm;co.prototype.set=Im;var ul=co;function ck(){this.__data__=[],this.size=0}var Dm=ck;function uk(t,e){for(var n=t.length;n--;)if(ua(t[n][0],e))return n;return-1}var ir=uk;var dk=Array.prototype,fk=dk.splice;function pk(t){var e=this.__data__,n=ir(e,t);if(n<0)return!1;var o=e.length-1;return n==o?e.pop():fk.call(e,n,1),--this.size,!0}var Fm=pk;function mk(t){var e=this.__data__,n=ir(e,t);return n<0?void 0:e[n][1]}var Mm=mk;function hk(t){return ir(this.__data__,t)>-1}var Pm=hk;function gk(t,e){var n=this.__data__,o=ir(n,t);return o<0?(++this.size,n.push([t,e])):n[o][1]=e,this}var Lm=gk;function uo(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}uo.prototype.clear=Dm;uo.prototype.delete=Fm;uo.prototype.get=Mm;uo.prototype.has=Pm;uo.prototype.set=Lm;var ar=uo;var bk=Ot(st,"Map"),sr=bk;function xk(){this.size=0,this.__data__={hash:new ul,map:new(sr||ar),string:new ul}}var Bm=xk;function vk(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var Um=vk;function yk(t,e){var n=t.__data__;return Um(e)?n[typeof e=="string"?"string":"hash"]:n.map}var lr=yk;function wk(t){var e=lr(this,t).delete(t);return this.size-=e?1:0,e}var jm=wk;function _k(t){return lr(this,t).get(t)}var zm=_k;function kk(t){return lr(this,t).has(t)}var Hm=kk;function Tk(t,e){var n=lr(this,t),o=n.size;return n.set(t,e),this.size+=n.size==o?0:1,this}var Vm=Tk;function fo(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}fo.prototype.clear=Bm;fo.prototype.delete=jm;fo.prototype.get=zm;fo.prototype.has=Hm;fo.prototype.set=Vm;var Wm=fo;function Ck(t,e){for(var n=-1,o=e.length,r=t.length;++n<o;)t[r+n]=e[n];return t}var ba=Ck;var Sk=ga(Object.getPrototypeOf,Object),xa=Sk;function Ek(){this.__data__=new ar,this.size=0}var Gm=Ek;function Ok(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}var qm=Ok;function Ak(t){return this.__data__.get(t)}var Xm=Ak;function Nk(t){return this.__data__.has(t)}var Ym=Nk;var Rk=200;function Ik(t,e){var n=this.__data__;if(n instanceof ar){var o=n.__data__;if(!sr||o.length<Rk-1)return o.push([t,e]),this.size=++n.size,this;n=this.__data__=new Wm(o)}return n.set(t,e),this.size=n.size,this}var Qm=Ik;function po(t){var e=this.__data__=new ar(t);this.size=e.size}po.prototype.clear=Gm;po.prototype.delete=qm;po.prototype.get=Xm;po.prototype.has=Ym;po.prototype.set=Qm;var $m=po;function Dk(t,e){return t&&or(e,so(e),t)}var Km=Dk;function Fk(t,e){return t&&or(e,lo(e),t)}var Jm=Fk;var nh=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Zm=nh&&typeof module=="object"&&module&&!module.nodeType&&module,Mk=Zm&&Zm.exports===nh,eh=Mk?st.Buffer:void 0,th=eh?eh.allocUnsafe:void 0;function Pk(t,e){if(e)return t.slice();var n=t.length,o=th?th(n):new t.constructor(n);return t.copy(o),o}var rh=Pk;function Lk(t,e){for(var n=-1,o=t==null?0:t.length,r=0,i=[];++n<o;){var a=t[n];e(a,n,t)&&(i[r++]=a)}return i}var oh=Lk;function Bk(){return[]}var va=Bk;var Uk=Object.prototype,jk=Uk.propertyIsEnumerable,ih=Object.getOwnPropertySymbols,zk=ih?function(t){return t==null?[]:(t=Object(t),oh(ih(t),function(e){return jk.call(t,e)}))}:va,mo=zk;function Hk(t,e){return or(t,mo(t),e)}var ah=Hk;var Vk=Object.getOwnPropertySymbols,Wk=Vk?function(t){for(var e=[];t;)ba(e,mo(t)),t=xa(t);return e}:va,ya=Wk;function Gk(t,e){return or(t,ya(t),e)}var sh=Gk;function qk(t,e,n){var o=e(t);return oo(t)?o:ba(o,n(t))}var wa=qk;function Xk(t){return wa(t,so,mo)}var lh=Xk;function Yk(t){return wa(t,lo,ya)}var ch=Yk;var Qk=Ot(st,"DataView"),_a=Qk;var $k=Ot(st,"Promise"),ka=$k;var Kk=Ot(st,"Set"),Ta=Kk;var uh="[object Map]",Jk="[object Object]",dh="[object Promise]",fh="[object Set]",ph="[object WeakMap]",mh="[object DataView]",Zk=Un(_a),eT=Un(sr),tT=Un(ka),nT=Un(Ta),rT=Un(la),Ar=Bn;(_a&&Ar(new _a(new ArrayBuffer(1)))!=mh||sr&&Ar(new sr)!=uh||ka&&Ar(ka.resolve())!=dh||Ta&&Ar(new Ta)!=fh||la&&Ar(new la)!=ph)&&(Ar=function(t){var e=Bn(t),n=e==Jk?t.constructor:void 0,o=n?Un(n):"";if(o)switch(o){case Zk:return mh;case eT:return uh;case tT:return dh;case nT:return fh;case rT:return ph}return e});var ho=Ar;var oT=Object.prototype,iT=oT.hasOwnProperty;function aT(t){var e=t.length,n=new t.constructor(e);return e&&typeof t[0]=="string"&&iT.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var hh=aT;var sT=st.Uint8Array,dl=sT;function lT(t){var e=new t.constructor(t.byteLength);return new dl(e).set(new dl(t)),e}var go=lT;function cT(t,e){var n=e?go(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var gh=cT;var uT=/\w*$/;function dT(t){var e=new t.constructor(t.source,uT.exec(t));return e.lastIndex=t.lastIndex,e}var bh=dT;var xh=Ln?Ln.prototype:void 0,vh=xh?xh.valueOf:void 0;function fT(t){return vh?Object(vh.call(t)):{}}var yh=fT;function pT(t,e){var n=e?go(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var wh=pT;var mT="[object Boolean]",hT="[object Date]",gT="[object Map]",bT="[object Number]",xT="[object RegExp]",vT="[object Set]",yT="[object String]",wT="[object Symbol]",_T="[object ArrayBuffer]",kT="[object DataView]",TT="[object Float32Array]",CT="[object Float64Array]",ST="[object Int8Array]",ET="[object Int16Array]",OT="[object Int32Array]",AT="[object Uint8Array]",NT="[object Uint8ClampedArray]",RT="[object Uint16Array]",IT="[object Uint32Array]";function DT(t,e,n){var o=t.constructor;switch(e){case _T:return go(t);case mT:case hT:return new o(+t);case kT:return gh(t,n);case TT:case CT:case ST:case ET:case OT:case AT:case NT:case RT:case IT:return wh(t,n);case gT:return new o;case bT:case yT:return new o(t);case xT:return bh(t);case vT:return new o;case wT:return yh(t)}}var _h=DT;function FT(t){return typeof t.constructor=="function"&&!io(t)?cm(xa(t)):{}}var kh=FT;var MT="[object Map]";function PT(t){return gn(t)&&ho(t)==MT}var Th=PT;var Ch=jn&&jn.isMap,LT=Ch?ao(Ch):Th,Sh=LT;var BT="[object Set]";function UT(t){return gn(t)&&ho(t)==BT}var Eh=UT;var Oh=jn&&jn.isSet,jT=Oh?ao(Oh):Eh,Ah=jT;var zT=1,HT=2,VT=4,Nh="[object Arguments]",WT="[object Array]",GT="[object Boolean]",qT="[object Date]",XT="[object Error]",Rh="[object Function]",YT="[object GeneratorFunction]",QT="[object Map]",$T="[object Number]",Ih="[object Object]",KT="[object RegExp]",JT="[object Set]",ZT="[object String]",eC="[object Symbol]",tC="[object WeakMap]",nC="[object ArrayBuffer]",rC="[object DataView]",oC="[object Float32Array]",iC="[object Float64Array]",aC="[object Int8Array]",sC="[object Int16Array]",lC="[object Int32Array]",cC="[object Uint8Array]",uC="[object Uint8ClampedArray]",dC="[object Uint16Array]",fC="[object Uint32Array]",Ke={};Ke[Nh]=Ke[WT]=Ke[nC]=Ke[rC]=Ke[GT]=Ke[qT]=Ke[oC]=Ke[iC]=Ke[aC]=Ke[sC]=Ke[lC]=Ke[QT]=Ke[$T]=Ke[Ih]=Ke[KT]=Ke[JT]=Ke[ZT]=Ke[eC]=Ke[cC]=Ke[uC]=Ke[dC]=Ke[fC]=!0;Ke[XT]=Ke[Rh]=Ke[tC]=!1;function Ca(t,e,n,o,r,i){var a,s=e&zT,c=e&HT,l=e&VT;if(n&&(a=r?n(t,o,r,i):n(t)),a!==void 0)return a;if(!bn(t))return t;var u=oo(t);if(u){if(a=hh(t),!s)return um(t,a)}else{var d=ho(t),f=d==Rh||d==YT;if(ma(t))return rh(t,s);if(d==Ih||d==Nh||f&&!r){if(a=c||f?{}:kh(t),!s)return c?sh(t,Jm(a,t)):ah(t,Km(a,t))}else{if(!Ke[d])return r?t:{};a=_h(t,d,s)}}i||(i=new $m);var p=i.get(t);if(p)return p;i.set(t,a),Ah(t)?t.forEach(function(b){a.add(Ca(b,e,n,b,t,i))}):Sh(t)&&t.forEach(function(b,x){a.set(x,Ca(b,e,n,x,t,i))});var m=l?c?ch:lh:c?lo:so,h=u?void 0:m(t);return dm(h||t,function(b,x){h&&(x=b,b=t[x]),da(a,x,Ca(b,e,n,x,t,i))}),a}var Dh=Ca;var pC=1,mC=4;function hC(t){return Dh(t,pC|mC)}var fl=hC;var Mh=pt(Ct());var Fh=pt(Ct());function At(t){return Number.isNaN(t)||t==0?".0000":t.toFixed(4).replace(/^0+|0+$/g,"")}function cr(t,e){return e/t.width}function ur(t,e){return e/t.height}function dr(t,e){return Math.round(e*t.width)}function fr(t,e){return Math.round(e*t.height)}var Lt=class t{constructor({left:e=0,top:n=0,fill:o=nn,occludeInactive:r,ordinal:i=void 0}={}){this.fill=nn;this.left=e,this.top=n,this.fill=o,this.occludeInactive=r,this.ordinal=i}toDataForCloze(){return{left:At(this.left),top:At(this.top),...this.fill===nn?{}:{fill:this.fill}}}toFabric(e){let n=this.toAbsolute(e);return new Fh.fabric.Object(n)}normalPosition(e){return{left:cr(e,this.left),top:ur(e,this.top)}}toNormal(e){return new t({...this,...this.normalPosition(e)})}absolutePosition(e){return{left:dr(e,this.left),top:fr(e,this.top)}}toAbsolute(e){return new t({...this,...this.absolutePosition(e)})}};var xn=class t extends Lt{constructor({rx:n=0,ry:o=0,...r}={}){super(r);this.rx=n,this.ry=o}toDataForCloze(){return{...super.toDataForCloze(),rx:At(this.rx),ry:At(this.ry)}}toFabric(n){let o=this.toAbsolute(n);return new Mh.fabric.Ellipse(o)}toNormal(n){return new t({...this,...super.normalPosition(n),rx:cr(n,this.rx),ry:ur(n,this.ry)})}toAbsolute(n){return new t({...this,...super.absolutePosition(n),rx:dr(n,this.rx),ry:fr(n,this.ry)})}};var Ph=pt(Ct());var vn=class t extends Lt{constructor({points:n=[],...o}={}){super(o);this.points=n}toDataForCloze(){return{...super.toDataForCloze(),points:this.points.map(({x:n,y:o})=>`${At(n)},${At(o)}`).join(" ")}}toFabric(n){let o=this.toAbsolute(n);return new Ph.fabric.Polygon(o.points,o)}toNormal(n){let o=[];return this.points.forEach(r=>{o.push({x:cr(n,r.x),y:ur(n,r.y)})}),new t({...this,...super.normalPosition(n),points:o})}toAbsolute(n){let o=[];return this.points.forEach(r=>{o.push({x:dr(n,r.x),y:fr(n,r.y)})}),new t({...this,...super.absolutePosition(n),points:o})}},Ko=class{constructor({x:e=0,y:n=0}={}){this.x=0;this.y=0;this.x=e,this.y=n}};var Lh=pt(Ct());var yn=class t extends Lt{constructor({width:n=0,height:o=0,...r}={}){super(r);this.width=n,this.height=o}toDataForCloze(){return{...super.toDataForCloze(),width:At(this.width),height:At(this.height)}}toFabric(n){let o=this.toAbsolute(n);return new Lh.fabric.Rect(o)}toNormal(n){return new t({...this,...super.normalPosition(n),width:cr(n,this.width),height:ur(n,this.height)})}toAbsolute(n){return new t({...this,...super.absolutePosition(n),width:dr(n,this.width),height:fr(n,this.height)})}};var Bh=pt(Ct());var Gt=class t extends Lt{constructor({text:n="",scaleX:o=1,scaleY:r=1,...i}={}){super(i);this.text=n,this.scaleX=o,this.scaleY=r}toDataForCloze(){return{...super.toDataForCloze(),text:this.text,scale:At(this.scaleX)}}toFabric(n){let o=this.toAbsolute(n);return new Bh.fabric.IText(o.text,{...o,fontFamily:ta,backgroundColor:ea,padding:na})}toNormal(n){return new t({...this,...super.normalPosition(n)})}toAbsolute(n){return new t({...this,...super.absolutePosition(n)})}};function Sa(t){let e=ml(),n="",o=0,r=e.map(l=>Array.isArray(l)?l[0].ordinal:l.ordinal),i=r.flatMap(l=>typeof l=="number"?[l]:[]),a=Math.max(...i,0),s=[];for(let l=1;l<=a;l++)r.includes(l)||s.push(l);let c=a+1;return e.map(l=>{if(l===null)return;let u;Array.isArray(l)?u=l[0].ordinal:u=l.ordinal,u===void 0&&(l instanceof Gt?u=0:s.length>0?u=s.shift():(u=c,c++),Array.isArray(l)?l.forEach(d=>d.ordinal=u):l.ordinal=u),n+=jh(l,u,t),l instanceof Gt||o++}),{clozes:n,noteCount:o}}function ml(){let t=globalThis.canvas,e=t.getActiveObject(),n=e instanceof pl.fabric.ActiveSelection&&e.size()>1?e:null,o=t.getObjects(),r=ro();return o.map(i=>{let a=n!=null&&n.contains(i)?n:void 0;return i.width<5||i.height<5||i.fill=="transparent"?null:Uh(r,i,a)}).filter(i=>i!==null)}function Uh(t,e,n){let o,r=fl(e);if(n){let i=n.getObjectScaling();r.width=r.width*i.scaleX,r.height=r.height*i.scaleY}switch(e.type){case"rect":o=new yn(r);break;case"ellipse":o=new xn(r);break;case"polygon":o=new vn(r);break;case"i-text":o=new Gt(r);break;case"group":return e._objects.map(i=>Uh(t,i,e));default:return null}if(n){let i=pl.fabric.util.transformPoint({x:o.left,y:o.top},n.calcTransformMatrix());o.left=i.x,o.top=i.y}return t==null&&(t={width:0,height:0}),o=o.toNormal(t),o}function jh(t,e,n){let o="";function r(a,s){s=s.replace(":","\\:"),o+=`:${a}=${s}`}let i;if(Array.isArray(t))return t.map(a=>jh(a,e,n)).join("");if(t instanceof yn)i="rect";else if(t instanceof xn)i="ellipse";else if(t instanceof vn)i="polygon";else if(t instanceof Gt)i="text";else throw new Error("Unknown shape type");for(let[a,s]of Object.entries(t.toDataForCloze()))r(a,s);return n&&r("oi","1"),o=`{{c${e}::image-occlusion:${i}${o}}}<br>`,o}typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Bp);function gC(t){let e,n,o=t[4].default,r=Le(o,t,t[3],null);return{c(){e=fe("span"),r&&r.c(),qe(e,"--width-multiplier",t[1]),qe(e,"--icon-size",t[0]+"%"),oe(e,"class","svelte-111fj0e"),me(e,"flip-x",t[2])},m(i,a){Z(i,e,a),r&&r.m(e,null),n=!0},p(i,[a]){r&&r.p&&(!n||a&8)&&Ue(r,o,i,i[3],n?Be(o,i[3],a,null):je(i[3]),null),(!n||a&2)&&qe(e,"--width-multiplier",i[1]),(!n||a&1)&&qe(e,"--icon-size",i[0]+"%"),(!n||a&4)&&me(e,"flip-x",i[2])},i(i){n||(q(r,i),n=!0)},o(i){Y(r,i),n=!1},d(i){i&&J(e),r&&r.d(i)}}}function bC(t,e,n){let{$$slots:o={},$$scope:r}=e,{iconSize:i=100}=e,{widthMultiplier:a=1}=e,{flipX:s=!1}=e;return t.$$set=c=>{"iconSize"in c&&n(0,i=c.iconSize),"widthMultiplier"in c&&n(1,a=c.widthMultiplier),"flipX"in c&&n(2,s=c.flipX),"$$scope"in c&&n(3,r=c.$$scope)},[i,a,s,r,o]}var hl=class extends he{constructor(e){super(),ye(this,e,bC,gC,xe,{iconSize:0,widthMultiplier:1,flipX:2})}},pr=hl;function xC(t){let e,n=t[10].default,o=Le(n,t,t[13],null);return{c(){o&&o.c()},m(r,i){o&&o.m(r,i),e=!0},p(r,i){o&&o.p&&(!e||i&8192)&&Ue(o,n,r,r[13],e?Be(n,r[13],i,null):je(r[13]),null)},i(r){e||(q(o,r),e=!0)},o(r){Y(o,r),e=!1},d(r){o&&o.d(r)}}}function vC(t){let e,n,o,r,i,a,s;return n=new pr({props:{flipX:t[9],widthMultiplier:t[8],iconSize:t[7],$$slots:{default:[xC]},$$scope:{ctx:t}}}),{c(){e=fe("button"),pe(n.$$.fragment),oe(e,"id",t[0]),oe(e,"class",o="icon-button "+t[1]+" svelte-1p77nr8"),oe(e,"title",t[2]),e.disabled=t[5],oe(e,"tabindex",r=t[6]?0:-1),me(e,"active",t[4]),me(e,"primary",t[3])},m(c,l){Z(c,e,l),ue(n,e,null),i=!0,a||(s=[Ce(e,"click",t[11]),Ce(e,"mousedown",Wt(t[12]))],a=!0)},p(c,[l]){let u={};l&512&&(u.flipX=c[9]),l&256&&(u.widthMultiplier=c[8]),l&128&&(u.iconSize=c[7]),l&8192&&(u.$$scope={dirty:l,ctx:c}),n.$set(u),(!i||l&1)&&oe(e,"id",c[0]),(!i||l&2&&o!==(o="icon-button "+c[1]+" svelte-1p77nr8"))&&oe(e,"class",o),(!i||l&4)&&oe(e,"title",c[2]),(!i||l&32)&&(e.disabled=c[5]),(!i||l&64&&r!==(r=c[6]?0:-1))&&oe(e,"tabindex",r),(!i||l&18)&&me(e,"active",c[4]),(!i||l&10)&&me(e,"primary",c[3])},i(c){i||(q(n.$$.fragment,c),i=!0)},o(c){Y(n.$$.fragment,c),i=!1},d(c){c&&J(e),de(n),a=!1,ze(s)}}}function yC(t,e,n){let{$$slots:o={},$$scope:r}=e,{id:i=void 0}=e,{class:a=""}=e,{tooltip:s=void 0}=e,{primary:c=!1}=e,{active:l=!1}=e,{disabled:u=!1}=e,{tabbable:d=!1}=e,{iconSize:f=75}=e,{widthMultiplier:p=1}=e,{flipX:m=!1}=e;function h(x){Ie.call(this,t,x)}function b(x){Ie.call(this,t,x)}return t.$$set=x=>{"id"in x&&n(0,i=x.id),"class"in x&&n(1,a=x.class),"tooltip"in x&&n(2,s=x.tooltip),"primary"in x&&n(3,c=x.primary),"active"in x&&n(4,l=x.active),"disabled"in x&&n(5,u=x.disabled),"tabbable"in x&&n(6,d=x.tabbable),"iconSize"in x&&n(7,f=x.iconSize),"widthMultiplier"in x&&n(8,p=x.widthMultiplier),"flipX"in x&&n(9,m=x.flipX),"$$scope"in x&&n(13,r=x.$$scope)},[i,a,s,c,l,u,d,f,p,m,o,h,b,r]}var gl=class extends he{constructor(e){super(),ye(this,e,yC,vC,xe,{id:0,class:1,tooltip:2,primary:3,active:4,disabled:5,tabbable:6,iconSize:7,widthMultiplier:8,flipX:9})}},yt=gl;var bl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-align-horizontal-center" viewBox="0 0 24 24"><path d="M11 2H13V7H21V10H13V14H18V17H13V22H11V17H6V14H11V10H3V7H11V2Z" /></svg>';var xl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-align-horizontal-left" viewBox="0 0 24 24"><path d="M4 22H2V2H4V22M22 7H6V10H22V7M16 14H6V17H16V14Z" /></svg>';var vl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-align-horizontal-right" viewBox="0 0 24 24"><path d="M20 2H22V22H20V2M2 10H18V7H2V10M8 17H18V14H8V17Z" /></svg>';var yl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-align-vertical-bottom" viewBox="0 0 24 24"><path d="M22 22H2V20H22V22M10 2H7V18H10V2M17 8H14V18H17V8Z" /></svg>';var wl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-align-vertical-center" viewBox="0 0 24 24"><path d="M22 11H17V6H14V11H10V3H7V11H1.8V13H7V21H10V13H14V18H17V13H22V11Z" /></svg>';var _l='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-align-vertical-top" viewBox="0 0 24 24"><path d="M22 2V4H2V2H22M7 22H10V6H7V22M14 16H17V6H14V16Z" /></svg>';var kl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-close" viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>';var Tl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-code-tags" viewBox="0 0 24 24"><path d="M14.6,16.6L19.2,12L14.6,7.4L16,6L22,12L16,18L14.6,16.6M9.4,16.6L4.8,12L9.4,7.4L8,6L2,12L8,18L9.4,16.6Z" /></svg>';var Cl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-content-copy" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" /></svg>';var Sl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-cursor-default-outline" viewBox="0 0 24 24"><path d="M10.07,14.27C10.57,14.03 11.16,14.25 11.4,14.75L13.7,19.74L15.5,18.89L13.19,13.91C12.95,13.41 13.17,12.81 13.67,12.58L13.95,12.5L16.25,12.05L8,5.12V15.9L9.82,14.43L10.07,14.27M13.64,21.97C13.14,22.21 12.54,22 12.31,21.5L10.13,16.76L7.62,18.78C7.45,18.92 7.24,19 7,19A1,1 0 0,1 6,18V3A1,1 0 0,1 7,2C7.24,2 7.47,2.09 7.64,2.23L7.65,2.22L19.14,11.86C19.57,12.22 19.62,12.85 19.27,13.27C19.12,13.45 18.91,13.57 18.7,13.61L15.54,14.23L17.74,18.96C18,19.46 17.76,20.05 17.26,20.28L13.64,21.97Z" /></svg>';var El='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-delete-outline" viewBox="0 0 24 24"><path d="M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19M8,9H16V19H8V9M15.5,4L14.5,3H9.5L8.5,4H5V6H19V4H15.5Z" /></svg>';var Ol='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-ellipse-outline" viewBox="0 0 24 24"><path d="M12,6C16.41,6 20,8.69 20,12C20,15.31 16.41,18 12,18C7.59,18 4,15.31 4,12C4,8.69 7.59,6 12,6M12,4C6.5,4 2,7.58 2,12C2,16.42 6.5,20 12,20C17.5,20 22,16.42 22,12C22,7.58 17.5,4 12,4Z" /></svg>';var Al='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-eye" viewBox="0 0 24 24"><path d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z" /></svg>';var Nl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-format-align-center" viewBox="0 0 24 24"><path d="M3,3H21V5H3V3M7,7H17V9H7V7M3,11H21V13H3V11M7,15H17V17H7V15M3,19H21V21H3V19Z" /></svg>';var Rl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-format-bold" viewBox="0 0 24 24"><path d="M13.5,15.5H10V12.5H13.5A1.5,1.5 0 0,1 15,14A1.5,1.5 0 0,1 13.5,15.5M10,6.5H13A1.5,1.5 0 0,1 14.5,8A1.5,1.5 0 0,1 13,9.5H10M15.6,10.79C16.57,10.11 17.25,9 17.25,8C17.25,5.74 15.5,4 13.25,4H7V18H14.04C16.14,18 17.75,16.3 17.75,14.21C17.75,12.69 16.89,11.39 15.6,10.79Z" /></svg>';var Il='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-format-italic" viewBox="0 0 24 24"><path d="M10,4V7H12.21L8.79,15H6V18H14V15H11.79L15.21,7H18V4H10Z" /></svg>';var Dl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-format-underline" viewBox="0 0 24 24"><path d="M5,21H19V19H5V21M12,17A6,6 0 0,0 18,11V3H15.5V11A3.5,3.5 0 0,1 12,14.5A3.5,3.5 0 0,1 8.5,11V3H6V11A6,6 0 0,0 12,17Z" /></svg>';var Fl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-group" viewBox="0 0 24 24"><path d="M1,1V5H2V19H1V23H5V22H19V23H23V19H22V5H23V1H19V2H5V1M5,4H19V5H20V19H19V20H5V19H4V5H5M6,6V14H9V18H18V9H14V6M8,8H12V12H8M14,11H16V16H11V14H14" /></svg>';var Ml='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-magnify-expand" viewBox="0 0 24 24"><path d="M18 16H17.42L16.61 15.19C17.5 14 18 12.5 18 11C18 7.13 14.87 4 11 4C9.5 4 8 4.5 6.79 5.4C3.7 7.72 3.07 12.11 5.39 15.2C7.71 18.29 12.1 18.92 15.19 16.6L16 17.41V18L21 23L23 21L18 16M11 16C8.24 16 6 13.76 6 11S8.24 6 11 6 16 8.24 16 11 13.76 16 11 16M3 6L1 8V1H8L6 3H3V6M21 1V8L19 6V3H16L14 1H21M6 19L8 21H1V14L3 16V19H6Z" /></svg>';var Pl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-magnify-minus-outline" viewBox="0 0 24 24"><path d="M15.5,14H14.71L14.43,13.73C15.41,12.59 16,11.11 16,9.5A6.5,6.5 0 0,0 9.5,3A6.5,6.5 0 0,0 3,9.5A6.5,6.5 0 0,0 9.5,16C11.11,16 12.59,15.41 13.73,14.43L14,14.71V15.5L19,20.5L20.5,19L15.5,14M9.5,14C7,14 5,12 5,9.5C5,7 7,5 9.5,5C12,5 14,7 14,9.5C14,12 12,14 9.5,14M7,9H12V10H7V9Z" /></svg>';var Ll='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-magnify-plus-outline" viewBox="0 0 24 24"><path d="M15.5,14L20.5,19L19,20.5L14,15.5V14.71L13.73,14.43C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.43,13.73L14.71,14H15.5M9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14M12,10H10V12H9V10H7V9H9V7H10V9H12V10Z" /></svg>';var Bl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-rectangle-outline" viewBox="0 0 24 24"><path d="M4,6V19H20V6H4M18,17H6V8H18V17Z" /></svg>';var Ul='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-redo" viewBox="0 0 24 24"><path d="M18.4,10.6C16.55,9 14.15,8 11.5,8C6.85,8 2.92,11.03 1.54,15.22L3.9,16C4.95,12.81 7.95,10.5 11.5,10.5C13.45,10.5 15.23,11.22 16.62,12.38L13,16H22V7L18.4,10.6Z" /></svg>';var jl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-select-all" viewBox="0 0 24 24"><path d="M9,9H15V15H9M7,17H17V7H7M15,5H17V3H15M15,21H17V19H15M19,17H21V15H19M19,9H21V7H19M19,21A2,2 0 0,0 21,19H19M19,13H21V11H19M11,21H13V19H11M9,3H7V5H9M3,17H5V15H3M5,21V19H3A2,2 0 0,0 5,21M19,3V5H21A2,2 0 0,0 19,3M13,3H11V5H13M3,9H5V7H3M7,21H9V19H7M3,13H5V11H3M3,5H5V3A2,2 0 0,0 3,5Z" /></svg>';var Ea='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-square" viewBox="0 0 24 24"><path d="M3,3V21H21V3" /></svg>';var zl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-text-box" viewBox="0 0 24 24"><path d="M14,17H7V15H14M17,13H7V11H17M17,9H7V7H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z" /></svg>';var Hl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-undo" viewBox="0 0 24 24"><path d="M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z" /></svg>';var Vl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-ungroup" viewBox="0 0 24 24"><path d="M2,2H6V3H13V2H17V6H16V9H18V8H22V12H21V18H22V22H18V21H12V22H8V18H9V16H6V17H2V13H3V6H2V2M18,12V11H16V13H17V17H13V16H11V18H12V19H18V18H19V12H18M13,6V5H6V6H5V13H6V14H9V12H8V8H12V9H14V6H13M12,12H11V14H13V13H14V11H12V12Z" /></svg>';var Wl='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-vector-polygon-variant" viewBox="0 0 24 24"><path d="M22 8V2H16V5.8L14.4 8H9.6L8 5.8V2H2V8H4V16H2V22H8V20H16V22H22V16H20V8H22M11 10H13V12H11V10M4 4H6V6H4V4M6 20H4V18H6V20M16 18H8V16H6V8H7.1L9 10.6V14H15V10.6L16.9 8H18V16H16V18M20 20H18V18H20V20M18 6V4H20V6H18Z" /></svg>';var Oa='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-view-dashboard" viewBox="0 0 24 24"><path d="M13,3V9H21V3M13,21H21V11H13M3,21H11V15H3M3,13H11V3H3V13Z" /></svg>';function zh(t){let e,n,o,r,i,a,s;return i=new yt({props:{iconSize:96,class:"toast-icon",$$slots:{default:[KC]},$$scope:{ctx:t}}}),i.$on("click",t[3]),{c(){e=fe("div"),n=fe("div"),o=Ge(t[2]),r=ke(),pe(i.$$.fragment),oe(n,"class",a="toast "+(t[1]==="success"?"success":"error")+" svelte-1svf720"),oe(e,"class","toast-container desktop-only svelte-1svf720")},m(c,l){Z(c,e,l),Oe(e,n),Oe(n,o),Oe(n,r),ue(i,n,null),s=!0},p(c,l){(!s||l&4)&&Zt(o,c[2]);let u={};l&16&&(u.$$scope={dirty:l,ctx:c}),i.$set(u),(!s||l&2&&a!==(a="toast "+(c[1]==="success"?"success":"error")+" svelte-1svf720"))&&oe(n,"class",a)},i(c){s||(q(i.$$.fragment,c),s=!0)},o(c){Y(i.$$.fragment,c),s=!1},d(c){c&&J(e),de(i)}}}function KC(t){let e,n;return{c(){e=new Je(!1),n=He(),e.a=n},m(o,r){e.m(kl,o,r),Z(o,n,r)},p:_e,d(o){o&&(J(n),e.d())}}}function JC(t){let e,n,o=t[0]&&zh(t);return{c(){o&&o.c(),e=He()},m(r,i){o&&o.m(r,i),Z(r,e,i),n=!0},p(r,[i]){r[0]?o?(o.p(r,i),i&1&&q(o,1)):(o=zh(r),o.c(),q(o,1),o.m(e.parentNode,e)):o&&(De(),Y(o,1,1,()=>{o=null}),Fe())},i(r){n||(q(o),n=!0)},o(r){Y(o),n=!1},d(r){r&&J(e),o&&o.d(r)}}}function ZC(t,e,n){let{type:o="success"}=e,{message:r}=e,{showToast:i=!1}=e,a=()=>{n(0,i=!1)};return t.$$set=s=>{"type"in s&&n(1,o=s.type),"message"in s&&n(2,r=s.message),"showToast"in s&&n(0,i=s.showToast)},[i,o,r,a]}var Gl=class extends he{constructor(e){super(),ye(this,e,ZC,JC,xe,{type:1,message:2,showToast:0})}},Aa=Gl;var Vh=async function(t,e){let{clozes:n,noteCount:o}=Sa(e);if(o===0)return;let r=rt(no),i=rt(Er),a=r[0].textareaValue,s=r[1].textareaValue;if(a=a?`<div>${a}</div>`:"",s=a?`<div>${s}</div>`:"",t.kind=="edit"){let c=await kp({noteId:BigInt(t.noteId),occlusions:n,header:a,backExtra:s,tags:i});Hh(t.noteId,c,o)}else{let c=await _p({notetypeId:BigInt(t.notetypeId),imagePath:t.imagePath,occlusions:n,header:a,backExtra:s,tags:i});Hh(null,c,o)}},Hh=(t,e,n)=>{let o=new Aa({target:document.body,props:{message:"",type:"error"}});if(e.note){let r=t?ad({count:n}):Md({count:n});o.$set({message:r,type:"success",showToast:!0})}else{let r=Ud();o.$set({message:r,showToast:!0})}};function eS(t){let e,n,o,r=t[4].default,i=Le(r,t,t[3],null);return{c(){e=fe("div"),i&&i.c(),oe(e,"id",t[0]),oe(e,"class",n="container "+t[1]+" svelte-14e7rtp"),me(e,"container-xs",t[2]==="xs"),me(e,"container-sm",t[2]==="sm"),me(e,"container-md",t[2]==="md"),me(e,"container-lg",t[2]==="lg"),me(e,"container-xl",t[2]==="xl"),me(e,"container-xxl",t[2]==="xxl"),me(e,"container-fluid",t[2]==="fluid")},m(a,s){Z(a,e,s),i&&i.m(e,null),o=!0},p(a,[s]){i&&i.p&&(!o||s&8)&&Ue(i,r,a,a[3],o?Be(r,a[3],s,null):je(a[3]),null),(!o||s&1)&&oe(e,"id",a[0]),(!o||s&2&&n!==(n="container "+a[1]+" svelte-14e7rtp"))&&oe(e,"class",n),(!o||s&6)&&me(e,"container-xs",a[2]==="xs"),(!o||s&6)&&me(e,"container-sm",a[2]==="sm"),(!o||s&6)&&me(e,"container-md",a[2]==="md"),(!o||s&6)&&me(e,"container-lg",a[2]==="lg"),(!o||s&6)&&me(e,"container-xl",a[2]==="xl"),(!o||s&6)&&me(e,"container-xxl",a[2]==="xxl"),(!o||s&6)&&me(e,"container-fluid",a[2]==="fluid")},i(a){o||(q(i,a),o=!0)},o(a){Y(i,a),o=!1},d(a){a&&J(e),i&&i.d(a)}}}function tS(t,e,n){let{$$slots:o={},$$scope:r}=e,{id:i=void 0}=e,{class:a=""}=e,{breakpoint:s="fluid"}=e;return t.$$set=c=>{"id"in c&&n(0,i=c.id),"class"in c&&n(1,a=c.class),"breakpoint"in c&&n(2,s=c.breakpoint),"$$scope"in c&&n(3,r=c.$$scope)},[i,a,s,r,o]}var ql=class extends he{constructor(e){super(),ye(this,e,tS,eS,xe,{id:0,class:1,breakpoint:2})}},Wh=ql;var Hn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Na=[];for(let t=0;t<Hn.length;t++)Na[Hn[t].charCodeAt(0)]=t;Na["-".charCodeAt(0)]=Hn.indexOf("+");Na["_".charCodeAt(0)]=Hn.indexOf("/");var Xl={dec(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let n=new Uint8Array(e),o=0,r=0,i,a=0;for(let s=0;s<t.length;s++){if(i=Na[t.charCodeAt(s)],i===void 0)switch(t[s]){case"=":r=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(r){case 0:a=i,r=1;break;case 1:n[o++]=a<<2|(i&48)>>4,a=i,r=2;break;case 2:n[o++]=(a&15)<<4|(i&60)>>2,a=i,r=3;break;case 3:n[o++]=(a&3)<<6|i,r=0;break}}if(r==1)throw Error("invalid base64 string.");return n.subarray(0,o)},enc(t){let e="",n=0,o,r=0;for(let i=0;i<t.length;i++)switch(o=t[i],n){case 0:e+=Hn[o>>2],r=(o&3)<<4,n=1;break;case 1:e+=Hn[r|o>>4],r=(o&15)<<2,n=2;break;case 2:e+=Hn[r|o>>6],e+=Hn[o&63],n=0;break}return n&&(e+=Hn[r],e+="=",n==1&&(e+="=")),e}};var wn=pt(Ct());function nS(t,e){let{width:n,height:o}=t,r=window.devicePixelRatio;e.width*=r,e.height*=r;let i=Math.min(e.width/t.width,e.height/t.height);n*=i,o*=i;let a=4096*4096,s=n*o;if(s>a){let c=Math.sqrt(a)/Math.sqrt(s);n*=c,o*=c}return{width:Math.floor(n),height:Math.floor(o)}}function Ra(t,e){let{width:n,height:o}=nS(t,e);return{width:n/window.devicePixelRatio,height:o/window.devicePixelRatio}}function Gh(t){let e=[];for(let n of t){let o=[];for(let r of n.shapes)if(rS(r.shape)){let i=Object.fromEntries(r.properties.map(a=>[a.name,a.value]));i.ordinal=n.ordinal,o.push(oS(r.shape,i))}n.ordinal===0?e.push(...o):o.length>1?e.push(o):e.push(o[0])}return e}function rS(t){return["rect","ellipse","polygon","text"].includes(t)}function oS(t,e){switch(e.left=parseFloat(Number.isNaN(Number(e.left))?".0000":e.left),e.top=parseFloat(Number.isNaN(Number(e.top))?".0000":e.top),t){case"rect":return new yn({...e,width:parseFloat(e.width),height:parseFloat(e.height)});case"ellipse":return new xn({...e,rx:parseFloat(e.rx),ry:parseFloat(e.ry)});case"polygon":return e.points!==""?e.points=e.points.split(" ").map(n=>{let[o,r]=n.split(",");return new Ko({x:o,y:r})}):e.points=[new Ko({x:0,y:0})],new vn(e);case"text":return new Gt({...e,scaleX:parseFloat(e.scale),scaleY:parseFloat(e.scale)})}}var qh=pt(Ct());var Ia=(t,e,n)=>{let o=n.toFabric(e.getBoundingRect(!0));al(o),o.type==="i-text"&&oa(t,o),t.add(o)},Da=(t,e,n)=>{let o=new qh.fabric.Group;n.map(r=>{let i=r.toFabric(e.getBoundingRect(!0));al(i),o.addWithUpdate(i)}),t.add(o)};var Xh=(t,e,n)=>{for(let o of Gh(n))Array.isArray(o)?Da(t,e,o):Ia(t,e,o);it(t)};var Gn=pt(Ct());var hg=pt(Ct());var Yh="S",Qh="R",$h="E",Kh="P",Jh="T";var Zh="Control+Z",eg="Control+Y",tg="[",ng="]",rg="F",Yl="L",og="Delete",ig="D",ag="G",sg="U",lg="A",cg="Shift+L",ug="Shift+H",dg="Shift+R",fg="Shift+T",pg="Shift+V",mg="Shift+B";var iS=["rect","ellipse","i-text","group"],aS=t=>!(t.width<=5||t.height<=5||iS.indexOf(t.type)===-1),Ql=class{constructor(){this.stack=[];this.index=-1;this.locked=!1;this.shapeIds=new Set;this.state=ut({undoable:!1,redoable:!1});this.subscribe=this.state.subscribe}setCanvas(e){this.canvas=e,this.canvas.on("object:modified",n=>this.maybePush(n)),this.canvas.on("object:removed",n=>{!n.target.group&&!n.target.destroyed&&this.maybePush(n)})}reset(){this.shapeIds.clear(),this.stack.length=0,this.index=-1,this.push(),this.updateState()}canUndo(){return this.index>0}canRedo(){return this.index<this.stack.length-1}updateState(){this.state.set({undoable:this.canUndo(),redoable:this.canRedo()})}updateCanvas(){var e,n;this.locked=!0,(e=this.canvas)==null||e.loadFromJSON(this.stack[this.index],()=>{var o;(o=this.canvas)==null||o.renderAll(),mr(),this.locked=!1}),(n=this.canvas)==null||n.forEachObject(o=>{o instanceof hg.default.Rect&&o.fill==="transparent"&&(o.selectable=!1)})}onObjectAdded(e){this.shapeIds.has(e)||this.push(),this.shapeIds.add(e),mr()}onObjectModified(){this.push(),mr()}maybePush(e){!this.locked&&aS(e.target)&&this.push()}push(){let e=JSON.stringify(this.canvas);e!==this.stack[this.stack.length-1]&&(this.stack.length=this.index+1,this.stack.push(e),this.index++,this.updateState())}undo(){this.canUndo()&&(this.index--,this.updateState(),this.updateCanvas())}redo(){this.canRedo()&&(this.index++,this.updateState(),this.updateCanvas())}},lt=new Ql,$l=[{name:"undo",icon:Hl,action:()=>lt.undo(),tooltip:Xd,shortcut:Zh},{name:"redo",icon:Ul,action:()=>lt.redo(),tooltip:qd,shortcut:eg}];function Vn(){let t=window.navigator["platform"];return t.startsWith("Mac")||t.startsWith("iP")}function Kl(){return!/iphone|ipad|ipod|android/i.test(window.navigator.userAgent)}var vg=pt(gg());var Zl=.5,ec=5,bg=1,Jl=1,yg=t=>{t.on("mouse:wheel",Eg)},wg=t=>{t.on("mouse:down",Og),t.on("mouse:move",Ag),t.on("mouse:up",Dg)},_g=t=>{t.off("mouse:wheel",Eg)},kg=t=>{t.off("mouse:down",Og),t.off("mouse:move",Ag),t.off("mouse:up",Dg)},Tg=t=>{let e=t.getZoom();e=Math.min(ec,e*1.1),t.zoomToPoint({x:t.width/2,y:t.height/2},e),Wn(t),it(t)},Cg=t=>{let e=t.getZoom();e=Math.max(Zl,e/1.1),t.zoomToPoint({x:t.width/2,y:t.height/2},e/1.1),Wn(t),it(t)},tc=t=>{xg(t),xg(t)},xg=t=>{sS(t);let e=t.viewportTransform;t.zoomToPoint({x:t.width/2,y:t.height/2},e[0])},Sg=t=>{let e=new vg.default(t.upperCanvasEl);e.get("pinch").set({enable:!0}),e.on("pinchin pinchout",n=>{Jl=Math.min(Math.max(Zl,n.scale*bg),ec),t.zoomToPoint({x:t.width/2,y:t.height/2},Jl),Wn(t),it(t)}),e.on("pinchend pinchcancel",()=>{bg=Jl})};var Ma=t=>{Jo(t),tc(t)},Eg=t=>{let e=globalThis.canvas,n=t.e.deltaY,o=e.getZoom();o*=.999**n,o=Math.max(Zl,Math.min(o,ec)),e.zoomToPoint({x:t.pointer.x,y:t.pointer.y},o),t.e.preventDefault(),t.e.stopPropagation(),Wn(e),it(e)},Og=t=>{let e=globalThis.canvas;e.discardActiveObject();let{e:n}=t,o=n.type==="touchstart"?n.touches[0].clientX:n.clientX,r=n.type==="touchstart"?n.touches[0].clientY:n.clientY;e.lastPosX=o,e.lastPosY=r,it(e)},Ag=t=>{let e=globalThis.canvas;e.discardActiveObject(),e.viewportTransform&&(rn(t)||Ng(e,t))};document.addEventListener("touchstart",t=>{let e=globalThis.canvas;e.lastPosX=t.touches[0].clientX,e.lastPosY=t.touches[0].clientY});document.addEventListener("mousemove",t=>{document.addEventListener("keydown",e=>{if(e.key===" "){let n=globalThis.canvas;n.lastPosX=t.clientX,n.lastPosY=t.clientY}})});var rn=t=>{let{e}=t,n=globalThis.canvas;return e.type==="touchmove"&&e.touches.length>1?(Ng(n,t),!0):!1},Ng=(t,e)=>{let{e:n}=e,o=n.type==="touchmove"?n.touches[0].clientX:n.clientX,r=n.type==="touchmove"?n.touches[0].clientY:n.clientY,i=t.viewportTransform;i[4]+=o-t.lastPosX,i[5]+=r-t.lastPosY,t.lastPosX+=o-t.lastPosX,t.lastPosY+=r-t.lastPosY,Wn(t),it(t)},Rg=(t,e)=>{let n=e.deltaX,o=e.deltaY,r=t.viewportTransform;t.lastPosX=e.clientX,t.lastPosY=e.clientY,r[4]-=n,r[5]-=o,t.lastPosX-=n,t.lastPosY-=o,t.setViewportTransform(r),Wn(t),it(t)},Ig=(t,e)=>{let n=e.deltaY,o=t.viewportTransform;t.lastPosY=e.clientY,o[4]-=n,t.lastPosX-=n,t.setViewportTransform(o),Wn(t),it(t)},Dg=()=>{let t=globalThis.canvas;t.setViewportTransform(t.viewportTransform),Wn(t),it(t)},Wn=t=>{let e=ro(),n=document.getElementById("image"),o=e.width*t.getZoom(),r=e.height*t.getZoom(),i=t.viewportTransform[4],a=t.viewportTransform[5];n.width=o,n.height=r,n.style.left=`${i}px`,n.style.top=`${a}px`},Jo=t=>{let e=window.innerWidth-39,n=window.innerHeight;n=Kl()?n-76:n-46,t.setHeight(n),t.setWidth(e),it(t)},sS=t=>{let e=ro(),n=lS(e),o=t.viewportTransform,r=e.width*t.getZoom(),i=e.height*t.getZoom(),a=t.getCenter(),s=a.left-r/2,c=a.top-i/2;o[0]=n,o[3]=n,o[4]=Math.max(1,s),o[5]=Math.max(1,c),t.setViewportTransform(t.viewportTransform),Wn(t),it(t)},lS=t=>{let e=t.height,n=t.width,o=innerWidth-42,r=window.innerHeight;return r=Kl()?r-79:r-48,Math.min(o/n,r/e)};var hr,on,Zo=[],gr=[],bo=!1,nc=t=>{t.discardActiveObject(),t.forEachObject(function(e){e.selectable=!1}),t.selectionColor="rgba(0, 0, 0, 0)",t.on("mouse:down",function(e){try{e.target&&e.target.id===gr[0].id?dS(t,gr):uS(t,e)}catch{}}),t.on("mouse:move",function(e){if(rn(e)){rc(t);return}if(hr&&hr.class==="line"){let n=t.getPointer(e.e);hr.set({x2:n.x,y2:n.y});let o=on.get("points");o[gr.length]={x:n.x,y:n.y},on.set({points:o})}t.renderAll()})},cS=t=>{bo=!bo,bo?(hr=null,on=null,Zo=[],gr=[],bo=!1,t.selection=!0):(bo=!0,t.selection=!1)},uS=(t,e)=>{let n=t.getPointer(e.e),o=n.x,r=n.y;if(!rr(n))return;let i=new Gn.fabric.Circle({radius:5,fill:"#ffffff",stroke:"#333333",strokeWidth:.5,originX:"left",originY:"top",left:o,top:r,selectable:!1,hasBorders:!1,hasControls:!1,objectCaching:!1});gr.length===0&&i.set({fill:"red"});let a=[o,r,o,r],s=new Gn.fabric.Line(a,{strokeWidth:2,fill:"#999999",stroke:"#999999",originX:"left",originY:"top",selectable:!1,hasBorders:!1,hasControls:!1,evented:!1,objectCaching:!1});if(s.class="line",on){let c=t.getPointer(e.e),l=on.get("points");l.push({x:c.x,y:c.y});let u=new Gn.fabric.Polygon(l,{stroke:"#333333",strokeWidth:1,fill:"#cccccc",opacity:.3,selectable:!1,hasBorders:!1,hasControls:!1,evented:!1,objectCaching:!1});t.remove(on),t.add(u),on=u,t.renderAll()}else{let c=[{x:o,y:r}],l=new Gn.fabric.Polygon(c,{stroke:"#333333",strokeWidth:1,fill:"#cccccc",opacity:.3,selectable:!1,hasBorders:!1,hasControls:!1,evented:!1,objectCaching:!1});on=l,t.add(l)}hr=s,gr.push(i),Zo.push(s),t.add(s),t.add(i),t.renderAll()},dS=(t,e)=>{let n=[];e.forEach(r=>{n.push({x:r.left,y:r.top}),t.remove(r)}),Zo.forEach(r=>{t.remove(r)}),t.remove(on).remove(hr);let o=new Gn.fabric.Polygon(n,{id:"polygon-"+new Date().getTime(),fill:nn,objectCaching:!1,stroke:nr,strokeWidth:1,strokeUniform:!0,noScaleCache:!1,opacity:rt(Pt)?.4:1});o.width>5&&o.height>5&&(t.add(o),t.setActiveObject(o),lt.onObjectAdded(o.id)),cS(t)},Fg=(t,e)=>{let n=e.calcTransformMatrix(),o=e.get("points").map(function(i){return new Gn.fabric.Point(i.x-e.pathOffset.x,i.y-e.pathOffset.y)}).map(function(i){return Gn.fabric.util.transformPoint(i,n)}),r=new Gn.fabric.Polygon(o,{id:e.id,fill:nn,objectCaching:!1,stroke:nr,strokeWidth:1,strokeUniform:!0,noScaleCache:!1,opacity:rt(Pt)?.4:1});t.remove(e),t.add(r)},rc=t=>{t.remove(on).remove(hr),gr.forEach(e=>{t.remove(e)}),Zo.forEach(e=>{t.remove(e)}),hr=null,on=null,Zo=[],gr=[],bo=!1,t.selection=!0};var Mg=async(t,e,n)=>{let o=await Xs({path:t}),r=Lg(e),i=document.getElementById("image");return i.src=ic(o.data,t),i.onload=function(){let a=Ra({width:i.width,height:i.height},ac());Jo(r),n({path:t}),oc(r,a),lt.reset()},r},Pg=async(t,e,n)=>{var c;let o=await wp({noteId:BigInt(t)}),r=(c=o.value)==null?void 0:c.case;if(!r||r==="error"){new Aa({target:document.body,props:{message:jd(),type:"error"}}).$set({showToast:!0});return}let i=o.value.value,a=Lg(e),s=document.getElementById("image");return s.src=ic(i.imageData,i.imageFileName),s.onload=async function(){let l=Ra({width:s.width,height:s.height},ac());Jo(a);let u=oc(a,l);Xh(a,u,i.occlusions),ra(a,!0),fS(i.header,i.backExtra,i.tags),lt.reset(),window.requestAnimationFrame(()=>{n({noteId:BigInt(t)})})},a};function Lg(t){let e=new wn.fabric.Canvas("canvas");return Er.set([]),globalThis.canvas=e,lt.setCanvas(e),e.perPixelTargetFind=!0,e.uniformScaling=!1,e.uniScaleKey="none",delete wn.fabric.Object.prototype.controls.mtr,wn.fabric.Object.prototype.objectCaching=!1,wn.fabric.Object.prototype.transparentCorners=!1,wn.fabric.Object.prototype.cornerStyle="circle",wn.fabric.Object.prototype.cornerStrokeColor="#000000",wn.fabric.Object.prototype.padding=8,e.on("object:modified",n=>{n.target instanceof wn.fabric.Polygon&&(Fg(e,n.target),lt.onObjectModified()),t()}),e.on("object:removed",t),e}var oc=(t,e)=>{let n=new wn.fabric.Rect({id:"boundingBox",fill:"transparent",width:e.width,height:e.height,hasBorders:!1,hasControls:!1,lockMovementX:!0,lockMovementY:!0,selectable:!1,evented:!1});return t.add(n),Ma(t),Jp(t,n),$p(t,n),Sg(t),n},ic=(t,e)=>{let n=Xl.enc(t),o=e.split(".").pop();return`data:image/${{jpg:"jpeg",jpeg:"jpeg",gif:"gif",svg:"svg+xml",webp:"webp",avif:"avif",png:"png"}[o]||"png"};base64,${n}`},fS=(t,e,n)=>{let o=rt(no);o[0].divValue=t,o[1].divValue=e,o[0].textareaValue=t,o[1].textareaValue=e,Er.set(n),o.forEach(r=>{let i=`${r.id}--div`,a=`${r.id}--textarea`,s=document.getElementById(i),c=document.getElementById(a);s.innerHTML=r.divValue,c.value=r.textareaValue})};function ac(){let t=document.querySelector(".editor-main");return{width:t.clientWidth,height:t.clientHeight}}async function pS(t,e){let n=await Xs({path:t}),o=document.getElementById("image");o.src=ic(n.data,t);let r=globalThis.canvas;o.onload=async function(){let i=Ra({width:o.naturalWidth,height:o.naturalHeight},ac());o.width=i.width,o.height=i.height,Jo(r),e({path:t}),oc(r,i)}}globalThis.resetIOImage=pS;var Az=Symbol("fontFamily"),Nz=Symbol("fontSize"),Bg=Symbol("direction"),Rz=Symbol("description"),Iz=Symbol("collapsed"),xo=Symbol("tagActionsShortcuts");function Nr(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function Ug(t){t.preventDefault()}var sc=["Control","Alt","Shift","Meta"],lc=Vn()?["Meta","Alt","Shift","Control"]:["Control","Alt","Shift","OS"];function mS(t){return lc[sc.indexOf(t)]}function jg(t){let e=!1;for(let n of sc)e||(e=t.code.startsWith(n));return e}var zg=(t,e=[])=>n=>sc.reduce((o,r,i)=>o&&(e.includes(r)||n.getModifierState(lc[i])===t.includes(r)),!0),Pa=t=>e=>{let n=mS(t),o=e.getModifierState(n);return e.type==="keyup"?o&&e.key!==n:o},Hg=Pa("Control"),Vg=Pa("Shift"),Pz=Pa("Alt"),La=Pa("Meta");function Wg(t){let e=Vn()?["^","\u2325","\u21E7","\u2318"]:[`${Pd()}+`,"Alt+",`${Ld()}+`,"Win+"],n="";for(let o of t)n+=e[lc.indexOf(o)];return n}function Gg(t){switch(t){case"Backspace":return"\u232B";case"Delete":return"\u2326";case"Escape":return"\u238B";default:return t}}function qg(t){return t.code==="ArrowLeft"?!0:Vn()&&La(t)&&t.code==="KeyB"}function Xg(t){return t.code==="ArrowRight"?!0:Vn()&&La(t)&&t.code==="KeyF"}function Yg(t){return t.code==="ArrowUp"?!0:Vn()&&La(t)&&t.code==="KeyP"}function Qg(t){return t.code==="ArrowDown"?!0:Vn()&&La(t)&&t.code==="KeyN"}function cc(t){return e=>{switch(e.code){case"Enter":case"Space":t();break}}}var ei={},uc=()=>!1;function hS(t,e){ei[t]=e}function Rr(t,e,n){let o=n?new Proxy(e,{set:uc,defineProperty:uc,deleteProperty:uc,get:(r,i)=>(i in n&&console.log(`anki: ${i} is deprecated: ${n[i]}`),r[i])}):e;hS(t,o)}function $g(t){if(t in ei)return ei[t];throw new Error(`Cannot require "${t}" at runtime.`)}function gS(){return Object.keys(ei)}function bS(...t){for(let e of t)if(!(e in ei))return!1;return!0}Object.assign(window,{require:$g});Rr("anki/packages",{require:$g,listPackages:gS,hasPackages:bS});var xS={Backspace:8,Delete:46,Tab:9,Enter:13,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"=":187,"-":189,"[":219,"]":221,"\\":220,";":186,"'":222,",":188,".":190,"/":191,"`":192};function Kg(t){return!t.endsWith("?")}function Jg(t){return t.split(", ").map(e=>e.split("+"))}function vS(t){return Wg(t.slice(0,-1).filter(Kg))+Gg(t[t.length-1])}function wt(t){return Jg(t).map(vS).join(", ")}function yS(t,e){return t["which"]===e}function wS(t,e){let n=[],o=[];return e.forEach(r=>{(t(r)?n:o).push(r)}),[n,o]}function _S(t){return t.substring(0,t.length-1)}function kS(t){let[e,n]=wS(Kg,t),o=n.map(_S);return[e,o]}var TS=(t,e,n)=>o=>yS(o,t)&&zg(e,n)(o);function CS(t){return xS[t]||t.toUpperCase().charCodeAt(0)}function SS(t){let e=CS(t[t.length-1]),[n,o]=kS(t.slice(0,-1));return TS(e,n,o)}function Zg(t,e,n,...o){if(o.length===0)return n(e);let[r,...i]=o,a=Nr(document,"keydown",s,{once:!0});function s(c){r(c)?Zg(t,c,n,...i):jg(c)||a()}}var dc={target:document,event:"keydown"};function ti(t,e,n=dc){let{target:o=dc.target,event:r=dc.event}=n,[i,...a]=Jg(e).map(SS);function s(c){i(c)&&Zg(o,c,t,...a)}return Nr(o,r,s)}Rr("anki/shortcuts",{registerShortcut:ti,getPlatformString:wt});function ES(t){let e,n,o,r,i,a,s=t[11].default,c=Le(s,t,t[10],null);return{c(){e=fe("button"),c&&c.c(),oe(e,"id",t[1]),oe(e,"role",t[2]),oe(e,"aria-selected",t[3]),oe(e,"tabindex",n=t[8]?0:-1),oe(e,"class",o="dropdown-item "+t[4]+" svelte-1ft3k22"),oe(e,"title",t[5]),e.disabled=t[7],me(e,"active",t[6]),me(e,"rtl",t[9])},m(l,u){Z(l,e,u),c&&c.m(e,null),t[17](e),r=!0,i||(a=[Ce(e,"mouseenter",t[12]),Ce(e,"focus",t[13]),Ce(e,"keydown",t[14]),Ce(e,"click",t[15]),Ce(e,"mousedown",Wt(t[16]))],i=!0)},p(l,[u]){c&&c.p&&(!r||u&1024)&&Ue(c,s,l,l[10],r?Be(s,l[10],u,null):je(l[10]),null),(!r||u&2)&&oe(e,"id",l[1]),(!r||u&4)&&oe(e,"role",l[2]),(!r||u&8)&&oe(e,"aria-selected",l[3]),(!r||u&256&&n!==(n=l[8]?0:-1))&&oe(e,"tabindex",n),(!r||u&16&&o!==(o="dropdown-item "+l[4]+" svelte-1ft3k22"))&&oe(e,"class",o),(!r||u&32)&&oe(e,"title",l[5]),(!r||u&128)&&(e.disabled=l[7]),(!r||u&80)&&me(e,"active",l[6]),(!r||u&528)&&me(e,"rtl",l[9])},i(l){r||(q(c,l),r=!0)},o(l){Y(c,l),r=!1},d(l){l&&J(e),c&&c.d(l),t[17](null),i=!1,ze(a)}}}function OS(t,e,n){let{$$slots:o={},$$scope:r}=e,{id:i=void 0}=e,{role:a=void 0}=e,{selected:s=!1}=e,{class:c=""}=e,{buttonRef:l=void 0}=e,{tooltip:u=void 0}=e,{active:d=!1}=e,{disabled:f=!1}=e,p=window.getComputedStyle(document.body).direction=="rtl",{tabbable:m=!1}=e;function h(S){Ie.call(this,t,S)}function b(S){Ie.call(this,t,S)}function x(S){Ie.call(this,t,S)}function T(S){Ie.call(this,t,S)}function B(S){Ie.call(this,t,S)}function A(S){Xe[S?"unshift":"push"](()=>{l=S,n(0,l)})}return t.$$set=S=>{"id"in S&&n(1,i=S.id),"role"in S&&n(2,a=S.role),"selected"in S&&n(3,s=S.selected),"class"in S&&n(4,c=S.class),"buttonRef"in S&&n(0,l=S.buttonRef),"tooltip"in S&&n(5,u=S.tooltip),"active"in S&&n(6,d=S.active),"disabled"in S&&n(7,f=S.disabled),"tabbable"in S&&n(8,m=S.tabbable),"$$scope"in S&&n(10,r=S.$$scope)},t.$$.update=()=>{t.$$.dirty&65&&l&&d&&l.scrollIntoView({behavior:"smooth",block:"nearest"})},[l,i,a,s,c,u,d,f,m,p,r,o,h,b,x,T,B,A]}var fc=class extends he{constructor(e){super(),ye(this,e,OS,ES,xe,{id:1,role:2,selected:3,class:4,buttonRef:0,tooltip:5,active:6,disabled:7,tabbable:8})}},Ir=fc;var Qz=Symbol("touchDevice"),$z=Symbol("section"),Kz=Symbol("buttonGroup"),Jz=Symbol("dropdown"),Zz=Symbol("modals"),Ba=Symbol("floating"),e7=Symbol("overlay"),t7=Symbol("select"),n7=Symbol("selectShow"),r7=Symbol("selectFocusId");function AS(t){let e,n,o,r=`${t[5]}px`,i,a,s,c=t[10].default,l=Le(c,t,t[9],null);return{c(){e=fe("div"),n=fe("div"),l&&l.c(),oe(n,"class","popover svelte-1hgq719"),oe(n,"id",t[0]),oe(n,"role","listbox"),me(n,"scrollable",t[1]),me(n,"hidden",t[2]),me(n,"top",t[3]==="top"),me(n,"right",t[3]==="right"),me(n,"bottom",t[3]==="bottom"),me(n,"left",t[3]==="left"),oe(e,"class","popover-wrapper d-flex svelte-1hgq719"),qe(e,"--min-height",r)},m(u,d){Z(u,e,d),Oe(e,n),l&&l.m(n,null),t[11](e),i=!0,a||(s=Et(o=t[7].call(null,n)),a=!0)},p(u,[d]){l&&l.p&&(!i||d&512)&&Ue(l,c,u,u[9],i?Be(c,u[9],d,null):je(u[9]),null),(!i||d&1)&&oe(n,"id",u[0]),(!i||d&2)&&me(n,"scrollable",u[1]),(!i||d&4)&&me(n,"hidden",u[2]),(!i||d&8)&&me(n,"top",u[3]==="top"),(!i||d&8)&&me(n,"right",u[3]==="right"),(!i||d&8)&&me(n,"bottom",u[3]==="bottom"),(!i||d&8)&&me(n,"left",u[3]==="left"),d&32&&r!==(r=`${u[5]}px`)&&qe(e,"--min-height",r)},i(u){i||(q(l,u),i=!0)},o(u){Y(l,u),i=!1},d(u){u&&J(e),l&&l.d(u),t[11](null),a=!1,s()}}}function NS(t,e,n){let o,{$$slots:r={},$$scope:i}=e,{id:a=""}=e,{scrollable:s=!1}=e,c,l=!0,u=0,d,f=Qe(),p=Pn(Ba);at(t,p,b=>n(8,o=b)),Tt(async()=>{n(5,u=c.offsetHeight)});function m(b){f("revealed",b)}function h(b){Xe[b?"unshift":"push"](()=>{c=b,n(4,c)})}return t.$$set=b=>{"id"in b&&n(0,a=b.id),"scrollable"in b&&n(1,s=b.scrollable),"$$scope"in b&&n(9,i=b.$$scope)},t.$$.update=()=>{t.$$.dirty&268&&o!==void 0&&l&&o.then(b=>{d!=b&&(n(3,d=b),n(2,l=!1))})},[a,s,l,d,c,u,p,m,o,i,r,h]}var pc=class extends he{constructor(e){super(),ye(this,e,NS,AS,xe,{id:0,scrollable:1})}},vo=pc;function RS(t,e,n){let{keyCombination:o}=e,{event:r=void 0}=e,i=Qe();return Tt(()=>ti(a=>{Ug(a),i("action",{originalEvent:a})},o,{event:r})),t.$$set=a=>{"keyCombination"in a&&n(0,o=a.keyCombination),"event"in a&&n(1,r=a.event)},[o,r]}var mc=class extends he{constructor(e){super(),ye(this,e,RS,null,xe,{keyCombination:0,event:1})}},Nt=mc;function eb(...t){return()=>{for(let e of t)e()}}function IS(t){return t.button===2}function DS(t,{reference:e,floating:n,inside:o,outside:r}){function i(s){return s.includes(e)?!1:o&&s.includes(n)?"insideClick":r&&!s.includes(n)?"outsideClick":!1}function a(s){return IS(s)?"secondaryButton":i(s.composedPath())}return to(t,(s,c)=>{let l=a(s);l&&c({reason:l,originalEvent:s})})}var tb=DS;function FS(t,e){function n(o){return o.key==="Tab"?!1:"keyup"}return to(t,(o,r)=>{let i=n(o);i&&r({reason:i,originalEvent:o})})}var nb=FS;function MS(t,e,n){let o=new n(e);return eo(o,r=>Nr(t,e,r))}function PS(){let t=new MouseEvent("click");return eo(t,e=>{let n,o;function r(a){n=a.clientX,o=a.clientY}function i(a){Math.abs(n-a.clientX)<5&&Math.abs(o-a.clientY)<5&&e(a)}return document.addEventListener("mousedown",r),document.addEventListener("click",i),()=>{document.removeEventListener("click",i),document.removeEventListener("mousedown",r)}})}var rb=PS(),ob=MS(document,"keyup",KeyboardEvent);function ib(t){let e=!1;function n(r){e=r}let o=Nr(document,"keydown",r=>{r.key==="Escape"&&e&&(r.stopImmediatePropagation(),t&&t())},{capture:!0});return{set:n,remove:o}}function LS(t,e=document.body){let n;async function o(i){n=i,n&&n.append(t)}function r(){t.remove()}return o(e),{update:o,destroy:r}}var ab=LS;var sb=["top","right","bottom","left"];var an=Math.min,qt=Math.max,ri=Math.round,oi=Math.floor,qn=t=>({x:t,y:t}),BS={left:"right",right:"left",bottom:"top",top:"bottom"},US={start:"end",end:"start"};function ja(t,e,n){return qt(t,an(e,n))}function br(t,e){return typeof t=="function"?t(e):t}function _n(t){return t.split("-")[0]}function yo(t){return t.split("-")[1]}function hc(t){return t==="x"?"y":"x"}function za(t){return t==="y"?"height":"width"}function wo(t){return["top","bottom"].includes(_n(t))?"y":"x"}function Ha(t){return hc(wo(t))}function lb(t,e,n){n===void 0&&(n=!1);let o=yo(t),r=Ha(t),i=za(r),a=r==="x"?o===(n?"end":"start")?"right":"left":o==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(a=ni(a)),[a,ni(a)]}function cb(t){let e=ni(t);return[Ua(t),e,Ua(e)]}function Ua(t){return t.replace(/start|end/g,e=>US[e])}function jS(t,e,n){let o=["left","right"],r=["right","left"],i=["top","bottom"],a=["bottom","top"];switch(t){case"top":case"bottom":return n?e?r:o:e?o:r;case"left":case"right":return e?i:a;default:return[]}}function ub(t,e,n,o){let r=yo(t),i=jS(_n(t),n==="start",o);return r&&(i=i.map(a=>a+"-"+r),e&&(i=i.concat(i.map(Ua)))),i}function ni(t){return t.replace(/left|right|bottom|top/g,e=>BS[e])}function zS(t){return{top:0,right:0,bottom:0,left:0,...t}}function Va(t){return typeof t!="number"?zS(t):{top:t,right:t,bottom:t,left:t}}function Xn(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}function db(t,e,n){let{reference:o,floating:r}=t,i=wo(e),a=Ha(e),s=za(a),c=_n(e),l=i==="y",u=o.x+o.width/2-r.width/2,d=o.y+o.height/2-r.height/2,f=o[s]/2-r[s]/2,p;switch(c){case"top":p={x:u,y:o.y-r.height};break;case"bottom":p={x:u,y:o.y+o.height};break;case"right":p={x:o.x+o.width,y:d};break;case"left":p={x:o.x-r.width,y:d};break;default:p={x:o.x,y:o.y}}switch(yo(e)){case"start":p[a]-=f*(n&&l?-1:1);break;case"end":p[a]+=f*(n&&l?-1:1);break}return p}var mb=async(t,e,n)=>{let{placement:o="bottom",strategy:r="absolute",middleware:i=[],platform:a}=n,s=i.filter(Boolean),c=await(a.isRTL==null?void 0:a.isRTL(e)),l=await a.getElementRects({reference:t,floating:e,strategy:r}),{x:u,y:d}=db(l,o,c),f=o,p={},m=0;for(let h=0;h<s.length;h++){let{name:b,fn:x}=s[h],{x:T,y:B,data:A,reset:S}=await x({x:u,y:d,initialPlacement:o,placement:f,strategy:r,middlewareData:p,rects:l,platform:a,elements:{reference:t,floating:e}});u=T!=null?T:u,d=B!=null?B:d,p={...p,[b]:{...p[b],...A}},S&&m<=50&&(m++,typeof S=="object"&&(S.placement&&(f=S.placement),S.rects&&(l=S.rects===!0?await a.getElementRects({reference:t,floating:e,strategy:r}):S.rects),{x:u,y:d}=db(l,f,c)),h=-1)}return{x:u,y:d,placement:f,strategy:r,middlewareData:p}};async function ii(t,e){var n;e===void 0&&(e={});let{x:o,y:r,platform:i,rects:a,elements:s,strategy:c}=t,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:f=!1,padding:p=0}=br(e,t),m=Va(p),b=s[f?d==="floating"?"reference":"floating":d],x=Xn(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(b)))==null||n?b:b.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(s.floating)),boundary:l,rootBoundary:u,strategy:c})),T=d==="floating"?{...a.floating,x:o,y:r}:a.reference,B=await(i.getOffsetParent==null?void 0:i.getOffsetParent(s.floating)),A=await(i.isElement==null?void 0:i.isElement(B))?await(i.getScale==null?void 0:i.getScale(B))||{x:1,y:1}:{x:1,y:1},S=Xn(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:s,rect:T,offsetParent:B,strategy:c}):T);return{top:(x.top-S.top+m.top)/A.y,bottom:(S.bottom-x.bottom+m.bottom)/A.y,left:(x.left-S.left+m.left)/A.x,right:(S.right-x.right+m.right)/A.x}}var hb=t=>({name:"arrow",options:t,async fn(e){let{x:n,y:o,placement:r,rects:i,platform:a,elements:s,middlewareData:c}=e,{element:l,padding:u=0}=br(t,e)||{};if(l==null)return{};let d=Va(u),f={x:n,y:o},p=Ha(r),m=za(p),h=await a.getDimensions(l),b=p==="y",x=b?"top":"left",T=b?"bottom":"right",B=b?"clientHeight":"clientWidth",A=i.reference[m]+i.reference[p]-f[p]-i.floating[m],S=f[p]-i.reference[p],H=await(a.getOffsetParent==null?void 0:a.getOffsetParent(l)),j=H?H[B]:0;(!j||!await(a.isElement==null?void 0:a.isElement(H)))&&(j=s.floating[B]||i.floating[m]);let M=A/2-S/2,I=j/2-h[m]/2-1,O=an(d[x],I),Q=an(d[T],I),v=O,k=j-h[m]-Q,R=j/2-h[m]/2+M,N=ja(v,R,k),W=!c.arrow&&yo(r)!=null&&R!==N&&i.reference[m]/2-(R<v?O:Q)-h[m]/2<0,C=W?R<v?R-v:R-k:0;return{[p]:f[p]+C,data:{[p]:N,centerOffset:R-N-C,...W&&{alignmentOffset:C}},reset:W}}});var gb=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,o;let{placement:r,middlewareData:i,rects:a,initialPlacement:s,platform:c,elements:l}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:h=!0,...b}=br(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};let x=_n(r),T=_n(s)===s,B=await(c.isRTL==null?void 0:c.isRTL(l.floating)),A=f||(T||!h?[ni(s)]:cb(s));!f&&m!=="none"&&A.push(...ub(s,h,m,B));let S=[s,...A],H=await ii(e,b),j=[],M=((o=i.flip)==null?void 0:o.overflows)||[];if(u&&j.push(H[x]),d){let v=lb(r,a,B);j.push(H[v[0]],H[v[1]])}if(M=[...M,{placement:r,overflows:j}],!j.every(v=>v<=0)){var I,O;let v=(((I=i.flip)==null?void 0:I.index)||0)+1,k=S[v];if(k)return{data:{index:v,overflows:M},reset:{placement:k}};let R=(O=M.filter(N=>N.overflows[0]<=0).sort((N,W)=>N.overflows[1]-W.overflows[1])[0])==null?void 0:O.placement;if(!R)switch(p){case"bestFit":{var Q;let N=(Q=M.map(W=>[W.placement,W.overflows.filter(C=>C>0).reduce((C,w)=>C+w,0)]).sort((W,C)=>W[1]-C[1])[0])==null?void 0:Q[0];N&&(R=N);break}case"initialPlacement":R=s;break}if(r!==R)return{reset:{placement:R}}}return{}}}};function fb(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function pb(t){return sb.some(e=>t[e]>=0)}var bb=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){let{rects:n}=e,{strategy:o="referenceHidden",...r}=br(t,e);switch(o){case"referenceHidden":{let i=await ii(e,{...r,elementContext:"reference"}),a=fb(i,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:pb(a)}}}case"escaped":{let i=await ii(e,{...r,altBoundary:!0}),a=fb(i,n.floating);return{data:{escapedOffsets:a,escaped:pb(a)}}}default:return{}}}}};function xb(t){let e=an(...t.map(i=>i.left)),n=an(...t.map(i=>i.top)),o=qt(...t.map(i=>i.right)),r=qt(...t.map(i=>i.bottom));return{x:e,y:n,width:o-e,height:r-n}}function HS(t){let e=t.slice().sort((r,i)=>r.y-i.y),n=[],o=null;for(let r=0;r<e.length;r++){let i=e[r];!o||i.y-o.y>o.height/2?n.push([i]):n[n.length-1].push(i),o=i}return n.map(r=>Xn(xb(r)))}var vb=function(t){return t===void 0&&(t={}),{name:"inline",options:t,async fn(e){let{placement:n,elements:o,rects:r,platform:i,strategy:a}=e,{padding:s=2,x:c,y:l}=br(t,e),u=Array.from(await(i.getClientRects==null?void 0:i.getClientRects(o.reference))||[]),d=HS(u),f=Xn(xb(u)),p=Va(s);function m(){if(d.length===2&&d[0].left>d[1].right&&c!=null&&l!=null)return d.find(b=>c>b.left-p.left&&c<b.right+p.right&&l>b.top-p.top&&l<b.bottom+p.bottom)||f;if(d.length>=2){if(wo(n)==="y"){let O=d[0],Q=d[d.length-1],v=_n(n)==="top",k=O.top,R=Q.bottom,N=v?O.left:Q.left,W=v?O.right:Q.right,C=W-N,w=R-k;return{top:k,bottom:R,left:N,right:W,width:C,height:w,x:N,y:k}}let b=_n(n)==="left",x=qt(...d.map(O=>O.right)),T=an(...d.map(O=>O.left)),B=d.filter(O=>b?O.left===T:O.right===x),A=B[0].top,S=B[B.length-1].bottom,H=T,j=x,M=j-H,I=S-A;return{top:A,bottom:S,left:H,right:j,width:M,height:I,x:H,y:A}}return f}let h=await i.getElementRects({reference:{getBoundingClientRect:m},floating:o.floating,strategy:a});return r.reference.x!==h.reference.x||r.reference.y!==h.reference.y||r.reference.width!==h.reference.width||r.reference.height!==h.reference.height?{reset:{rects:h}}:{}}}};async function VS(t,e){let{placement:n,platform:o,elements:r}=t,i=await(o.isRTL==null?void 0:o.isRTL(r.floating)),a=_n(n),s=yo(n),c=wo(n)==="y",l=["left","top"].includes(a)?-1:1,u=i&&c?-1:1,d=br(e,t),{mainAxis:f,crossAxis:p,alignmentAxis:m}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...d};return s&&typeof m=="number"&&(p=s==="end"?m*-1:m),c?{x:p*u,y:f*l}:{x:f*l,y:p*u}}var gc=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,o;let{x:r,y:i,placement:a,middlewareData:s}=e,c=await VS(e,t);return a===((n=s.offset)==null?void 0:n.placement)&&(o=s.arrow)!=null&&o.alignmentOffset?{}:{x:r+c.x,y:i+c.y,data:{...c,placement:a}}}}},yb=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){let{x:n,y:o,placement:r}=e,{mainAxis:i=!0,crossAxis:a=!1,limiter:s={fn:b=>{let{x,y:T}=b;return{x,y:T}}},...c}=br(t,e),l={x:n,y:o},u=await ii(e,c),d=wo(_n(r)),f=hc(d),p=l[f],m=l[d];if(i){let b=f==="y"?"top":"left",x=f==="y"?"bottom":"right",T=p+u[b],B=p-u[x];p=ja(T,p,B)}if(a){let b=d==="y"?"top":"left",x=d==="y"?"bottom":"right",T=m+u[b],B=m-u[x];m=ja(T,m,B)}let h=s.fn({...e,[f]:p,[d]:m});return{...h,data:{x:h.x-n,y:h.y-o}}}}};function Yn(t){return _b(t)?(t.nodeName||"").toLowerCase():"#document"}function Rt(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function kn(t){var e;return(e=(_b(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function _b(t){return t instanceof Node||t instanceof Rt(t).Node}function Tn(t){return t instanceof Element||t instanceof Rt(t).Element}function sn(t){return t instanceof HTMLElement||t instanceof Rt(t).HTMLElement}function wb(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Rt(t).ShadowRoot}function ko(t){let{overflow:e,overflowX:n,overflowY:o,display:r}=Bt(t);return/auto|scroll|overlay|hidden|clip/.test(e+o+n)&&!["inline","contents"].includes(r)}function kb(t){return["table","td","th"].includes(Yn(t))}function Wa(t){let e=Ga(),n=Bt(t);return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(o=>(n.willChange||"").includes(o))||["paint","layout","strict","content"].some(o=>(n.contain||"").includes(o))}function Tb(t){let e=Dr(t);for(;sn(e)&&!ai(e);){if(Wa(e))return e;e=Dr(e)}return null}function Ga(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function ai(t){return["html","body","#document"].includes(Yn(t))}function Bt(t){return Rt(t).getComputedStyle(t)}function si(t){return Tn(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Dr(t){if(Yn(t)==="html")return t;let e=t.assignedSlot||t.parentNode||wb(t)&&t.host||kn(t);return wb(e)?e.host:e}function Cb(t){let e=Dr(t);return ai(e)?t.ownerDocument?t.ownerDocument.body:t.body:sn(e)&&ko(e)?e:Cb(e)}function _o(t,e,n){var o;e===void 0&&(e=[]),n===void 0&&(n=!0);let r=Cb(t),i=r===((o=t.ownerDocument)==null?void 0:o.body),a=Rt(r);return i?e.concat(a,a.visualViewport||[],ko(r)?r:[],a.frameElement&&n?_o(a.frameElement):[]):e.concat(r,_o(r,[],n))}function Ob(t){let e=Bt(t),n=parseFloat(e.width)||0,o=parseFloat(e.height)||0,r=sn(t),i=r?t.offsetWidth:n,a=r?t.offsetHeight:o,s=ri(n)!==i||ri(o)!==a;return s&&(n=i,o=a),{width:n,height:o,$:s}}function bc(t){return Tn(t)?t:t.contextElement}function To(t){let e=bc(t);if(!sn(e))return qn(1);let n=e.getBoundingClientRect(),{width:o,height:r,$:i}=Ob(e),a=(i?ri(n.width):n.width)/o,s=(i?ri(n.height):n.height)/r;return(!a||!Number.isFinite(a))&&(a=1),(!s||!Number.isFinite(s))&&(s=1),{x:a,y:s}}var WS=qn(0);function Ab(t){let e=Rt(t);return!Ga()||!e.visualViewport?WS:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function GS(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Rt(t)?!1:e}function Fr(t,e,n,o){e===void 0&&(e=!1),n===void 0&&(n=!1);let r=t.getBoundingClientRect(),i=bc(t),a=qn(1);e&&(o?Tn(o)&&(a=To(o)):a=To(t));let s=GS(i,n,o)?Ab(i):qn(0),c=(r.left+s.x)/a.x,l=(r.top+s.y)/a.y,u=r.width/a.x,d=r.height/a.y;if(i){let f=Rt(i),p=o&&Tn(o)?Rt(o):o,m=f,h=m.frameElement;for(;h&&o&&p!==m;){let b=To(h),x=h.getBoundingClientRect(),T=Bt(h),B=x.left+(h.clientLeft+parseFloat(T.paddingLeft))*b.x,A=x.top+(h.clientTop+parseFloat(T.paddingTop))*b.y;c*=b.x,l*=b.y,u*=b.x,d*=b.y,c+=B,l+=A,m=Rt(h),h=m.frameElement}}return Xn({width:u,height:d,x:c,y:l})}var qS=[":popover-open",":modal"];function Nb(t){return qS.some(e=>{try{return t.matches(e)}catch{return!1}})}function XS(t){let{elements:e,rect:n,offsetParent:o,strategy:r}=t,i=r==="fixed",a=kn(o),s=e?Nb(e.floating):!1;if(o===a||s&&i)return n;let c={scrollLeft:0,scrollTop:0},l=qn(1),u=qn(0),d=sn(o);if((d||!d&&!i)&&((Yn(o)!=="body"||ko(a))&&(c=si(o)),sn(o))){let f=Fr(o);l=To(o),u.x=f.x+o.clientLeft,u.y=f.y+o.clientTop}return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-c.scrollLeft*l.x+u.x,y:n.y*l.y-c.scrollTop*l.y+u.y}}function YS(t){return Array.from(t.getClientRects())}function Rb(t){return Fr(kn(t)).left+si(t).scrollLeft}function QS(t){let e=kn(t),n=si(t),o=t.ownerDocument.body,r=qt(e.scrollWidth,e.clientWidth,o.scrollWidth,o.clientWidth),i=qt(e.scrollHeight,e.clientHeight,o.scrollHeight,o.clientHeight),a=-n.scrollLeft+Rb(t),s=-n.scrollTop;return Bt(o).direction==="rtl"&&(a+=qt(e.clientWidth,o.clientWidth)-r),{width:r,height:i,x:a,y:s}}function $S(t,e){let n=Rt(t),o=kn(t),r=n.visualViewport,i=o.clientWidth,a=o.clientHeight,s=0,c=0;if(r){i=r.width,a=r.height;let l=Ga();(!l||l&&e==="fixed")&&(s=r.offsetLeft,c=r.offsetTop)}return{width:i,height:a,x:s,y:c}}function KS(t,e){let n=Fr(t,!0,e==="fixed"),o=n.top+t.clientTop,r=n.left+t.clientLeft,i=sn(t)?To(t):qn(1),a=t.clientWidth*i.x,s=t.clientHeight*i.y,c=r*i.x,l=o*i.y;return{width:a,height:s,x:c,y:l}}function Sb(t,e,n){let o;if(e==="viewport")o=$S(t,n);else if(e==="document")o=QS(kn(t));else if(Tn(e))o=KS(e,n);else{let r=Ab(t);o={...e,x:e.x-r.x,y:e.y-r.y}}return Xn(o)}function Ib(t,e){let n=Dr(t);return n===e||!Tn(n)||ai(n)?!1:Bt(n).position==="fixed"||Ib(n,e)}function JS(t,e){let n=e.get(t);if(n)return n;let o=_o(t,[],!1).filter(s=>Tn(s)&&Yn(s)!=="body"),r=null,i=Bt(t).position==="fixed",a=i?Dr(t):t;for(;Tn(a)&&!ai(a);){let s=Bt(a),c=Wa(a);!c&&s.position==="fixed"&&(r=null),(i?!c&&!r:!c&&s.position==="static"&&!!r&&["absolute","fixed"].includes(r.position)||ko(a)&&!c&&Ib(t,a))?o=o.filter(u=>u!==a):r=s,a=Dr(a)}return e.set(t,o),o}function ZS(t){let{element:e,boundary:n,rootBoundary:o,strategy:r}=t,a=[...n==="clippingAncestors"?JS(e,this._c):[].concat(n),o],s=a[0],c=a.reduce((l,u)=>{let d=Sb(e,u,r);return l.top=qt(d.top,l.top),l.right=an(d.right,l.right),l.bottom=an(d.bottom,l.bottom),l.left=qt(d.left,l.left),l},Sb(e,s,r));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function e2(t){let{width:e,height:n}=Ob(t);return{width:e,height:n}}function t2(t,e,n){let o=sn(e),r=kn(e),i=n==="fixed",a=Fr(t,!0,i,e),s={scrollLeft:0,scrollTop:0},c=qn(0);if(o||!o&&!i)if((Yn(e)!=="body"||ko(r))&&(s=si(e)),o){let d=Fr(e,!0,i,e);c.x=d.x+e.clientLeft,c.y=d.y+e.clientTop}else r&&(c.x=Rb(r));let l=a.left+s.scrollLeft-c.x,u=a.top+s.scrollTop-c.y;return{x:l,y:u,width:a.width,height:a.height}}function Eb(t,e){return!sn(t)||Bt(t).position==="fixed"?null:e?e(t):t.offsetParent}function Db(t,e){let n=Rt(t);if(!sn(t)||Nb(t))return n;let o=Eb(t,e);for(;o&&kb(o)&&Bt(o).position==="static";)o=Eb(o,e);return o&&(Yn(o)==="html"||Yn(o)==="body"&&Bt(o).position==="static"&&!Wa(o))?n:o||Tb(t)||n}var n2=async function(t){let e=this.getOffsetParent||Db,n=this.getDimensions;return{reference:t2(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,...await n(t.floating)}}};function r2(t){return Bt(t).direction==="rtl"}var o2={convertOffsetParentRelativeRectToViewportRelativeRect:XS,getDocumentElement:kn,getClippingRect:ZS,getOffsetParent:Db,getElementRects:n2,getClientRects:YS,getDimensions:e2,getScale:To,isElement:Tn,isRTL:r2};function i2(t,e){let n=null,o,r=kn(t);function i(){var s;clearTimeout(o),(s=n)==null||s.disconnect(),n=null}function a(s,c){s===void 0&&(s=!1),c===void 0&&(c=1),i();let{left:l,top:u,width:d,height:f}=t.getBoundingClientRect();if(s||e(),!d||!f)return;let p=oi(u),m=oi(r.clientWidth-(l+d)),h=oi(r.clientHeight-(u+f)),b=oi(l),T={rootMargin:-p+"px "+-m+"px "+-h+"px "+-b+"px",threshold:qt(0,an(1,c))||1},B=!0;function A(S){let H=S[0].intersectionRatio;if(H!==c){if(!B)return a();H?a(!1,H):o=setTimeout(()=>{a(!1,1e-7)},100)}B=!1}try{n=new IntersectionObserver(A,{...T,root:r.ownerDocument})}catch{n=new IntersectionObserver(A,T)}n.observe(t)}return a(!0),i}function Fb(t,e,n,o){o===void 0&&(o={});let{ancestorScroll:r=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:c=!1}=o,l=bc(t),u=r||i?[...l?_o(l):[],..._o(e)]:[];u.forEach(x=>{r&&x.addEventListener("scroll",n,{passive:!0}),i&&x.addEventListener("resize",n)});let d=l&&s?i2(l,n):null,f=-1,p=null;a&&(p=new ResizeObserver(x=>{let[T]=x;T&&T.target===l&&p&&(p.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var B;(B=p)==null||B.observe(e)})),n()}),l&&!c&&p.observe(l),p.observe(e));let m,h=c?Fr(t):null;c&&b();function b(){let x=Fr(t);h&&(x.x!==h.x||x.y!==h.y||x.width!==h.width||x.height!==h.height)&&n(),h=x,m=requestAnimationFrame(b)}return n(),()=>{var x;u.forEach(T=>{r&&T.removeEventListener("scroll",n),i&&T.removeEventListener("resize",n)}),d==null||d(),(x=p)==null||x.disconnect(),p=null,c&&cancelAnimationFrame(m)}}var Mb=yb,Pb=gb;var xc=bb,Lb=hb,Bb=vb;var Ub=(t,e,n)=>{let o=new Map,r={platform:o2,...n},i={...r.platform,_c:o};return mb(t,e,{...r,platform:i})};function a2(t,e){let n;function o(){n==null||n()}function r(i){o(),n=i(t,Fb)}return r(e),{destroy:o,update:r}}var jb=a2;function s2({placement:t,arrow:e,shift:n,offset:o,inline:r,hideIfEscaped:i,hideIfReferenceHidden:a,hideCallback:s}){return async function(c,l){var B,A,S,H,j,M;let u=[Pb(),gc(o),Mb({padding:n}),Lb({element:e,padding:5})];r&&u.unshift(Bb());let d={middleware:u,placement:t};i&&u.push(xc({strategy:"escaped"})),a&&u.push(xc({strategy:"referenceHidden"}));let{x:f,y:p,middlewareData:m,placement:h}=await Ub(c,l,d);if((B=m.hide)!=null&&B.escaped)return s("escaped"),h;if((A=m.hide)!=null&&A.referenceHidden)return s("referenceHidden"),h;Object.assign(l.style,{left:`${f}px`,top:`${p}px`});let b,x,T;return h.startsWith("bottom")?(b=45,x=(S=m.arrow)==null?void 0:S.x,T=-5):h.startsWith("left")?(b=135,x=l.offsetWidth-5,T=(H=m.arrow)==null?void 0:H.y):h.startsWith("top")?(b=225,x=(j=m.arrow)==null?void 0:j.x,T=l.offsetHeight-5):(b=315,x=-5,T=(M=m.arrow)==null?void 0:M.y),Object.assign(e.style,{left:x?`${x}px`:"",top:T?`${T}px`:"",transform:`rotate(${b}deg)`}),h}}var zb=s2;function l2(t,e){let n=!0;return t.subscribe(o=>{n?n=!1:e(o)})}var vc=l2;function c2(t){let e;return{c(){e=fe("div"),oe(e,"class","arrow svelte-137gj59")},m(n,o){Z(n,e,o)},p:_e,i:_e,o:_e,d(n){n&&J(e)}}}var yc=class extends he{constructor(e){super(),ye(this,e,null,c2,xe,{})}},Hb=yc;var u2=t=>({}),Vb=t=>({position:t[7]}),d2=t=>({}),Wb=t=>({}),f2=t=>({}),Gb=t=>({}),p2=t=>({}),qb=t=>({position:t[7],asReference:t[8]});function Xb(t){let e,n,o,r,i=[h2,m2],a=[];function s(c,l){return c[1]?0:1}return e=s(t,[-1,-1]),n=a[e]=i[e](t),{c(){n.c(),o=He()},m(c,l){a[e].m(c,l),Z(c,o,l),r=!0},p(c,l){let u=e;e=s(c,l),e===u?a[e].p(c,l):(De(),Y(a[u],1,1,()=>{a[u]=null}),Fe(),n=a[e],n?n.p(c,l):(n=a[e]=i[e](c),n.c()),q(n,1),n.m(o.parentNode,o))},i(c){r||(q(n),r=!0)},o(c){Y(n),r=!1},d(c){c&&J(o),a[e].d(c)}}}function m2(t){let e,n,o,r,i,a=t[22].reference,s=Le(a,t,t[21],Wb);return{c(){e=fe("div"),s&&s.c(),oe(e,"class","floating-reference")},m(c,l){Z(c,e,l),s&&s.m(e,null),o=!0,r||(i=Et(n=t[8].call(null,e)),r=!0)},p(c,l){s&&s.p&&(!o||l[0]&2097152)&&Ue(s,a,c,c[21],o?Be(a,c[21],l,d2):je(c[21]),Wb)},i(c){o||(q(s,c),o=!0)},o(c){Y(s,c),o=!1},d(c){c&&J(e),s&&s.d(c),r=!1,i()}}}function h2(t){let e,n,o,r,i,a=t[22].reference,s=Le(a,t,t[21],Gb);return{c(){e=fe("span"),s&&s.c(),oe(e,"class","floating-reference svelte-1rg7qgv")},m(c,l){Z(c,e,l),s&&s.m(e,null),o=!0,r||(i=Et(n=t[8].call(null,e)),r=!0)},p(c,l){s&&s.p&&(!o||l[0]&2097152)&&Ue(s,a,c,c[21],o?Be(a,c[21],l,f2):je(c[21]),Gb)},i(c){o||(q(s,c),o=!0)},o(c){Y(s,c),o=!1},d(c){c&&J(e),s&&s.d(c),r=!1,i()}}}function Yb(t){let e,n=t[22].floating,o=Le(n,t,t[21],Vb);return{c(){o&&o.c()},m(r,i){o&&o.m(r,i),e=!0},p(r,i){o&&o.p&&(!e||i[0]&2097152)&&Ue(o,n,r,r[21],e?Be(n,r[21],i,u2):je(r[21]),Vb)},i(r){e||(q(o,r),e=!0)},o(r){Y(o,r),e=!1},d(r){o&&o.d(r)}}}function Qb(t){let e,n;return e=new Hb({}),{c(){pe(e.$$.fragment)},m(o,r){ue(e,o,r),n=!0},i(o){n||(q(e.$$.fragment,o),n=!0)},o(o){Y(e.$$.fragment,o),n=!1},d(o){de(e,o)}}}function g2(t){let e,n,o,r,i,a,s,c,l,u,d=t[22].default,f=Le(d,t,t[21],qb),p=t[9].reference&&Xb(t),m=t[2]&&Yb(t),h=!t[3]&&Qb(t);return{c(){f&&f.c(),e=ke(),p&&p.c(),n=ke(),o=fe("div"),m&&m.c(),r=ke(),i=fe("div"),h&&h.c(),oe(i,"class","floating-arrow svelte-1rg7qgv"),i.hidden=a=!t[2],oe(o,"class","floating svelte-1rg7qgv"),me(o,"show",t[2])},m(b,x){f&&f.m(b,x),Z(b,e,x),p&&p.m(b,x),Z(b,n,x),Z(b,o,x),m&&m.m(o,null),Oe(o,r),Oe(o,i),h&&h.m(i,null),t[23](i),t[24](o),c=!0,l||(u=Et(s=ab.call(null,o,t[0])),l=!0)},p(b,x){f&&f.p&&(!c||x[0]&2097152)&&Ue(f,d,b,b[21],c?Be(d,b[21],x,p2):je(b[21]),qb),b[9].reference?p?(p.p(b,x),x[0]&512&&q(p,1)):(p=Xb(b),p.c(),q(p,1),p.m(n.parentNode,n)):p&&(De(),Y(p,1,1,()=>{p=null}),Fe()),b[2]?m?(m.p(b,x),x[0]&4&&q(m,1)):(m=Yb(b),m.c(),q(m,1),m.m(o,r)):m&&(De(),Y(m,1,1,()=>{m=null}),Fe()),b[3]?h&&(De(),Y(h,1,1,()=>{h=null}),Fe()):h?x[0]&8&&q(h,1):(h=Qb(b),h.c(),q(h,1),h.m(i,null)),(!c||x[0]&4&&a!==(a=!b[2]))&&(i.hidden=a),s&&Jt(s.update)&&x[0]&1&&s.update.call(null,b[0]),(!c||x[0]&4)&&me(o,"show",b[2])},i(b){c||(q(f,b),q(p),q(m),q(h),c=!0)},o(b){Y(f,b),Y(p),Y(m),Y(h),c=!1},d(b){b&&(J(e),J(n),J(o)),f&&f.d(b),p&&p.d(b),m&&m.d(),h&&h.d(),t[23](null),t[24](null),l=!1,u()}}}function b2(t,e,n){let o,r,{$$slots:i={},$$scope:a}=e,s=Op(i);var c;let{portalTarget:l=null}=e,{preferredPlacement:u="bottom"}=e,d=ut(void 0);at(t,d,_=>n(26,r=_)),Xo(Ba,d);let{offset:f=5}=e,{shift:p=30}=e,{inline:m=!1}=e,{hideIfEscaped:h=!1}=e,{hideIfReferenceHidden:b=!1}=e,{show:x=!0}=e,T=Qe(),B,{set:A,remove:S}=ib(()=>T("close",{reason:"esc"})),H={},{closeOnInsideClick:j=!1}=e,{keepOnKeyup:M=!1}=e,{hideArrow:I=!1}=e,{reference:O=void 0}=e,Q;function v(_,F,G){let $=G(_,F);return er(d,r=$,r),$}async function k(_=v){if(O&&Q)return _(O,Q,o)}function R(_){n(10,O=_)}function N(_,F){let G=Q;return F(_,G,()=>{er(d,r=o(_,G),r)})}let W=null;function C(_,F,G){if(W==null||W(),W=null,A(G),!_||!F||!G)return;if(n(19,H=jb(_,N)),!(_ instanceof EventTarget)){W=H.destroy;return}let $=tb(rb,{reference:_,floating:F,inside:j,outside:!0}),X=[vc($,U=>T("close",U))];if(!M){let U=nb(ob,{reference:_,floating:F});X.push(vc(U,P=>T("close",P)))}W=eb(...X,H.destroy,S)}Tr(()=>W==null?void 0:W());function w(_){Xe[_?"unshift":"push"](()=>{B=_,n(4,B)})}function D(_){Xe[_?"unshift":"push"](()=>{Q=_,n(5,Q)})}return t.$$set=_=>{"portalTarget"in _&&n(0,l=_.portalTarget),"preferredPlacement"in _&&n(11,u=_.preferredPlacement),"offset"in _&&n(12,f=_.offset),"shift"in _&&n(13,p=_.shift),"inline"in _&&n(1,m=_.inline),"hideIfEscaped"in _&&n(14,h=_.hideIfEscaped),"hideIfReferenceHidden"in _&&n(15,b=_.hideIfReferenceHidden),"show"in _&&n(2,x=_.show),"closeOnInsideClick"in _&&n(16,j=_.closeOnInsideClick),"keepOnKeyup"in _&&n(17,M=_.keepOnKeyup),"hideArrow"in _&&n(3,I=_.hideArrow),"reference"in _&&n(10,O=_.reference),"$$scope"in _&&n(21,a=_.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&63506&&n(20,o=zb({placement:u,offset:f,shift:p,inline:m,arrow:B,hideIfEscaped:h,hideIfReferenceHidden:b,hideCallback:_=>T("close",{reason:_})})),t.$$.dirty[0]&1835008&&(n(18,c=H.update)==null||c.call(H,N)),t.$$.dirty[0]&1060&&C(O,Q,x)},[l,m,x,I,B,Q,d,k,R,s,O,u,f,p,h,b,j,M,c,H,o,a,i,w,D]}var wc=class extends he{constructor(e){super(),ye(this,e,b2,g2,xe,{portalTarget:0,preferredPlacement:11,offset:12,shift:13,inline:1,hideIfEscaped:14,hideIfReferenceHidden:15,show:2,closeOnInsideClick:16,keepOnKeyup:17,hideArrow:3,reference:10},null,[-1,-1])}},Co=wc;var $b=pt(Ct());var _c=t=>{t.selectionColor="rgba(0, 0, 0, 0)";let e,n,o,r;hn(t),t.on("mouse:down",function(i){if(i.target)return;n=!0;let a=t.getPointer(i.e);if(o=a.x,r=a.y,!rr(a)){n=!1;return}e=new $b.fabric.Ellipse({id:"ellipse-"+new Date().getTime(),left:o,top:r,originX:"left",originY:"top",rx:a.x-o,ry:a.y-r,fill:nn,transparentCorners:!1,selectable:!0,stroke:nr,strokeWidth:1,strokeUniform:!0,noScaleCache:!1,opacity:rt(Pt)?.4:1}),t.add(e)}),t.on("mouse:move",function(i){if(rn(i)){t.remove(e),t.renderAll();return}if(!n)return;let a=t.getPointer(i.e),s=Math.abs(o-a.x)/2,c=Math.abs(r-a.y)/2,l=a.x,u=a.y;s>e.strokeWidth&&(s-=e.strokeWidth/2),c>e.strokeWidth&&(c-=e.strokeWidth/2),l<o?e.set({originX:"right"}):e.set({originX:"left"}),u<r?e.set({originY:"bottom"}):e.set({originY:"top"}),e.set({rx:s,ry:c}),t.renderAll()}),t.on("mouse:up",function(){if(n=!1,!!e){if(e.width<5||e.height<5){t.remove(e),e=void 0;return}e.originX==="right"&&e.set({originX:"left",left:e.left-e.width+e.strokeWidth}),e.originY==="bottom"&&e.set({originY:"top",top:e.top-e.height+e.strokeWidth}),e.setCoords(),t.setActiveObject(e),lt.onObjectAdded(e.id),e=void 0}})};var Kb=pt(Ct());var kc=t=>{t.selectionColor="rgba(0, 0, 0, 0)";let e,n,o,r;hn(t),t.on("mouse:down",function(i){if(i.target)return;n=!0;let a=t.getPointer(i.e);if(o=a.x,r=a.y,!rr(a)){n=!1;return}e=new Kb.fabric.Rect({id:"rect-"+new Date().getTime(),left:o,top:r,originX:"left",originY:"top",width:a.x-o,height:a.y-r,angle:0,fill:nn,transparentCorners:!1,selectable:!0,stroke:nr,strokeWidth:1,strokeUniform:!0,noScaleCache:!1,opacity:rt(Pt)?.4:1}),t.add(e)}),t.on("mouse:move",function(i){if(rn(i)){t.remove(e),t.renderAll();return}if(!n)return;let a=t.getPointer(i.e),s=a.x,c=a.y;s<o?e.set({originX:"right"}):e.set({originX:"left"}),c<r?e.set({originY:"bottom"}):e.set({originY:"top"}),e.set({width:Math.abs(s-e.left),height:Math.abs(c-e.top)}),t.renderAll()}),t.on("mouse:up",function(){if(n=!1,!!e){if(e.width<5||e.height<5){t.remove(e),e=void 0;return}e.originX==="right"&&e.set({originX:"left",left:e.left-e.width+e.strokeWidth}),e.originY==="bottom"&&e.set({originY:"top",top:e.top-e.height+e.strokeWidth}),e.setCoords(),t.setActiveObject(e),lt.onObjectAdded(e.id),e=void 0}})};var Jb=pt(Ct());var Tc=t=>{t.selectionColor="rgba(0, 0, 0, 0)",hn(t);let e;t.on("mouse:down",function(n){if(n.target)return;let o=t.getPointer(n.e);rr(o)&&(e=new Jb.fabric.IText("text",{id:"text-"+new Date().getTime(),left:o.x,top:o.y,originX:"left",originY:"top",selectable:!0,strokeWidth:1,noScaleCache:!1,fontFamily:ta,backgroundColor:ea,padding:na,opacity:rt(Pt)?.4:1}),oa(t,e),t.add(e),t.setActiveObject(e),lt.onObjectAdded(e.id),e.selectAll())}),t.on("mouse:move",function(n){if(rn(n)){t.remove(e),t.renderAll();return}}),t.on("text:editing:entered",function(){Or.set(!0)}),t.on("text:editing:exited",function(){Or.set(!1)})};var Zb=t=>{if(!t.getActiveObject())return;let e=t.getActiveObject();t.getActiveObject().type=="activeSelection"?x2(t,e):e.set({left:0}),e.setCoords(),t.renderAll()},ex=t=>{if(!t.getActiveObject())return;let e=t.getActiveObject();t.getActiveObject().type=="activeSelection"?_2(t,e):e.set({left:t.width/2-e.width/2}),e.setCoords(),t.renderAll()},tx=t=>{if(!t.getActiveObject())return;let e=t.getActiveObject();t.getActiveObject().type=="activeSelection"?v2(t,e):e.set({left:t.getWidth()-e.width}),e.setCoords(),t.renderAll()},nx=t=>{if(!t.getActiveObject())return;let e=t.getActiveObject();t.getActiveObject().type=="activeSelection"?y2(t,e):e.set({top:0}),e.setCoords(),t.renderAll()},rx=t=>{if(!t.getActiveObject())return;let e=t.getActiveObject();t.getActiveObject().type=="activeSelection"?k2(t,e):e.set({top:t.getHeight()/2-e.height/2}),e.setCoords(),t.renderAll()},ox=t=>{if(!t.getActiveObject())return;let e=t.getActiveObject();t.getActiveObject().type=="activeSelection"?w2(t,e):e.set({top:t.height-e.height}),e.setCoords(),t.renderAll()},x2=(t,e)=>{let n=e.getObjects(),o=n[0];for(let r=1;r<n.length;r++)n[r].left<o.left&&(o=n[r]);n.forEach(r=>{r.left=o.left,r.setCoords()})},v2=(t,e)=>{let n=e.getObjects(),o=n[0];for(let r=1;r<n.length;r++)n[r].left>o.left&&(o=n[r]);n.forEach(r=>{r.left=o.left+o.width-r.width,r.setCoords()})},y2=(t,e)=>{let n=e.getObjects(),o=n[0];for(let r=1;r<n.length;r++)n[r].top<o.top&&(o=n[r]);n.forEach(r=>{r.top=o.top,r.setCoords()})},w2=(t,e)=>{let n=e.getObjects(),o=n[0];for(let r=1;r<n.length;r++)n[r].top+n[r].height>o.top+o.height&&(o=n[r]);n.forEach(function(r){r!==o&&(r.set({top:o.top+o.height-r.height}),r.setCoords())})},_2=(t,e)=>{let n=e.getObjects(),o=n[0],r=n[0];for(let a=1;a<n.length;a++)n[a].left<o.left&&(o=n[a]),n[a].left>r.left&&(r=n[a]);let i=(o.left+r.left+r.width)/2;n.forEach(a=>{a.left=i-a.width/2,a.setCoords()})},k2=(t,e)=>{let n=e.getObjects(),o=n[0],r=n[0];for(let a=1;a<n.length;a++)n[a].top<o.top&&(o=n[a]),n[a].top>r.top&&(r=n[a]);let i=(o.top+r.top+r.height)/2;n.forEach(a=>{a.top=i-a.height/2,a.setCoords()})};var Cc=[{name:"group",icon:Fl,action:Yp,tooltip:xd,shortcut:ag},{name:"ungroup",icon:Vl,action:Qp,tooltip:Sd,shortcut:sg},{name:"select-all",icon:jl,action:Zp,tooltip:_d,shortcut:lg}],Sc=[{name:"delete",icon:El,action:qp,tooltip:hd,shortcut:og},{name:"duplicate",icon:Cl,action:Xp,tooltip:gd,shortcut:ig}],Ec=[{name:"zoomOut",icon:Pl,action:Cg,tooltip:Od,shortcut:tg},{name:"zoomIn",icon:Ll,action:Tg,tooltip:Ed,shortcut:ng},{name:"zoomReset",icon:Ml,action:tc,tooltip:Ad,shortcut:rg}],Oc=[{id:1,icon:xl,action:Zb,tooltip:ud,shortcut:cg},{id:2,icon:bl,action:ex,tooltip:cd,shortcut:ug},{id:3,icon:vl,action:tx,tooltip:dd,shortcut:dg},{id:4,icon:_l,action:nx,tooltip:fd,shortcut:fg},{id:5,icon:wl,action:rx,tooltip:pd,shortcut:pg},{id:6,icon:yl,action:ox,tooltip:ld,shortcut:mg}];var Ac=[{id:"cursor",icon:Sl,tooltip:kd,shortcut:Yh},{id:"draw-rectangle",icon:Bl,tooltip:wd,shortcut:Qh},{id:"draw-ellipse",icon:Ol,tooltip:bd,shortcut:$h},{id:"draw-polygon",icon:Wl,tooltip:yd,shortcut:Kh},{id:"draw-text",icon:zl,tooltip:Td,shortcut:Jh}];var ix=t=>{t.selectionColor="rgba(100, 100, 255, 0.3)",hn(t),t.on("mouse:down",function(e){e.target}),t.on("mouse:move",function(e){rn(e)})};function ax(t,e,n){let o=t.slice();return o[37]=e[n],o}function sx(t,e,n){let o=t.slice();return o[40]=e[n],o}function lx(t,e,n){let o=t.slice();return o[40]=e[n],o}function cx(t,e,n){let o=t.slice();return o[40]=e[n],o}function ux(t,e,n){let o=t.slice();return o[40]=e[n],o}function dx(t,e,n){let o=t.slice();return o[40]=e[n],o}function T2(t){let e,n=t[40].icon+"",o;return{c(){e=new Je(!1),o=He(),e.a=o},m(r,i){e.m(n,r,i),Z(r,o,i)},p:_e,d(r){r&&(J(o),e.d())}}}function fx(t){let e,n;function o(){return t[15](t[40])}return e=new Nt({props:{keyCombination:t[40].shortcut}}),e.$on("action",o),{c(){pe(e.$$.fragment)},m(r,i){ue(e,r,i),n=!0},p(r,i){t=r},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){Y(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function px(t){let e,n,o,r;function i(){return t[14](t[40])}e=new yt({props:{class:"tool-icon-button "+(t[0]==t[40].id?"active-tool":""),iconSize:t[2],tooltip:t[40].tooltip()+" ("+wt(t[40].shortcut)+")",active:t[0]===t[40].id,$$slots:{default:[T2]},$$scope:{ctx:t}}}),e.$on("click",i);let a=t[8]&&!t[9]&&fx(t);return{c(){pe(e.$$.fragment),n=ke(),a&&a.c(),o=He()},m(s,c){ue(e,s,c),Z(s,n,c),a&&a.m(s,c),Z(s,o,c),r=!0},p(s,c){t=s;let l={};c[0]&1&&(l.class="tool-icon-button "+(t[0]==t[40].id?"active-tool":"")),c[0]&4&&(l.iconSize=t[2]),c[0]&1&&(l.active=t[0]===t[40].id),c[1]&1048576&&(l.$$scope={dirty:c,ctx:t}),e.$set(l),t[8]&&!t[9]?a?(a.p(t,c),c[0]&768&&q(a,1)):(a=fx(t),a.c(),q(a,1),a.m(o.parentNode,o)):a&&(De(),Y(a,1,1,()=>{a=null}),Fe())},i(s){r||(q(e.$$.fragment,s),q(a),r=!0)},o(s){Y(e.$$.fragment,s),Y(a),r=!1},d(s){s&&(J(n),J(o)),de(e,s),a&&a.d(s)}}}function C2(t){let e,n=(t[7]?Oa:Ea)+"",o;return{c(){e=new Je(!1),o=He(),e.a=o},m(r,i){e.m(n,r,i),Z(r,o,i)},p(r,i){i[0]&128&&n!==(n=(r[7]?Oa:Ea)+"")&&e.p(n)},d(r){r&&(J(o),e.d())}}}function S2(t){let e,n;return e=new yt({props:{class:"top-tool-icon-button border-radius dropdown-tool-mode",slot:"reference",tooltip:vd(),iconSize:t[2],$$slots:{default:[C2]},$$scope:{ctx:t}}}),e.$on("click",t[18]),{c(){pe(e.$$.fragment)},m(o,r){ue(e,o,r),n=!0},p(o,r){let i={};r[0]&4&&(i.iconSize=o[2]),r[0]&128|r[1]&1048576&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(q(e.$$.fragment,o),n=!0)},o(o){Y(e.$$.fragment,o),n=!1},d(o){de(e,o)}}}function E2(t){let e;return{c(){e=fe("span"),e.textContent=`${Hd()}`,oe(e,"class","svelte-1xb7oaz")},m(n,o){Z(n,e,o)},p:_e,d(n){n&&J(e)}}}function O2(t){let e;return{c(){e=fe("span"),e.textContent=`${Vd()}`,oe(e,"class","svelte-1xb7oaz")},m(n,o){Z(n,e,o)},p:_e,d(n){n&&J(e)}}}function A2(t){let e,n,o,r;return e=new Ir({props:{active:t[7],$$slots:{default:[E2]},$$scope:{ctx:t}}}),e.$on("click",t[16]),o=new Ir({props:{active:!t[7],$$slots:{default:[O2]},$$scope:{ctx:t}}}),o.$on("click",t[17]),{c(){pe(e.$$.fragment),n=ke(),pe(o.$$.fragment)},m(i,a){ue(e,i,a),Z(i,n,a),ue(o,i,a),r=!0},p(i,a){let s={};a[0]&128&&(s.active=i[7]),a[1]&1048576&&(s.$$scope={dirty:a,ctx:i}),e.$set(s);let c={};a[0]&128&&(c.active=!i[7]),a[1]&1048576&&(c.$$scope={dirty:a,ctx:i}),o.$set(c)},i(i){r||(q(e.$$.fragment,i),q(o.$$.fragment,i),r=!0)},o(i){Y(e.$$.fragment,i),Y(o.$$.fragment,i),r=!1},d(i){i&&J(n),de(e,i),de(o,i)}}}function N2(t){let e,n;return e=new vo({props:{slot:"floating",$$slots:{default:[A2]},$$scope:{ctx:t}}}),{c(){pe(e.$$.fragment)},m(o,r){ue(e,o,r),n=!0},p(o,r){let i={};r[0]&128|r[1]&1048576&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(q(e.$$.fragment,o),n=!0)},o(o){Y(e.$$.fragment,o),n=!1},d(o){de(e,o)}}}function R2(t){let e,n=t[40].icon+"",o;return{c(){e=new Je(!1),o=He(),e.a=o},m(r,i){e.m(n,r,i),Z(r,o,i)},p:_e,d(r){r&&(J(o),e.d())}}}function mx(t){let e,n;return e=new Nt({props:{keyCombination:t[40].shortcut}}),e.$on("action",t[40].action),{c(){pe(e.$$.fragment)},m(o,r){ue(e,o,r),n=!0},i(o){n||(q(e.$$.fragment,o),n=!0)},o(o){Y(e.$$.fragment,o),n=!1},d(o){de(e,o)}}}function hx(t){let e,n,o,r;e=new yt({props:{class:"top-tool-icon-button "+(t[40].name==="undo"?"left-border-radius":"right-border-radius"),iconSize:t[2],tooltip:t[40].tooltip()+" ("+wt(t[40].shortcut)+")",disabled:t[40].name==="undo"?!t[11].undoable:!t[11].redoable,$$slots:{default:[R2]},$$scope:{ctx:t}}}),e.$on("click",t[40].action);let i=t[8]&&!t[9]&&mx(t);return{c(){pe(e.$$.fragment),n=ke(),i&&i.c(),o=He()},m(a,s){ue(e,a,s),Z(a,n,s),i&&i.m(a,s),Z(a,o,s),r=!0},p(a,s){let c={};s[0]&4&&(c.iconSize=a[2]),s[0]&2048&&(c.disabled=a[40].name==="undo"?!a[11].undoable:!a[11].redoable),s[1]&1048576&&(c.$$scope={dirty:s,ctx:a}),e.$set(c),a[8]&&!a[9]?i?s[0]&768&&q(i,1):(i=mx(a),i.c(),q(i,1),i.m(o.parentNode,o)):i&&(De(),Y(i,1,1,()=>{i=null}),Fe())},i(a){r||(q(e.$$.fragment,a),q(i),r=!0)},o(a){Y(e.$$.fragment,a),Y(i),r=!1},d(a){a&&(J(n),J(o)),de(e,a),i&&i.d(a)}}}function I2(t){let e,n=t[40].icon+"",o;return{c(){e=new Je(!1),o=He(),e.a=o},m(r,i){e.m(n,r,i),Z(r,o,i)},p:_e,d(r){r&&(J(o),e.d())}}}function gx(t){let e,n;function o(){return t[21](t[40])}return e=new Nt({props:{keyCombination:t[40].shortcut}}),e.$on("action",o),{c(){pe(e.$$.fragment)},m(r,i){ue(e,r,i),n=!0},p(r,i){t=r},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){Y(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function bx(t){let e,n,o,r;function i(){return t[20](t[40])}e=new yt({props:{class:"top-tool-icon-button "+(t[40].name==="zoomOut"?"left-border-radius":"")+" "+(t[40].name==="zoomReset"?"right-border-radius":""),iconSize:t[2],tooltip:t[40].tooltip()+" ("+wt(t[40].shortcut)+")",$$slots:{default:[I2]},$$scope:{ctx:t}}}),e.$on("click",i);let a=t[8]&&!t[9]&&gx(t);return{c(){pe(e.$$.fragment),n=ke(),a&&a.c(),o=He()},m(s,c){ue(e,s,c),Z(s,n,c),a&&a.m(s,c),Z(s,o,c),r=!0},p(s,c){t=s;let l={};c[0]&4&&(l.iconSize=t[2]),c[1]&1048576&&(l.$$scope={dirty:c,ctx:t}),e.$set(l),t[8]&&!t[9]?a?(a.p(t,c),c[0]&768&&q(a,1)):(a=gx(t),a.c(),q(a,1),a.m(o.parentNode,o)):a&&(De(),Y(a,1,1,()=>{a=null}),Fe())},i(s){r||(q(e.$$.fragment,s),q(a),r=!0)},o(s){Y(e.$$.fragment,s),Y(a),r=!1},d(s){s&&(J(n),J(o)),de(e,s),a&&a.d(s)}}}function D2(t){let e,n;return{c(){e=new Je(!1),n=He(),e.a=n},m(o,r){e.m(Al,o,r),Z(o,n,r)},p:_e,d(o){o&&(J(n),e.d())}}}function xx(t){let e,n;return e=new Nt({props:{keyCombination:Yl}}),e.$on("action",t[23]),{c(){pe(e.$$.fragment)},m(o,r){ue(e,o,r),n=!0},p:_e,i(o){n||(q(e.$$.fragment,o),n=!0)},o(o){Y(e.$$.fragment,o),n=!1},d(o){de(e,o)}}}function F2(t){let e,n=t[40].icon+"",o;return{c(){e=new Je(!1),o=He(),e.a=o},m(r,i){e.m(n,r,i),Z(r,o,i)},p:_e,d(r){r&&(J(o),e.d())}}}function vx(t){let e,n;function o(){return t[25](t[40])}return e=new Nt({props:{keyCombination:t[40].shortcut}}),e.$on("action",o),{c(){pe(e.$$.fragment)},m(r,i){ue(e,r,i),n=!0},p(r,i){t=r},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){Y(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function yx(t){let e,n,o,r;function i(){return t[24](t[40])}e=new yt({props:{class:"top-tool-icon-button "+(t[40].name==="duplicate"?"right-border-radius":""),iconSize:t[2],tooltip:t[40].tooltip()+" ("+wt(t[40].shortcut)+")",$$slots:{default:[F2]},$$scope:{ctx:t}}}),e.$on("click",i);let a=t[8]&&!t[9]&&vx(t);return{c(){pe(e.$$.fragment),n=ke(),a&&a.c(),o=He()},m(s,c){ue(e,s,c),Z(s,n,c),a&&a.m(s,c),Z(s,o,c),r=!0},p(s,c){t=s;let l={};c[0]&4&&(l.iconSize=t[2]),c[1]&1048576&&(l.$$scope={dirty:c,ctx:t}),e.$set(l),t[8]&&!t[9]?a?(a.p(t,c),c[0]&768&&q(a,1)):(a=vx(t),a.c(),q(a,1),a.m(o.parentNode,o)):a&&(De(),Y(a,1,1,()=>{a=null}),Fe())},i(s){r||(q(e.$$.fragment,s),q(a),r=!0)},o(s){Y(e.$$.fragment,s),Y(a),r=!1},d(s){s&&(J(n),J(o)),de(e,s),a&&a.d(s)}}}function M2(t){let e,n=t[40].icon+"",o;return{c(){e=new Je(!1),o=He(),e.a=o},m(r,i){e.m(n,r,i),Z(r,o,i)},p:_e,d(r){r&&(J(o),e.d())}}}function wx(t){let e,n;function o(){return t[27](t[40])}return e=new Nt({props:{keyCombination:t[40].shortcut}}),e.$on("action",o),{c(){pe(e.$$.fragment)},m(r,i){ue(e,r,i),n=!0},p(r,i){t=r},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){Y(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function _x(t){let e,n,o,r;function i(){return t[26](t[40])}e=new yt({props:{class:"top-tool-icon-button "+(t[40].name==="group"?"left-border-radius":""),iconSize:t[2],tooltip:t[40].tooltip()+" ("+wt(t[40].shortcut)+")",$$slots:{default:[M2]},$$scope:{ctx:t}}}),e.$on("click",i);let a=t[8]&&!t[9]&&wx(t);return{c(){pe(e.$$.fragment),n=ke(),a&&a.c(),o=He()},m(s,c){ue(e,s,c),Z(s,n,c),a&&a.m(s,c),Z(s,o,c),r=!0},p(s,c){t=s;let l={};c[0]&4&&(l.iconSize=t[2]),c[1]&1048576&&(l.$$scope={dirty:c,ctx:t}),e.$set(l),t[8]&&!t[9]?a?(a.p(t,c),c[0]&768&&q(a,1)):(a=wx(t),a.c(),q(a,1),a.m(o.parentNode,o)):a&&(De(),Y(a,1,1,()=>{a=null}),Fe())},i(s){r||(q(e.$$.fragment,s),q(a),r=!0)},o(s){Y(e.$$.fragment,s),Y(a),r=!1},d(s){s&&(J(n),J(o)),de(e,s),a&&a.d(s)}}}function P2(t){let e,n;return{c(){e=new Je(!1),n=He(),e.a=n},m(o,r){e.m(Nl,o,r),Z(o,n,r)},p:_e,d(o){o&&(J(n),e.d())}}}function L2(t){let e,n=t[37].icon+"",o;return{c(){e=new Je(!1),o=He(),e.a=o},m(r,i){e.m(n,r,i),Z(r,o,i)},p:_e,d(r){r&&(J(o),e.d())}}}function kx(t){let e,n;function o(){return t[30](t[37])}return e=new Nt({props:{keyCombination:t[37].shortcut}}),e.$on("action",o),{c(){pe(e.$$.fragment)},m(r,i){ue(e,r,i),n=!0},p(r,i){t=r},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){Y(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function Tx(t){let e,n,o,r;function i(){return t[29](t[37])}e=new yt({props:{class:"top-tool-icon-button",iconSize:t[2],tooltip:t[37].tooltip()+" ("+wt(t[37].shortcut)+")",$$slots:{default:[L2]},$$scope:{ctx:t}}}),e.$on("click",i);let a=t[8]&&!t[9]&&kx(t);return{c(){pe(e.$$.fragment),n=ke(),a&&a.c(),o=He()},m(s,c){ue(e,s,c),Z(s,n,c),a&&a.m(s,c),Z(s,o,c),r=!0},p(s,c){t=s;let l={};c[0]&4&&(l.iconSize=t[2]),c[1]&1048576&&(l.$$scope={dirty:c,ctx:t}),e.$set(l),t[8]&&!t[9]?a?(a.p(t,c),c[0]&768&&q(a,1)):(a=kx(t),a.c(),q(a,1),a.m(o.parentNode,o)):a&&(De(),Y(a,1,1,()=>{a=null}),Fe())},i(s){r||(q(e.$$.fragment,s),q(a),r=!0)},o(s){Y(e.$$.fragment,s),Y(a),r=!1},d(s){s&&(J(n),J(o)),de(e,s),a&&a.d(s)}}}function B2(t){let e,n,o,r,i,a,s,c,l,u,d,f,p,m,h,b,x,T,B,A,S,H=Ve(Ac),j=[];for(let U=0;U<H.length;U+=1)j[U]=px(dx(t,H,U));let M=U=>Y(j[U],1,1,()=>{j[U]=null});i=new Co({props:{show:t[6],closeOnInsideClick:!0,inline:!0,$$slots:{floating:[N2],reference:[S2]},$$scope:{ctx:t}}}),i.$on("close",t[19]);let I=Ve($l),O=[];for(let U=0;U<I.length;U+=1)O[U]=hx(ux(t,I,U));let Q=U=>Y(O[U],1,1,()=>{O[U]=null}),v=Ve(Ec),k=[];for(let U=0;U<v.length;U+=1)k[U]=bx(cx(t,v,U));let R=U=>Y(k[U],1,1,()=>{k[U]=null});f=new yt({props:{class:"top-tool-icon-button left-border-radius",iconSize:t[2],tooltip:Cd()+" ("+wt(Yl)+")",$$slots:{default:[D2]},$$scope:{ctx:t}}}),f.$on("click",t[22]);let N=t[8]&&!t[9]&&xx(t),W=Ve(Sc),C=[];for(let U=0;U<W.length;U+=1)C[U]=yx(lx(t,W,U));let w=U=>Y(C[U],1,1,()=>{C[U]=null}),D=Ve(Cc),_=[];for(let U=0;U<D.length;U+=1)_[U]=_x(sx(t,D,U));let F=U=>Y(_[U],1,1,()=>{_[U]=null});T=new yt({props:{class:"top-tool-icon-button dropdown-tool right-border-radius",iconSize:t[2],tooltip:md(),$$slots:{default:[P2]},$$scope:{ctx:t}}}),T.$on("click",t[28]);let G=Ve(Oc),$=[];for(let U=0;U<G.length;U+=1)$[U]=Tx(ax(t,G,U));let X=U=>Y($[U],1,1,()=>{$[U]=null});return{c(){e=fe("div");for(let U=0;U<j.length;U+=1)j[U].c();n=ke(),o=fe("div"),r=fe("div"),pe(i.$$.fragment),a=ke(),s=fe("div");for(let U=0;U<O.length;U+=1)O[U].c();c=ke(),l=fe("div");for(let U=0;U<k.length;U+=1)k[U].c();u=ke(),d=fe("div"),pe(f.$$.fragment),p=ke(),N&&N.c(),m=ke();for(let U=0;U<C.length;U+=1)C[U].c();h=ke(),b=fe("div");for(let U=0;U<_.length;U+=1)_[U].c();x=ke(),pe(T.$$.fragment),B=ke(),A=fe("div");for(let U=0;U<$.length;U+=1)$[U].c();oe(e,"class","tool-bar-container svelte-1xb7oaz"),oe(s,"class","undo-redo-button svelte-1xb7oaz"),oe(l,"class","tool-button-container svelte-1xb7oaz"),oe(d,"class","tool-button-container svelte-1xb7oaz"),oe(b,"class","tool-button-container svelte-1xb7oaz"),oe(r,"class","top-tool-bar-container svelte-1xb7oaz"),oe(A,"class","dropdown-content svelte-1xb7oaz"),qe(A,"left",t[4]+"px"),me(A,"show",t[3]),oe(o,"dir",t[10]),oe(o,"class","svelte-1xb7oaz")},m(U,P){Z(U,e,P);for(let V=0;V<j.length;V+=1)j[V]&&j[V].m(e,null);Z(U,n,P),Z(U,o,P),Oe(o,r),ue(i,r,null),Oe(r,a),Oe(r,s);for(let V=0;V<O.length;V+=1)O[V]&&O[V].m(s,null);Oe(r,c),Oe(r,l);for(let V=0;V<k.length;V+=1)k[V]&&k[V].m(l,null);Oe(r,u),Oe(r,d),ue(f,d,null),Oe(d,p),N&&N.m(d,null),Oe(d,m);for(let V=0;V<C.length;V+=1)C[V]&&C[V].m(d,null);Oe(r,h),Oe(r,b);for(let V=0;V<_.length;V+=1)_[V]&&_[V].m(b,null);Oe(b,x),ue(T,b,null),Oe(o,B),Oe(o,A);for(let V=0;V<$.length;V+=1)$[V]&&$[V].m(A,null);S=!0},p(U,P){if(P[0]&773){H=Ve(Ac);let L;for(L=0;L<H.length;L+=1){let re=dx(U,H,L);j[L]?(j[L].p(re,P),q(j[L],1)):(j[L]=px(re),j[L].c(),q(j[L],1),j[L].m(e,null))}for(De(),L=H.length;L<j.length;L+=1)M(L);Fe()}let V={};if(P[0]&64&&(V.show=U[6]),P[0]&196|P[1]&1048576&&(V.$$scope={dirty:P,ctx:U}),i.$set(V),P[0]&2820){I=Ve($l);let L;for(L=0;L<I.length;L+=1){let re=ux(U,I,L);O[L]?(O[L].p(re,P),q(O[L],1)):(O[L]=hx(re),O[L].c(),q(O[L],1),O[L].m(s,null))}for(De(),L=I.length;L<O.length;L+=1)Q(L);Fe()}if(P[0]&774){v=Ve(Ec);let L;for(L=0;L<v.length;L+=1){let re=cx(U,v,L);k[L]?(k[L].p(re,P),q(k[L],1)):(k[L]=bx(re),k[L].c(),q(k[L],1),k[L].m(l,null))}for(De(),L=v.length;L<k.length;L+=1)R(L);Fe()}let K={};if(P[0]&4&&(K.iconSize=U[2]),P[1]&1048576&&(K.$$scope={dirty:P,ctx:U}),f.$set(K),U[8]&&!U[9]?N?(N.p(U,P),P[0]&768&&q(N,1)):(N=xx(U),N.c(),q(N,1),N.m(d,m)):N&&(De(),Y(N,1,1,()=>{N=null}),Fe()),P[0]&774){W=Ve(Sc);let L;for(L=0;L<W.length;L+=1){let re=lx(U,W,L);C[L]?(C[L].p(re,P),q(C[L],1)):(C[L]=yx(re),C[L].c(),q(C[L],1),C[L].m(d,null))}for(De(),L=W.length;L<C.length;L+=1)w(L);Fe()}if(P[0]&774){D=Ve(Cc);let L;for(L=0;L<D.length;L+=1){let re=sx(U,D,L);_[L]?(_[L].p(re,P),q(_[L],1)):(_[L]=_x(re),_[L].c(),q(_[L],1),_[L].m(b,x))}for(De(),L=D.length;L<_.length;L+=1)F(L);Fe()}let te={};if(P[0]&4&&(te.iconSize=U[2]),P[1]&1048576&&(te.$$scope={dirty:P,ctx:U}),T.$set(te),P[0]&774){G=Ve(Oc);let L;for(L=0;L<G.length;L+=1){let re=ax(U,G,L);$[L]?($[L].p(re,P),q($[L],1)):($[L]=Tx(re),$[L].c(),q($[L],1),$[L].m(A,null))}for(De(),L=G.length;L<$.length;L+=1)X(L);Fe()}(!S||P[0]&16)&&qe(A,"left",U[4]+"px"),(!S||P[0]&8)&&me(A,"show",U[3]),(!S||P[0]&1024)&&oe(o,"dir",U[10])},i(U){if(!S){for(let P=0;P<H.length;P+=1)q(j[P]);q(i.$$.fragment,U);for(let P=0;P<I.length;P+=1)q(O[P]);for(let P=0;P<v.length;P+=1)q(k[P]);q(f.$$.fragment,U),q(N);for(let P=0;P<W.length;P+=1)q(C[P]);for(let P=0;P<D.length;P+=1)q(_[P]);q(T.$$.fragment,U);for(let P=0;P<G.length;P+=1)q($[P]);S=!0}},o(U){j=j.filter(Boolean);for(let P=0;P<j.length;P+=1)Y(j[P]);Y(i.$$.fragment,U),O=O.filter(Boolean);for(let P=0;P<O.length;P+=1)Y(O[P]);k=k.filter(Boolean);for(let P=0;P<k.length;P+=1)Y(k[P]);Y(f.$$.fragment,U),Y(N),C=C.filter(Boolean);for(let P=0;P<C.length;P+=1)Y(C[P]);_=_.filter(Boolean);for(let P=0;P<_.length;P+=1)Y(_[P]);Y(T.$$.fragment,U),$=$.filter(Boolean);for(let P=0;P<$.length;P+=1)Y($[P]);S=!1},d(U){U&&(J(e),J(n),J(o)),bt(j,U),de(i),bt(O,U),bt(k,U),de(f),N&&N.d(),bt(C,U),bt(_,U),de(T),bt($,U)}}}var Nc=" ",Cx="Control",Sx="Shift";function U2(t,e,n){let o,r,i,a,s;at(t,Yo,X=>n(7,o=X)),at(t,Wp,X=>n(8,r=X)),at(t,Or,X=>n(9,i=X)),at(t,lt,X=>n(11,s=X));let{canvas:c}=e,{iconSize:l}=e,{activeTool:u="cursor"}=e,d=!1,f=82,p=!1,m=!1,h=Pn(Bg);at(t,h,X=>n(10,a=X)),document.addEventListener("click",X=>{let U=document.querySelector(".upper-canvas");X.target==U&&n(3,d=!1)});let b=!1,x=!1,T=!1,B=!1;Tt(()=>{window.addEventListener("mousedown",()=>{window.addEventListener("keydown",X=>{X.key===Nc&&(b=!0)})}),window.addEventListener("mousemove",()=>{(b||B)&&(S(),wg(c))}),window.addEventListener("mouseup",()=>{b&&(b=!1),B&&(B=!1),S(),A(u)}),window.addEventListener("keyup",X=>{(X.key===Nc||X.key===Cx||X.key===Sx)&&(b=!1,x=!1,T=!1,B=!1,S(),A(u))}),window.addEventListener("keydown",X=>{X.key===Nc&&(b=!0),X.key===Cx&&(x=!0),X.key===Sx&&(T=!0)}),window.addEventListener("wheel",X=>{X.ctrlKey&&(x=!0),X.shiftKey&&(T=!0)}),window.addEventListener("wheel",X=>{if(X.preventDefault(),x){S(),yg(c);return}if(T){Ig(c,X);return}Rg(c,X)},{passive:!1})});let A=X=>{switch(S(),ra(c,!0),rc(c),X){case"cursor":ix(c);break;case"draw-rectangle":kc(c);break;case"draw-ellipse":_c(c);break;case"draw-polygon":nc(c);break;case"draw-text":Tc(c);break;default:break}},S=()=>{hn(c),_g(c),kg(c)};function H(X){er(Yo,o=X==="all",o),mr()}let j=X=>{n(0,u=X.id)},M=X=>{n(0,u=X.id)},I=()=>H("all"),O=()=>H("one"),Q=()=>n(6,m=!m),v=()=>n(6,m=!1),k=X=>{X.action(c)},R=X=>{X.action(c)},N=()=>{n(5,p=!p),ol(c,p)},W=()=>{n(5,p=!p),ol(c,p)},C=X=>{X.action(c),lt.onObjectModified()},w=X=>{X.action(c),mr()},D=X=>{X.action(c),lt.onObjectModified()},_=X=>{X.action(c),mr()},F=X=>{n(3,d=!d),n(4,f=X.pageX-100)},G=X=>{X.action(c),lt.onObjectModified()},$=X=>{X.action(c)};return t.$$set=X=>{"canvas"in X&&n(1,c=X.canvas),"iconSize"in X&&n(2,l=X.iconSize),"activeTool"in X&&n(0,u=X.activeTool)},t.$$.update=()=>{t.$$.dirty[0]&3&&c&&A(u)},[u,c,l,d,f,p,m,o,r,i,a,s,h,H,j,M,I,O,Q,v,k,R,N,W,C,w,D,_,F,G,$]}var Rc=class extends he{constructor(e){super(),ye(this,e,U2,B2,xe,{canvas:1,iconSize:2,activeTool:0},null,[-1,-1])}},Ex=Rc;var qa=class{constructor(e){this.Shape=Lt;this.Rectangle=yn;this.Ellipse=xn;this.Polygon=vn;this.Text=Gt;this.canvas=e}addShape(e,n){Ia(this.canvas,e,n)}addShapeGroup(e,n){Da(this.canvas,e,n)}getClozes(e){let{clozes:n,noteCount:o}=Sa(e);return{clozes:n,cardCount:o}}getShapes(){return ml()}redraw(){it(this.canvas)}clear(){Kp(this.canvas)}};function j2(t){let e,n,o,r,i,a,s,c,l;return e=new Ex({props:{canvas:t[0],iconSize:z2,activeTool:t[2]}}),{c(){pe(e.$$.fragment),n=ke(),o=fe("div"),r=fe("div"),r.innerHTML='<img id="image" class="svelte-1ivj53x"/> <canvas id="canvas"></canvas>',oe(r,"class","editor-container svelte-1ivj53x"),oe(o,"class","editor-main svelte-1ivj53x"),Mt(()=>t[6].call(o))},m(u,d){ue(e,u,d),Z(u,n,d),Z(u,o,d),Oe(o,r),a=Qr(o,t[6].bind(o)),s=!0,c||(l=Et(i=t[3].call(null,r)),c=!0)},p(u,[d]){let f={};d&1&&(f.canvas=u[0]),e.$set(f)},i(u){s||(q(e.$$.fragment,u),s=!0)},o(u){Y(e.$$.fragment,u),s=!1},d(u){u&&(J(n),J(o)),de(e,u),a(),c=!1,l()}}}var Ox=ut(Symbol());function mr(){Ox.set(Symbol())}var z2=80;function H2(t,e,n){let o,r;at(t,Ox,m=>n(5,r=m));let{mode:i}=e,a=0,s=i.kind==="add"?"draw-rectangle":"cursor",c=Qe();function l(){c("change",{canvas:o})}function u({path:m,noteId:h}){c("image-loaded",{path:m,noteId:h})}function d(m){i.kind=="add"?Mg(i.imagePath,l,u).then(h=>{n(0,o=h)}):Pg(i.noteId,l,u).then(h=>{n(0,o=h)})}Tt(()=>{window.addEventListener("resize",f)}),Tr(()=>{window.removeEventListener("resize",f)});let f=()=>{Ma(o)};function p(){a=this.clientWidth,n(1,a)}return t.$$set=m=>{"mode"in m&&n(4,i=m.mode)},t.$$.update=()=>{t.$$.dirty&1&&(globalThis.maskEditor=o?new qa(o):null),t.$$.dirty&32&&l()},n(0,o=null),[o,a,s,d,i,r,p]}var Ic=class extends he{constructor(e){super(),ye(this,e,H2,j2,xe,{mode:4})}},Ax=Ic;function V2(t){let e,n,o,r=t[3].default,i=Le(r,t,t[2],null);return{c(){e=fe("div"),i&&i.c(),oe(e,"class",n="col "+t[0]+" svelte-1wesuxj"),me(e,"col-xs",t[1]==="xs"),me(e,"col-sm",t[1]==="sm"),me(e,"col-md",t[1]==="md"),me(e,"col-lg",t[1]==="lg"),me(e,"col-xl",t[1]==="xl"),me(e,"col-xxl",t[1]==="xxl")},m(a,s){Z(a,e,s),i&&i.m(e,null),o=!0},p(a,[s]){i&&i.p&&(!o||s&4)&&Ue(i,r,a,a[2],o?Be(r,a[2],s,null):je(a[2]),null),(!o||s&1&&n!==(n="col "+a[0]+" svelte-1wesuxj"))&&oe(e,"class",n),(!o||s&3)&&me(e,"col-xs",a[1]==="xs"),(!o||s&3)&&me(e,"col-sm",a[1]==="sm"),(!o||s&3)&&me(e,"col-md",a[1]==="md"),(!o||s&3)&&me(e,"col-lg",a[1]==="lg"),(!o||s&3)&&me(e,"col-xl",a[1]==="xl"),(!o||s&3)&&me(e,"col-xxl",a[1]==="xxl")},i(a){o||(q(i,a),o=!0)},o(a){Y(i,a),o=!1},d(a){a&&J(e),i&&i.d(a)}}}function W2(t,e,n){let{$$slots:o={},$$scope:r}=e,{class:i=""}=e,{breakpoint:a="xs"}=e;return t.$$set=s=>{"class"in s&&n(0,i=s.class),"breakpoint"in s&&n(1,a=s.breakpoint),"$$scope"in s&&n(2,r=s.$$scope)},[i,a,r,o]}var Dc=class extends he{constructor(e){super(),ye(this,e,W2,V2,xe,{class:0,breakpoint:1})}},Nx=Dc;function G2(t){let e,n,o,r=t[2].default,i=Le(r,t,t[1],null);return{c(){e=fe("div"),i&&i.c(),oe(e,"class",n="row "+t[0]+" svelte-1r5bk3q")},m(a,s){Z(a,e,s),i&&i.m(e,null),o=!0},p(a,[s]){i&&i.p&&(!o||s&2)&&Ue(i,r,a,a[1],o?Be(r,a[1],s,null):je(a[1]),null),(!o||s&1&&n!==(n="row "+a[0]+" svelte-1r5bk3q"))&&oe(e,"class",n)},i(a){o||(q(i,a),o=!0)},o(a){Y(i,a),o=!1},d(a){a&&J(e),i&&i.d(a)}}}function q2(t,e,n){let{$$slots:o={},$$scope:r}=e,{class:i=""}=e;return t.$$set=a=>{"class"in a&&n(0,i=a.class),"$$scope"in a&&n(1,r=a.$$scope)},[i,r,o]}var Fc=class extends he{constructor(e){super(),ye(this,e,q2,G2,xe,{class:0})}},li=Fc;var Rx=()=>{let t=document.activeElement;if(!t||!t.id.includes("--"))return;let e=t.id.split("--")[0],n=`${e}--div`,o=`${e}--textarea`,r=document.getElementById(n),i=document.getElementById(o);r.style.display=="none"?(r.style.display="block",i.style.display="none",r.focus()):(r.style.display="none",i.style.display="block",i.focus())};function Ix(t,e,n){let o=t.slice();return o[3]=e[n],o}function X2(t){let e,n=t[3].icon+"",o;return{c(){e=new Je(!1),o=ke(),e.a=o},m(r,i){e.m(n,r,i),Z(r,o,i)},p:_e,d(r){r&&(e.d(),J(o))}}}function Dx(t){let e,n;function o(){return t[2](t[3])}return e=new yt({props:{class:"note-tool-icon-button right-border-radius",iconSize:t[0],tooltip:t[3].title,$$slots:{default:[X2]},$$scope:{ctx:t}}}),e.$on("click",o),{c(){pe(e.$$.fragment)},m(r,i){ue(e,r,i),n=!0},p(r,i){t=r;let a={};i&1&&(a.iconSize=t[0]),i&64&&(a.$$scope={dirty:i,ctx:t}),e.$set(a)},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){Y(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function Y2(t){let e,n,o=Ve(t[1]),r=[];for(let a=0;a<o.length;a+=1)r[a]=Dx(Ix(t,o,a));let i=a=>Y(r[a],1,1,()=>{r[a]=null});return{c(){for(let a=0;a<r.length;a+=1)r[a].c();e=He()},m(a,s){for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(a,s);Z(a,e,s),n=!0},p(a,[s]){if(s&3){o=Ve(a[1]);let c;for(c=0;c<o.length;c+=1){let l=Ix(a,o,c);r[c]?(r[c].p(l,s),q(r[c],1)):(r[c]=Dx(l),r[c].c(),q(r[c],1),r[c].m(e.parentNode,e))}for(De(),c=o.length;c<r.length;c+=1)i(c);Fe()}},i(a){if(!n){for(let s=0;s<o.length;s+=1)q(r[s]);n=!0}},o(a){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)Y(r[s]);n=!1},d(a){a&&J(e),bt(r,a)}}}function Q2(t,e,n){let{iconSize:o}=e,r=[{name:"code",title:"Code",icon:Tl,action:Rx}],i=a=>a.action();return t.$$set=a=>{"iconSize"in a&&n(0,o=a.iconSize)},[o,r,i]}var Mc=class extends he{constructor(e){super(),ye(this,e,Q2,Y2,xe,{iconSize:0})}},Fx=Mc;function Xa(t,e,n){document.execCommand(t,e,n)}function Mr(t){let e=t.getRootNode();return e.getSelection?e.getSelection():document.getSelection()}function Mx(t){let e=t.rangeCount;return e===0?null:t.getRangeAt(e-1)}function Px(t,e,n){if(!t.parentNode||t===e)return n;{let o=t.parentNode,r=[Array.prototype.indexOf.call(t.parentNode.childNodes,t),...n];return Px(o,e,r)}}function ci(t,e){return Px(t,e,[])}function ui(t,e){if(e.length===0)return t;if(t.childNodes[e[0]]){let[n,...o]=e;return ui(t.childNodes[n],o)}else return null}var di=(o=>(o[o.Before=-1]="Before",o[o.Equal=0]="Equal",o[o.After=1]="After",o))(di||{});function Lx(t,e){let n=Math.min(t.coordinates.length,e.coordinates.length);for(let o=0;o<=n;o++){if(t.coordinates.length===o)return e.coordinates.length===o?t.offset<e.offset?-1:t.offset>e.offset?1:0:-1;if(e.coordinates.length===o)return 1;if(t.coordinates[o]<e.coordinates[o])return-1;if(t.coordinates[o]>e.coordinates[o])return 1}throw new Error("compareLocations: Should never happen")}function Bx(t){let e=Mr(t),n=Mx(e);if(!n)return null;let o=n.collapsed,i={coordinates:ci(e.anchorNode,t),offset:e.anchorOffset};if(o)return{anchor:i,collapsed:o};let s={coordinates:ci(e.focusNode,t),offset:e.focusOffset},l=Lx(i,s)===1?"backward":"forward";return{anchor:i,focus:s,collapsed:o,direction:l}}function $2(t){t.empty()}function K2(t,e,n,o){let r=o.focus,i=r.offset,a=ui(t,r.coordinates);o.direction==="forward"?(n.setEnd(a,i),e.addRange(n)):(e.addRange(n),e.extend(a,i))}function Ux(t){return Bx(t)}function jx(t,e){let n=Mr(t);$2(n);let o=new Range,r=ui(t,e.anchor.coordinates);o.setStart(r,e.anchor.offset),e.collapsed?(o.collapse(!0),n.addRange(o)):K2(t,n,o,e)}Rr("anki/location",{Position:di,restoreSelection:jx,saveSelection:Ux});function xr(t){return t.nodeType===Node.ELEMENT_NODE}function fi(t){return t.nodeType===Node.TEXT_NODE}function zx(t){return t.nodeType===Node.COMMENT_NODE}var Pc=t=>e=>{var i;let n=(i=Mr(e))==null?void 0:i.anchorNode;if(!n)return null;let o=null,r=xr(n)?n:n.parentElement;for(;r;)o=o||(t(r)?r:null),r=r.parentElement;return o},Hx=t=>window.getComputedStyle(t).display==="list-item",Vx=t=>t.tagName==="P",J2=t=>Hx(t)||Vx(t),zV=Pc(Hx),HV=Pc(Vx),VV=Pc(J2);function Lc(t){return t.parentNode}var Bc=class t{constructor(e,n,o){this.parent=e;this.startIndex=n;this.endIndex=o}static make(e,n,o=n+1){return new t(e,n,o)}static merge(e,n){return t.make(e.parent,e.startIndex,n.endIndex)}static fromNode(e){let n=Lc(e),o=Array.prototype.indexOf.call(n.childNodes,e);return t.make(n,o)}get firstChild(){return this.parent.childNodes[this.startIndex]}get lastChild(){return this.parent.childNodes[this.endIndex-1]}select(e){this.parent=Lc(e),this.startIndex=Array.prototype.indexOf.call(this.parent.childNodes,e),this.endIndex=this.startIndex+1}toDOMRange(){let e=new Range;if(e.setStart(this.parent,this.startIndex),e.setEnd(this.parent,this.endIndex),e.collapsed){let n=e.commonAncestorContainer.childNodes[e.startOffset];xr(n)&&e.selectNode(n)}return e}[Symbol.iterator](){let e=this.parent,n=this.endIndex,o=this.startIndex;return{next(){return o>=n?{value:null,done:!0}:{value:e.childNodes[o++],done:!1}}}}get length(){return this.endIndex-this.startIndex}toString(){let e="";for(let n of[...this])fi(n)?e+=n.data:zx(n)?e+=`<!--${n.data}-->`:xr(n)&&(e+=n.outerHTML);return e}};function qx(t,e,n){let o=t.slice();return o[4]=e[n],o}function cE(t){let e,n=t[4].icon+"",o;return{c(){e=new Je(!1),o=ke(),e.a=o},m(r,i){e.m(n,r,i),Z(r,o,i)},p:_e,d(r){r&&(e.d(),J(o))}}}function Xx(t){let e,n;function o(){return t[3](t[4])}return e=new yt({props:{id:"note-tool-"+t[4].name,class:"note-tool-icon-button "+(t[4].name==="b"?"left-border-radius":""),iconSize:t[0],tooltip:t[4].title,$$slots:{default:[cE]},$$scope:{ctx:t}}}),e.$on("click",o),{c(){pe(e.$$.fragment)},m(r,i){ue(e,r,i),n=!0},p(r,i){t=r;let a={};i&1&&(a.iconSize=t[0]),i&128&&(a.$$scope={dirty:i,ctx:t}),e.$set(a)},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){Y(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function uE(t){let e,n,o=Ve(t[1]),r=[];for(let a=0;a<o.length;a+=1)r[a]=Xx(qx(t,o,a));let i=a=>Y(r[a],1,1,()=>{r[a]=null});return{c(){for(let a=0;a<r.length;a+=1)r[a].c();e=He()},m(a,s){for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(a,s);Z(a,e,s),n=!0},p(a,[s]){if(s&7){o=Ve(a[1]);let c;for(c=0;c<o.length;c+=1){let l=qx(a,o,c);r[c]?(r[c].p(l,s),q(r[c],1)):(r[c]=Xx(l),r[c].c(),q(r[c],1),r[c].m(e.parentNode,e))}for(De(),c=o.length;c<r.length;c+=1)i(c);Fe()}},i(a){if(!n){for(let s=0;s<o.length;s+=1)q(r[s]);n=!0}},o(a){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)Y(r[s]);n=!1},d(a){a&&J(e),bt(r,a)}}}function dE(t,e,n){let{iconSize:o}=e,r=[{name:"b",title:sd(),icon:Rl,action:"bold"},{name:"i",title:Nd(),icon:Il,action:"italic"},{name:"u",title:Fd(),icon:Dl,action:"underline"}],i=s=>{Xa(s.action,!1,s.name)},a=s=>{i(s)};return t.$$set=s=>{"iconSize"in s&&n(0,o=s.iconSize)},[o,r,i,a]}var Uc=class extends he{constructor(e){super(),ye(this,e,dE,uE,xe,{iconSize:0})}},Yx=Uc;function fE(t){let e,n,o,r;return e=new Yx({props:{iconSize:Qx}}),o=new Fx({props:{iconSize:Qx}}),{c(){pe(e.$$.fragment),n=ke(),pe(o.$$.fragment)},m(i,a){ue(e,i,a),Z(i,n,a),ue(o,i,a),r=!0},p:_e,i(i){r||(q(e.$$.fragment,i),q(o.$$.fragment,i),r=!0)},o(i){Y(e.$$.fragment,i),Y(o.$$.fragment,i),r=!1},d(i){i&&J(n),de(e,i),de(o,i)}}}var Qx=80,jc=class extends he{constructor(e){super(),ye(this,e,null,fE,xe,{})}},$x=jc;var Ut="\u2237";function mi(t){return t.replace(/::/g,Ut)}function So(t){return t.replace(/\u2237/gu,"::")}function zc(t){let e=t.trim();for(;e.startsWith(":")||e.startsWith(Ut);)e=e.slice(1).trimStart();for(;e.endsWith(":")||e.endsWith(Ut);)e=e.slice(0,-1).trimEnd();return e}function Ya(t){return{id:Math.random().toString(36).substring(2),name:t,selected:!1,flash:()=>{}}}function Kx(t){return t.name}function pE(t){let e,n,o,r,i;return{c(){e=fe("input"),oe(e,"id",t[2]),oe(e,"class",n="tag-input "+t[3]+" svelte-1nk8ij0"),oe(e,"type","text"),oe(e,"tabindex","-1"),oe(e,"size","1"),me(e,"disabled",t[4])},m(a,s){Z(a,e,s),t[14](e),Yr(e,t[0]),r||(i=[Ce(e,"input",t[15]),Ce(e,"focus",t[11]),Ce(e,"blur",Wt(t[6])),Ce(e,"keydown",t[7]),Ce(e,"keydown",t[12]),Ce(e,"keyup",t[13]),Ce(e,"input",t[16]),Ce(e,"copy",Wt(t[8])),Ce(e,"paste",Wt(t[9])),Et(o=t[10].call(null,e))],r=!0)},p(a,s){s[0]&4&&oe(e,"id",a[2]),s[0]&8&&n!==(n="tag-input "+a[3]+" svelte-1nk8ij0")&&oe(e,"class",n),s[0]&1&&e.value!==a[0]&&Yr(e,a[0]),s[0]&24&&me(e,"disabled",a[4])},i:_e,o:_e,d(a){a&&J(e),t[14](null),r=!1,ze(i)}}}var vr=ut(null),zG=to(vr,t=>()=>t==null?void 0:t.blur());function mE(t,e,n){let o,r=_e,i=()=>(r(),r=mn(vr,F=>n(17,o=F)),vr);at(t,vr,F=>n(17,o=F)),t.$$.on_destroy.push(()=>r());let{id:a=void 0}=e,{class:s=""}=e,{name:c}=e,{input:l}=e,{disabled:u}=e,d=Qe();function f(){return l.selectionStart===l.selectionEnd}function p(){return l.selectionStart===0&&l.selectionEnd===0}function m(){return l.selectionStart===l.value.length&&l.selectionEnd===l.value.length}function h(F){l.setSelectionRange(F,F)}function b(){return c.length===0}async function x(F){let G=l.value.length;d("tagjoinprevious"),await vt(),h(l.value.length-G),F.preventDefault()}async function T(F,G){if(G>c.length)return;c.slice(0,G).endsWith(Ut)&&(n(0,c=c.slice(0,G-1)+c.slice(G,c.length)),await vt(),F.preventDefault(),h(G-1),d("taginput"))}function B(F){p()?x(F):T(F,l.selectionStart)}async function A(F){let G=l.value.length;d("tagjoinnext"),await vt(),h(G),F.preventDefault()}function S(F){m()?A(F):T(F,l.selectionStart+2)}function H(){n(0,c=zc(c)),c.length===0&&d("tagdelete"),d("tagaccept")}function j(F){d("tagsplit",{start:l.selectionStart,end:l.selectionEnd}),F.preventDefault()}async function M(F,G=!1){let $=l.selectionStart,X=l.selectionEnd,U=c.slice(0,$),P=c.slice(X,c.length);if(U.endsWith(Ut)){F.preventDefault(),F.stopPropagation();return}else if(U.endsWith(":")){F.preventDefault(),n(0,c=`${U.slice(0,-1)}${Ut}${c.slice(X,c.length)}`),await vt(),h($),d("taginput");return}else if(P.startsWith(":"))F.preventDefault(),n(0,c=`${U}${Ut}${c.slice(X+1,c.length)}`);else{if(G)return;F.preventDefault(),n(0,c=`${U}${Ut}${P}`)}await vt(),h($+1),d("taginput")}function I(F){switch(F.code){case"Enter":j(F);break;case"Backspace":f()&&B(F);break;case"Delete":f()&&S(F);break}qg(F)?b()?x(F):p()&&(d("tagmoveprevious"),F.preventDefault()):Xg(F)?b()?A(F):m()&&(d("tagmovenext"),F.preventDefault()):F.key===" "?M(F,!1):F.key===":"&&M(F,!0)}function O(F){let G=document.getSelection();F.clipboardData.setData("text/plain",So(G.toString()))}function Q(F){if(!F.clipboardData)return;let $=(c+F.clipboardData.getData("text/plain")).split(/\s+/).map(zc).filter(U=>U.length>0).map(mi);if($.length===0)return;let X=$.pop();for(let U of $.reverse())n(0,c=U),d("tagadd");n(0,c=X)}function v(F){c.length===0&&(F.preventDefault(),F.stopPropagation(),d("tagselectall"))}let{selectAllShortcut:k}=Pn(xo);Tt(()=>{ti(v,k,{target:l}),l.focus()});function R(F){return er(vr,o=F,o),{destroy(){o===F&&er(vr,o=null,o)}}}function N(F){Ie.call(this,t,F)}function W(F){Ie.call(this,t,F)}function C(F){Ie.call(this,t,F)}function w(F){Xe[F?"unshift":"push"](()=>{l=F,n(1,l)})}function D(){c=this.value,n(0,c)}let _=()=>d("taginput");return t.$$set=F=>{"id"in F&&n(2,a=F.id),"class"in F&&n(3,s=F.class),"name"in F&&n(0,c=F.name),"input"in F&&n(1,l=F.input),"disabled"in F&&n(4,u=F.disabled)},[c,l,a,s,u,d,H,I,O,Q,R,N,W,C,w,D,_]}var Hc=class extends he{constructor(e){super(),ye(this,e,mE,pE,xe,{id:2,class:3,name:0,input:1,disabled:4},null,[-1,-1])}},Jx=Hc;var Vc='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-dots-vertical" viewBox="0 0 24 24"><path d="M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z" /></svg>';var Wc='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-tag-outline" viewBox="0 0 24 24"><path d="M21.41 11.58L12.41 2.58A2 2 0 0 0 11 2H4A2 2 0 0 0 2 4V11A2 2 0 0 0 2.59 12.42L11.59 21.42A2 2 0 0 0 13 22A2 2 0 0 0 14.41 21.41L21.41 14.41A2 2 0 0 0 22 13A2 2 0 0 0 21.41 11.58M13 20L4 11V4H11L20 13M6.5 5A1.5 1.5 0 1 1 5 6.5A1.5 1.5 0 0 1 6.5 5Z" /></svg>';var Gc='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-tag-plus-outline" viewBox="0 0 24 24"><path d="M6.5 5A1.5 1.5 0 1 0 8 6.5A1.5 1.5 0 0 0 6.5 5M6.5 5A1.5 1.5 0 1 0 8 6.5A1.5 1.5 0 0 0 6.5 5M21.41 11.58L12.41 2.58A2 2 0 0 0 11 2H4A2 2 0 0 0 2 4V11A2 2 0 0 0 2.59 12.42L3 12.82A5.62 5.62 0 0 1 5.08 12.08L4 11V4H11L20 13L13 20L11.92 18.92A5.57 5.57 0 0 1 11.18 21L11.59 21.41A2 2 0 0 0 13 22A2 2 0 0 0 14.41 21.41L21.41 14.41A2 2 0 0 0 22 13A2 2 0 0 0 21.41 11.58M6.5 5A1.5 1.5 0 1 0 8 6.5A1.5 1.5 0 0 0 6.5 5M10 19H7V22H5V19H2V17H5V14H7V17H10Z" /></svg>';function xE(t){let e,n,o,r;return{c(){e=new Je(!1),n=ke(),o=new Je(!1),r=He(),e.a=n,o.a=r},m(i,a){e.m(Wc,i,a),Z(i,n,a),o.m(Gc,i,a),Z(i,r,a)},p:_e,d(i){i&&(e.d(),J(n),J(r),o.d())}}}function vE(t){let e,n,o,r,i,a,s,c,l,u,d;n=new pr({props:{$$slots:{default:[xE]},$$scope:{ctx:t}}});let f=t[4].default,p=Le(f,t,t[6],null);return c=new Nt({props:{keyCombination:t[0]}}),c.$on("action",t[5]),{c(){e=fe("div"),pe(n.$$.fragment),o=ke(),r=fe("span"),p&&p.c(),s=ke(),pe(c.$$.fragment),oe(r,"class","tags-info svelte-1rjs6r4"),oe(e,"class","tag-add-button svelte-1rjs6r4"),oe(e,"title",i=ys()+" ("+wt(t[0])+")"),oe(e,"role","button"),oe(e,"tabindex",a=t[1]?-1:0)},m(m,h){Z(m,e,h),ue(n,e,null),Oe(e,o),Oe(e,r),p&&p.m(r,null),Z(m,s,h),ue(c,m,h),l=!0,u||(d=[Ce(e,"click",t[3]),Ce(e,"focus",t[3])],u=!0)},p(m,[h]){let b={};h&64&&(b.$$scope={dirty:h,ctx:m}),n.$set(b),p&&p.p&&(!l||h&64)&&Ue(p,f,m,m[6],l?Be(f,m[6],h,null):je(m[6]),null),(!l||h&1&&i!==(i=ys()+" ("+wt(m[0])+")"))&&oe(e,"title",i),(!l||h&2&&a!==(a=m[1]?-1:0))&&oe(e,"tabindex",a);let x={};h&1&&(x.keyCombination=m[0]),c.$set(x)},i(m){l||(q(n.$$.fragment,m),q(p,m),q(c.$$.fragment,m),l=!0)},o(m){Y(n.$$.fragment,m),Y(p,m),Y(c.$$.fragment,m),l=!1},d(m){m&&(J(e),J(s)),de(n),p&&p.d(m),de(c,m),u=!1,ze(d)}}}function yE(t,e,n){let o;at(t,vr,u=>n(1,o=u));let{$$slots:r={},$$scope:i}=e,{keyCombination:a}=e,s=Qe();function c(){s("tagappend")}let l=()=>s("tagappend");return t.$$set=u=>{"keyCombination"in u&&n(0,a=u.keyCombination),"$$scope"in u&&n(6,i=u.$$scope)},[a,o,s,c,r,l,i]}var qc=class extends he{constructor(e){super(),ye(this,e,yE,vE,xe,{keyCombination:0})}},Zx=qc;function wE(t){let e,n;return{c(){e=new Je(!1),n=He(),e.a=n},m(o,r){e.m(Vc,o,r),Z(o,n,r)},p:_e,d(o){o&&(J(n),e.d())}}}function _E(t){let e,n,o,r,i,a;return n=new pr({props:{$$slots:{default:[wE]},$$scope:{ctx:t}}}),{c(){e=fe("div"),pe(n.$$.fragment),oe(e,"class","tags-selected-button svelte-1d1hiwg"),oe(e,"role","button"),oe(e,"tabindex","0")},m(s,c){Z(s,e,c),ue(n,e,null),r=!0,i||(a=[Et(o=t[10].call(null,e)),Ce(e,"click",t[8]),Ce(e,"keydown",function(){Jt(cc(t[9]))&&cc(t[9]).apply(this,arguments)})],i=!0)},p(s,c){t=s;let l={};c&2048&&(l.$$scope={dirty:c,ctx:t}),n.$set(l)},i(s){r||(q(n.$$.fragment,s),r=!0)},o(s){Y(n.$$.fragment,s),r=!1},d(s){s&&J(e),de(n),i=!1,ze(a)}}}function kE(t){let e=Dd()+"",n,o,r=wt(t[2])+"",i,a;return{c(){n=Ge(e),o=Ge(" ("),i=Ge(r),a=Ge(")")},m(s,c){Z(s,n,c),Z(s,o,c),Z(s,i,c),Z(s,a,c)},p:_e,d(s){s&&(J(n),J(o),J(i),J(a))}}}function TE(t){let e=Rd()+"",n,o,r=wt(t[3])+"",i,a;return{c(){n=Ge(e),o=Ge(" ("),i=Ge(r),a=Ge(")")},m(s,c){Z(s,n,c),Z(s,o,c),Z(s,i,c),Z(s,a,c)},p:_e,d(s){s&&(J(n),J(o),J(i),J(a))}}}function CE(t){let e=Id()+"",n,o,r=wt(t[4])+"",i,a;return{c(){n=Ge(e),o=Ge(" ("),i=Ge(r),a=Ge(")")},m(s,c){Z(s,n,c),Z(s,o,c),Z(s,i,c),Z(s,a,c)},p:_e,d(s){s&&(J(n),J(o),J(i),J(a))}}}function SE(t){let e,n,o,r,i,a;return e=new Ir({props:{$$slots:{default:[kE]},$$scope:{ctx:t}}}),e.$on("click",t[5]),o=new Ir({props:{$$slots:{default:[TE]},$$scope:{ctx:t}}}),o.$on("click",t[6]),i=new Ir({props:{$$slots:{default:[CE]},$$scope:{ctx:t}}}),i.$on("click",t[7]),{c(){pe(e.$$.fragment),n=ke(),pe(o.$$.fragment),r=ke(),pe(i.$$.fragment)},m(s,c){ue(e,s,c),Z(s,n,c),ue(o,s,c),Z(s,r,c),ue(i,s,c),a=!0},p(s,c){let l={};c&2048&&(l.$$scope={dirty:c,ctx:s}),e.$set(l);let u={};c&2048&&(u.$$scope={dirty:c,ctx:s}),o.$set(u);let d={};c&2048&&(d.$$scope={dirty:c,ctx:s}),i.$set(d)},i(s){a||(q(e.$$.fragment,s),q(o.$$.fragment,s),q(i.$$.fragment,s),a=!0)},o(s){Y(e.$$.fragment,s),Y(o.$$.fragment,s),Y(i.$$.fragment,s),a=!1},d(s){s&&(J(n),J(r)),de(e,s),de(o,s),de(i,s)}}}function EE(t){let e,n;return e=new vo({props:{slot:"floating",$$slots:{default:[SE]},$$scope:{ctx:t}}}),{c(){pe(e.$$.fragment)},m(o,r){ue(e,o,r),n=!0},p(o,r){let i={};r&2048&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(q(e.$$.fragment,o),n=!0)},o(o){Y(e.$$.fragment,o),n=!1},d(o){de(e,o)}}}function OE(t){let e,n;return e=new Co({props:{show:t[0],preferredPlacement:"top",portalTarget:document.body,shift:0,$$slots:{floating:[EE],default:[_E,({asReference:o})=>({10:o}),({asReference:o})=>o?1024:0]},$$scope:{ctx:t}}}),{c(){pe(e.$$.fragment)},m(o,r){ue(e,o,r),n=!0},p(o,[r]){let i={};r&1&&(i.show=o[0]),r&2049&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(q(e.$$.fragment,o),n=!0)},o(o){Y(e.$$.fragment,o),n=!1},d(o){de(e,o)}}}function AE(t,e,n){let o=Qe(),r=!1,{selectAllShortcut:i,copyShortcut:a,removeShortcut:s}=Pn(xo);return[r,o,i,a,s,()=>o("tagselectall"),()=>o("tagcopy"),()=>o("tagdelete"),()=>n(0,r=!r),()=>n(0,r=!r)]}var Xc=class extends he{constructor(e){super(),ye(this,e,AE,OE,xe,{})}},ev=Xc;function NE(t){let e,n;return e=new Zx({props:{keyCombination:t[2]}}),e.$on("tagappend",t[7]),{c(){pe(e.$$.fragment)},m(o,r){ue(e,o,r),n=!0},p(o,r){let i={};r&4&&(i.keyCombination=o[2]),e.$set(i)},i(o){n||(q(e.$$.fragment,o),n=!0)},o(o){Y(e.$$.fragment,o),n=!1},d(o){de(e,o)}}}function RE(t){let e,n;return e=new ev({}),e.$on("tagselectall",t[4]),e.$on("tagcopy",t[5]),e.$on("tagdelete",t[6]),{c(){pe(e.$$.fragment)},m(o,r){ue(e,o,r),n=!0},p:_e,i(o){n||(q(e.$$.fragment,o),n=!0)},o(o){Y(e.$$.fragment,o),n=!1},d(o){de(e,o)}}}function IE(t){let e,n,o,r,i,a,s,c=[RE,NE],l=[];function u(d,f){return d[1]?0:1}return n=u(t,-1),o=l[n]=c[n](t),{c(){e=fe("div"),o.c(),oe(e,"class","tag-options-button gap svelte-16efk4p"),Mt(()=>t[8].call(e))},m(d,f){Z(d,e,f),l[n].m(e,null),r=Qr(e,t[8].bind(e)),i=!0,a||(s=Ce(e,"mousedown",Wt(t[3])),a=!0)},p(d,[f]){let p=n;n=u(d,f),n===p?l[n].p(d,f):(De(),Y(l[p],1,1,()=>{l[p]=null}),Fe(),o=l[n],o?o.p(d,f):(o=l[n]=c[n](d),o.c()),q(o,1),o.m(e,null))},i(d){i||(q(o),i=!0)},o(d){Y(o),i=!1},d(d){d&&J(e),l[n].d(),r(),a=!1,s()}}}function DE(t,e,n){let{badgeHeight:o}=e,{tagsSelected:r}=e,{keyCombination:i}=e;function a(f){Ie.call(this,t,f)}function s(f){Ie.call(this,t,f)}function c(f){Ie.call(this,t,f)}function l(f){Ie.call(this,t,f)}function u(f){Ie.call(this,t,f)}function d(){o=this.offsetHeight,n(0,o)}return t.$$set=f=>{"badgeHeight"in f&&n(0,o=f.badgeHeight),"tagsSelected"in f&&n(1,r=f.tagsSelected),"keyCombination"in f&&n(2,i=f.keyCombination)},[o,r,i,a,s,c,l,u,d]}var Yc=class extends he{constructor(e){super(),ye(this,e,DE,IE,xe,{badgeHeight:0,tagsSelected:1,keyCombination:2})}},Qc=Yc;function FE(t){let e,n=t[6].default,o=Le(n,t,t[11],null);return{c(){o&&o.c()},m(r,i){o&&o.m(r,i),e=!0},p(r,i){o&&o.p&&(!e||i&2048)&&Ue(o,n,r,r[11],e?Be(n,r[11],i,null):je(r[11]),null)},i(r){e||(q(o,r),e=!0)},o(r){Y(o,r),e=!1},d(r){o&&o.d(r)}}}function ME(t){let e,n,o,r,i,a;return n=new pr({props:{iconSize:t[2],widthMultiplier:t[3],flipX:t[4],$$slots:{default:[FE]},$$scope:{ctx:t}}}),{c(){e=fe("button"),pe(n.$$.fragment),oe(e,"title",t[1]),oe(e,"class",o="badge "+t[0]+" svelte-tvhc1n"),oe(e,"tabindex","-1")},m(s,c){Z(s,e,c),ue(n,e,null),t[10](e),r=!0,i||(a=[Ce(e,"click",t[7]),Ce(e,"mouseenter",t[8]),Ce(e,"mouseleave",t[9])],i=!0)},p(s,[c]){let l={};c&4&&(l.iconSize=s[2]),c&8&&(l.widthMultiplier=s[3]),c&16&&(l.flipX=s[4]),c&2048&&(l.$$scope={dirty:c,ctx:s}),n.$set(l),(!r||c&2)&&oe(e,"title",s[1]),(!r||c&1&&o!==(o="badge "+s[0]+" svelte-tvhc1n"))&&oe(e,"class",o)},i(s){r||(q(n.$$.fragment,s),r=!0)},o(s){Y(n.$$.fragment,s),r=!1},d(s){s&&J(e),de(n),t[10](null),i=!1,ze(a)}}}function PE(t,e,n){let{$$slots:o={},$$scope:r}=e,{class:i=""}=e,{tooltip:a=void 0}=e,{iconSize:s=100}=e,{widthMultiplier:c=1}=e,{flipX:l=!1}=e,u=Qe(),d;Tt(()=>{u("mount",{span:d})});function f(b){Ie.call(this,t,b)}function p(b){Ie.call(this,t,b)}function m(b){Ie.call(this,t,b)}function h(b){Xe[b?"unshift":"push"](()=>{d=b,n(5,d)})}return t.$$set=b=>{"class"in b&&n(0,i=b.class),"tooltip"in b&&n(1,a=b.tooltip),"iconSize"in b&&n(2,s=b.iconSize),"widthMultiplier"in b&&n(3,c=b.widthMultiplier),"flipX"in b&&n(4,l=b.flipX),"$$scope"in b&&n(11,r=b.$$scope)},[i,a,s,c,l,d,o,f,p,m,h,r]}var $c=class extends he{constructor(e){super(),ye(this,e,PE,ME,xe,{class:0,tooltip:1,iconSize:2,widthMultiplier:3,flipX:4})}},tv=$c;var Kc=`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-x" viewBox="0 0 16 16">
  <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"/>
</svg>`;function BE(t){let e,n;return{c(){e=new Je(!1),n=He(),e.a=n},m(o,r){e.m(Kc,o,r),Z(o,n,r)},p:_e,d(o){o&&(J(n),e.d())}}}function UE(t){let e,n;return e=new tv({props:{class:"d-flex align-items-center ms-1 "+t[0],iconSize:80,$$slots:{default:[BE]},$$scope:{ctx:t}}}),e.$on("click",t[1]),{c(){pe(e.$$.fragment)},m(o,r){ue(e,o,r),n=!0},p(o,[r]){let i={};r&1&&(i.class="d-flex align-items-center ms-1 "+o[0]),r&4&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(q(e.$$.fragment,o),n=!0)},o(o){Y(e.$$.fragment,o),n=!1},d(o){de(e,o)}}}function jE(t,e,n){let{class:o=""}=e;function r(i){Ie.call(this,t,i)}return t.$$set=i=>{"class"in i&&n(0,o=i.class)},[o,r]}var Jc=class extends he{constructor(e){super(),ye(this,e,jE,UE,xe,{class:0})}},nv=Jc;var Pv=pt(Fv());var BO=t=>({tooltipObject:t&1}),Mv=t=>({createTooltip:t[1],tooltipObject:t[0]});function UO(t){let e,n=t[10].default,o=Le(n,t,t[9],Mv);return{c(){o&&o.c()},m(r,i){o&&o.m(r,i),e=!0},p(r,[i]){o&&o.p&&(!e||i&513)&&Ue(o,n,r,r[9],e?Be(n,r[9],i,BO):je(r[9]),Mv)},i(r){e||(q(o,r),e=!0)},o(r){Y(o,r),e=!1},d(r){o&&o.d(r)}}}function jO(t,e,n){let{$$slots:o={},$$scope:r}=e,{tooltip:i}=e,{trigger:a="hover focus"}=e,{placement:s="top"}=e,{html:c=!0}=e,{offset:l=[0,0]}=e,{showDelay:u=0}=e,{hideDelay:d=0}=e,f,p;function m(h){f=h,h.title=i,n(0,p=new Pv.default(h,{placement:s,html:c,offset:l,delay:{show:u,hide:d},trigger:a}))}return Tr(()=>{f==null||f.addEventListener("hidden.bs.tooltip",()=>{p==null||p.dispose()}),p==null||p.hide()}),t.$$set=h=>{"tooltip"in h&&n(2,i=h.tooltip),"trigger"in h&&n(3,a=h.trigger),"placement"in h&&n(4,s=h.placement),"html"in h&&n(5,c=h.html),"offset"in h&&n(6,l=h.offset),"showDelay"in h&&n(7,u=h.showDelay),"hideDelay"in h&&n(8,d=h.hideDelay),"$$scope"in h&&n(9,r=h.$$scope)},[p,m,i,a,s,c,l,u,d,r,o]}var Du=class extends he{constructor(e){super(),ye(this,e,jO,UO,xe,{tooltip:2,trigger:3,placement:4,html:5,offset:6,showDelay:7,hideDelay:8})}},Lv=Du;function Bv(){return{isDark:document.documentElement.classList.contains("night-mode")}}var Uv=null,ts=eo(Bv(),t=>{Uv=t});rt(ts);var zO=new MutationObserver((t,e)=>{Uv(Bv())});zO.observe(document.documentElement,{attributeFilter:["class"]});Rr("anki/theme",{pageTheme:ts});function HO(t){let e,n,o,r,i,a=t[8].default,s=Le(a,t,t[7],null);return{c(){e=fe("button"),s&&s.c(),oe(e,"class",n="tag d-inline-flex align-items-center text-nowrap ps-2 pe-1 "+t[0]+" svelte-1cw7igw"),oe(e,"tabindex","-1"),oe(e,"title",t[2]),oe(e,"data-addon-tag",t[1]),me(e,"selected",t[3]),me(e,"flashing",t[4])},m(c,l){Z(c,e,l),s&&s.m(e,null),t[11](e),o=!0,r||(i=[Ce(e,"mousemove",t[9]),Ce(e,"click",t[10])],r=!0)},p(c,[l]){s&&s.p&&(!o||l&128)&&Ue(s,a,c,c[7],o?Be(a,c[7],l,null):je(c[7]),null),(!o||l&1&&n!==(n="tag d-inline-flex align-items-center text-nowrap ps-2 pe-1 "+c[0]+" svelte-1cw7igw"))&&oe(e,"class",n),(!o||l&4)&&oe(e,"title",c[2]),(!o||l&2)&&oe(e,"data-addon-tag",c[1]),(!o||l&9)&&me(e,"selected",c[3]),(!o||l&17)&&me(e,"flashing",c[4])},i(c){o||(q(s,c),o=!0)},o(c){Y(s,c),o=!1},d(c){c&&J(e),s&&s.d(c),t[11](null),r=!1,ze(i)}}}function VO(t,e,n){let{$$slots:o={},$$scope:r}=e,{class:i=""}=e,{tagName:a}=e,{tooltip:s=void 0}=e,{selected:c=!1}=e,l=Qe(),u=!1;function d(){n(4,u=!0),setTimeout(()=>n(4,u=!1),300)}let f;Tt(()=>l("mount",{button:f}));function p(b){Ie.call(this,t,b)}function m(b){Ie.call(this,t,b)}function h(b){Xe[b?"unshift":"push"](()=>{f=b,n(5,f)})}return t.$$set=b=>{"class"in b&&n(0,i=b.class),"tagName"in b&&n(1,a=b.tagName),"tooltip"in b&&n(2,s=b.tooltip),"selected"in b&&n(3,c=b.selected),"$$scope"in b&&n(7,r=b.$$scope)},[i,a,s,c,u,f,d,r,o,p,m,h]}var Fu=class extends he{constructor(e){super(),ye(this,e,VO,HO,xe,{class:0,tagName:1,tooltip:2,selected:3,flash:6})}get flash(){return this.$$.ctx[6]}},ns=Fu;var WO=t=>({selectMode:t&128}),jv=t=>({selectMode:t[7],hoverClass:Pu}),GO=t=>({selectMode:t&128}),zv=t=>({selectMode:t[7],hoverClass:Pu}),qO=t=>({selectMode:t&128}),Hv=t=>({selectMode:t[7],hoverClass:Pu});function XO(t){let e,n,o,r;function i(c){t[19](c)}function a(c){t[20](c)}let s={class:t[3],tagName:t[2],$$slots:{default:[$O]},$$scope:{ctx:t}};return t[1]!==void 0&&(s.flash=t[1]),t[0]!==void 0&&(s.selected=t[0]),e=new ns({props:s}),Xe.push(()=>tn(e,"flash",i)),Xe.push(()=>tn(e,"selected",a)),e.$on("mousemove",t[9]),e.$on("click",t[10]),{c(){pe(e.$$.fragment)},m(c,l){ue(e,c,l),r=!0},p(c,l){let u={};l&8&&(u.class=c[3]),l&4&&(u.tagName=c[2]),l&2097284&&(u.$$scope={dirty:l,ctx:c}),!n&&l&2&&(n=!0,u.flash=c[1],en(()=>n=!1)),!o&&l&1&&(o=!0,u.selected=c[0],en(()=>o=!1)),e.$set(u)},i(c){r||(q(e.$$.fragment,c),r=!0)},o(c){Y(e.$$.fragment,c),r=!1},d(c){de(e,c)}}}function YO(t){let e,n;return e=new Lv({props:{tooltip:t[4],trigger:"hover",placement:"top",$$slots:{default:[JO,({createTooltip:o})=>({23:o}),({createTooltip:o})=>o?8388608:0]},$$scope:{ctx:t}}}),{c(){pe(e.$$.fragment)},m(o,r){ue(e,o,r),n=!0},p(o,r){let i={};r&16&&(i.tooltip=o[4]),r&10485903&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(q(e.$$.fragment,o),n=!0)},o(o){Y(e.$$.fragment,o),n=!1},d(o){de(e,o)}}}function QO(t){let e,n;return e=new ns({props:{class:t[3],tagName:t[2],$$slots:{default:[ZO]},$$scope:{ctx:t}}}),e.$on("mousemove",t[9]),e.$on("click",t[10]),{c(){pe(e.$$.fragment)},m(o,r){ue(e,o,r),n=!0},p(o,r){let i={};r&8&&(i.class=o[3]),r&4&&(i.tagName=o[2]),r&2097284&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(q(e.$$.fragment,o),n=!0)},o(o){Y(e.$$.fragment,o),n=!1},d(o){de(e,o)}}}function $O(t){let e,n,o,r,i=t[15].default,a=Le(i,t,t[21],jv);return{c(){e=fe("span"),n=Ge(t[2]),o=ke(),a&&a.c()},m(s,c){Z(s,e,c),Oe(e,n),Z(s,o,c),a&&a.m(s,c),r=!0},p(s,c){(!r||c&4)&&Zt(n,s[2]),a&&a.p&&(!r||c&2097280)&&Ue(a,i,s,s[21],r?Be(i,s[21],c,WO):je(s[21]),jv)},i(s){r||(q(a,s),r=!0)},o(s){Y(a,s),r=!1},d(s){s&&(J(e),J(o)),a&&a.d(s)}}}function KO(t){let e,n=t[11](t[2])+"",o,r,i,a=t[15].default,s=Le(a,t,t[21],zv);return{c(){e=fe("span"),o=Ge(n),r=ke(),s&&s.c()},m(c,l){Z(c,e,l),Oe(e,o),Z(c,r,l),s&&s.m(c,l),i=!0},p(c,l){(!i||l&4)&&n!==(n=c[11](c[2])+"")&&Zt(o,n),s&&s.p&&(!i||l&2097280)&&Ue(s,a,c,c[21],i?Be(a,c[21],l,GO):je(c[21]),zv)},i(c){i||(q(s,c),i=!0)},o(c){Y(s,c),i=!1},d(c){c&&(J(e),J(r)),s&&s.d(c)}}}function JO(t){let e,n,o,r;function i(l){t[16](l)}function a(l){t[17](l)}function s(...l){return t[18](t[23],...l)}let c={class:t[3],tagName:t[2],$$slots:{default:[KO]},$$scope:{ctx:t}};return t[1]!==void 0&&(c.flash=t[1]),t[0]!==void 0&&(c.selected=t[0]),e=new ns({props:c}),Xe.push(()=>tn(e,"flash",i)),Xe.push(()=>tn(e,"selected",a)),e.$on("mousemove",t[9]),e.$on("click",t[10]),e.$on("mount",s),{c(){pe(e.$$.fragment)},m(l,u){ue(e,l,u),r=!0},p(l,u){t=l;let d={};u&8&&(d.class=t[3]),u&4&&(d.tagName=t[2]),u&2097284&&(d.$$scope={dirty:u,ctx:t}),!n&&u&2&&(n=!0,d.flash=t[1],en(()=>n=!1)),!o&&u&1&&(o=!0,d.selected=t[0],en(()=>o=!1)),e.$set(d)},i(l){r||(q(e.$$.fragment,l),r=!0)},o(l){Y(e.$$.fragment,l),r=!1},d(l){de(e,l)}}}function ZO(t){let e,n,o,r=t[15].default,i=Le(r,t,t[21],Hv);return{c(){e=Ge(t[2]),n=ke(),i&&i.c()},m(a,s){Z(a,e,s),Z(a,n,s),i&&i.m(a,s),o=!0},p(a,s){(!o||s&4)&&Zt(e,a[2]),i&&i.p&&(!o||s&2097280)&&Ue(i,r,a,a[21],o?Be(r,a[21],s,qO):je(a[21]),Hv)},i(a){o||(q(i,a),o=!0)},o(a){Y(i,a),o=!1},d(a){a&&(J(e),J(n)),i&&i.d(a)}}}function e3(t){let e,n,o,r,i,a,s,c,l=[QO,YO,XO],u=[];function d(f,p){return p&68&&(o=null),f[5]?0:(o==null&&(o=!!(f[6]&&f[12](f[2]))),o?1:2)}return r=d(t,-1),i=u[r]=l[r](t),{c(){e=ke(),n=fe("div"),i.c(),oe(n,"class","svelte-cc9c1q"),me(n,"select-mode",t[7]),me(n,"night-mode",t[8].isDark),me(n,"empty",t[2]==="")},m(f,p){Z(f,e,p),Z(f,n,p),u[r].m(n,null),a=!0,s||(c=[Ce(document.body,"keydown",t[9]),Ce(document.body,"keyup",t[9])],s=!0)},p(f,[p]){let m=r;r=d(f,p),r===m?u[r].p(f,p):(De(),Y(u[m],1,1,()=>{u[m]=null}),Fe(),i=u[r],i?i.p(f,p):(i=u[r]=l[r](f),i.c()),q(i,1),i.m(n,null)),(!a||p&128)&&me(n,"select-mode",f[7]),(!a||p&256)&&me(n,"night-mode",f[8].isDark),(!a||p&4)&&me(n,"empty",f[2]==="")},i(f){a||(q(i),a=!0)},o(f){Y(i),a=!1},d(f){f&&(J(e),J(n)),u[r].d(),s=!1,ze(c)}}}var Pu="tag-icon-hover";function t3(t,e,n){let o,r;at(t,ts,O=>n(8,r=O));let{$$slots:i={},$$scope:a}=e,{name:s}=e,{class:c=""}=e,{tooltip:l}=e,{selected:u}=e,{active:d}=e,{shorten:f}=e,{flash:p}=e,m=Qe(),h=!1,b=!1;function x(O){n(13,h=Hg(O)),n(14,b=Vg(O))}function T(){m(b?"tagrange":h?"tagselect":"tagclick")}function B(O){let Q=O.split(Ut);return Q.length===1?O:`\u2026${Ut}`+Q[Q.length-1]}function A(O){return O.split(Ut).length>1}function S(O){p=O,n(1,p)}function H(O){u=O,n(0,u)}let j=(O,Q)=>O(Q.detail.button);function M(O){p=O,n(1,p)}function I(O){u=O,n(0,u)}return t.$$set=O=>{"name"in O&&n(2,s=O.name),"class"in O&&n(3,c=O.class),"tooltip"in O&&n(4,l=O.tooltip),"selected"in O&&n(0,u=O.selected),"active"in O&&n(5,d=O.active),"shorten"in O&&n(6,f=O.shorten),"flash"in O&&n(1,p=O.flash),"$$scope"in O&&n(21,a=O.$$scope)},t.$$.update=()=>{t.$$.dirty&24576&&n(7,o=h||b)},[u,p,s,c,l,d,f,o,r,x,T,B,A,h,b,i,S,H,j,M,I,a]}var Mu=class extends he{constructor(e){super(),ye(this,e,t3,e3,xe,{name:2,class:3,tooltip:4,selected:0,active:5,shorten:6,flash:1})}},Vv=Mu;function n3(t){let e,n;function o(){return t[9](t[13])}return e=new nv({props:{class:t[14]}}),e.$on("click",o),{c(){pe(e.$$.fragment)},m(r,i){ue(e,r,i),n=!0},p(r,i){t=r;let a={};i&16384&&(a.class=t[14]),e.$set(a)},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){Y(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function r3(t){let e,n;return e=new Vv({props:{name:t[0],class:t[1],tooltip:t[2],selected:t[3],active:t[4],shorten:t[5],flash:t[6],$$slots:{default:[n3,({selectMode:o,hoverClass:r})=>({13:o,14:r}),({selectMode:o,hoverClass:r})=>(o?8192:0)|(r?16384:0)]},$$scope:{ctx:t}}}),e.$on("tagrange",t[10]),e.$on("tagselect",t[11]),e.$on("tagclick",t[12]),{c(){pe(e.$$.fragment)},m(o,r){ue(e,o,r),n=!0},p(o,[r]){let i={};r&1&&(i.name=o[0]),r&2&&(i.class=o[1]),r&4&&(i.tooltip=o[2]),r&8&&(i.selected=o[3]),r&16&&(i.active=o[4]),r&32&&(i.shorten=o[5]),r&64&&(i.flash=o[6]),r&57344&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(q(e.$$.fragment,o),n=!0)},o(o){Y(e.$$.fragment,o),n=!1},d(o){de(e,o)}}}function o3(t,e,n){let{name:o}=e,{class:r=""}=e,{tooltip:i}=e,{selected:a}=e,{active:s}=e,{shorten:c}=e,{flash:l}=e,u=Qe();function d(){u("tagdelete")}let f=b=>{b||d()};function p(b){Ie.call(this,t,b)}function m(b){Ie.call(this,t,b)}let h=()=>u("tagedit");return t.$$set=b=>{"name"in b&&n(0,o=b.name),"class"in b&&n(1,r=b.class),"tooltip"in b&&n(2,i=b.tooltip),"selected"in b&&n(3,a=b.selected),"active"in b&&n(4,s=b.active),"shorten"in b&&n(5,c=b.shorten),"flash"in b&&n(6,l=b.flash)},[o,r,i,a,s,c,l,u,d,f,p,m,h]}var Lu=class extends he{constructor(e){super(),ye(this,e,o3,r3,xe,{name:0,class:1,tooltip:2,selected:3,active:4,shorten:5,flash:6})}},Wv=Lu;function i3(t){let e,n,o;return{c(){e=fe("div"),e.innerHTML="<br/>",oe(e,"class","tag-spacer svelte-1k3couf"),oe(e,"role","textbox"),oe(e,"tabindex","-1")},m(r,i){Z(r,e,i),n||(o=Ce(e,"click",t[0]),n=!0)},p:_e,i:_e,o:_e,d(r){r&&J(e),n=!1,o()}}}function a3(t){function e(n){Ie.call(this,t,n)}return[e]}var Bu=class extends he{constructor(e){super(),ye(this,e,a3,i3,xe,{})}},Gv=Bu;function s3(t){let e,n,o,r,i=t[5].default,a=Le(i,t,t[4],null);return{c(){e=fe("div"),a&&a.c(),oe(e,"tabindex","-1"),oe(e,"class","autocomplete-item svelte-k8iwcm"),oe(e,"data-addon-suggestion",t[2]),me(e,"selected",t[0]),me(e,"active",t[1])},m(s,c){Z(s,e,c),a&&a.m(e,null),t[10](e),n=!0,o||(r=[Ce(e,"mousedown",Wt(t[6])),Ce(e,"mouseup",t[7]),Ce(e,"mouseenter",t[8]),Ce(e,"mouseleave",t[9])],o=!0)},p(s,[c]){a&&a.p&&(!n||c&16)&&Ue(a,i,s,s[4],n?Be(i,s[4],c,null):je(s[4]),null),(!n||c&4)&&oe(e,"data-addon-suggestion",s[2]),(!n||c&1)&&me(e,"selected",s[0]),(!n||c&2)&&me(e,"active",s[1])},i(s){n||(q(a,s),n=!0)},o(s){Y(a,s),n=!1},d(s){s&&J(e),a&&a.d(s),t[10](null),o=!1,ze(r)}}}function l3(t,e,n){let{$$slots:o={},$$scope:r}=e,{selected:i=!1}=e,{active:a=!1}=e,{suggestion:s}=e,c;function l(m){Ie.call(this,t,m)}function u(m){Ie.call(this,t,m)}function d(m){Ie.call(this,t,m)}function f(m){Ie.call(this,t,m)}function p(m){Xe[m?"unshift":"push"](()=>{c=m,n(3,c)})}return t.$$set=m=>{"selected"in m&&n(0,i=m.selected),"active"in m&&n(1,a=m.active),"suggestion"in m&&n(2,s=m.suggestion),"$$scope"in m&&n(4,r=m.$$scope)},t.$$.update=()=>{t.$$.dirty&9&&i&&c&&c.scrollIntoViewIfNeeded({behavior:"smooth",block:"start"})},[i,a,s,c,r,o,l,u,d,f,p]}var Uu=class extends he{constructor(e){super(),ye(this,e,l3,s3,xe,{selected:0,active:1,suggestion:2})}},ju=Uu;var c3=t=>({}),qv=t=>({createAutocomplete:t[6]});function Xv(t,e,n){let o=t.slice();return o[30]=e[n],o[32]=n,o}function u3(t){let e,n,o,r,i,a=t[11].default,s=Le(a,t,t[20],qv);return{c(){e=fe("span"),s&&s.c(),oe(e,"class","autocomplete-reference svelte-1bkz961")},m(c,l){Z(c,e,l),s&&s.m(e,null),o=!0,r||(i=Et(n=t[33].call(null,e)),r=!0)},p(c,l){s&&s.p&&(!o||l[0]&1048576)&&Ue(s,a,c,c[20],o?Be(a,c[20],l,c3):je(c[20]),qv)},i(c){o||(q(s,c),o=!0)},o(c){Y(s,c),o=!1},d(c){c&&J(e),s&&s.d(c),r=!1,i()}}}function d3(t){let e,n;function o(){return t[16](t[32])}function r(){return t[17](t[32])}function i(...a){return t[18](t[32],...a)}return e=new ju({props:{suggestion:t[30],$$slots:{default:[p3]},$$scope:{ctx:t}}}),e.$on("mousedown",o),e.$on("mouseup",r),e.$on("mouseenter",i),{c(){pe(e.$$.fragment)},m(a,s){ue(e,a,s),n=!0},p(a,s){t=a;let c={};s[0]&2&&(c.suggestion=t[30]),s[0]&1048578&&(c.$$scope={dirty:s,ctx:t}),e.$set(c)},i(a){n||(q(e.$$.fragment,a),n=!0)},o(a){Y(e.$$.fragment,a),n=!1},d(a){de(e,a)}}}function f3(t){let e,n;function o(){return t[12](t[32])}function r(){return t[13](t[32])}function i(...a){return t[14](t[32],...a)}return e=new ju({props:{selected:!0,active:t[3],suggestion:t[30],$$slots:{default:[m3]},$$scope:{ctx:t}}}),e.$on("mousedown",o),e.$on("mouseup",r),e.$on("mouseenter",i),e.$on("mouseleave",t[15]),{c(){pe(e.$$.fragment)},m(a,s){ue(e,a,s),n=!0},p(a,s){t=a;let c={};s[0]&8&&(c.active=t[3]),s[0]&2&&(c.suggestion=t[30]),s[0]&1048578&&(c.$$scope={dirty:s,ctx:t}),e.$set(c)},i(a){n||(q(e.$$.fragment,a),n=!0)},o(a){Y(e.$$.fragment,a),n=!1},d(a){de(e,a)}}}function p3(t){let e=t[30]+"",n,o;return{c(){n=Ge(e),o=ke()},m(r,i){Z(r,n,i),Z(r,o,i)},p(r,i){i[0]&2&&e!==(e=r[30]+"")&&Zt(n,e)},d(r){r&&(J(n),J(o))}}}function m3(t){let e=t[30]+"",n,o;return{c(){n=Ge(e),o=ke()},m(r,i){Z(r,n,i),Z(r,o,i)},p(r,i){i[0]&2&&e!==(e=r[30]+"")&&Zt(n,e)},d(r){r&&(J(n),J(o))}}}function Yv(t){let e,n,o,r,i=[f3,d3],a=[];function s(c,l){return c[32]===c[2]?0:1}return e=s(t,[-1,-1]),n=a[e]=i[e](t),{c(){n.c(),o=He()},m(c,l){a[e].m(c,l),Z(c,o,l),r=!0},p(c,l){let u=e;e=s(c,l),e===u?a[e].p(c,l):(De(),Y(a[u],1,1,()=>{a[u]=null}),Fe(),n=a[e],n?n.p(c,l):(n=a[e]=i[e](c),n.c()),q(n,1),n.m(o.parentNode,o))},i(c){r||(q(n),r=!0)},o(c){Y(n),r=!1},d(c){c&&J(o),a[e].d(c)}}}function h3(t){let e,n,o=Ve(t[1]),r=[];for(let a=0;a<o.length;a+=1)r[a]=Yv(Xv(t,o,a));let i=a=>Y(r[a],1,1,()=>{r[a]=null});return{c(){e=fe("div");for(let a=0;a<r.length;a+=1)r[a].c();oe(e,"class","autocomplete-menu svelte-1bkz961")},m(a,s){Z(a,e,s);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(e,null);n=!0},p(a,s){if(s[0]&942){o=Ve(a[1]);let c;for(c=0;c<o.length;c+=1){let l=Xv(a,o,c);r[c]?(r[c].p(l,s),q(r[c],1)):(r[c]=Yv(l),r[c].c(),q(r[c],1),r[c].m(e,null))}for(De(),c=o.length;c<r.length;c+=1)i(c);Fe()}},i(a){if(!n){for(let s=0;s<o.length;s+=1)q(r[s]);n=!0}},o(a){r=r.filter(Boolean);for(let s=0;s<r.length;s+=1)Y(r[s]);n=!1},d(a){a&&J(e),bt(r,a)}}}function g3(t){let e,n,o;return e=new vo({props:{slot:"floating",$$slots:{default:[h3]},$$scope:{ctx:t}}}),{c(){n=fe("div"),pe(e.$$.fragment),qe(n,"display","contents"),qe(n,"--popover-padding-inline","0")},m(r,i){Z(r,n,i),ue(e,n,null),o=!0},p(r,i){let a={};i[0]&1048590&&(a.$$scope={dirty:i,ctx:r}),e.$set(a)},i(r){o||(q(e.$$.fragment,r),o=!0)},o(r){Y(e.$$.fragment,r),o=!1},d(r){r&&e&&J(n),de(e,r)}}}function b3(t){let e,n;return e=new Co({props:{keepOnKeyup:!0,show:t[4],preferredPlacement:"top",portalTarget:document.body,$$slots:{floating:[g3],default:[u3,({asReference:o})=>({33:o}),({asReference:o})=>[0,o?4:0]]},$$scope:{ctx:t}}}),e.$on("close",t[19]),{c(){pe(e.$$.fragment)},m(o,r){ue(e,o,r),n=!0},p(o,r){let i={};r[0]&16&&(i.show=o[4]),r[0]&1048590&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(q(e.$$.fragment,o),n=!0)},o(o){Y(e.$$.fragment,o),n=!1},d(o){de(e,o)}}}function x3(t,e,n){let o,r=_e,i=()=>(r(),r=mn(l,D=>n(4,o=D)),l);t.$$.on_destroy.push(()=>r());let{$$slots:a={},$$scope:s}=e,{suggestionsPromise:c}=e,{show:l}=e;i();let u=[],d=null,f=!1,p=Qe();function m(){d===null?n(2,d=0):d>=u.length-1?n(2,d=null):n(2,d++,d)}function h(){d===null?n(2,d=u.length-1):d===0?n(2,d=null):n(2,d--,d)}async function b(){p("select",{selected:u[d!=null?d:-1]})}async function x(){m(),await b()}async function T(){h(),await b()}async function B(){n(3,f=!0),p("choose",{chosen:u[d!=null?d:-1]}),await vt(),l.set(!1)}async function A(){await vt(),p("update")}function S(){return d!==null}function H(){return{selectPrevious:T,selectNext:x,chooseSelected:B,update:A,hasSelected:S}}function j(D){n(2,d=D),n(3,f=!0)}function M(D){j(D)}async function I(D){n(3,f=!1),p("select",{selected:u[D]})}function O(D,_){D.buttons===1&&j(_)}let Q=D=>M(D),v=D=>{I(D),B()},k=(D,_)=>O(_,D),R=()=>n(3,f=!1),N=D=>M(D),W=D=>{I(D),B()},C=(D,_)=>O(_,D),w=()=>l.set(!1);return t.$$set=D=>{"suggestionsPromise"in D&&n(10,c=D.suggestionsPromise),"show"in D&&i(n(0,l=D.show)),"$$scope"in D&&n(20,s=D.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1025&&c.then(D=>{l.set(D.length>0),Vn()&&navigator.userAgent.match(/Chrome\/77/)&&(D=D.slice(0,10)),n(1,u=D)})},[l,u,d,f,o,B,H,M,I,O,c,a,Q,v,k,R,N,W,C,w,s]}var zu=class extends he{constructor(e){super(),ye(this,e,x3,b3,xe,{suggestionsPromise:10,show:0},null,[-1,-1])}},Qv=zu;function $v(t,e,n){let o=t.slice();return o[75]=e[n],o[76]=e,o[77]=n,o}function Kv(t){let e,n,o,r,i,a;return e=new Nt({props:{keyCombination:ny}}),e.$on("action",t[34]),o=new Nt({props:{keyCombination:ry}}),o.$on("action",t[35]),i=new Nt({props:{keyCombination:oy}}),i.$on("action",t[36]),{c(){pe(e.$$.fragment),n=ke(),pe(o.$$.fragment),r=ke(),pe(i.$$.fragment)},m(s,c){ue(e,s,c),Z(s,n,c),ue(o,s,c),Z(s,r,c),ue(i,s,c),a=!0},p:_e,i(s){a||(q(e.$$.fragment,s),q(o.$$.fragment,s),q(i.$$.fragment,s),a=!0)},o(s){Y(e.$$.fragment,s),Y(o.$$.fragment,s),Y(i.$$.fragment,s),a=!1},d(s){s&&(J(n),J(r)),de(e,s),de(o,s),de(i,s)}}}function Jv(t){let e,n;function o(...r){return t[61](t[77],...r)}return e=new Qv({props:{suggestionsPromise:t[7],show:t[14],$$slots:{default:[v3,({createAutocomplete:r})=>({78:r}),({createAutocomplete:r})=>[0,0,r?65536:0]]},$$scope:{ctx:t}}}),e.$on("update",t[17]),e.$on("select",t[60]),e.$on("choose",o),{c(){pe(e.$$.fragment)},m(r,i){ue(e,r,i),n=!0},p(r,i){t=r;let a={};i[0]&128&&(a.suggestionsPromise=t[7]),i[0]&7688|i[2]&196608&&(a.$$scope={dirty:i,ctx:t}),e.$set(a)},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){Y(e.$$.fragment,r),n=!1},d(r){de(e,r)}}}function v3(t){let e,n,o,r;function i(T){t[46](T)}function a(T){t[47](T)}function s(){return t[48](t[75],t[78])}function c(){return t[50](t[75])}function l(...T){return t[51](t[77],...T)}function u(){return t[52](t[77])}function d(){return t[53](t[77])}function f(){return t[55](t[77])}function p(){return t[56](t[77])}function m(){return t[57](t[77])}function h(){return t[58](t[77])}function b(){return t[59](t[75],t[77])}let x={id:t[75].id,class:"position-absolute start-0 top-0 bottom-0 ps-2 py-0",disabled:t[12]};return t[9]!==void 0&&(x.name=t[9]),t[10]!==void 0&&(x.input=t[10]),e=new Jx({props:x}),Xe.push(()=>tn(e,"name",i)),Xe.push(()=>tn(e,"input",a)),e.$on("focus",s),e.$on("keydown",t[29]),e.$on("keyup",t[49]),e.$on("taginput",c),e.$on("tagsplit",l),e.$on("tagadd",u),e.$on("tagdelete",d),e.$on("tagselectall",t[54]),e.$on("tagjoinprevious",f),e.$on("tagjoinnext",p),e.$on("tagmoveprevious",m),e.$on("tagmovenext",h),e.$on("tagaccept",b),{c(){pe(e.$$.fragment)},m(T,B){ue(e,T,B),r=!0},p(T,B){t=T;let A={};B[0]&8&&(A.id=t[75].id),B[0]&4096&&(A.disabled=t[12]),!n&&B[0]&512&&(n=!0,A.name=t[9],en(()=>n=!1)),!o&&B[0]&1024&&(o=!0,A.input=t[10],en(()=>o=!1)),e.$set(A)},i(T){r||(q(e.$$.fragment,T),r=!0)},o(T){Y(e.$$.fragment,T),r=!1},d(T){de(e,T)}}}function Zv(t,e){let n,o,r,i,a,s;function c(b){e[40](b,e[75])}function l(b){e[41](b,e[75])}function u(){return e[42](e[77])}function d(){return e[43](e[77])}function f(){return e[44](e[77])}function p(){return e[45](e[77])}let m={class:"ms-0",name:e[77]===e[8]?e[9]:e[75].name,tooltip:e[75].name,active:e[77]===e[8],shorten:e[6]};e[75].flash!==void 0&&(m.flash=e[75].flash),e[75].selected!==void 0&&(m.selected=e[75].selected),o=new Wv({props:m}),Xe.push(()=>tn(o,"flash",c)),Xe.push(()=>tn(o,"selected",l)),o.$on("tagedit",u),o.$on("tagselect",d),o.$on("tagrange",f),o.$on("tagdelete",p);let h=e[77]===e[8]&&Jv(e);return{key:t,first:null,c(){n=fe("div"),pe(o.$$.fragment),a=ke(),h&&h.c(),oe(n,"class","tag-relative svelte-1abeqln"),me(n,"hide-tag",e[77]===e[8]),this.first=n},m(b,x){Z(b,n,x),ue(o,n,null),Oe(n,a),h&&h.m(n,null),s=!0},p(b,x){e=b;let T={};x[0]&776&&(T.name=e[77]===e[8]?e[9]:e[75].name),x[0]&8&&(T.tooltip=e[75].name),x[0]&264&&(T.active=e[77]===e[8]),x[0]&64&&(T.shorten=e[6]),!r&&x[0]&8&&(r=!0,T.flash=e[75].flash,en(()=>r=!1)),!i&&x[0]&8&&(i=!0,T.selected=e[75].selected,en(()=>i=!1)),o.$set(T),e[77]===e[8]?h?(h.p(e,x),x[0]&264&&q(h,1)):(h=Jv(e),h.c(),q(h,1),h.m(n,null)):h&&(De(),Y(h,1,1,()=>{h=null}),Fe()),(!s||x[0]&264)&&me(n,"hide-tag",e[77]===e[8])},i(b){s||(q(o.$$.fragment,b),q(h),s=!0)},o(b){Y(o.$$.fragment,b),Y(h),s=!1},d(b){b&&J(n),de(o),h&&h.d()}}}function y3(t){let e,n,o,r,i,a,s=[],c=new Map,l,u,d,f,p,m,h=t[13]&&Kv(t);function b(A){t[39](A)}let x={tagsSelected:t[13],keyCombination:t[1]};t[5]!==void 0&&(x.badgeHeight=t[5]),o=new Qc({props:x}),Xe.push(()=>tn(o,"badgeHeight",b)),o.$on("tagselectall",t[34]),o.$on("tagcopy",t[35]),o.$on("tagdelete",t[36]),o.$on("tagappend",t[2]);let T=Ve(t[3]),B=A=>A[75].id;for(let A=0;A<T.length;A+=1){let S=$v(t,T,A),H=B(S);c.set(H,s[A]=Zv(H,S))}return u=new Gv({}),u.$on("click",t[2]),{c(){h&&h.c(),e=ke(),n=fe("div"),r=fe("div"),pe(o.$$.fragment),a=ke();for(let A=0;A<s.length;A+=1)s[A].c();l=ke(),pe(u.$$.fragment),qe(r,"display","contents"),qe(r,"--icon-align","baseline"),oe(n,"class","tag-editor svelte-1abeqln"),Mt(()=>t[62].call(n))},m(A,S){h&&h.m(A,S),Z(A,e,S),Z(A,n,S),Oe(n,r),ue(o,r,null),Oe(n,a);for(let H=0;H<s.length;H+=1)s[H]&&s[H].m(n,null);Oe(n,l),ue(u,n,null),d=Qr(n,t[62].bind(n)),f=!0,p||(m=Ce(n,"focusout",t[33]),p=!0)},p(A,S){A[13]?h?(h.p(A,S),S[0]&8192&&q(h,1)):(h=Kv(A),h.c(),q(h,1),h.m(e.parentNode,e)):h&&(De(),Y(h,1,1,()=>{h=null}),Fe());let H={};S[0]&8192&&(H.tagsSelected=A[13]),S[0]&2&&(H.keyCombination=A[1]),!i&&S[0]&32&&(i=!0,H.badgeHeight=A[5],en(()=>i=!1)),o.$set(H),S[0]&2147475400|S[1]&11|S[2]&65536&&(T=Ve(A[3]),De(),s=Lp(s,S,B,1,A,T,c,n,Pp,Zv,l,$v),Fe())},i(A){if(!f){q(h),q(o.$$.fragment,A);for(let S=0;S<T.length;S+=1)q(s[S]);q(u.$$.fragment,A),f=!0}},o(A){Y(h),Y(o.$$.fragment,A);for(let S=0;S<s.length;S+=1)Y(s[S]);Y(u.$$.fragment,A),f=!1},d(A){A&&(J(e),J(n)),h&&h.d(A),de(o);for(let S=0;S<s.length;S+=1)s[S].d();de(u),d(),p=!1,m()}}}var ny="Control+A",ry="Control+C",oy="Backspace",ey=/^:?([^:].*?[^:]):?$/;function ty(t){return t===0}function w3(t,e,n){let o,r,i,a,s,c=_e,l=()=>(c(),c=mn(u,ne=>n(38,s=ne)),u);t.$$.on_destroy.push(()=>c());let{tags:u}=e;l();let{keyCombination:d="Control+Shift+T"}=e;Xo(xo,{selectAllShortcut:ny,copyShortcut:ry,removeShortcut:oy});let f;function p(ne){n(3,f=ne.map(we=>Ya(mi(we))))}let m=ut(!1);at(t,m,ne=>n(66,a=ne));let h=Qe(),b=Promise.resolve([]),x=b;function T(){let ne=f.map(we=>we.name).map(So);h("tagsupdate",{tags:ne}),n(7,x=b)}let B=null,A=null,S="",H,j,M=!1;async function I(ne){let{tags:we}=await Tp({input:ne,matchLimit:500});return we}function O(){let we=f[B].name;if(n(12,M=we.length===0),M)n(7,x=b);else{let dt=So(we),An=ey.test(dt)?dt.replace(ey,"$1"):dt;n(7,x=I(An).then(Hr=>(n(12,M=Hr.length===0),Hr.map(mi))))}}function Q(ne){let we=f[B];n(9,S=ne!=null?ne:we.name);let dt=H.value.length;H.setSelectionRange(dt,dt)}async function v(ne){ne.name=S,n(3,f),await vt(),H&&j.update()}function k(ne){A===null&&(A=ne)}function R(){ce();let ne=f[f.length-1];(!ne||ne.name.length>0)&&N(f.length-1,"");let we=B===null;n(8,B=null),we&&P()}function N(ne,we){f.splice(ne+1,0,Ya(we)),n(3,f),k(ne+1)}function W(ne){let we=f.map(Kx);we.splice(ne,1);let dt=we.indexOf(S);return dt>=0?(f[dt>=ne?dt+1:dt].flash(),!1):!0}async function C(ne,we,dt){let An=S.slice(0,we),Hr=S.slice(dt);n(9,S=An),await vt(),N(ne,Hr),n(8,B=null),await vt(),ne!==B&&H.setSelectionRange(0,0)}function w(ne){W(ne)&&(f.splice(ne,0,Ya(S)),n(8,B++,B),n(3,f))}function D(ne){let we=f.splice(ne,1)[0];return n(3,f),A!==null&&A>ne&&A--,we}function _(ne){return ne===f.length-1}function F(ne){if(ty(ne))return;let we=D(ne-1);n(9,S=we.name+S),n(8,B--,B),v(f[B])}function G(ne){if(_(ne))return;let we=D(ne+1);n(9,S=S+we.name),v(f[B])}function $(ne){ty(ne)||(A=ne-1,n(8,B=null),H.blur())}async function X(ne){if(_(ne)){S.length!==0&&(N(ne,""),n(8,B=null));return}A=ne+1,n(8,B=null),H.blur(),await vt(),H.setSelectionRange(0,0)}function U(ne,we){f.includes(ne)&&(W(we)||D(we))}function P(){n(8,B=A),A=null}function V(ne){if(Yg(ne)){j.selectPrevious(),ne.preventDefault();return}else if(Qg(ne)){j.selectNext(),ne.preventDefault();return}switch(ne.code){case"Tab":if(a)ne.shiftKey?j.selectPrevious():j.selectNext();else break;ne.preventDefault();break;case"Enter":j.chooseSelected(),ne.preventDefault();break}}let K=null,te=null;function L(ne){n(3,f[ne].selected=!f[ne].selected,f),n(3,f),K=ne}function re(ne){if(K===null){L(ne);return}te=ne;let we=Math.min(K,te),dt=Math.max(K,te);for(let An=we;An<=dt;An++)n(3,f[An].selected=!0,f);n(3,f)}function ce(){n(3,f=f.map(ne=>({...ne,selected:!1}))),K=null,te=null}function Te(ne){let we=ne.currentTarget;(ne.relatedTarget===null||!we.contains(ne.relatedTarget))&&ce()}function ve(ne){let we=document.createElement("textarea");we.value=ne,we.setAttribute("readonly",""),we.style.position="absolute",we.style.left="-9999px",document.body.appendChild(we),we.select(),Xa("copy"),document.body.removeChild(we)}function ie(){for(let ne of f)ne.selected=!0;n(3,f)}function ge(){let ne=f.filter(we=>we.selected).map(we=>So(we.name)).join(`
`);ve(ne),ce()}function Ee(){f.map((ne,we)=>[ne.selected,we]).filter(([ne])=>ne).reverse().forEach(([,ne])=>D(ne)),ce(),T()}let Ne,Pe;function Se(ne){Pe=ne,n(5,Pe)}function et(ne,we){t.$$.not_equal(we.flash,ne)&&(we.flash=ne,n(3,f))}function Ye(ne,we){t.$$.not_equal(we.selected,ne)&&(we.selected=ne,n(3,f))}let St=ne=>{n(8,B=ne),ce()},Ft=ne=>L(ne),ht=ne=>re(ne),En=ne=>{ce(),D(ne),T()};function ln(ne){S=ne,n(9,S)}function On(ne){H=ne,n(10,H)}let Ur=(ne,we)=>{h("tagsFocused"),n(9,S=ne.name),n(11,j=we())},jr=()=>{S.length===0&&(m==null||m.set(!1))},Io=ne=>v(ne),rs=(ne,{detail:we})=>C(ne,we.start,we.end),os=ne=>w(ne),is=ne=>D(ne),as=async()=>{f.length<=1||(H.blur(),await vt(),ie())},ss=ne=>F(ne),zr=ne=>G(ne),ls=ne=>$(ne),cs=ne=>X(ne),wi=(ne,we)=>{U(ne,we),ne&&v(ne),T(),P()},_i=({detail:ne})=>Q(ne.selected),Do=(ne,{detail:we})=>{Q(we.chosen),C(ne,we.chosen.length,we.chosen.length)};function us(){Ne=this.offsetHeight,n(4,Ne)}return t.$$set=ne=>{"tags"in ne&&l(n(0,u=ne.tags)),"keyCombination"in ne&&n(1,d=ne.keyCombination)},t.$$.update=()=>{t.$$.dirty[1]&128&&p(s),t.$$.dirty[0]&48&&n(37,o=Math.floor(Ne/Pe)),t.$$.dirty[0]&64|t.$$.dirty[1]&64&&n(6,r=r||o>2),t.$$.dirty[0]&8&&n(13,i=f.some(ne=>ne.selected))},[u,d,R,f,Ne,Pe,r,x,B,S,H,j,M,i,m,h,T,O,Q,v,C,w,D,F,G,$,X,U,P,V,L,re,ce,Te,ie,ge,Ee,o,s,Se,et,Ye,St,Ft,ht,En,ln,On,Ur,jr,Io,rs,os,is,as,ss,zr,ls,cs,wi,_i,Do,us]}var Hu=class extends he{constructor(e){super(),ye(this,e,w3,y3,xe,{tags:0,keyCombination:1,appendEmptyTag:2},null,[-1,-1,-1])}get appendEmptyTag(){return this.$$.ctx[2]}},iy=Hu;function _3(t){let e,n;return e=new iy({props:{tags:t[0],keyCombination:"Control+T"}}),e.$on("tagsupdate",t[2]),{c(){pe(e.$$.fragment)},m(o,r){ue(e,o,r),n=!0},p(o,r){let i={};r&1&&(i.tags=o[0]),e.$set(i)},i(o){n||(q(e.$$.fragment,o),n=!0)},o(o){Y(e.$$.fragment,o),n=!1},d(o){de(e,o)}}}function k3(t){let e,n,o,r;return e=new li({props:{$$slots:{default:[_3]},$$scope:{ctx:t}}}),{c(){n=fe("div"),pe(e.$$.fragment),qe(n,"display","contents"),qe(n,"--cols",o=1)},m(i,a){Z(i,n,a),ue(e,n,null),r=!0},p(i,[a]){let s={};a&11&&(s.$$scope={dirty:a,ctx:i}),e.$set(s)},i(i){r||(q(e.$$.fragment,i),r=!0)},o(i){Y(e.$$.fragment,i),r=!1},d(i){i&&e&&J(n),de(e,i)}}}function T3(t,e,n){let{tagsWritable:o}=e,r,i=({detail:a})=>{n(1,r=a.tags),o.set(r)};return t.$$set=a=>{"tagsWritable"in a&&n(0,o=a.tagsWritable)},[o,r,i]}var Vu=class extends he{constructor(e){super(),ye(this,e,T3,k3,xe,{tagsWritable:0})}},ay=Vu;function sy(t,e,n){let o=t.slice();return o[4]=e[n],o[5]=e,o[6]=n,o}function C3(t){let e=t[4].title+"",n;return{c(){n=Ge(e)},m(o,r){Z(o,n,r)},p(o,r){r&1&&e!==(e=o[4].title+"")&&Zt(n,e)},d(o){o&&J(n)}}}function S3(t){let e,n,o,r;return e=new Nx({props:{$$slots:{default:[C3]},$$scope:{ctx:t}}}),{c(){n=fe("div"),pe(e.$$.fragment),qe(n,"display","contents"),qe(n,"--col-size",o=1)},m(i,a){Z(i,n,a),ue(e,n,null),r=!0},p(i,a){let s={};a&129&&(s.$$scope={dirty:a,ctx:i}),e.$set(s)},i(i){r||(q(e.$$.fragment,i),r=!0)},o(i){Y(e.$$.fragment,i),r=!1},d(i){i&&e&&J(n),de(e,i)}}}function E3(t){let e,n,o,r,i,a,s,c;function l(){t[1].call(n,t[5],t[6])}function u(){return t[2](t[4],t[5],t[6])}function d(){t[3].call(i,t[5],t[6])}return{c(){e=fe("div"),n=fe("div"),r=ke(),i=fe("textarea"),oe(n,"id",o=t[4].id+"--div"),oe(n,"class","text-editor svelte-15uw96v"),oe(n,"contenteditable",""),t[4].divValue===void 0&&Mt(l),oe(i,"id",a=t[4].id+"--textarea"),oe(i,"class","text-area svelte-15uw96v"),oe(e,"id","note-container"),oe(e,"class","svelte-15uw96v")},m(f,p){Z(f,e,p),Oe(e,n),t[4].divValue!==void 0&&(n.innerHTML=t[4].divValue),Oe(e,r),Oe(e,i),Yr(i,t[4].textareaValue),s||(c=[Ce(n,"input",l),Ce(n,"input",u),Ce(i,"input",d)],s=!0)},p(f,p){t=f,p&1&&o!==(o=t[4].id+"--div")&&oe(n,"id",o),p&1&&t[4].divValue!==n.innerHTML&&(n.innerHTML=t[4].divValue),p&1&&a!==(a=t[4].id+"--textarea")&&oe(i,"id",a),p&1&&Yr(i,t[4].textareaValue)},d(f){f&&J(e),s=!1,ze(c)}}}function ly(t){let e,n,o,r,i,a,s,c;return e=new li({props:{$$slots:{default:[S3]},$$scope:{ctx:t}}}),i=new li({props:{$$slots:{default:[E3]},$$scope:{ctx:t}}}),{c(){n=fe("div"),pe(e.$$.fragment),r=ke(),a=fe("div"),pe(i.$$.fragment),qe(n,"display","contents"),qe(n,"--cols",o=1),qe(a,"display","contents"),qe(a,"--cols",s=1)},m(l,u){Z(l,n,u),ue(e,n,null),Z(l,r,u),Z(l,a,u),ue(i,a,null),c=!0},p(l,u){let d={};u&129&&(d.$$scope={dirty:u,ctx:l}),e.$set(d);let f={};u&129&&(f.$$scope={dirty:u,ctx:l}),i.$set(f)},i(l){c||(q(e.$$.fragment,l),q(i.$$.fragment,l),c=!0)},o(l){Y(e.$$.fragment,l),Y(i.$$.fragment,l),c=!1},d(l){l&&J(r),l&&e&&J(n),de(e,l),l&&i&&J(a),de(i,l)}}}function O3(t){let e,n,o,r,i,a,s;n=new $x({});let c=Ve(t[0]),l=[];for(let d=0;d<c.length;d+=1)l[d]=ly(sy(t,c,d));let u=d=>Y(l[d],1,1,()=>{l[d]=null});return a=new ay({props:{tagsWritable:Er}}),{c(){e=fe("div"),pe(n.$$.fragment),o=ke();for(let d=0;d<l.length;d+=1)l[d].c();r=ke(),i=fe("div"),pe(a.$$.fragment),oe(e,"class","note-toolbar svelte-15uw96v"),qe(i,"margin-top","10px"),oe(i,"class","svelte-15uw96v")},m(d,f){Z(d,e,f),ue(n,e,null),Z(d,o,f);for(let p=0;p<l.length;p+=1)l[p]&&l[p].m(d,f);Z(d,r,f),Z(d,i,f),ue(a,i,null),s=!0},p(d,[f]){if(f&1){c=Ve(d[0]);let p;for(p=0;p<c.length;p+=1){let m=sy(d,c,p);l[p]?(l[p].p(m,f),q(l[p],1)):(l[p]=ly(m),l[p].c(),q(l[p],1),l[p].m(r.parentNode,r))}for(De(),p=c.length;p<l.length;p+=1)u(p);Fe()}},i(d){if(!s){q(n.$$.fragment,d);for(let f=0;f<c.length;f+=1)q(l[f]);q(a.$$.fragment,d),s=!0}},o(d){Y(n.$$.fragment,d),l=l.filter(Boolean);for(let f=0;f<l.length;f+=1)Y(l[f]);Y(a.$$.fragment,d),s=!1},d(d){d&&(J(e),J(o),J(r),J(i)),de(n),bt(l,d),de(a)}}}function A3(t,e,n){let o=[{id:"header",title:zd(),divValue:"",textareaValue:""},{id:"back-extra",title:Bd(),divValue:"",textareaValue:""}];function r(s,c){s[c].divValue=this.innerHTML,n(0,o)}let i=(s,c,l)=>{n(0,c[l].textareaValue=s.divValue,o)};function a(s,c){s[c].textareaValue=this.value,n(0,o)}return t.$$.update=()=>{t.$$.dirty&1&&no.set(o)},[o,r,i,a]}var Wu=class extends he{constructor(e){super(),ye(this,e,A3,O3,xe,{})}},cy=Wu;function uy(t,e,n){let o=t.slice();return o[7]=e[n],o}function dy(t){let e,n=t[7].label+"",o,r,i,a,s;function c(){return t[4](t[7])}return{c(){e=fe("button"),o=Ge(n),r=ke(),oe(e,"class",i="tab-item "+(t[1]===t[7].value?"active":"")+" "+(t[7].value===1?"left-border-radius":"right-border-radius")+" svelte-1kszhh")},m(l,u){Z(l,e,u),Oe(e,o),Oe(e,r),a||(s=Ce(e,"click",c),a=!0)},p(l,u){t=l,u&2&&i!==(i="tab-item "+(t[1]===t[7].value?"active":"")+" "+(t[7].value===1?"left-border-radius":"right-border-radius")+" svelte-1kszhh")&&oe(e,"class",i)},d(l){l&&J(e),a=!1,s()}}}function N3(t){let e,n,o,r,i,a,s,c,l,u,d=Ve(t[2]),f=[];for(let p=0;p<d.length;p+=1)f[p]=dy(uy(t,d,p));return r=new Ax({props:{mode:t[0]}}),r.$on("change",t[5]),r.$on("image-loaded",t[6]),c=new cy({}),{c(){e=fe("div");for(let p=0;p<f.length;p+=1)f[p].c();n=ke(),o=fe("div"),pe(r.$$.fragment),a=ke(),s=fe("div"),pe(c.$$.fragment),oe(e,"class","tab-buttons svelte-1kszhh"),o.hidden=i=t[1]!=1,s.hidden=l=t[1]!=2},m(p,m){Z(p,e,m);for(let h=0;h<f.length;h+=1)f[h]&&f[h].m(e,null);Z(p,n,m),Z(p,o,m),ue(r,o,null),Z(p,a,m),Z(p,s,m),ue(c,s,null),u=!0},p(p,m){if(m&14){d=Ve(p[2]);let b;for(b=0;b<d.length;b+=1){let x=uy(p,d,b);f[b]?f[b].p(x,m):(f[b]=dy(x),f[b].c(),f[b].m(e,null))}for(;b<f.length;b+=1)f[b].d(1);f.length=d.length}let h={};m&1&&(h.mode=p[0]),r.$set(h),(!u||m&2&&i!==(i=p[1]!=1))&&(o.hidden=i),(!u||m&2&&l!==(l=p[1]!=2))&&(s.hidden=l)},i(p){u||(q(r.$$.fragment,p),q(c.$$.fragment,p),u=!0)},o(p){Y(r.$$.fragment,p),Y(c.$$.fragment,p),u=!1},d(p){p&&(J(e),J(n),J(o),J(a),J(s)),bt(f,p),de(r),de(c)}}}function R3(t){let e,n;return e=new Wh({props:{class:"image-occlusion",$$slots:{default:[N3]},$$scope:{ctx:t}}}),{c(){pe(e.$$.fragment)},m(o,r){ue(e,o,r),n=!0},p(o,[r]){let i={};r&1027&&(i.$$scope={dirty:r,ctx:o}),e.$set(i)},i(o){n||(q(e.$$.fragment,o),n=!0)},o(o){Y(e.$$.fragment,o),n=!1},d(o){de(e,o)}}}function I3(t,e,n){let{mode:o}=e,r=[{label:Wd(),value:1},{label:Gd(),value:2}],i=1,a=u=>{Or.set(u===2),n(1,i=u)},s=u=>a(u.value);function c(u){Ie.call(this,t,u)}function l(u){Ie.call(this,t,u)}return t.$$set=u=>{"mode"in u&&n(0,o=u.mode)},[o,i,r,a,s,c,l]}var Gu=class extends he{constructor(e){super(),ye(this,e,I3,R3,xe,{mode:0})}},fy=Gu;globalThis.anki=globalThis.anki||{};var D3=Cp({modules:[Ae.IMPORTING,Ae.DECKS,Ae.EDITING,Ae.NOTETYPES,Ae.ACTIONS,Ae.BROWSING,Ae.UNDO]});async function qu(t,e=document.body){Up(),await D3;async function n(){Vh(t,rt(Yo))}return globalThis.anki.imageOcclusion={mode:t,addNote:n},new fy({target:e,props:{mode:t}})}if(window.location.hash.startsWith("#test-")){let t=window.location.hash.replace("#test-","");qu({kind:"add",imagePath:t,notetypeId:0})}if(window.location.hash.startsWith("#testforedit-")){let t=parseInt(window.location.hash.replace("#testforedit-",""));qu({kind:"edit",noteId:t})}return id(F3);})();
/*! Bundled license information:

fabric/dist/fabric.js:
  (*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) *)

hammerjs/hammer.js:
  (*! Hammer.JS - v2.0.7 - 2016-04-22
   * http://hammerjs.github.io/
   *
   * Copyright (c) 2016 Jorik Tangelder;
   * Licensed under the MIT license *)

bootstrap/js/dist/dom/data.js:
  (*!
    * Bootstrap data.js v5.3.3 (https://getbootstrap.com/)
    * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
    *)

bootstrap/js/dist/util/index.js:
  (*!
    * Bootstrap index.js v5.3.3 (https://getbootstrap.com/)
    * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
    *)

bootstrap/js/dist/dom/event-handler.js:
  (*!
    * Bootstrap event-handler.js v5.3.3 (https://getbootstrap.com/)
    * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
    *)

bootstrap/js/dist/dom/manipulator.js:
  (*!
    * Bootstrap manipulator.js v5.3.3 (https://getbootstrap.com/)
    * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
    *)

bootstrap/js/dist/util/config.js:
  (*!
    * Bootstrap config.js v5.3.3 (https://getbootstrap.com/)
    * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
    *)

bootstrap/js/dist/base-component.js:
  (*!
    * Bootstrap base-component.js v5.3.3 (https://getbootstrap.com/)
    * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
    *)

bootstrap/js/dist/util/sanitizer.js:
  (*!
    * Bootstrap sanitizer.js v5.3.3 (https://getbootstrap.com/)
    * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
    *)

bootstrap/js/dist/dom/selector-engine.js:
  (*!
    * Bootstrap selector-engine.js v5.3.3 (https://getbootstrap.com/)
    * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
    *)

bootstrap/js/dist/util/template-factory.js:
  (*!
    * Bootstrap template-factory.js v5.3.3 (https://getbootstrap.com/)
    * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
    *)

bootstrap/js/dist/tooltip.js:
  (*!
    * Bootstrap tooltip.js v5.3.3 (https://getbootstrap.com/)
    * Copyright 2011-2024 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
    * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
    *)

lodash-es/lodash.js:
  (**
   * @license
   * Lodash (Custom Build) <https://lodash.com/>
   * Build: `lodash modularize exports="es" -o ./`
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)
*/
